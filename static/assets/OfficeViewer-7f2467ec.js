import{c as d,y as l}from"./useSetting-78313f06.js";import{f as u,E as g}from"./request-7014ab81.js";import{a5 as _,o as v,b as h,g as y,x as w}from"./index-008199ed.js";import{c as E}from"./path-229a1735.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";import"./dialog-9877e468.js";import"./index-8286893b.js";import"./vnode-5e2fd68e.js";import"./index-4ea0a277.js";import"./scroll-374ad3fb.js";import"./button-30635c71.js";import"./overlay-64b24548.js";import"./refs-9142934b.js";/* empty css                     *//* empty css               *//* empty css                  */import"./dropdown-item-28606bba.js";import"./index-60380bfa.js";import"./index-0da14aee.js";import"./dropdown-40114633.js";import"./input-73d413ba.js";import"./_initCloneObject-ffec0ace.js";import"./index-c0734d0a.js";import"./validator-38288ad7.js";import"./index-9e699d2b.js";import"./directive-20abcd4b.js";import"./base-00eb0fe9.js";const b=r=>u({url:"/onlyOffice/config/token",method:"post",data:r});const x={class:"zfile-office-viewer"},P={__name:"OfficeViewer",props:{fileName:String},setup(r){let{getPathPwd:a}=l(),n=d(),{storageKey:s,currentPath:p}=_();const c=r;v(()=>{f("".concat(n.globalConfig.onlyOfficeUrl,"/web-apps/apps/api/documents/api.js"),()=>{let o=E(p.value,c.fileName),t={storageKey:s.value,path:o,password:a()};b(t).then(e=>{let i=e.data;new DocsAPI.DocEditor("office-body",i)})})});function f(o,t){let e=document.createElement("script"),i=document.getElementsByTagName("head")[0];e.type="text/javascript",e.charset="UTF-8",e.src=o,e.addEventListener?(e.addEventListener("load",function(){t()},!1),e.addEventListener("error",function(){g.warning("调用在线文档服务失败，请检查在线文档服务是否正常")},!1)):e.attachEvent&&e.attachEvent("onreadystatechange",function(){var m=window.event.srcElement;m.readyState==="loaded"&&t()}),i.appendChild(e)}return(o,t)=>(h(),y("div",x,t[0]||(t[0]=[w("div",{id:"office-body"},null,-1)])))}},Z=O(P,[["__scopeId","data-v-c72be8c4"]]);export{Z as default};
