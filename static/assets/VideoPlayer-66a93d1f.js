import{X as na,a6 as ta,b as Fr,g as Br,x as zt,a5 as io,Y as ro,ae as ka,r as ao,o as no,aG as so,f as Gi,aj as Ra,k as ki,w as Qt,a0 as Ri,l as zn,F as oo,h as Hn}from"./index-008199ed.js";import"./tooltip-4ed993c7.js";/* empty css               */import{E as lo}from"./button-30635c71.js";import{c as ia}from"./file-0e0ba447.js";import{u as uo,c as co,F as ho}from"./useSetting-78313f06.js";import{_ as fo}from"./_plugin-vue_export-helper-c27b6911.js";import{E as po}from"./index-60380bfa.js";import"./index-4ea0a277.js";import"./request-7014ab81.js";import"./dialog-9877e468.js";import"./index-8286893b.js";import"./vnode-5e2fd68e.js";import"./scroll-374ad3fb.js";import"./overlay-64b24548.js";import"./refs-9142934b.js";import"./ArrowPathIcon-f6c0972c.js";import"./TrashIcon-6780b292.js";import"./input-73d413ba.js";import"./_initCloneObject-ffec0ace.js";/* empty css                */import"./row-5d0d9aad.js";/* empty css                  */import"./image-viewer-3212b1b6.js";import"./debounce-3f0c1a7c.js";/* empty css                     *//* empty css                 *//* empty css                  *//* empty css            */import"./baseline-content-copy-92f2b234.js";import"./path-229a1735.js";import"./base-00eb0fe9.js";import"./vue3-clipboard.esm-f774ce6a.js";import"./DocumentTextIcon-be3b1186.js";import"./CircleStackIcon-b82f03c9.js";import"./index-91840f01.js";import"./index-0da14aee.js";import"./index-293710b7.js";import"./directive-20abcd4b.js";import"./select-275ec4c7.js";import"./index-dc7d0be4.js";import"./strings-535b4609.js";import"./trash-bin-minimalistic-bold-83774240.js";import"./rename-outline-9169668c.js";import"./alert-f7baa744.js";import"./index-680901bf.js";import"./index-c0734d0a.js";import"./validator-38288ad7.js";import"./route-block-83d24a4e.js";/* empty css                     */import"./dropdown-item-28606bba.js";import"./dropdown-40114633.js";import"./index-9e699d2b.js";const mo="/assets/video-download-3a226681.png",go="/assets/video-thunder-5e7f4cec.png",vo="/assets/video-motrix-95ef7e61.png",_o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAOeUlEQVR4Xu3dy5EjuRWF4TMGyA550ibIgPZirJjFODIeaDVOaDMvSREKRdRKGy0UVF1mZTV5yGS+ACSA/G/EV1F1p7unu4pA4nEB6nK5fIeG/UN/vvyuL5df9fXyi75///zHq9/00+UP/fye+9vVr3q7cZnw7deMvy/+jPiz4s+MPz/+PyH+v//Wnx7+PmiKPIEKRUMbG/nYuIdG7Q34GPF3GTuJ4e/4hc6hDfIEDjY29njaRqN6/cSu29gxDCMTOoUKyRMoLIbS8dSs7ameS/wbx5FC/Nv9+4Gi5AlkNj7hhzl1/w1+ztghMEI4hDyBDOJJF8PgWFDzBoB745SB0UER8gQSGRs9T/nthl0MOoOM5AnswJM+n7EzYJqQlDyBDWL+OqzYP75wkd6w5fjl4eeA1eQJLDQU4MRqdrvbdK0bipWYIuwgT2AGT/s6xc+EjmA1eQITYt+auX394mfE9GAxeQI3YsGJlfw2DT+zrywaviZP4MNw8IX5fevoCF6SJ04tXiTDqTqe+L0ZOwL/mZ+cPHFaNPxzGEqPWSP4IE+cTrwYWNw7H3YNruSJ0/i2j//44sB5xGvgxOsD8sQpsMCHe/FaOOX6gDzRNYb7eCVeGyebFsgTXRrO4DPcxzIxQvTXUKfkie4M12uxuo91TrJbIE90g6c+Uuh8NCBPdGE4l89TH2l0vDYgTzRvuLf+8YcI7NfdToE80awY8nNMF7nFa6yjugF5okkM+VFSvNY6mRLIE81hyI9jdFE8JE80g1V+1CBeg/7abIg80YRo/FT0oRYNrwvIE9Vjvo8aNbouIE9UbXiHXA7xoFZvrXUC8kS1WOxDG95aKiGWJ6pE40d7mtghkCeqM5zd928uUL8GzhHIE1Vhmw+tq7wTkCeqQeNHLyruBOSJKtD40ZtKC4bkicPR+NGrCkcC8sShaPzoXWWdgDxxGFb7cRYVdQLyxCHY58f5VFEnIE8UN5T3+jcH6F8FFYPyRFHU9uPcDi8blieKiUMTNH7g0ANE8kQRcXaaI73AINrCQfcJyBNFcJkHcC8uFfF2UoA8kR17/cBzB2wPyhNZsd0HvFZ4UVCeyIZFP2CJoouC8kQWLPoByxVcFJQnsuAde4B1Ci0KyhPJMe8HtspeLixPJDXM+/0fBWCZ7OsB8kQyzPuB/aJmxttWQvJEMuz3A2lkrA+QJ5LghB+QVqapgDyRBEN/IK1oU97OEpAnduNmHyCPDFMBeWIXVv2BvBJPBeSJXTjlB+SVeFdAntiMgh+glGQFQvLEJrHnz0EfoJS3VGcF5IlN2PMHykr0TkPyxGos/AHHSLAgKE+sxsIfcIwEC4LyxCpU/AHH2nmDkDyxChV/wLF2VgjKE4ux7QfUYvO2oDyxGE9/oA47rhCTJxbh6b/Pv969/WXw9yf/HVhv0yhAnpjFRR/7/Pevl4f4zw90BNhn4yhAnpjF03+7eOJPxf/+Ofx3/z3AcqtHAfLELJ7+2z17+nvEr2E0gC027AjIEy+x77/Pmohpgf9+YN6qUYA88RJVf/usjZgWxIKh/znAlJXVgfLEJJ7++20NpgVYY0V1oDwxiXf32W9vsEiIJVa8q5A88RQn/tJIEUwLsMTCk4LyxFNc9JlGyqB2AK8svEBUnniK237SSB3UDmDa28Xb8RPyxAMW/9LJFbFIyLQAbsFioDzxgMW/dHIHtQO4tWAxUJ64M1z2+fgHY5sSwbQAt2bOB8gTd1j8S6tkUDuAMLMYKE/cofIvrSOC0cC5zVQGyhOf2PtP76igduDcXtQEyBOfGP6nd3RQO3BOL6YB8sQnhv/p1RJMC87lxTRAnrhi+J9HTUHtwLlMTAPkiSuG/3nUGNQOnMPENECeuKL4J49ag9qB/k0UBckTFP9kVHtQO9C3J0VB8gS1/xm1EkwL+vTkbIA8wVt9Z9RSUDvQnydvKS5PcOtvRi0G04J+PLk1WHcJtv/yajVYJOyHbQfq9osLb/qRV+tB7UAP7q4N1+0XzP8z6yUoKW6XrQPo9gvKfzPrKZgWtMnKgvX5Bfv/+fUYLBK256YeQOMn7P8X0HNQO9COm3oAjZ9Q/19A70HtQBtuzgVo/IT6/wLOEkwL6nZzLkDjJxQAFXC2YJGwTjcFQbp+wgJgGWcMpgV1+lgIVHygArCQMwe1A3X5WAhUfLhQAVjG2YPagZpcKwIVH6gALIQYgkXC431UBCo+sANQCHEf1A4c52MnQPGBEuBCiMdgkfAYHzsBig8X3v67DGI6mBaUd+0A2AIsh5gPFgnLeW/7YguwIGJZMC0o43d9EYeACiLWBbUDeV07AGoAyiHWB7UD+fyi78UpwIKI7cEiYXrXDoAioHKI/UHtQDrvbZ8OoCQiTbBImMZv+klUARZEpA2mBfv8oZ9FFWBBRJ5gkXCbawfARSDlEPmCacF6722fDqAkIn9QO7DGW9QBcA6gFKJMUDuw1LUD8CRyIcoGb2U2iw6gJOKYoHZgEh1AScRxEaMB/3mADqAo4thgXeABHUBJxLERi4P+Mzk5OoCSiOPDfyYnRwdQEnFssA7wgA6gJOLYYEvwAYVAJRHHBQuAz1AJWBRRPjgx+MobZwFKIsoF5cDzroeBOA5cDlEmOBC0zLUD4EKQcoi8Qe3/Otf7AOgAyiHyBMP9ba5XgnEnYDlE+mC4v931UlCuBS+HSBfcALTftQPgjUHKIdIEw/00Pt4XgLcGK4XYF+zpp/aVNwctidgWDPfzuL43IG8PXg6xPhju5/P+8H//ePnuQjlwGcTyYLif33vbj4/fUQ5cCDEfDPfLiDb/2QFQDFQG8Tq4vLOcaPOfHQDFQGUQz4PhfnnR5j87AGoByiDugxLeI3293IwAqAUogfgWDPePFW3+swNgK7AMguF+LaLNf3YA7ASUceZguF+Tt8tHu9f4CTsBBZw1OLFXl48dgKDxE04FFnC24IKOOkVbf+gAWAjM7yzBcL9uHwuAQeMnLAQWcIZguF+/jwXAoPGTKxYC8+o5GO634aMEeKTbL6gIzKzHYLjflo8KwJFuv7hQEZhXb8Fwv0XXCsCRbr/gcpDMeglO7LUr2vhkBxBYB8inh2C43y6b/wd5gnWAjFoOSnjbZ/P/IE9QD5BRi8Fwvx83+/8jeYJ6gIxaC4b7fbnZ/x/JE1e8YWgerQTD/f5Em/Z2PtkBcC4gj9qD4X6/bur/b8kTV2wH5lFzcEFH32z7byRPfGI7ML0ag+F+/55s/43kiU9MA9KrKSjhPY+J4X+QJz4xDUivlmC4fy4Tw/8gT9xhGpDW0cFw/3xeDP+DPHGHaUBaRwXD/fN6MfwP8sQdpgFpHRGc2Du3F8P/IE884LLQdEoGF3Tg5vLPKfLEA84GpFMiGO5j9KT238kTD4azAbx9eAq5g+E+vvm8+/8VeeIpjginkSsY7sM9Ofr7jDzxFIuBaaQOhvuYMrP4N5InJrEYuF/KYLiPKQsW/0byxCQWA/dLEZzYw5wFi38jeeIl7gnYZ28w3Mecmco/J0+8xLXh+2wNSnix3N2133PkiZdiS5DzAdutDYb7WCPa5pNrv16RJ2ZxPmC7NcFwH2vN1P0/I0/MojBouxjKzwXDfWzztvbpH+SJRRgFbBNP9alguI89Njz9gzyxCKOA7WL/3oPhPvbZ9PQP8sRi7AhsF0P8aPQ88ZHGqpX/W/LEYuwIAMfbsPJ/S55YhVEAcLTNT/8gT6xGdSBwjIl3+1lDnliNMwLAMVbU/E+RJzbhpCBQ1ooTf6/IE5sM9wWwLQiU8bb0vP8ceWIzioOAMjYW/TwjT2zGtiCQ38rjvnPkiV1YEATySrDwd0ue2I0LRIE8Fl70uYY8sRtTASC9nRV/U+SJJJgKAGklHvqP5IlkmAoAaWQY+o/kiWSYCgD7ZRr6j+SJpJgKAPskKviZIk8kR4EQsE3Cgp8p8kQWnBgE1klU6z9HnsiC9QBguczz/lvyRDasBwBLJDvos4Q8kRU3CAFzdt3ws5Y8kR31AcBzGff7p8gT2cXchkVB4F6C6722kCeKYFEQ+Kbgop+TJ4qIfyy3CAGh6KKfkyeKYmcA5/aW65DPUvJEcewM4KwObvxBnjgE5cI4n6LbfVPkicOwPYizKFDjv5Q8cSg6AfTugL3+V+SJw9EJoFeVNf4gT1SBdxpCbyps/EGeqAYjAfSi0sYf5Imq0AmgdRU3/iBPVIdOAK2qaLV/ijxRJeoE0J4q9vnnyBPVomIQbTi8vHcNeaJqw9kBDhChVoce7NlCnqhefIM5SozaxGuyscYf5IkmcKkIahJ1Kwed599LnmhGfMPZIcDRKt/mmyNPNIfFQRyjqcW+KfJEk1gXQEmNzvefkSeaFVMCzhAgt4bn+8/IE82jaAh5xPZzE8U9a8gTXWBKgJRix6mTIb+TJ7rBLgFSaKCefw95ojuxUstoAGvFa6aDVf458kSXGA1gjXjqd7TQ94o80TXWBvBKx3P9KfLEKQw7BRwqwqjLFf4l5InTYFqAEK+Bkwz3n5EnTmP8oceQj4NF5xMFPScb7j8jT5xWDAFZH+jfSVb3l5InTi1GBcPhItYHejN07qec578iT+AydAQsFPaBhv+SPAETHQFTg/bQ8BeRJzCBNYI2xIIuc/zF5AnMiBcXx47rw6r+JvIEFhqqClknOFKMyE5UtpuDPIENGBWU9Hb9XjPMT0KewA7jqIDCovSG7+lXnvZpyRNIZOwMWDjcLhp9fA+Z22cjTyADRgZLDcP7eNLT6IuQJ5DZcAjpy/UQCqODsTT3x+v3hOF9cfIECosnXTzxztIhDPv0NPhKyBM42DhCiClDDIdb7hTi7z78G76nwddJnkCFouHcjhSiUQ3rCTXUILxd/y5jQx/n7zT2JsgTaMzYOQxvnR7lyvG0jSH2t45iKJiJkUR0GKPHhjwaf/3YsIfpSexoDA08/l808i78HzPcPJXn8KhQAAAAAElFTkSuQmCC",yo="/assets/video-iina-1db26170.png",bo="/assets/video-vlc-54e63a7e.png",Eo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAK2UlEQVR4Xu2dC3BUZxXHD4g4VlukLRTEIKhYochjeBRaCoggpQaqBSrQWFuCwLbFDpRhQIs4Y8YRO1Lr4JSWJkCJVihgy0PerxapUhqaQrCFIkUghM1rs7sJVCYcz3d3v+Tuud+9e/dFdpPvP/OfwAzs3j0//v9zv2x2ANDS0tLS0tLS0tLS0tLS0tLS0tJqEHrhi1gJM+jrOqyAf2A5vEFeSr8exP+sVopFg59C9pJR6UrYRu7F/55WCkQJWGABoPY1Ss9K+tqZP4ZWkkQwRtGAryuG7+QAgfmFqDj+eFoJiob7nmLgbl1KNTYdEVrzx9WKQ1gFvRVDjt2VcIx8P398rRhFdfWoZbiJ2AvbCcxd/Hm0XIqAeCxDTdz19Lj5qBd/7EoREOkApWWJXvwxKMVADFdXQmkRLX7Qiz+6UgHkagXgyWrAzTWAvw0APh1s8Im5Qb34HZUMINfJ5yoBd/sAl/sB5zYCUHpOELaT+/Jr0YL4gVwmAIcpBQUEYKFi6C5cPy8I+TNr9eKPkFsgAQLwPgFYTzX0K+tw43ctBH4WgLwlevGHZAfkGu2BjwjAVgLwXOQeSJrnRLqU4OSORGjDr7FFSQIRe+A8pWAfQXiRaugZxQCTaQajwU8FoeSJlrz4j1SBZw2lYJFiaKk0BxGGYZiA4Owg7JpdC/359TZ7zQuAhw8rleYQzCBMMKTr6ff5U2rhy/y6m61uJBAnEAoYODPsWQGom9FSFv+NAhIPDAKBPyXnkh8nT/dD6fQAzG7Wiz/VQDgIFQwzCDMMAULCkP4xOccPJVOb6+JPJRAOgsPgqZAwZCrMMH4ShvEIeSr5R+TJftg3obkt/lQA4RDcwFBVlDkVAoSwAYI8iW7Nf0B3hxNqoH68Dwqyq6Arf20ZqWQC4QDcgrCDoUrFw/5GGNnkB8hjyCN8UDe8BvImZ/riTxYQDoGDsNsV5oqyS4WAIVPxkN9IhQFiLHmUgEG+hzzEBwjVUAYXBzwB+5dk5uJPFAiHoAJhB0O1uM2pUFWUTIWAIUAMEhAudUU4PQeheBfCOz6Ew36EQ/4SeNufzV9v2iteIByCHQwVCGEOQqbCXFEShLBIhYAhQEA5+VwOQsk6hCNlCP8MEogAgRAmGG+HfZD8ln8/HKzOnMWfTCBOu8IpFbyieCp6VxKAiw8ifLQC4djHCO8SgH+F3QDD3whDgBDeXxPy3pp62Fv9KuyuS//FHw8QDiIWGHxfqCpqXLWoodEI/1mKcPwownvBEAThIyYYAoSEYU7FwTCIfQYMhN1UY7vIO6vrYIcvD/5eeQufQ9ooViDxgHBa3MJTKAntL/emGlqEcHIvpYCGVxQMgVDBcKqoAyYYe3xmGAjbydsMl8OW6sf5LNJCsQCxA+EEwy4VA6taIVzw0DLeRMvYSxDqCIJwbSOIoyYQFhh+sbitFSVTIWBIEDsEDF8Ixpaw36xCeKPqZUBsxWfSpHIDxCkV0hyEeV8ICA+Ku6GL06iGChBOnCEINPz360IgGmC4SIWqosyp2OuLhCFSIZMhQGw2QCBsqgz5b1WL+EyaVNGAcBgcCE+GhDGNauhm71iET36P8CHtgeJgCIJ0BIjaRhgyFSoY5oqyLm5TRclUmEA0pCIMYiN5A/n1iquwtjZ93te3A8IhcBAcxgzy3RX9qIZ+iXCK9sBxGswHtZEQLKkQIEwVxUEYMEypiKgotridKmpzdSgVEoYBgrxOuBzhLxUL+FyaTBwIh6ACISsqu0rcDT1FNbSRaqgsBECagzDD4KlQwVClQsKQqZAVpV7c1lREwKhA+KuAIVy5jc+lySSBcAgqGI/QmaBVGR3IzuVTDZ0mCDTYD65EglDBsOwKxeK2gxHv4hapUFXUegajkPzn8nf5XJpMAgiHIEGIu6O+5fcjnF9GNUR74EQwBEH4eIww3KTC6WzBFzdPRcTiDleUJRXhinpNwqC7u7XkV737+FyaTHNMQASEMVV0HihdjHBmD0KJrxGA2W5ACMebCleL2xe5uLc6VJQqFRLGGgPI83wuTaaJPvAYe+CTDQj/LrUO3+xYU6GCwUHEe7YwUuGwuEVFOaVCwlgtvl4eyufSdDp51WMZvMoGiBhg8IqKNRXRKsq8uI2zBUuFZXFHVFQIhHDBpfRZ6IbcAHEDIu6K8lthSBDy2x92i5tXVMPZIkpFGSDIq8pOQUGgAx9J08oJiNuKkiAaYIRBqCrK6cTNzxY8FU6L21xRAgSvKJEKM4z8SzvgT95OfBxNLzsgqoriIOJOhaKilItbpsIEgqfCrqJUqRBeVVYKr5RN42NIH6mAcBDxwrA7catguF3cvKKUi7vcurgLvNdglfcP8MfT6futd0MSiKgntxVlt7hVFSXPFqoTd6oXt4SRX3YI8i9nyAeEJJBYQDilQllRNqmwragYFrdTKlZ7vbQrHku7b7E7SgBJFAYHwSvKdnErUqFa3KqKclrcKz6sh8cWvzhs2LD2/OWmv4oFEAcQsVaUanFLGDIVzu/mWVMRraJWX0CY9xL2HTsa87vdcQQBBvKXmTkqDjQCsQOhSkXK381jqTC+/WFKRd4W7PDQw/jz/t3xU6BSAqC/BLPIGf7RawGEg7CkQjjOVERb3KqKsqSC/NIxhNz5mDNiIJ6F1gKA9HVyAfl2/tIyU8W1ViDRUhENhtPibkiFCYQqFYXnEBa+gNnjx+CBrDvMAMwmSnAPf0mZLQ7EDgYHwRe307t5blKxkXbB0k1497SpuGbAN/nguenB4GlyZv64qKMkEA4iGRUVbXGvPIRZT87F34wZhFegLR+6yqKeCsnp8x540iWAcBiuKoqnIlxRTot73SmEZ5ehZ9I4PNPtK3zY0VxCHskvv/lJAnGbiljOFlvLEJa9hlOnP4pvDfk2H7Bb0xPCAnJbfunNU0UExHUqoi1uSsLqA/jdZ+bj+ux7ETu348ON1a+Ts/glN28JIBxGxOKWMGwqatNx7J23DJfnjMcrfboj3vYZxC+0QmxtGW4sPk3+Hr/UlqEiOofYpULcRfHFvfMCtl1eiM8+mYtnRw5A7EYp6HIzpeEmxHZtENtahhuLqTthMflz/DJbjo4SEBUMWVEH6ZZ07U6ctXghvjNxNGKfLog9b0P8xi2IXQlEFwLRke6Q2iWcis3k7vzyWp4EEH62eLMIf/jc87hlxkTE+76F2K8zgaDDWc+OiHfeHoIhU5F4RZ0lj+eX1XIlgOw5i/e9XIj582fhlQcGIw7thjj4q4iDskIwenUKpeLO9o0VJVMRf0V9Sv41+fP8klq0/pszzoPf6YE4/OuI9xKIIWEQ/ama+lEqeplSISsq8VTsJPfg16JFwlFf8+Dw7qFUSBgRFRVOhYDRWaRCLO64YZwnT+bXoGUSjiAgsqKMVIQrykjFreFUJFxR/yP/jpzZnyG/EcIhWZ5QRYVTwSsq8cV9gKz/iwu3olR4lBWV+NmilJxDzqD3s9NA2Kejx5IKubjjO1tcI79A/hJ/Li0Xwrs6TYpc3OFUxFdRh8n9+HNoxSDs2aFHEs4W5eRc1PWUHGGnmw7HubjrySvIt/LH1EpA2AaGUirEyZkP3MlHyYP5Y2klSTTcmRj6F88Hz11N9mDG/7hNBoiG/H3yxwoIwuJw9wo5zT5P0cyFMOCzNPQJGLp13UBeSZ5HTsPPUmhpaWlpaWlpaWlpaWlpaWlpaWlpaWklqv8Da8GBU4g36CAAAAAASUVORK5CYII=",So="/assets/video-mxplayer-5dfa69aa.png",Ao="/assets/video-mxplayer-pro-10406916.png";var qn={exports:{}};(function(vi,ii){(function(R,J){vi.exports=J()})(window,function(){return function(R){var J={};function w(Q){if(J[Q])return J[Q].exports;var g=J[Q]={i:Q,l:!1,exports:{}};return R[Q].call(g.exports,g,g.exports,w),g.l=!0,g.exports}return w.m=R,w.c=J,w.d=function(Q,g,p){w.o(Q,g)||Object.defineProperty(Q,g,{enumerable:!0,get:p})},w.r=function(Q){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})},w.t=function(Q,g){if(1&g&&(Q=w(Q)),8&g||4&g&&typeof Q=="object"&&Q&&Q.__esModule)return Q;var p=Object.create(null);if(w.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:Q}),2&g&&typeof Q!="string")for(var D in Q)w.d(p,D,(function(m){return Q[m]}).bind(null,D));return p},w.n=function(Q){var g=Q&&Q.__esModule?function(){return Q.default}:function(){return Q};return w.d(g,"a",g),g},w.o=function(Q,g){return Object.prototype.hasOwnProperty.call(Q,g)},w.p="",w(w.s=20)}([function(R,J,w){var Q=w(9),g=w.n(Q),p=function(){function D(){}return D.e=function(m,y){m&&!D.FORCE_GLOBAL_TAG||(m=D.GLOBAL_TAG);var _="[".concat(m,"] > ").concat(y);D.ENABLE_CALLBACK&&D.emitter.emit("log","error",_),D.ENABLE_ERROR&&(console.error?console.error(_):console.warn?console.warn(_):console.log(_))},D.i=function(m,y){m&&!D.FORCE_GLOBAL_TAG||(m=D.GLOBAL_TAG);var _="[".concat(m,"] > ").concat(y);D.ENABLE_CALLBACK&&D.emitter.emit("log","info",_),D.ENABLE_INFO&&(console.info?console.info(_):console.log(_))},D.w=function(m,y){m&&!D.FORCE_GLOBAL_TAG||(m=D.GLOBAL_TAG);var _="[".concat(m,"] > ").concat(y);D.ENABLE_CALLBACK&&D.emitter.emit("log","warn",_),D.ENABLE_WARN&&(console.warn?console.warn(_):console.log(_))},D.d=function(m,y){m&&!D.FORCE_GLOBAL_TAG||(m=D.GLOBAL_TAG);var _="[".concat(m,"] > ").concat(y);D.ENABLE_CALLBACK&&D.emitter.emit("log","debug",_),D.ENABLE_DEBUG&&(console.debug?console.debug(_):console.log(_))},D.v=function(m,y){m&&!D.FORCE_GLOBAL_TAG||(m=D.GLOBAL_TAG);var _="[".concat(m,"] > ").concat(y);D.ENABLE_CALLBACK&&D.emitter.emit("log","verbose",_),D.ENABLE_VERBOSE&&console.log(_)},D}();p.GLOBAL_TAG="mpegts.js",p.FORCE_GLOBAL_TAG=!1,p.ENABLE_ERROR=!0,p.ENABLE_INFO=!0,p.ENABLE_WARN=!0,p.ENABLE_DEBUG=!0,p.ENABLE_VERBOSE=!0,p.ENABLE_CALLBACK=!1,p.emitter=new g.a,J.a=p},function(R,J,w){var Q;(function(g){g.IO_ERROR="io_error",g.DEMUX_ERROR="demux_error",g.INIT_SEGMENT="init_segment",g.MEDIA_SEGMENT="media_segment",g.LOADING_COMPLETE="loading_complete",g.RECOVERED_EARLY_EOF="recovered_early_eof",g.MEDIA_INFO="media_info",g.METADATA_ARRIVED="metadata_arrived",g.SCRIPTDATA_ARRIVED="scriptdata_arrived",g.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",g.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",g.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",g.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",g.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",g.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",g.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",g.STATISTICS_INFO="statistics_info",g.RECOMMEND_SEEKPOINT="recommend_seekpoint"})(Q||(Q={})),J.a=Q},function(R,J,w){w.d(J,"c",function(){return g}),w.d(J,"b",function(){return p}),w.d(J,"a",function(){return D});var Q=w(3),g={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},p={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},D=function(){function m(y){this._type=y||"undefined",this._status=g.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return m.prototype.destroy=function(){this._status=g.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},m.prototype.isWorking=function(){return this._status===g.kConnecting||this._status===g.kBuffering},Object.defineProperty(m.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(y){this._onContentLengthKnown=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(y){this._onURLRedirect=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(y){this._onDataArrival=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onError",{get:function(){return this._onError},set:function(y){this._onError=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onComplete",{get:function(){return this._onComplete},set:function(y){this._onComplete=y},enumerable:!1,configurable:!0}),m.prototype.open=function(y,_){throw new Q.c("Unimplemented abstract function!")},m.prototype.abort=function(){throw new Q.c("Unimplemented abstract function!")},m}()},function(R,J,w){w.d(J,"d",function(){return p}),w.d(J,"a",function(){return D}),w.d(J,"b",function(){return m}),w.d(J,"c",function(){return y});var Q,g=(Q=function(_,b){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,L){E.__proto__=L}||function(E,L){for(var I in L)Object.prototype.hasOwnProperty.call(L,I)&&(E[I]=L[I])})(_,b)},function(_,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function E(){this.constructor=_}Q(_,b),_.prototype=b===null?Object.create(b):(E.prototype=b.prototype,new E)}),p=function(){function _(b){this._message=b}return Object.defineProperty(_.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),_.prototype.toString=function(){return this.name+": "+this.message},_}(),D=function(_){function b(E){return _.call(this,E)||this}return g(b,_),Object.defineProperty(b.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),b}(p),m=function(_){function b(E){return _.call(this,E)||this}return g(b,_),Object.defineProperty(b.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),b}(p),y=function(_){function b(E){return _.call(this,E)||this}return g(b,_),Object.defineProperty(b.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),b}(p)},function(R,J,w){var Q;(function(g){g.ERROR="error",g.LOADING_COMPLETE="loading_complete",g.RECOVERED_EARLY_EOF="recovered_early_eof",g.MEDIA_INFO="media_info",g.METADATA_ARRIVED="metadata_arrived",g.SCRIPTDATA_ARRIVED="scriptdata_arrived",g.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",g.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",g.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",g.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",g.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",g.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",g.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",g.STATISTICS_INFO="statistics_info",g.DESTROYING="destroying"})(Q||(Q={})),J.a=Q},function(R,J,w){var Q={};(function(){var g=self.navigator.userAgent.toLowerCase(),p=/(edge)\/([\w.]+)/.exec(g)||/(opr)[\/]([\w.]+)/.exec(g)||/(chrome)[ \/]([\w.]+)/.exec(g)||/(iemobile)[\/]([\w.]+)/.exec(g)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(g)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(g)||/(webkit)[ \/]([\w.]+)/.exec(g)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(g)||/(msie) ([\w.]+)/.exec(g)||g.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(g)||g.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(g)||[],D=/(ipad)/.exec(g)||/(ipod)/.exec(g)||/(windows phone)/.exec(g)||/(iphone)/.exec(g)||/(kindle)/.exec(g)||/(android)/.exec(g)||/(windows)/.exec(g)||/(mac)/.exec(g)||/(linux)/.exec(g)||/(cros)/.exec(g)||[],m={browser:p[5]||p[3]||p[1]||"",version:p[2]||p[4]||"0",majorVersion:p[4]||p[2]||"0",platform:D[0]||""},y={};if(m.browser){y[m.browser]=!0;var _=m.majorVersion.split(".");y.version={major:parseInt(m.majorVersion,10),string:m.version},_.length>1&&(y.version.minor=parseInt(_[1],10)),_.length>2&&(y.version.build=parseInt(_[2],10))}m.platform&&(y[m.platform]=!0),(y.chrome||y.opr||y.safari)&&(y.webkit=!0),(y.rv||y.iemobile)&&(y.rv&&delete y.rv,m.browser="msie",y.msie=!0),y.edge&&(delete y.edge,m.browser="msedge",y.msedge=!0),y.opr&&(m.browser="opera",y.opera=!0),y.safari&&y.android&&(m.browser="android",y.android=!0);for(var b in y.name=m.browser,y.platform=m.platform,Q)Q.hasOwnProperty(b)&&delete Q[b];Object.assign(Q,y)})(),J.a=Q},function(R,J,w){J.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(R,J,w){var Q;(function(g){g.ERROR="error",g.SOURCE_OPEN="source_open",g.UPDATE_END="update_end",g.BUFFER_FULL="buffer_full",g.START_STREAMING="start_streaming",g.END_STREAMING="end_streaming"})(Q||(Q={})),J.a=Q},function(R,J,w){var Q=w(9),g=w.n(Q),p=w(0),D=function(){function m(){}return Object.defineProperty(m,"forceGlobalTag",{get:function(){return p.a.FORCE_GLOBAL_TAG},set:function(y){p.a.FORCE_GLOBAL_TAG=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"globalTag",{get:function(){return p.a.GLOBAL_TAG},set:function(y){p.a.GLOBAL_TAG=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableAll",{get:function(){return p.a.ENABLE_VERBOSE&&p.a.ENABLE_DEBUG&&p.a.ENABLE_INFO&&p.a.ENABLE_WARN&&p.a.ENABLE_ERROR},set:function(y){p.a.ENABLE_VERBOSE=y,p.a.ENABLE_DEBUG=y,p.a.ENABLE_INFO=y,p.a.ENABLE_WARN=y,p.a.ENABLE_ERROR=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableDebug",{get:function(){return p.a.ENABLE_DEBUG},set:function(y){p.a.ENABLE_DEBUG=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableVerbose",{get:function(){return p.a.ENABLE_VERBOSE},set:function(y){p.a.ENABLE_VERBOSE=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableInfo",{get:function(){return p.a.ENABLE_INFO},set:function(y){p.a.ENABLE_INFO=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableWarn",{get:function(){return p.a.ENABLE_WARN},set:function(y){p.a.ENABLE_WARN=y,m._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(m,"enableError",{get:function(){return p.a.ENABLE_ERROR},set:function(y){p.a.ENABLE_ERROR=y,m._notifyChange()},enumerable:!1,configurable:!0}),m.getConfig=function(){return{globalTag:p.a.GLOBAL_TAG,forceGlobalTag:p.a.FORCE_GLOBAL_TAG,enableVerbose:p.a.ENABLE_VERBOSE,enableDebug:p.a.ENABLE_DEBUG,enableInfo:p.a.ENABLE_INFO,enableWarn:p.a.ENABLE_WARN,enableError:p.a.ENABLE_ERROR,enableCallback:p.a.ENABLE_CALLBACK}},m.applyConfig=function(y){p.a.GLOBAL_TAG=y.globalTag,p.a.FORCE_GLOBAL_TAG=y.forceGlobalTag,p.a.ENABLE_VERBOSE=y.enableVerbose,p.a.ENABLE_DEBUG=y.enableDebug,p.a.ENABLE_INFO=y.enableInfo,p.a.ENABLE_WARN=y.enableWarn,p.a.ENABLE_ERROR=y.enableError,p.a.ENABLE_CALLBACK=y.enableCallback},m._notifyChange=function(){var y=m.emitter;if(y.listenerCount("change")>0){var _=m.getConfig();y.emit("change",_)}},m.registerListener=function(y){m.emitter.addListener("change",y)},m.removeListener=function(y){m.emitter.removeListener("change",y)},m.addLogListener=function(y){p.a.emitter.addListener("log",y),p.a.emitter.listenerCount("log")>0&&(p.a.ENABLE_CALLBACK=!0,m._notifyChange())},m.removeLogListener=function(y){p.a.emitter.removeListener("log",y),p.a.emitter.listenerCount("log")===0&&(p.a.ENABLE_CALLBACK=!1,m._notifyChange())},m}();D.emitter=new g.a,J.a=D},function(R,J,w){var Q,g=typeof Reflect=="object"?Reflect:null,p=g&&typeof g.apply=="function"?g.apply:function(F,ee,fe){return Function.prototype.apply.call(F,ee,fe)};Q=g&&typeof g.ownKeys=="function"?g.ownKeys:Object.getOwnPropertySymbols?function(F){return Object.getOwnPropertyNames(F).concat(Object.getOwnPropertySymbols(F))}:function(F){return Object.getOwnPropertyNames(F)};var D=Number.isNaN||function(F){return F!=F};function m(){m.init.call(this)}R.exports=m,R.exports.once=function(F,ee){return new Promise(function(fe,ae){function B(N){F.removeListener(ee,x),ae(N)}function x(){typeof F.removeListener=="function"&&F.removeListener("error",B),fe([].slice.call(arguments))}oe(F,ee,x,{once:!0}),ee!=="error"&&function(N,Y,re){typeof N.on=="function"&&oe(N,"error",Y,re)}(F,B,{once:!0})})},m.EventEmitter=m,m.prototype._events=void 0,m.prototype._eventsCount=0,m.prototype._maxListeners=void 0;var y=10;function _(F){if(typeof F!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof F)}function b(F){return F._maxListeners===void 0?m.defaultMaxListeners:F._maxListeners}function E(F,ee,fe,ae){var B,x,N,Y;if(_(fe),(x=F._events)===void 0?(x=F._events=Object.create(null),F._eventsCount=0):(x.newListener!==void 0&&(F.emit("newListener",ee,fe.listener?fe.listener:fe),x=F._events),N=x[ee]),N===void 0)N=x[ee]=fe,++F._eventsCount;else if(typeof N=="function"?N=x[ee]=ae?[fe,N]:[N,fe]:ae?N.unshift(fe):N.push(fe),(B=b(F))>0&&N.length>B&&!N.warned){N.warned=!0;var re=new Error("Possible EventEmitter memory leak detected. "+N.length+" "+String(ee)+" listeners added. Use emitter.setMaxListeners() to increase limit");re.name="MaxListenersExceededWarning",re.emitter=F,re.type=ee,re.count=N.length,Y=re,console&&console.warn&&console.warn(Y)}return F}function L(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function I(F,ee,fe){var ae={fired:!1,wrapFn:void 0,target:F,type:ee,listener:fe},B=L.bind(ae);return B.listener=fe,ae.wrapFn=B,B}function z(F,ee,fe){var ae=F._events;if(ae===void 0)return[];var B=ae[ee];return B===void 0?[]:typeof B=="function"?fe?[B.listener||B]:[B]:fe?function(x){for(var N=new Array(x.length),Y=0;Y<N.length;++Y)N[Y]=x[Y].listener||x[Y];return N}(B):W(B,B.length)}function j(F){var ee=this._events;if(ee!==void 0){var fe=ee[F];if(typeof fe=="function")return 1;if(fe!==void 0)return fe.length}return 0}function W(F,ee){for(var fe=new Array(ee),ae=0;ae<ee;++ae)fe[ae]=F[ae];return fe}function oe(F,ee,fe,ae){if(typeof F.on=="function")ae.once?F.once(ee,fe):F.on(ee,fe);else{if(typeof F.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof F);F.addEventListener(ee,function B(x){ae.once&&F.removeEventListener(ee,B),fe(x)})}}Object.defineProperty(m,"defaultMaxListeners",{enumerable:!0,get:function(){return y},set:function(F){if(typeof F!="number"||F<0||D(F))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+F+".");y=F}}),m.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},m.prototype.setMaxListeners=function(F){if(typeof F!="number"||F<0||D(F))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+F+".");return this._maxListeners=F,this},m.prototype.getMaxListeners=function(){return b(this)},m.prototype.emit=function(F){for(var ee=[],fe=1;fe<arguments.length;fe++)ee.push(arguments[fe]);var ae=F==="error",B=this._events;if(B!==void 0)ae=ae&&B.error===void 0;else if(!ae)return!1;if(ae){var x;if(ee.length>0&&(x=ee[0]),x instanceof Error)throw x;var N=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw N.context=x,N}var Y=B[F];if(Y===void 0)return!1;if(typeof Y=="function")p(Y,this,ee);else{var re=Y.length,K=W(Y,re);for(fe=0;fe<re;++fe)p(K[fe],this,ee)}return!0},m.prototype.addListener=function(F,ee){return E(this,F,ee,!1)},m.prototype.on=m.prototype.addListener,m.prototype.prependListener=function(F,ee){return E(this,F,ee,!0)},m.prototype.once=function(F,ee){return _(ee),this.on(F,I(this,F,ee)),this},m.prototype.prependOnceListener=function(F,ee){return _(ee),this.prependListener(F,I(this,F,ee)),this},m.prototype.removeListener=function(F,ee){var fe,ae,B,x,N;if(_(ee),(ae=this._events)===void 0)return this;if((fe=ae[F])===void 0)return this;if(fe===ee||fe.listener===ee)--this._eventsCount==0?this._events=Object.create(null):(delete ae[F],ae.removeListener&&this.emit("removeListener",F,fe.listener||ee));else if(typeof fe!="function"){for(B=-1,x=fe.length-1;x>=0;x--)if(fe[x]===ee||fe[x].listener===ee){N=fe[x].listener,B=x;break}if(B<0)return this;B===0?fe.shift():function(Y,re){for(;re+1<Y.length;re++)Y[re]=Y[re+1];Y.pop()}(fe,B),fe.length===1&&(ae[F]=fe[0]),ae.removeListener!==void 0&&this.emit("removeListener",F,N||ee)}return this},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(F){var ee,fe,ae;if((fe=this._events)===void 0)return this;if(fe.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):fe[F]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete fe[F]),this;if(arguments.length===0){var B,x=Object.keys(fe);for(ae=0;ae<x.length;++ae)(B=x[ae])!=="removeListener"&&this.removeAllListeners(B);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(ee=fe[F])=="function")this.removeListener(F,ee);else if(ee!==void 0)for(ae=ee.length-1;ae>=0;ae--)this.removeListener(F,ee[ae]);return this},m.prototype.listeners=function(F){return z(this,F,!0)},m.prototype.rawListeners=function(F){return z(this,F,!1)},m.listenerCount=function(F,ee){return typeof F.listenerCount=="function"?F.listenerCount(ee):j.call(F,ee)},m.prototype.listenerCount=j,m.prototype.eventNames=function(){return this._eventsCount>0?Q(this._events):[]}},function(R,J,w){w.d(J,"b",function(){return p}),w.d(J,"a",function(){return D});var Q=w(2),g=w(6),p={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},D={NETWORK_EXCEPTION:Q.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:Q.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:Q.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:Q.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:g.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:g.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:g.a.CODEC_UNSUPPORTED}},function(R,J,w){w.d(J,"d",function(){return Q}),w.d(J,"b",function(){return g}),w.d(J,"a",function(){return p}),w.d(J,"c",function(){return D});var Q=function(m,y,_,b,E){this.dts=m,this.pts=y,this.duration=_,this.originalDts=b,this.isSyncPoint=E,this.fileposition=null},g=function(){function m(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return m.prototype.appendSyncPoint=function(y){y.isSyncPoint=!0,this.syncPoints.push(y)},m}(),p=function(){function m(){this._list=[]}return m.prototype.clear=function(){this._list=[]},m.prototype.appendArray=function(y){var _=this._list;y.length!==0&&(_.length>0&&y[0].originalDts<_[_.length-1].originalDts&&this.clear(),Array.prototype.push.apply(_,y))},m.prototype.getLastSyncPointBeforeDts=function(y){if(this._list.length==0)return null;var _=this._list,b=0,E=_.length-1,L=0,I=0,z=E;for(y<_[0].dts&&(b=0,I=z+1);I<=z;){if((L=I+Math.floor((z-I)/2))===E||y>=_[L].dts&&y<_[L+1].dts){b=L;break}_[L].dts<y?I=L+1:z=L-1}return this._list[b]},m}(),D=function(){function m(y){this._type=y,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(m.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),m.prototype.isEmpty=function(){return this._list.length===0},m.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},m.prototype._searchNearestSegmentBefore=function(y){var _=this._list;if(_.length===0)return-2;var b=_.length-1,E=0,L=0,I=b,z=0;if(y<_[0].originalBeginDts)return z=-1;for(;L<=I;){if((E=L+Math.floor((I-L)/2))===b||y>_[E].lastSample.originalDts&&y<_[E+1].originalBeginDts){z=E;break}_[E].originalBeginDts<y?L=E+1:I=E-1}return z},m.prototype._searchNearestSegmentAfter=function(y){return this._searchNearestSegmentBefore(y)+1},m.prototype.append=function(y){var _=this._list,b=y,E=this._lastAppendLocation,L=0;E!==-1&&E<_.length&&b.originalBeginDts>=_[E].lastSample.originalDts&&(E===_.length-1||E<_.length-1&&b.originalBeginDts<_[E+1].originalBeginDts)?L=E+1:_.length>0&&(L=this._searchNearestSegmentBefore(b.originalBeginDts)+1),this._lastAppendLocation=L,this._list.splice(L,0,b)},m.prototype.getLastSegmentBefore=function(y){var _=this._searchNearestSegmentBefore(y);return _>=0?this._list[_]:null},m.prototype.getLastSampleBefore=function(y){var _=this.getLastSegmentBefore(y);return _!=null?_.lastSample:null},m.prototype.getLastSyncPointBefore=function(y){for(var _=this._searchNearestSegmentBefore(y),b=this._list[_].syncPoints;b.length===0&&_>0;)_--,b=this._list[_].syncPoints;return b.length>0?b[b.length-1]:null},m}()},function(R,J,w){var Q=function(){function g(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return g.prototype.isComplete=function(){var p=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,D=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&p&&D},g.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},g.prototype.getNearestKeyframe=function(p){if(this.keyframesIndex==null)return null;var D=this.keyframesIndex,m=this._search(D.times,p);return{index:m,milliseconds:D.times[m],fileposition:D.filepositions[m]}},g.prototype._search=function(p,D){var m=0,y=p.length-1,_=0,b=0,E=y;for(D<p[0]&&(m=0,b=E+1);b<=E;){if((_=b+Math.floor((E-b)/2))===y||D>=p[_]&&D<p[_+1]){m=_;break}p[_]<D?b=_+1:E=_-1}return m},g}();J.a=Q},function(R,J,w){var Q=w(9),g=w.n(Q),p=w(0),D=w(5),m=w(12);function y(v,f,c){var d=v;if(f+c<d.length){for(;c--;)if((192&d[++f])!=128)return!1;return!0}return!1}var _,b=function(v){for(var f=[],c=v,d=0,S=v.length;d<S;)if(c[d]<128)f.push(String.fromCharCode(c[d])),++d;else{if(!(c[d]<192)){if(c[d]<224){if(y(c,d,1)&&(O=(31&c[d])<<6|63&c[d+1])>=128){f.push(String.fromCharCode(65535&O)),d+=2;continue}}else if(c[d]<240){if(y(c,d,2)&&(O=(15&c[d])<<12|(63&c[d+1])<<6|63&c[d+2])>=2048&&(63488&O)!=55296){f.push(String.fromCharCode(65535&O)),d+=3;continue}}else if(c[d]<248){var O;if(y(c,d,3)&&(O=(7&c[d])<<18|(63&c[d+1])<<12|(63&c[d+2])<<6|63&c[d+3])>65536&&O<1114112){O-=65536,f.push(String.fromCharCode(O>>>10|55296)),f.push(String.fromCharCode(1023&O|56320)),d+=4;continue}}}f.push(String.fromCharCode(65533)),++d}return f.join("")},E=w(3),L=(_=new ArrayBuffer(2),new DataView(_).setInt16(0,256,!0),new Int16Array(_)[0]===256),I=function(){function v(){}return v.parseScriptData=function(f,c,d){var S={};try{var O=v.parseValue(f,c,d),C=v.parseValue(f,c+O.size,d-O.size);S[O.data]=C.data}catch(V){p.a.e("AMF",V.toString())}return S},v.parseObject=function(f,c,d){if(d<3)throw new E.a("Data not enough when parse ScriptDataObject");var S=v.parseString(f,c,d),O=v.parseValue(f,c+S.size,d-S.size),C=O.objectEnd;return{data:{name:S.data,value:O.data},size:S.size+O.size,objectEnd:C}},v.parseVariable=function(f,c,d){return v.parseObject(f,c,d)},v.parseString=function(f,c,d){if(d<2)throw new E.a("Data not enough when parse String");var S=new DataView(f,c,d).getUint16(0,!L);return{data:S>0?b(new Uint8Array(f,c+2,S)):"",size:2+S}},v.parseLongString=function(f,c,d){if(d<4)throw new E.a("Data not enough when parse LongString");var S=new DataView(f,c,d).getUint32(0,!L);return{data:S>0?b(new Uint8Array(f,c+4,S)):"",size:4+S}},v.parseDate=function(f,c,d){if(d<10)throw new E.a("Data size invalid when parse Date");var S=new DataView(f,c,d),O=S.getFloat64(0,!L),C=S.getInt16(8,!L);return{data:new Date(O+=60*C*1e3),size:10}},v.parseValue=function(f,c,d){if(d<1)throw new E.a("Data not enough when parse Value");var S,O=new DataView(f,c,d),C=1,V=O.getUint8(0),X=!1;try{switch(V){case 0:S=O.getFloat64(1,!L),C+=8;break;case 1:S=!!O.getUint8(1),C+=1;break;case 2:var Z=v.parseString(f,c+1,d-1);S=Z.data,C+=Z.size;break;case 3:S={};var ne=0;for((16777215&O.getUint32(d-4,!L))==9&&(ne=3);C<d-4;){var ce=v.parseObject(f,c+C,d-C-ne);if(ce.objectEnd)break;S[ce.data.name]=ce.data.value,C+=ce.size}C<=d-3&&(16777215&O.getUint32(C-1,!L))===9&&(C+=3);break;case 8:for(S={},C+=4,ne=0,(16777215&O.getUint32(d-4,!L))==9&&(ne=3);C<d-8;){var ue=v.parseVariable(f,c+C,d-C-ne);if(ue.objectEnd)break;S[ue.data.name]=ue.data.value,C+=ue.size}C<=d-3&&(16777215&O.getUint32(C-1,!L))===9&&(C+=3);break;case 9:S=void 0,C=1,X=!0;break;case 10:S=[];var me=O.getUint32(1,!L);C+=4;for(var Se=0;Se<me;Se++){var ke=v.parseValue(f,c+C,d-C);S.push(ke.data),C+=ke.size}break;case 11:var we=v.parseDate(f,c+1,d-1);S=we.data,C+=we.size;break;case 12:var Ve=v.parseString(f,c+1,d-1);S=Ve.data,C+=Ve.size;break;default:C=d,p.a.w("AMF","Unsupported AMF value type "+V)}}catch(Ne){p.a.e("AMF",Ne.toString())}return{data:S,size:C,objectEnd:X}},v}(),z=function(){function v(f){this.TAG="ExpGolomb",this._buffer=f,this._buffer_index=0,this._total_bytes=f.byteLength,this._total_bits=8*f.byteLength,this._current_word=0,this._current_word_bits_left=0}return v.prototype.destroy=function(){this._buffer=null},v.prototype._fillCurrentWord=function(){var f=this._total_bytes-this._buffer_index;if(f<=0)throw new E.a("ExpGolomb: _fillCurrentWord() but no bytes available");var c=Math.min(4,f),d=new Uint8Array(4);d.set(this._buffer.subarray(this._buffer_index,this._buffer_index+c)),this._current_word=new DataView(d.buffer).getUint32(0,!1),this._buffer_index+=c,this._current_word_bits_left=8*c},v.prototype.readBits=function(f){if(f>32)throw new E.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(f<=this._current_word_bits_left){var c=this._current_word>>>32-f;return this._current_word<<=f,this._current_word_bits_left-=f,c}var d=this._current_word_bits_left?this._current_word:0;d>>>=32-this._current_word_bits_left;var S=f-this._current_word_bits_left;this._fillCurrentWord();var O=Math.min(S,this._current_word_bits_left),C=this._current_word>>>32-O;return this._current_word<<=O,this._current_word_bits_left-=O,d=d<<O|C},v.prototype.readBool=function(){return this.readBits(1)===1},v.prototype.readByte=function(){return this.readBits(8)},v.prototype._skipLeadingZero=function(){var f;for(f=0;f<this._current_word_bits_left;f++)if(this._current_word&2147483648>>>f)return this._current_word<<=f,this._current_word_bits_left-=f,f;return this._fillCurrentWord(),f+this._skipLeadingZero()},v.prototype.readUEG=function(){var f=this._skipLeadingZero();return this.readBits(f+1)-1},v.prototype.readSEG=function(){var f=this.readUEG();return 1&f?f+1>>>1:-1*(f>>>1)},v}(),j=function(){function v(){}return v._ebsp2rbsp=function(f){for(var c=f,d=c.byteLength,S=new Uint8Array(d),O=0,C=0;C<d;C++)C>=2&&c[C]===3&&c[C-1]===0&&c[C-2]===0||(S[O]=c[C],O++);return new Uint8Array(S.buffer,0,O)},v.parseSPS=function(f){for(var c=f.subarray(1,4),d="avc1.",S=0;S<3;S++){var O=c[S].toString(16);O.length<2&&(O="0"+O),d+=O}var C=v._ebsp2rbsp(f),V=new z(C);V.readByte();var X=V.readByte();V.readByte();var Z=V.readByte();V.readUEG();var ne=v.getProfileString(X),ce=v.getLevelString(Z),ue=1,me=420,Se=8,ke=8;if((X===100||X===110||X===122||X===244||X===44||X===83||X===86||X===118||X===128||X===138||X===144)&&((ue=V.readUEG())===3&&V.readBits(1),ue<=3&&(me=[0,420,422,444][ue]),Se=V.readUEG()+8,ke=V.readUEG()+8,V.readBits(1),V.readBool()))for(var we=ue!==3?8:12,Ve=0;Ve<we;Ve++)V.readBool()&&(Ve<6?v._skipScalingList(V,16):v._skipScalingList(V,64));V.readUEG();var Ne=V.readUEG();if(Ne===0)V.readUEG();else if(Ne===1){V.readBits(1),V.readSEG(),V.readSEG();var Ce=V.readUEG();for(Ve=0;Ve<Ce;Ve++)V.readSEG()}var $e=V.readUEG();V.readBits(1);var tt=V.readUEG(),Be=V.readUEG(),Qe=V.readBits(1);Qe===0&&V.readBits(1),V.readBits(1);var dt=0,Je=0,rt=0,vt=0;V.readBool()&&(dt=V.readUEG(),Je=V.readUEG(),rt=V.readUEG(),vt=V.readUEG());var Tt=1,at=1,ut=0,kt=!0,Ut=0,hi=0;if(V.readBool()){if(V.readBool()){var qt=V.readByte();qt>0&&qt<16?(Tt=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][qt-1],at=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][qt-1]):qt===255&&(Tt=V.readByte()<<8|V.readByte(),at=V.readByte()<<8|V.readByte())}if(V.readBool()&&V.readBool(),V.readBool()&&(V.readBits(4),V.readBool()&&V.readBits(24)),V.readBool()&&(V.readUEG(),V.readUEG()),V.readBool()){var si=V.readBits(32),Ft=V.readBits(32);kt=V.readBool(),ut=(Ut=Ft)/(hi=2*si)}}var ei=1;Tt===1&&at===1||(ei=Tt/at);var Wt=0,_t=0;ue===0?(Wt=1,_t=2-Qe):(Wt=ue===3?1:2,_t=(ue===1?2:1)*(2-Qe));var fi=16*(tt+1),Ei=16*(Be+1)*(2-Qe);fi-=(dt+Je)*Wt,Ei-=(rt+vt)*_t;var hr=Math.ceil(fi*ei);return V.destroy(),V=null,{codec_mimetype:d,profile_idc:X,level_idc:Z,profile_string:ne,level_string:ce,chroma_format_idc:ue,bit_depth:Se,bit_depth_luma:Se,bit_depth_chroma:ke,ref_frames:$e,chroma_format:me,chroma_format_string:v.getChromaFormatString(me),frame_rate:{fixed:kt,fps:ut,fps_den:hi,fps_num:Ut},sar_ratio:{width:Tt,height:at},codec_size:{width:fi,height:Ei},present_size:{width:hr,height:Ei}}},v._skipScalingList=function(f,c){for(var d=8,S=8,O=0;O<c;O++)S!==0&&(S=(d+f.readSEG()+256)%256),d=S===0?d:S},v.getProfileString=function(f){switch(f){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},v.getLevelString=function(f){return(f/10).toFixed(1)},v.getChromaFormatString=function(f){switch(f){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},v}(),W=w(6),oe=function(){function v(){}return v._ebsp2rbsp=function(f){for(var c=f,d=c.byteLength,S=new Uint8Array(d),O=0,C=0;C<d;C++)C>=2&&c[C]===3&&c[C-1]===0&&c[C-2]===0||(S[O]=c[C],O++);return new Uint8Array(S.buffer,0,O)},v.parseVPS=function(f){var c=v._ebsp2rbsp(f),d=new z(c);return d.readByte(),d.readByte(),d.readBits(4),d.readBits(2),d.readBits(6),{num_temporal_layers:d.readBits(3)+1,temporal_id_nested:d.readBool()}},v.parseSPS=function(f){var c=v._ebsp2rbsp(f),d=new z(c);d.readByte(),d.readByte();for(var S=0,O=0,C=0,V=0,X=(d.readBits(4),d.readBits(3)),Z=(d.readBool(),d.readBits(2)),ne=d.readBool(),ce=d.readBits(5),ue=d.readByte(),me=d.readByte(),Se=d.readByte(),ke=d.readByte(),we=d.readByte(),Ve=d.readByte(),Ne=d.readByte(),Ce=d.readByte(),$e=d.readByte(),tt=d.readByte(),Be=d.readByte(),Qe=[],dt=[],Je=0;Je<X;Je++)Qe.push(d.readBool()),dt.push(d.readBool());if(X>0)for(Je=X;Je<8;Je++)d.readBits(2);for(Je=0;Je<X;Je++)Qe[Je]&&(d.readByte(),d.readByte(),d.readByte(),d.readByte(),d.readByte(),d.readByte(),d.readByte(),d.readByte(),d.readByte(),d.readByte(),d.readByte()),dt[Je]&&d.readByte();d.readUEG();var rt=d.readUEG();rt==3&&d.readBits(1);var vt=d.readUEG(),Tt=d.readUEG();d.readBool()&&(S+=d.readUEG(),O+=d.readUEG(),C+=d.readUEG(),V+=d.readUEG());var at=d.readUEG(),ut=d.readUEG(),kt=d.readUEG();for(Je=d.readBool()?0:X;Je<=X;Je++)d.readUEG(),d.readUEG(),d.readUEG();if(d.readUEG(),d.readUEG(),d.readUEG(),d.readUEG(),d.readUEG(),d.readUEG(),d.readBool()&&d.readBool())for(var Ut=0;Ut<4;Ut++)for(var hi=0;hi<(Ut===3?2:6);hi++)if(d.readBool()){var qt=Math.min(64,1<<4+(Ut<<1));for(Ut>1&&d.readSEG(),Je=0;Je<qt;Je++)d.readSEG()}else d.readUEG();d.readBool(),d.readBool(),d.readBool()&&(d.readByte(),d.readUEG(),d.readUEG(),d.readBool());var si=d.readUEG(),Ft=0;for(Je=0;Je<si;Je++){var ei=!1;if(Je!==0&&(ei=d.readBool()),ei){Je===si&&d.readUEG(),d.readBool(),d.readUEG();for(var Wt=0,_t=0;_t<=Ft;_t++){var fi=d.readBool(),Ei=!1;fi||(Ei=d.readBool()),(fi||Ei)&&Wt++}Ft=Wt}else{var hr=d.readUEG(),Ji=d.readUEG();for(Ft=hr+Ji,_t=0;_t<hr;_t++)d.readUEG(),d.readBool();for(_t=0;_t<Ji;_t++)d.readUEG(),d.readBool()}}if(d.readBool()){var Gr=d.readUEG();for(Je=0;Je<Gr;Je++){for(_t=0;_t<kt+4;_t++)d.readBits(1);d.readBits(1)}}var Et=0,Yi=1,$i=1,zr=!1,wr=1,fr=1;if(d.readBool(),d.readBool(),d.readBool()){if(d.readBool()){var Bi=d.readByte();Bi>0&&Bi<=16?(Yi=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][Bi-1],$i=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][Bi-1]):Bi===255&&(Yi=d.readBits(16),$i=d.readBits(16))}if(d.readBool()&&d.readBool(),d.readBool()&&(d.readBits(3),d.readBool(),d.readBool()&&(d.readByte(),d.readByte(),d.readByte())),d.readBool()&&(d.readUEG(),d.readUEG()),d.readBool(),d.readBool(),d.readBool(),d.readBool()&&(d.readUEG(),d.readUEG(),d.readUEG(),d.readUEG()),d.readBool()&&(wr=d.readBits(32),fr=d.readBits(32),d.readBool()&&d.readUEG(),d.readBool())){var xr=!1,kr=!1,er=!1;for(xr=d.readBool(),kr=d.readBool(),(xr||kr)&&((er=d.readBool())&&(d.readByte(),d.readBits(5),d.readBool(),d.readBits(5)),d.readBits(4),d.readBits(4),er&&d.readBits(4),d.readBits(5),d.readBits(5),d.readBits(5)),Je=0;Je<=X;Je++){var $t=d.readBool();zr=$t;var Hr=!0,pr=1;$t||(Hr=d.readBool());var Yr=!1;if(Hr?d.readUEG():Yr=d.readBool(),Yr||(pr=d.readUEG()+1),xr){for(_t=0;_t<pr;_t++)d.readUEG(),d.readUEG(),er&&(d.readUEG(),d.readUEG());d.readBool()}if(kr){for(_t=0;_t<pr;_t++)d.readUEG(),d.readUEG(),er&&(d.readUEG(),d.readUEG());d.readBool()}}}d.readBool()&&(d.readBool(),d.readBool(),d.readBool(),Et=d.readUEG(),d.readUEG(),d.readUEG(),d.readUEG(),d.readUEG())}d.readBool();var tr="hvc1.".concat(ce,".1.L").concat(Be,".B0"),mr=vt-(S+O)*(rt===1||rt===2?2:1),qi=Tt-(C+V)*(rt===1?2:1),Rr=1;return Yi!==1&&$i!==1&&(Rr=Yi/$i),d.destroy(),d=null,{codec_mimetype:tr,profile_string:v.getProfileString(ce),level_string:v.getLevelString(Be),profile_idc:ce,bit_depth:at+8,ref_frames:1,chroma_format:rt,chroma_format_string:v.getChromaFormatString(rt),general_level_idc:Be,general_profile_space:Z,general_tier_flag:ne,general_profile_idc:ce,general_profile_compatibility_flags_1:ue,general_profile_compatibility_flags_2:me,general_profile_compatibility_flags_3:Se,general_profile_compatibility_flags_4:ke,general_constraint_indicator_flags_1:we,general_constraint_indicator_flags_2:Ve,general_constraint_indicator_flags_3:Ne,general_constraint_indicator_flags_4:Ce,general_constraint_indicator_flags_5:$e,general_constraint_indicator_flags_6:tt,min_spatial_segmentation_idc:Et,constant_frame_rate:0,chroma_format_idc:rt,bit_depth_luma_minus8:at,bit_depth_chroma_minus8:ut,frame_rate:{fixed:zr,fps:fr/wr,fps_den:wr,fps_num:fr},sar_ratio:{width:Yi,height:$i},codec_size:{width:mr,height:qi},present_size:{width:mr*Rr,height:qi}}},v.parsePPS=function(f){var c=v._ebsp2rbsp(f),d=new z(c);d.readByte(),d.readByte(),d.readUEG(),d.readUEG(),d.readBool(),d.readBool(),d.readBits(3),d.readBool(),d.readBool(),d.readUEG(),d.readUEG(),d.readSEG(),d.readBool(),d.readBool(),d.readBool()&&d.readUEG(),d.readSEG(),d.readSEG(),d.readBool(),d.readBool(),d.readBool(),d.readBool();var S=d.readBool(),O=d.readBool(),C=1;return O&&S?C=0:O?C=3:S&&(C=2),{parallelismType:C}},v.getChromaFormatString=function(f){switch(f){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},v.getProfileString=function(f){switch(f){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},v.getLevelString=function(f){return(f/30).toFixed(1)},v}();function F(v){return v.byteOffset%2==0&&v.byteLength%2==0}function ee(v){return v.byteOffset%4==0&&v.byteLength%4==0}function fe(v,f){for(var c=0;c<v.length;c++)if(v[c]!==f[c])return!1;return!0}var ae=function(v,f){return v.byteLength===f.byteLength&&(ee(v)&&ee(f)?function(c,d){return fe(new Uint32Array(c.buffer,c.byteOffset,c.byteLength/4),new Uint32Array(d.buffer,d.byteOffset,d.byteLength/4))}(v,f):F(v)&&F(f)?function(c,d){return fe(new Uint16Array(c.buffer,c.byteOffset,c.byteLength/2),new Uint16Array(d.buffer,d.byteOffset,d.byteLength/2))}(v,f):function(c,d){return fe(c,d)}(v,f))},B=function(){return(B=Object.assign||function(v){for(var f,c=1,d=arguments.length;c<d;c++)for(var S in f=arguments[c])Object.prototype.hasOwnProperty.call(f,S)&&(v[S]=f[S]);return v}).apply(this,arguments)},x=function(){function v(){}return v.parseOBUs=function(f,c){for(var d=0;d<f.byteLength;){var S=d,O=(f[d],(120&f[d])>>3),C=(4&f[d])!=0,V=(2&f[d])!=0;f[d],d+=1,C&&(d+=1);var X=Number.POSITIVE_INFINITY;if(V){X=0;for(var Z=0;;Z++){var ne=f[d++];if(X|=(127&ne)<<7*Z,(128&ne)==0)break}}console.log(O),O===1?c=B(B({},v.parseSeuqneceHeader(f.subarray(d,d+X))),{sequence_header_data:f.subarray(S,d+X)}):(O==3&&c||O==6&&c)&&(c=v.parseOBUFrameHeader(f.subarray(d,d+X),0,0,c)),d+=X}return c},v.parseSeuqneceHeader=function(f){var c=new z(f),d=c.readBits(3),S=(c.readBool(),c.readBool()),O=!0,C=0,V=1,X=void 0,Z=[];if(S)Z.push({operating_point_idc:0,level:c.readBits(5),tier:0});else{if(c.readBool()){var ne=c.readBits(32),ce=c.readBits(32),ue=c.readBool();if(ue){for(var me=0;c.readBits(1)===0;)me+=1;me>=32||(1<<me)-1+c.readBits(me)}(C=ce)/(V=ne),O=ue,c.readBool()&&(c.readBits(5),c.readBits(32),X=c.readBits(5),c.readBits(5))}for(var Se=c.readBool(),ke=c.readBits(5),we=0;we<=ke;we++){var Ve=c.readBits(12),Ne=c.readBits(5),Ce=Ne>7?c.readBits(1):0;Z.push({operating_point_idc:Ve,level:Ne,tier:Ce}),Se&&c.readBool()&&c.readBits(4)}}var $e=Z[0],tt=$e.level,Be=$e.tier,Qe=c.readBits(4),dt=c.readBits(4),Je=c.readBits(Qe+1)+1,rt=c.readBits(dt+1)+1,vt=!1;S||(vt=c.readBool()),vt&&(c.readBits(4),c.readBits(4)),c.readBool(),c.readBool(),c.readBool();var Tt=!1,at=2,ut=2,kt=0;S||(c.readBool(),c.readBool(),c.readBool(),c.readBool(),(Tt=c.readBool())&&(c.readBool(),c.readBool()),(at=c.readBool()?2:c.readBits(1))?ut=c.readBool()?2:c.readBits(1):ut=2,Tt?kt=c.readBits(3)+1:kt=0);var Ut=c.readBool(),hi=(c.readBool(),c.readBool(),c.readBool()),qt=8;d===2&&hi?qt=c.readBool()?12:10:qt=hi?10:8;var si=!1;d!==1&&(si=c.readBool()),c.readBool()&&(c.readBits(8),c.readBits(8),c.readBits(8));var Ft=1,ei=1;return si?(c.readBits(1),Ft=1,ei=1):(c.readBits(1),d==0?(Ft=1,ei=1):d==1?(Ft=0,ei=0):qt==12?c.readBits(1)&&c.readBits(1):(Ft=1,ei=0),Ft&&ei&&c.readBits(2),c.readBits(1)),c.readBool(),c.destroy(),c=null,{codec_mimetype:"av01.".concat(d,".").concat(v.getLevelString(tt,Be),".").concat(qt.toString(10).padStart(2,"0")),level:tt,tier:Be,level_string:v.getLevelString(tt,Be),profile_idc:d,profile_string:"".concat(d),bit_depth:qt,ref_frames:1,chroma_format:v.getChromaFormat(si,Ft,ei),chroma_format_string:v.getChromaFormatString(si,Ft,ei),sequence_header:{frame_id_numbers_present_flag:vt,additional_frame_id_length_minus_1:void 0,delta_frame_id_length_minus_2:void 0,reduced_still_picture_header:S,decoder_model_info_present_flag:!1,operating_points:Z,buffer_removal_time_length_minus_1:X,equal_picture_interval:O,seq_force_screen_content_tools:at,seq_force_integer_mv:ut,enable_order_hint:Tt,order_hint_bits:kt,enable_superres:Ut,frame_width_bit:Qe+1,frame_height_bit:dt+1,max_frame_width:Je,max_frame_height:rt},keyframe:void 0,frame_rate:{fixed:O,fps:C/V,fps_den:V,fps_num:C}}},v.parseOBUFrameHeader=function(f,c,d,S){var O=S.sequence_header,C=new z(f),V=(O.max_frame_width,O.max_frame_height,0);O.frame_id_numbers_present_flag&&(V=O.additional_frame_id_length_minus_1+O.delta_frame_id_length_minus_2+3);var X=0,Z=!0,ne=!0,ce=!1;if(!O.reduced_still_picture_header){if(C.readBool())return S;Z=(X=C.readBits(2))===2||X===0,(ne=C.readBool())&&O.decoder_model_info_present_flag&&O.equal_picture_interval,ne&&C.readBool(),ce=!!(X===3||X===0&&ne)||C.readBool()}S.keyframe=Z,C.readBool();var ue=O.seq_force_screen_content_tools;O.seq_force_screen_content_tools===2&&(ue=C.readBits(1)),ue&&(O.seq_force_integer_mv,O.seq_force_integer_mv==2&&C.readBits(1)),O.frame_id_numbers_present_flag&&C.readBits(V);var me=!1;if(me=X==3||!O.reduced_still_picture_header&&C.readBool(),C.readBits(O.order_hint_bits),Z||ce||C.readBits(3),O.decoder_model_info_present_flag&&C.readBool()){for(var Se=0;Se<=O.operating_points_cnt_minus_1;Se++)if(O.operating_points[Se].decoder_model_present_for_this_op[Se]){var ke=O.operating_points[Se].operating_point_idc;(ke===0||ke>>c&1&&ke>>d+8&1)&&C.readBits(O.buffer_removal_time_length_minus_1+1)}}var we=255;if(X===3||X==0&&ne||(we=C.readBits(8)),(Z||we!==255)&&ce&&O.enable_order_hint)for(var Ve=0;Ve<8;Ve++)C.readBits(O.order_hint_bits);if(Z){var Ne=v.frameSizeAndRenderSize(C,me,O);S.codec_size={width:Ne.FrameWidth,height:Ne.FrameHeight},S.present_size={width:Ne.RenderWidth,height:Ne.RenderHeight},S.sar_ratio={width:Ne.RenderWidth/Ne.FrameWidth,height:Ne.RenderHeight/Ne.FrameHeight}}return C.destroy(),C=null,S},v.frameSizeAndRenderSize=function(f,c,d){var S=d.max_frame_width,O=d.max_frame_height;c&&(S=f.readBits(d.frame_width_bit)+1,O=f.readBits(d.frame_height_bit)+1);var C=!1;d.enable_superres&&(C=f.readBool());var V=8;C&&(V=f.readBits(3)+9);var X=S;S=Math.floor((8*X+V/2)/V);var Z=X,ne=O;if(f.readBool()){var ce=f.readBits(16)+1,ue=f.readBits(16)+1;Z=f.readBits(ce)+1,ne=f.readBits(ue)+1}return{UpscaledWidth:X,FrameWidth:S,FrameHeight:O,RenderWidth:Z,RenderHeight:ne}},v.getLevelString=function(f,c){return"".concat(f.toString(10).padStart(2,"0")).concat(c===0?"M":"H")},v.getChromaFormat=function(f,c,d){return f?0:c===0&&d===0?3:c===1&&d===0?2:c===1&&d===1?1:Number.NaN},v.getChromaFormatString=function(f,c,d){return f?"4:0:0":c===0&&d===0?"4:4:4":c===1&&d===0?"4:2:2":c===1&&d===1?"4:2:0":"Unknown"},v}(),N,Y=function(){function v(f,c){this.TAG="FLVDemuxer",this._config=c,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=f.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=f.hasAudioTrack,this._hasVideo=f.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new m.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var d=new ArrayBuffer(2);return new DataView(d).setInt16(0,256,!0),new Int16Array(d)[0]===256}()}return v.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},v.probe=function(f){var c=new Uint8Array(f);if(c.byteLength<9)return{needMoreData:!0};var d={match:!1};if(c[0]!==70||c[1]!==76||c[2]!==86||c[3]!==1)return d;var S,O,C=(4&c[4])>>>2!=0,V=(1&c[4])!=0,X=(S=c)[O=5]<<24|S[O+1]<<16|S[O+2]<<8|S[O+3];return X<9?d:{match:!0,consumed:X,dataOffset:X,hasAudioTrack:C,hasVideoTrack:V}},v.prototype.bindDataSource=function(f){return f.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(v.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(f){this._onTrackMetadata=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(f){this._onMediaInfo=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(f){this._onMetaDataArrived=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(f){this._onScriptDataArrived=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onError",{get:function(){return this._onError},set:function(f){this._onError=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(f){this._onDataAvailable=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(f){this._timestampBase=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"overridedDuration",{get:function(){return this._duration},set:function(f){this._durationOverrided=!0,this._duration=f,this._mediaInfo.duration=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"overridedHasAudio",{set:function(f){this._hasAudioFlagOverrided=!0,this._hasAudio=f,this._mediaInfo.hasAudio=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"overridedHasVideo",{set:function(f){this._hasVideoFlagOverrided=!0,this._hasVideo=f,this._mediaInfo.hasVideo=f},enumerable:!1,configurable:!0}),v.prototype.resetMediaInfo=function(){this._mediaInfo=new m.a},v.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},v.prototype.parseChunks=function(f,c){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new E.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var d=0,S=this._littleEndian;if(c===0){if(!(f.byteLength>13))return 0;d=v.probe(f).dataOffset}for(this._firstParse&&(this._firstParse=!1,c+d!==this._dataOffset&&p.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),(O=new DataView(f,d)).getUint32(0,!S)!==0&&p.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),d+=4);d<f.byteLength;){this._dispatch=!0;var O=new DataView(f,d);if(d+11+4>f.byteLength)break;var C=O.getUint8(0),V=16777215&O.getUint32(0,!S);if(d+11+V+4>f.byteLength)break;if(C===8||C===9||C===18){var X=O.getUint8(4),Z=O.getUint8(5),ne=O.getUint8(6)|Z<<8|X<<16|O.getUint8(7)<<24;16777215&O.getUint32(7,!S)&&p.a.w(this.TAG,"Meet tag which has StreamID != 0!");var ce=d+11;switch(C){case 8:this._parseAudioData(f,ce,V,ne);break;case 9:this._parseVideoData(f,ce,V,ne,c+d);break;case 18:this._parseScriptData(f,ce,V)}var ue=O.getUint32(11+V,!S);ue!==11+V&&p.a.w(this.TAG,"Invalid PrevTagSize ".concat(ue)),d+=11+V+4}else p.a.w(this.TAG,"Unsupported tag type ".concat(C,", skipped")),d+=11+V+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),d},v.prototype._parseScriptData=function(f,c,d){var S=I.parseScriptData(f,c,d);if(S.hasOwnProperty("onMetaData")){if(S.onMetaData==null||typeof S.onMetaData!="object")return void p.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&p.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=S;var O=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},O)),typeof O.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=O.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof O.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=O.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof O.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=O.audiodatarate),typeof O.videodatarate=="number"&&(this._mediaInfo.videoDataRate=O.videodatarate),typeof O.width=="number"&&(this._mediaInfo.width=O.width),typeof O.height=="number"&&(this._mediaInfo.height=O.height),typeof O.duration=="number"){if(!this._durationOverrided){var C=Math.floor(O.duration*this._timescale);this._duration=C,this._mediaInfo.duration=C}}else this._mediaInfo.duration=0;if(typeof O.framerate=="number"){var V=Math.floor(1e3*O.framerate);if(V>0){var X=V/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=X,this._referenceFrameRate.fps_num=V,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=X}}if(typeof O.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var Z=O.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(Z),O.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=O,p.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(S).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},S))},v.prototype._parseKeyframesIndex=function(f){for(var c=[],d=[],S=1;S<f.times.length;S++){var O=this._timestampBase+Math.floor(1e3*f.times[S]);c.push(O),d.push(f.filepositions[S])}return{times:c,filepositions:d}},v.prototype._parseAudioData=function(f,c,d,S){if(d<=1)p.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(this._hasAudioFlagOverrided!==!0||this._hasAudio!==!1){this._littleEndian;var O=new DataView(f,c,d).getUint8(0),C=O>>>4;if(C!==9)if(C===2||C===10){var V=0,X=(12&O)>>>2;if(X>=0&&X<=4){V=this._flvSoundRateTable[X];var Z=1&O,ne=this._audioMetadata,ce=this._audioTrack;if(ne||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(ne=this._audioMetadata={}).type="audio",ne.id=ce.id,ne.timescale=this._timescale,ne.duration=this._duration,ne.audioSampleRate=V,ne.channelCount=Z===0?1:2),C===10){var ue=this._parseAACAudioData(f,c+1,d-1);if(ue==null)return;if(ue.packetType===0){if(ne.config){if(ae(ue.data.config,ne.config))return;p.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var me=ue.data;ne.audioSampleRate=me.samplingRate,ne.channelCount=me.channelCount,ne.codec=me.codec,ne.originalCodec=me.originalCodec,ne.config=me.config,ne.refSampleDuration=1024/ne.audioSampleRate*ne.timescale,p.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",ne),(we=this._mediaInfo).audioCodec=ne.originalCodec,we.audioSampleRate=ne.audioSampleRate,we.audioChannelCount=ne.channelCount,we.hasVideo?we.videoCodec!=null&&(we.mimeType='video/x-flv; codecs="'+we.videoCodec+","+we.audioCodec+'"'):we.mimeType='video/x-flv; codecs="'+we.audioCodec+'"',we.isComplete()&&this._onMediaInfo(we)}else if(ue.packetType===1){var Se=this._timestampBase+S,ke={unit:ue.data,length:ue.data.byteLength,dts:Se,pts:Se};ce.samples.push(ke),ce.length+=ue.data.length}else p.a.e(this.TAG,"Flv: Unsupported AAC data type ".concat(ue.packetType))}else if(C===2){if(!ne.codec){var we;if((me=this._parseMP3AudioData(f,c+1,d-1,!0))==null)return;ne.audioSampleRate=me.samplingRate,ne.channelCount=me.channelCount,ne.codec=me.codec,ne.originalCodec=me.originalCodec,ne.refSampleDuration=1152/ne.audioSampleRate*ne.timescale,p.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",ne),(we=this._mediaInfo).audioCodec=ne.codec,we.audioSampleRate=ne.audioSampleRate,we.audioChannelCount=ne.channelCount,we.audioDataRate=me.bitRate,we.hasVideo?we.videoCodec!=null&&(we.mimeType='video/x-flv; codecs="'+we.videoCodec+","+we.audioCodec+'"'):we.mimeType='video/x-flv; codecs="'+we.audioCodec+'"',we.isComplete()&&this._onMediaInfo(we)}var Ve=this._parseMP3AudioData(f,c+1,d-1,!1);if(Ve==null)return;Se=this._timestampBase+S;var Ne={unit:Ve,length:Ve.byteLength,dts:Se,pts:Se};ce.samples.push(Ne),ce.length+=Ve.length}}else this._onError(W.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+X)}else this._onError(W.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+C);else{if(d<=5)return void p.a.w(this.TAG,"Flv: Invalid audio packet, missing AudioFourCC in Ehnanced FLV payload!");var Ce=15&O,$e=String.fromCharCode.apply(String,new Uint8Array(f,c,d).slice(1,5));switch($e){case"Opus":this._parseOpusAudioPacket(f,c+5,d-5,S,Ce);break;case"fLaC":this._parseFlacAudioPacket(f,c+5,d-5,S,Ce);break;default:this._onError(W.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec: "+$e)}}}},v.prototype._parseAACAudioData=function(f,c,d){if(!(d<=1)){var S={},O=new Uint8Array(f,c,d);return S.packetType=O[0],O[0]===0?S.data=this._parseAACAudioSpecificConfig(f,c+1,d-1):S.data=O.subarray(1),S}p.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},v.prototype._parseAACAudioSpecificConfig=function(f,c,d){var S,O,C=new Uint8Array(f,c,d),V=null,X=0,Z=null;if(X=S=C[0]>>>3,(O=(7&C[0])<<1|C[1]>>>7)<0||O>=this._mpegSamplingRates.length)this._onError(W.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var ne=this._mpegSamplingRates[O],ce=(120&C[1])>>>3;if(!(ce<0||ce>=8)){X===5&&(Z=(7&C[1])<<1|C[2]>>>7,(124&C[2])>>>2);var ue=self.navigator.userAgent.toLowerCase();return ue.indexOf("firefox")!==-1?O>=6?(X=5,V=new Array(4),Z=O-3):(X=2,V=new Array(2),Z=O):ue.indexOf("android")!==-1?(X=2,V=new Array(2),Z=O):(X=5,Z=O,V=new Array(4),O>=6?Z=O-3:ce===1&&(X=2,V=new Array(2),Z=O)),V[0]=X<<3,V[0]|=(15&O)>>>1,V[1]=(15&O)<<7,V[1]|=(15&ce)<<3,X===5&&(V[1]|=(15&Z)>>>1,V[2]=(1&Z)<<7,V[2]|=8,V[3]=0),{config:V,samplingRate:ne,channelCount:ce,codec:"mp4a.40."+X,originalCodec:"mp4a.40."+S}}this._onError(W.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},v.prototype._parseMP3AudioData=function(f,c,d,S){if(!(d<4)){this._littleEndian;var O=new Uint8Array(f,c,d),C=null;if(S){if(O[0]!==255)return;var V=O[1]>>>3&3,X=(6&O[1])>>1,Z=(240&O[2])>>>4,ne=(12&O[2])>>>2,ce=(O[3]>>>6&3)!==3?2:1,ue=0,me=0;switch(V){case 0:ue=this._mpegAudioV25SampleRateTable[ne];break;case 2:ue=this._mpegAudioV20SampleRateTable[ne];break;case 3:ue=this._mpegAudioV10SampleRateTable[ne]}switch(X){case 1:Z<this._mpegAudioL3BitRateTable.length&&(me=this._mpegAudioL3BitRateTable[Z]);break;case 2:Z<this._mpegAudioL2BitRateTable.length&&(me=this._mpegAudioL2BitRateTable[Z]);break;case 3:Z<this._mpegAudioL1BitRateTable.length&&(me=this._mpegAudioL1BitRateTable[Z])}C={bitRate:me,samplingRate:ue,channelCount:ce,codec:"mp3",originalCodec:"mp3"}}else C=O;return C}p.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},v.prototype._parseOpusAudioPacket=function(f,c,d,S,O){if(O===0)this._parseOpusSequenceHeader(f,c,d);else if(O===1)this._parseOpusAudioData(f,c,d,S);else if(O!==2)return void this._onError(W.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(O))},v.prototype._parseOpusSequenceHeader=function(f,c,d){if(d<=16)p.a.w(this.TAG,"Flv: Invalid OpusSequenceHeader, lack of data!");else{var S=this._audioMetadata,O=this._audioTrack;S||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(S=this._audioMetadata={}).type="audio",S.id=O.id,S.timescale=this._timescale,S.duration=this._duration);var C=new DataView(f,c,d);C.setUint8(8,0);var V=C.getUint8(9);C.setUint16(10,C.getUint16(10,!0),!1);var X=C.getUint32(12,!0);C.setUint32(12,C.getUint32(12,!0),!1);var Z={config:new Uint8Array(f,c+8,d-8),channelCount:V,samplingFrequence:X,codec:"opus",originalCodec:"opus"};if(S.config){if(ae(Z.config,S.config))return;p.a.w(this.TAG,"OpusSequenceHeader has been changed, re-generate initialization segment")}S.audioSampleRate=Z.samplingFrequence,S.channelCount=Z.channelCount,S.codec=Z.codec,S.originalCodec=Z.originalCodec,S.config=Z.config,S.refSampleDuration=20,p.a.v(this.TAG,"Parsed OpusSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",S);var ne=this._mediaInfo;ne.audioCodec=S.originalCodec,ne.audioSampleRate=S.audioSampleRate,ne.audioChannelCount=S.channelCount,ne.hasVideo?ne.videoCodec!=null&&(ne.mimeType='video/x-flv; codecs="'+ne.videoCodec+","+ne.audioCodec+'"'):ne.mimeType='video/x-flv; codecs="'+ne.audioCodec+'"',ne.isComplete()&&this._onMediaInfo(ne)}},v.prototype._parseOpusAudioData=function(f,c,d,S){var O=this._audioTrack,C=new Uint8Array(f,c,d),V=this._timestampBase+S,X={unit:C,length:C.byteLength,dts:V,pts:V};O.samples.push(X),O.length+=C.length},v.prototype._parseFlacAudioPacket=function(f,c,d,S,O){if(O===0)this._parseFlacSequenceHeader(f,c,d);else if(O===1)this._parseFlacAudioData(f,c,d,S);else if(O!==2)return void this._onError(W.a.FORMAT_ERROR,"Flv: Invalid Flac audio packet type ".concat(O))},v.prototype._parseFlacSequenceHeader=function(f,c,d){var S=this._audioMetadata,O=this._audioTrack;S||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(S=this._audioMetadata={}).type="audio",S.id=O.id,S.timescale=this._timescale,S.duration=this._duration);var C=new Uint8Array(f,c+4,d-4),V=new z(C),X=V.readBits(16),Z=V.readBits(16),ne=Z===X?Z:null;V.readBits(24),V.readBits(24);var ce=V.readBits(20),ue=V.readBits(3)+1,me=V.readBits(5)+1;V.destroy();var Se=new Uint8Array(C.byteLength+4);Se.set(C,4),Se[0]=128,Se[1]=C.byteLength>>>16&255,Se[2]=C.byteLength>>>8&255,Se[3]=C.byteLength>>>0&255;var ke={config:Se,channelCount:ue,samplingFrequence:ce,sampleSize:me,codec:"flac",originalCodec:"flac"};if(S.config){if(ae(ke.config,S.config))return;p.a.w(this.TAG,"FlacSequenceHeader has been changed, re-generate initialization segment")}S.audioSampleRate=ke.samplingFrequence,S.channelCount=ke.channelCount,S.sampleSize=ke.sampleSize,S.codec=ke.codec,S.originalCodec=ke.originalCodec,S.config=ke.config,S.refSampleDuration=ne!=null?1e3*ne/ke.samplingFrequence:null,p.a.v(this.TAG,"Parsed FlacSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",S);var we=this._mediaInfo;we.audioCodec=S.originalCodec,we.audioSampleRate=S.audioSampleRate,we.audioChannelCount=S.channelCount,we.hasVideo?we.videoCodec!=null&&(we.mimeType='video/x-flv; codecs="'+we.videoCodec+","+we.audioCodec+'"'):we.mimeType='video/x-flv; codecs="'+we.audioCodec+'"',we.isComplete()&&this._onMediaInfo(we)},v.prototype._parseFlacAudioData=function(f,c,d,S){var O=this._audioTrack,C=new Uint8Array(f,c,d),V=this._timestampBase+S,X={unit:C,length:C.byteLength,dts:V,pts:V};O.samples.push(X),O.length+=C.length},v.prototype._parseVideoData=function(f,c,d,S,O){if(d<=1)p.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(this._hasVideoFlagOverrided!==!0||this._hasVideo!==!1){var C=new Uint8Array(f,c,d)[0],V=(112&C)>>>4;if(128&C){var X=15&C,Z=String.fromCharCode.apply(String,new Uint8Array(f,c,d).slice(1,5));if(Z==="hvc1")this._parseEnhancedHEVCVideoPacket(f,c+5,d-5,S,O,V,X);else{if(Z!=="av01")return void this._onError(W.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(Z));this._parseEnhancedAV1VideoPacket(f,c+5,d-5,S,O,V,X)}}else{var ne=15&C;if(ne===7)this._parseAVCVideoPacket(f,c+1,d-1,S,O,V);else{if(ne!==12)return void this._onError(W.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(ne));this._parseHEVCVideoPacket(f,c+1,d-1,S,O,V)}}}},v.prototype._parseAVCVideoPacket=function(f,c,d,S,O,C){if(d<4)p.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var V=this._littleEndian,X=new DataView(f,c,d),Z=X.getUint8(0),ne=(16777215&X.getUint32(0,!V))<<8>>8;if(Z===0)this._parseAVCDecoderConfigurationRecord(f,c+4,d-4);else if(Z===1)this._parseAVCVideoData(f,c+4,d-4,S,O,C,ne);else if(Z!==2)return void this._onError(W.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(Z))}},v.prototype._parseHEVCVideoPacket=function(f,c,d,S,O,C){if(d<4)p.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var V=this._littleEndian,X=new DataView(f,c,d),Z=X.getUint8(0),ne=(16777215&X.getUint32(0,!V))<<8>>8;if(Z===0)this._parseHEVCDecoderConfigurationRecord(f,c+4,d-4);else if(Z===1)this._parseHEVCVideoData(f,c+4,d-4,S,O,C,ne);else if(Z!==2)return void this._onError(W.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(Z))}},v.prototype._parseEnhancedHEVCVideoPacket=function(f,c,d,S,O,C,V){var X=this._littleEndian,Z=new DataView(f,c,d);if(V===0)this._parseHEVCDecoderConfigurationRecord(f,c,d);else if(V===1){var ne=(4294967040&Z.getUint32(0,!X))>>8;this._parseHEVCVideoData(f,c+3,d-3,S,O,C,ne)}else if(V===3)this._parseHEVCVideoData(f,c,d,S,O,C,0);else if(V!==2)return void this._onError(W.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(V))},v.prototype._parseEnhancedAV1VideoPacket=function(f,c,d,S,O,C,V){if(this._littleEndian,V===0)this._parseAV1CodecConfigurationRecord(f,c,d);else if(V===1)this._parseAV1VideoData(f,c,d,S,O,C,0);else{if(V===5)return void this._onError(W.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type ".concat(V));if(V!==2)return void this._onError(W.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(V))}},v.prototype._parseAVCDecoderConfigurationRecord=function(f,c,d){if(d<7)p.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var S=this._videoMetadata,O=this._videoTrack,C=this._littleEndian,V=new DataView(f,c,d);if(S){if(S.avcc!==void 0){var X=new Uint8Array(f,c,d);if(ae(X,S.avcc))return;p.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(S=this._videoMetadata={}).type="video",S.id=O.id,S.timescale=this._timescale,S.duration=this._duration;var Z=V.getUint8(0),ne=V.getUint8(1);if(V.getUint8(2),V.getUint8(3),Z===1&&ne!==0)if(this._naluLengthSize=1+(3&V.getUint8(4)),this._naluLengthSize===3||this._naluLengthSize===4){var ce=31&V.getUint8(5);if(ce!==0){ce>1&&p.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ".concat(ce));for(var ue=6,me=0;me<ce;me++){var Se=V.getUint16(ue,!C);if(ue+=2,Se!==0){var ke=new Uint8Array(f,c+ue,Se);ue+=Se;var we=j.parseSPS(ke);if(me===0){S.codecWidth=we.codec_size.width,S.codecHeight=we.codec_size.height,S.presentWidth=we.present_size.width,S.presentHeight=we.present_size.height,S.profile=we.profile_string,S.level=we.level_string,S.bitDepth=we.bit_depth,S.chromaFormat=we.chroma_format,S.sarRatio=we.sar_ratio,S.frameRate=we.frame_rate,we.frame_rate.fixed!==!1&&we.frame_rate.fps_num!==0&&we.frame_rate.fps_den!==0||(S.frameRate=this._referenceFrameRate);var Ve=S.frameRate.fps_den,Ne=S.frameRate.fps_num;S.refSampleDuration=S.timescale*(Ve/Ne);for(var Ce=ke.subarray(1,4),$e="avc1.",tt=0;tt<3;tt++){var Be=Ce[tt].toString(16);Be.length<2&&(Be="0"+Be),$e+=Be}S.codec=$e;var Qe=this._mediaInfo;Qe.width=S.codecWidth,Qe.height=S.codecHeight,Qe.fps=S.frameRate.fps,Qe.profile=S.profile,Qe.level=S.level,Qe.refFrames=we.ref_frames,Qe.chromaFormat=we.chroma_format_string,Qe.sarNum=S.sarRatio.width,Qe.sarDen=S.sarRatio.height,Qe.videoCodec=$e,Qe.hasAudio?Qe.audioCodec!=null&&(Qe.mimeType='video/x-flv; codecs="'+Qe.videoCodec+","+Qe.audioCodec+'"'):Qe.mimeType='video/x-flv; codecs="'+Qe.videoCodec+'"',Qe.isComplete()&&this._onMediaInfo(Qe)}}}var dt=V.getUint8(ue);if(dt!==0){for(dt>1&&p.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ".concat(dt)),ue++,me=0;me<dt;me++)Se=V.getUint16(ue,!C),ue+=2,Se!==0&&(ue+=Se);S.avcc=new Uint8Array(d),S.avcc.set(new Uint8Array(f,c,d),0),p.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",S)}else this._onError(W.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(W.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(W.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1));else this._onError(W.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},v.prototype._parseHEVCDecoderConfigurationRecord=function(f,c,d){if(d<22)p.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var S=this._videoMetadata,O=this._videoTrack,C=this._littleEndian,V=new DataView(f,c,d);if(S){if(S.hvcc!==void 0){var X=new Uint8Array(f,c,d);if(ae(X,S.hvcc))return;p.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(S=this._videoMetadata={}).type="video",S.id=O.id,S.timescale=this._timescale,S.duration=this._duration;var Z=V.getUint8(0),ne=31&V.getUint8(1);if(Z!==0&&Z!==1||ne===0)this._onError(W.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord");else if(this._naluLengthSize=1+(3&V.getUint8(21)),this._naluLengthSize===3||this._naluLengthSize===4){for(var ce=V.getUint8(22),ue=0,me=23;ue<ce;ue++){var Se=63&V.getUint8(me+0),ke=V.getUint16(me+1,!C);me+=3;for(var we=0;we<ke;we++){var Ve=V.getUint16(me+0,!C);if(we===0)if(Se===33){me+=2;var Ne=new Uint8Array(f,c+me,Ve),Ce=oe.parseSPS(Ne);S.codecWidth=Ce.codec_size.width,S.codecHeight=Ce.codec_size.height,S.presentWidth=Ce.present_size.width,S.presentHeight=Ce.present_size.height,S.profile=Ce.profile_string,S.level=Ce.level_string,S.bitDepth=Ce.bit_depth,S.chromaFormat=Ce.chroma_format,S.sarRatio=Ce.sar_ratio,S.frameRate=Ce.frame_rate,Ce.frame_rate.fixed!==!1&&Ce.frame_rate.fps_num!==0&&Ce.frame_rate.fps_den!==0||(S.frameRate=this._referenceFrameRate);var $e=S.frameRate.fps_den,tt=S.frameRate.fps_num;S.refSampleDuration=S.timescale*($e/tt),S.codec=Ce.codec_mimetype;var Be=this._mediaInfo;Be.width=S.codecWidth,Be.height=S.codecHeight,Be.fps=S.frameRate.fps,Be.profile=S.profile,Be.level=S.level,Be.refFrames=Ce.ref_frames,Be.chromaFormat=Ce.chroma_format_string,Be.sarNum=S.sarRatio.width,Be.sarDen=S.sarRatio.height,Be.videoCodec=Ce.codec_mimetype,Be.hasAudio?Be.audioCodec!=null&&(Be.mimeType='video/x-flv; codecs="'+Be.videoCodec+","+Be.audioCodec+'"'):Be.mimeType='video/x-flv; codecs="'+Be.videoCodec+'"',Be.isComplete()&&this._onMediaInfo(Be),me+=Ve}else me+=2+Ve;else me+=2+Ve}}S.hvcc=new Uint8Array(d),S.hvcc.set(new Uint8Array(f,c,d),0),p.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",S)}else this._onError(W.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1))}},v.prototype._parseAV1CodecConfigurationRecord=function(f,c,d){if(d<4)p.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var S=this._videoMetadata,O=this._videoTrack,C=(this._littleEndian,new DataView(f,c,d));S?S.av1c!==void 0&&p.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(S=this._videoMetadata={}).type="video",S.id=O.id,S.timescale=this._timescale,S.duration=this._duration);var V=127&C.getUint8(0);if(C.getUint8(1),C.getUint8(1),C.getUint8(2),V===1){var X=x.parseOBUs(new Uint8Array(f,c+4,d-4));if(X!=null){S.profile=X.profile_string,S.level=X.level_string,S.bitDepth=X.bit_depth,S.chromaFormat=X.chroma_format,S.frameRate=X.frame_rate,X.frame_rate.fixed!==!1&&X.frame_rate.fps_num!==0&&X.frame_rate.fps_den!==0||(S.frameRate=this._referenceFrameRate);var Z=S.frameRate.fps_den,ne=S.frameRate.fps_num;S.refSampleDuration=S.timescale*(Z/ne),S.codec=X.codec_mimetype,S.extra=X;var ce=this._mediaInfo;ce.fps=S.frameRate.fps,ce.profile=S.profile,ce.level=S.level,ce.refFrames=X.ref_frames,ce.chromaFormat=X.chroma_format_string,ce.videoCodec=X.codec_mimetype,ce.hasAudio?ce.audioCodec!=null&&(ce.mimeType='video/x-flv; codecs="'+ce.videoCodec+","+ce.audioCodec+'"'):ce.mimeType='video/x-flv; codecs="'+ce.videoCodec+'"',ce.isComplete()&&this._onMediaInfo(ce),S.av1c=new Uint8Array(d),S.av1c.set(new Uint8Array(f,c,d),0),p.a.v(this.TAG,"Preparing AV1CodecConfigurationRecord")}else this._onError(W.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(W.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},v.prototype._parseAVCVideoData=function(f,c,d,S,O,C,V){for(var X=this._littleEndian,Z=new DataView(f,c,d),ne=[],ce=0,ue=0,me=this._naluLengthSize,Se=this._timestampBase+S,ke=C===1;ue<d;){if(ue+4>=d){p.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(Se,", offset = ").concat(ue,", dataSize = ").concat(d));break}var we=Z.getUint32(ue,!X);if(me===3&&(we>>>=8),we>d-me)return void p.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(Se,", NaluSize > DataSize!"));var Ve=31&Z.getUint8(ue+me);Ve===5&&(ke=!0);var Ne=new Uint8Array(f,c+ue,me+we),Ce={type:Ve,data:Ne};ne.push(Ce),ce+=Ne.byteLength,ue+=me+we}if(ne.length){var $e=this._videoTrack,tt={units:ne,length:ce,isKeyframe:ke,dts:Se,cts:V,pts:Se+V};ke&&(tt.fileposition=O),$e.samples.push(tt),$e.length+=ce}},v.prototype._parseHEVCVideoData=function(f,c,d,S,O,C,V){for(var X=this._littleEndian,Z=new DataView(f,c,d),ne=[],ce=0,ue=0,me=this._naluLengthSize,Se=this._timestampBase+S,ke=C===1;ue<d;){if(ue+4>=d){p.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(Se,", offset = ").concat(ue,", dataSize = ").concat(d));break}var we=Z.getUint32(ue,!X);if(me===3&&(we>>>=8),we>d-me)return void p.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(Se,", NaluSize > DataSize!"));var Ve=Z.getUint8(ue+me)>>1&63;Ve!==19&&Ve!==20&&Ve!==21||(ke=!0);var Ne=new Uint8Array(f,c+ue,me+we),Ce={type:Ve,data:Ne};ne.push(Ce),ce+=Ne.byteLength,ue+=me+we}if(ne.length){var $e=this._videoTrack,tt={units:ne,length:ce,isKeyframe:ke,dts:Se,cts:V,pts:Se+V};ke&&(tt.fileposition=O),$e.samples.push(tt),$e.length+=ce}},v.prototype._parseAV1VideoData=function(f,c,d,S,O,C,V){this._littleEndian;var X,Z=[],ne=this._timestampBase+S,ce=C===1;if(ce){var ue=this._videoMetadata,me=x.parseOBUs(new Uint8Array(f,c,d),ue.extra);if(me==null)return void this._onError(W.a.FORMAT_ERROR,"Flv: Invalid AV1 VideoData");console.log(me),ue.codecWidth=me.codec_size.width,ue.codecHeight=me.codec_size.height,ue.presentWidth=me.present_size.width,ue.presentHeight=me.present_size.height,ue.sarRatio=me.sar_ratio;var Se=this._mediaInfo;Se.width=ue.codecWidth,Se.height=ue.codecHeight,Se.sarNum=ue.sarRatio.width,Se.sarDen=ue.sarRatio.height,p.a.v(this.TAG,"Parsed AV1DecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",ue)}if(X=d,Z.push({unitType:0,data:new Uint8Array(f,c+0,d)}),Z.length){var ke=this._videoTrack,we={units:Z,length:X,isKeyframe:ce,dts:ne,cts:V,pts:ne+V};ce&&(we.fileposition=O),ke.samples.push(we),ke.length+=X}},v}(),re=function(){function v(){}return v.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},v}(),K=function(){this.program_pmt_pid={}};(function(v){v[v.kMPEG1Audio=3]="kMPEG1Audio",v[v.kMPEG2Audio=4]="kMPEG2Audio",v[v.kPESPrivateData=6]="kPESPrivateData",v[v.kADTSAAC=15]="kADTSAAC",v[v.kLOASAAC=17]="kLOASAAC",v[v.kAC3=129]="kAC3",v[v.kEAC3=135]="kEAC3",v[v.kMetadata=21]="kMetadata",v[v.kSCTE35=134]="kSCTE35",v[v.kH264=27]="kH264",v[v.kH265=36]="kH265"})(N||(N={}));var k,de=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,av1:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},ie=function(){},ve=function(){},_e=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};(function(v){v[v.kUnspecified=0]="kUnspecified",v[v.kSliceNonIDR=1]="kSliceNonIDR",v[v.kSliceDPA=2]="kSliceDPA",v[v.kSliceDPB=3]="kSliceDPB",v[v.kSliceDPC=4]="kSliceDPC",v[v.kSliceIDR=5]="kSliceIDR",v[v.kSliceSEI=6]="kSliceSEI",v[v.kSliceSPS=7]="kSliceSPS",v[v.kSlicePPS=8]="kSlicePPS",v[v.kSliceAUD=9]="kSliceAUD",v[v.kEndOfSequence=10]="kEndOfSequence",v[v.kEndOfStream=11]="kEndOfStream",v[v.kFiller=12]="kFiller",v[v.kSPSExt=13]="kSPSExt",v[v.kReserved0=14]="kReserved0"})(k||(k={}));var q,H,le=function(){},be=function(v){var f=v.data.byteLength;this.type=v.type,this.data=new Uint8Array(4+f),new DataView(this.data.buffer).setUint32(0,f),this.data.set(v.data,4)},Ie=function(){function v(f){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=f,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&p.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return v.prototype.findNextStartCodeOffset=function(f){for(var c=f,d=this.data_;;){if(c+3>=d.byteLength)return this.eof_flag_=!0,d.byteLength;var S=d[c+0]<<24|d[c+1]<<16|d[c+2]<<8|d[c+3],O=d[c+0]<<16|d[c+1]<<8|d[c+2];if(S===1||O===1)return c;c++}},v.prototype.readNextNaluPayload=function(){for(var f=this.data_,c=null;c==null&&!this.eof_flag_;){var d=this.current_startcode_offset_,S=31&f[d+=(f[d]<<24|f[d+1]<<16|f[d+2]<<8|f[d+3])===1?4:3],O=(128&f[d])>>>7,C=this.findNextStartCodeOffset(d);if(this.current_startcode_offset_=C,!(S>=k.kReserved0)&&O===0){var V=f.subarray(d,C);(c=new le).type=S,c.data=V}}return c},v}(),Oe=function(){function v(f,c,d){var S=8+f.byteLength+1+2+c.byteLength,O=!1;f[3]!==66&&f[3]!==77&&f[3]!==88&&(O=!0,S+=4);var C=this.data=new Uint8Array(S);C[0]=1,C[1]=f[1],C[2]=f[2],C[3]=f[3],C[4]=255,C[5]=225;var V=f.byteLength;C[6]=V>>>8,C[7]=255&V;var X=8;C.set(f,8),C[X+=V]=1;var Z=c.byteLength;C[X+1]=Z>>>8,C[X+2]=255&Z,C.set(c,X+3),X+=3+Z,O&&(C[X]=252|d.chroma_format_idc,C[X+1]=248|d.bit_depth_luma-8,C[X+2]=248|d.bit_depth_chroma-8,C[X+3]=0,X+=4)}return v.prototype.getData=function(){return this.data},v}();(function(v){v[v.kNull=0]="kNull",v[v.kAACMain=1]="kAACMain",v[v.kAAC_LC=2]="kAAC_LC",v[v.kAAC_SSR=3]="kAAC_SSR",v[v.kAAC_LTP=4]="kAAC_LTP",v[v.kAAC_SBR=5]="kAAC_SBR",v[v.kAAC_Scalable=6]="kAAC_Scalable",v[v.kLayer1=32]="kLayer1",v[v.kLayer2=33]="kLayer2",v[v.kLayer3=34]="kLayer3"})(q||(q={})),function(v){v[v.k96000Hz=0]="k96000Hz",v[v.k88200Hz=1]="k88200Hz",v[v.k64000Hz=2]="k64000Hz",v[v.k48000Hz=3]="k48000Hz",v[v.k44100Hz=4]="k44100Hz",v[v.k32000Hz=5]="k32000Hz",v[v.k24000Hz=6]="k24000Hz",v[v.k22050Hz=7]="k22050Hz",v[v.k16000Hz=8]="k16000Hz",v[v.k12000Hz=9]="k12000Hz",v[v.k11025Hz=10]="k11025Hz",v[v.k8000Hz=11]="k8000Hz",v[v.k7350Hz=12]="k7350Hz"}(H||(H={}));var We,et,Le=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Re=(We=function(v,f){return(We=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var S in d)Object.prototype.hasOwnProperty.call(d,S)&&(c[S]=d[S])})(v,f)},function(v,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function c(){this.constructor=v}We(v,f),v.prototype=f===null?Object.create(f):(c.prototype=f.prototype,new c)}),He=function(){},Ue=function(v){function f(){return v!==null&&v.apply(this,arguments)||this}return Re(f,v),f}(He),Ke=function(){function v(f){this.TAG="AACADTSParser",this.data_=f,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&p.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return v.prototype.findNextSyncwordOffset=function(f){for(var c=f,d=this.data_;;){if(c+7>=d.byteLength)return this.eof_flag_=!0,d.byteLength;if((d[c+0]<<8|d[c+1])>>>4===4095)return c;c++}},v.prototype.readNextAACFrame=function(){for(var f=this.data_,c=null;c==null&&!this.eof_flag_;){var d=this.current_syncword_offset_,S=(8&f[d+1])>>>3,O=(6&f[d+1])>>>1,C=1&f[d+1],V=(192&f[d+2])>>>6,X=(60&f[d+2])>>>2,Z=(1&f[d+2])<<2|(192&f[d+3])>>>6,ne=(3&f[d+3])<<11|f[d+4]<<3|(224&f[d+5])>>>5;if(f[d+6],d+ne>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var ce=C===1?7:9,ue=ne-ce;d+=ce;var me=this.findNextSyncwordOffset(d+ue);if(this.current_syncword_offset_=me,(S===0||S===1)&&O===0){var Se=f.subarray(d,d+ue);(c=new He).audio_object_type=V+1,c.sampling_freq_index=X,c.sampling_frequency=Le[X],c.channel_config=Z,c.data=Se}}return c},v.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},v.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},v}(),st=function(){function v(f){this.TAG="AACLOASParser",this.data_=f,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&p.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return v.prototype.findNextSyncwordOffset=function(f){for(var c=f,d=this.data_;;){if(c+1>=d.byteLength)return this.eof_flag_=!0,d.byteLength;if((d[c+0]<<3|d[c+1]>>>5)===695)return c;c++}},v.prototype.getLATMValue=function(f){for(var c=f.readBits(2),d=0,S=0;S<=c;S++)d<<=8,d|=f.readByte();return d},v.prototype.readNextAACFrame=function(f){for(var c=this.data_,d=null;d==null&&!this.eof_flag_;){var S=this.current_syncword_offset_,O=(31&c[S+1])<<8|c[S+2];if(S+3+O>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var C=new z(c.subarray(S+3,S+3+O)),V=null;if(C.readBool()){if(f==null){p.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(S+3+O),C.destroy();continue}V=f}else{var X=C.readBool();if(X&&C.readBool()){p.a.e(this.TAG,"audioMuxVersionA is Not Supported"),C.destroy();break}if(X&&this.getLATMValue(C),!C.readBool()){p.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),C.destroy();break}if(C.readBits(6)!==0){p.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),C.destroy();break}if(C.readBits(4)!==0){p.a.e(this.TAG,"more than 2 numProgram Not Supported"),C.destroy();break}if(C.readBits(3)!==0){p.a.e(this.TAG,"more than 2 numLayer Not Supported"),C.destroy();break}var Z=X?this.getLATMValue(C):0,ne=C.readBits(5);Z-=5;var ce=C.readBits(4);Z-=4;var ue=C.readBits(4);Z-=4,C.readBits(3),(Z-=3)>0&&C.readBits(Z);var me=C.readBits(3);if(me!==0){p.a.e(this.TAG,"frameLengthType = ".concat(me,". Only frameLengthType = 0 Supported")),C.destroy();break}C.readByte();var Se=C.readBool();if(Se)if(X)this.getLATMValue(C);else{for(var ke=0;;){ke<<=8;var we=C.readBool();if(ke+=C.readByte(),!we)break}console.log(ke)}C.readBool()&&C.readByte(),(V=new Ue).audio_object_type=ne,V.sampling_freq_index=ce,V.sampling_frequency=Le[V.sampling_freq_index],V.channel_config=ue,V.other_data_present=Se}for(var Ve=0;;){var Ne=C.readByte();if(Ve+=Ne,Ne!==255)break}for(var Ce=new Uint8Array(Ve),$e=0;$e<Ve;$e++)Ce[$e]=C.readByte();(d=new Ue).audio_object_type=V.audio_object_type,d.sampling_freq_index=V.sampling_freq_index,d.sampling_frequency=Le[V.sampling_freq_index],d.channel_config=V.channel_config,d.other_data_present=V.other_data_present,d.data=Ce,this.current_syncword_offset_=this.findNextSyncwordOffset(S+3+O)}return d},v.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},v.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},v}(),Ze=function(v){var f=null,c=v.audio_object_type,d=v.audio_object_type,S=v.sampling_freq_index,O=v.channel_config,C=0,V=navigator.userAgent.toLowerCase();V.indexOf("firefox")!==-1?S>=6?(d=5,f=new Array(4),C=S-3):(d=2,f=new Array(2),C=S):V.indexOf("android")!==-1?(d=2,f=new Array(2),C=S):(d=5,C=S,f=new Array(4),S>=6?C=S-3:O===1&&(d=2,f=new Array(2),C=S)),f[0]=d<<3,f[0]|=(15&S)>>>1,f[1]=(15&S)<<7,f[1]|=(15&O)<<3,d===5&&(f[1]|=(15&C)>>>1,f[2]=(1&C)<<7,f[2]|=8,f[3]=0),this.config=f,this.sampling_rate=Le[S],this.channel_count=O,this.codec_mimetype="mp4a.40."+d,this.original_codec_mimetype="mp4a.40."+c},xt=function(){},Xt=function(){};(function(v){v[v.kSpliceNull=0]="kSpliceNull",v[v.kSpliceSchedule=4]="kSpliceSchedule",v[v.kSpliceInsert=5]="kSpliceInsert",v[v.kTimeSignal=6]="kTimeSignal",v[v.kBandwidthReservation=7]="kBandwidthReservation",v[v.kPrivateCommand=255]="kPrivateCommand"})(et||(et={}));var ct,ri=function(v){var f=v.readBool();return f?(v.readBits(6),{time_specified_flag:f,pts_time:4*v.readBits(31)+v.readBits(2)}):(v.readBits(7),{time_specified_flag:f})},Xe=function(v){var f=v.readBool();return v.readBits(6),{auto_return:f,duration:4*v.readBits(31)+v.readBits(2)}},Jt=function(v,f){var c=f.readBits(8);return v?{component_tag:c}:{component_tag:c,splice_time:ri(f)}},Bt=function(v){return{component_tag:v.readBits(8),utc_splice_time:v.readBits(32)}},_i=function(v){var f=v.readBits(32),c=v.readBool();v.readBits(7);var d={splice_event_id:f,splice_event_cancel_indicator:c};if(c)return d;if(d.out_of_network_indicator=v.readBool(),d.program_splice_flag=v.readBool(),d.duration_flag=v.readBool(),v.readBits(5),d.program_splice_flag)d.utc_splice_time=v.readBits(32);else{d.component_count=v.readBits(8),d.components=[];for(var S=0;S<d.component_count;S++)d.components.push(Bt(v))}return d.duration_flag&&(d.break_duration=Xe(v)),d.unique_program_id=v.readBits(16),d.avail_num=v.readBits(8),d.avails_expected=v.readBits(8),d},Si=function(v,f,c,d){return{descriptor_tag:v,descriptor_length:f,identifier:c,provider_avail_id:d.readBits(32)}},Ht=function(v,f,c,d){var S=d.readBits(8),O=d.readBits(3);d.readBits(5);for(var C="",V=0;V<O;V++)C+=String.fromCharCode(d.readBits(8));return{descriptor_tag:v,descriptor_length:f,identifier:c,preroll:S,dtmf_count:O,DTMF_char:C}},ui=function(v){var f=v.readBits(8);return v.readBits(7),{component_tag:f,pts_offset:4*v.readBits(31)+v.readBits(2)}},Oi=function(v,f,c,d){var S=d.readBits(32),O=d.readBool();d.readBits(7);var C={descriptor_tag:v,descriptor_length:f,identifier:c,segmentation_event_id:S,segmentation_event_cancel_indicator:O};if(O)return C;if(C.program_segmentation_flag=d.readBool(),C.segmentation_duration_flag=d.readBool(),C.delivery_not_restricted_flag=d.readBool(),C.delivery_not_restricted_flag?d.readBits(5):(C.web_delivery_allowed_flag=d.readBool(),C.no_regional_blackout_flag=d.readBool(),C.archive_allowed_flag=d.readBool(),C.device_restrictions=d.readBits(2)),!C.program_segmentation_flag){C.component_count=d.readBits(8),C.components=[];for(var V=0;V<C.component_count;V++)C.components.push(ui(d))}C.segmentation_duration_flag&&(C.segmentation_duration=d.readBits(40)),C.segmentation_upid_type=d.readBits(8),C.segmentation_upid_length=d.readBits(8);var X=new Uint8Array(C.segmentation_upid_length);for(V=0;V<C.segmentation_upid_length;V++)X[V]=d.readBits(8);return C.segmentation_upid=X.buffer,C.segmentation_type_id=d.readBits(8),C.segment_num=d.readBits(8),C.segments_expected=d.readBits(8),C.segmentation_type_id!==52&&C.segmentation_type_id!==54&&C.segmentation_type_id!==56&&C.segmentation_type_id!==58||(C.sub_segment_num=d.readBits(8),C.sub_segments_expected=d.readBits(8)),C},zi=function(v,f,c,d){return{descriptor_tag:v,descriptor_length:f,identifier:c,TAI_seconds:d.readBits(48),TAI_ns:d.readBits(32),UTC_offset:d.readBits(16)}},Ai=function(v){return{component_tag:v.readBits(8),ISO_code:String.fromCharCode(v.readBits(8),v.readBits(8),v.readBits(8)),Bit_Stream_Mode:v.readBits(3),Num_Channels:v.readBits(4),Full_Srvc_Audio:v.readBool()}},Pi=function(v,f,c,d){for(var S=d.readBits(4),O=[],C=0;C<S;C++)O.push(Ai(d));return{descriptor_tag:v,descriptor_length:f,identifier:c,audio_count:S,components:O}},nr=function(v){var f=new z(v),c=f.readBits(8),d=f.readBool(),S=f.readBool();f.readBits(2);var O=f.readBits(12),C=f.readBits(8),V=f.readBool(),X=f.readBits(6),Z=4*f.readBits(31)+f.readBits(2),ne=f.readBits(8),ce=f.readBits(12),ue=f.readBits(12),me=f.readBits(8),Se=null;me===et.kSpliceNull?Se={}:me===et.kSpliceSchedule?Se=function(rt){for(var vt=rt.readBits(8),Tt=[],at=0;at<vt;at++)Tt.push(_i(rt));return{splice_count:vt,events:Tt}}(f):me===et.kSpliceInsert?Se=function(rt){var vt=rt.readBits(32),Tt=rt.readBool();rt.readBits(7);var at={splice_event_id:vt,splice_event_cancel_indicator:Tt};if(Tt)return at;if(at.out_of_network_indicator=rt.readBool(),at.program_splice_flag=rt.readBool(),at.duration_flag=rt.readBool(),at.splice_immediate_flag=rt.readBool(),rt.readBits(4),at.program_splice_flag&&!at.splice_immediate_flag&&(at.splice_time=ri(rt)),!at.program_splice_flag){at.component_count=rt.readBits(8),at.components=[];for(var ut=0;ut<at.component_count;ut++)at.components.push(Jt(at.splice_immediate_flag,rt))}return at.duration_flag&&(at.break_duration=Xe(rt)),at.unique_program_id=rt.readBits(16),at.avail_num=rt.readBits(8),at.avails_expected=rt.readBits(8),at}(f):me===et.kTimeSignal?Se=function(rt){return{splice_time:ri(rt)}}(f):me===et.kBandwidthReservation?Se={}:me===et.kPrivateCommand?Se=function(rt,vt){for(var Tt=String.fromCharCode(vt.readBits(8),vt.readBits(8),vt.readBits(8),vt.readBits(8)),at=new Uint8Array(rt-4),ut=0;ut<rt-4;ut++)at[ut]=vt.readBits(8);return{identifier:Tt,private_data:at.buffer}}(ue,f):f.readBits(8*ue);for(var ke=[],we=f.readBits(16),Ve=0;Ve<we;){var Ne=f.readBits(8),Ce=f.readBits(8),$e=String.fromCharCode(f.readBits(8),f.readBits(8),f.readBits(8),f.readBits(8));Ne===0?ke.push(Si(Ne,Ce,$e,f)):Ne===1?ke.push(Ht(Ne,Ce,$e,f)):Ne===2?ke.push(Oi(Ne,Ce,$e,f)):Ne===3?ke.push(zi(Ne,Ce,$e,f)):Ne===4?ke.push(Pi(Ne,Ce,$e,f)):f.readBits(8*(Ce-4)),Ve+=2+Ce}var tt={table_id:c,section_syntax_indicator:d,private_indicator:S,section_length:O,protocol_version:C,encrypted_packet:V,encryption_algorithm:X,pts_adjustment:Z,cw_index:ne,tier:ce,splice_command_length:ue,splice_command_type:me,splice_command:Se,descriptor_loop_length:we,splice_descriptors:ke,E_CRC32:V?f.readBits(32):void 0,CRC32:f.readBits(32)};if(me===et.kSpliceInsert){var Be=Se;if(Be.splice_event_cancel_indicator)return{splice_command_type:me,detail:tt,data:v};if(Be.program_splice_flag&&!Be.splice_immediate_flag){var Qe=Be.duration_flag?Be.break_duration.auto_return:void 0,dt=Be.duration_flag?Be.break_duration.duration/90:void 0;return Be.splice_time.time_specified_flag?{splice_command_type:me,pts:(Z+Be.splice_time.pts_time)%Math.pow(2,33),auto_return:Qe,duraiton:dt,detail:tt,data:v}:{splice_command_type:me,auto_return:Qe,duraiton:dt,detail:tt,data:v}}return{splice_command_type:me,auto_return:Qe=Be.duration_flag?Be.break_duration.auto_return:void 0,duraiton:dt=Be.duration_flag?Be.break_duration.duration/90:void 0,detail:tt,data:v}}if(me===et.kTimeSignal){var Je=Se;return Je.splice_time.time_specified_flag?{splice_command_type:me,pts:(Z+Je.splice_time.pts_time)%Math.pow(2,33),detail:tt,data:v}:{splice_command_type:me,detail:tt,data:v}}return{splice_command_type:me,detail:tt,data:v}};(function(v){v[v.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",v[v.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",v[v.kSliceCRA_NUT=21]="kSliceCRA_NUT",v[v.kSliceVPS=32]="kSliceVPS",v[v.kSliceSPS=33]="kSliceSPS",v[v.kSlicePPS=34]="kSlicePPS",v[v.kSliceAUD=35]="kSliceAUD"})(ct||(ct={}));var Yt=function(){},sr=function(v){var f=v.data.byteLength;this.type=v.type,this.data=new Uint8Array(4+f),new DataView(this.data.buffer).setUint32(0,f),this.data.set(v.data,4)},it=function(){function v(f){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=f,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&p.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return v.prototype.findNextStartCodeOffset=function(f){for(var c=f,d=this.data_;;){if(c+3>=d.byteLength)return this.eof_flag_=!0,d.byteLength;var S=d[c+0]<<24|d[c+1]<<16|d[c+2]<<8|d[c+3],O=d[c+0]<<16|d[c+1]<<8|d[c+2];if(S===1||O===1)return c;c++}},v.prototype.readNextNaluPayload=function(){for(var f=this.data_,c=null;c==null&&!this.eof_flag_;){var d=this.current_startcode_offset_,S=f[d+=(f[d]<<24|f[d+1]<<16|f[d+2]<<8|f[d+3])===1?4:3]>>1&63,O=(128&f[d])>>>7,C=this.findNextStartCodeOffset(d);if(this.current_startcode_offset_=C,O===0){var V=f.subarray(d,C);(c=new Yt).type=S,c.data=V}}return c},v}(),or=function(){function v(f,c,d,S){var O=23+(5+f.byteLength)+(5+c.byteLength)+(5+d.byteLength),C=this.data=new Uint8Array(O);C[0]=1,C[1]=(3&S.general_profile_space)<<6|(S.general_tier_flag?1:0)<<5|31&S.general_profile_idc,C[2]=S.general_profile_compatibility_flags_1,C[3]=S.general_profile_compatibility_flags_2,C[4]=S.general_profile_compatibility_flags_3,C[5]=S.general_profile_compatibility_flags_4,C[6]=S.general_constraint_indicator_flags_1,C[7]=S.general_constraint_indicator_flags_2,C[8]=S.general_constraint_indicator_flags_3,C[9]=S.general_constraint_indicator_flags_4,C[10]=S.general_constraint_indicator_flags_5,C[11]=S.general_constraint_indicator_flags_6,C[12]=S.general_level_idc,C[13]=240|(3840&S.min_spatial_segmentation_idc)>>8,C[14]=255&S.min_spatial_segmentation_idc,C[15]=252|3&S.parallelismType,C[16]=252|3&S.chroma_format_idc,C[17]=248|7&S.bit_depth_luma_minus8,C[18]=248|7&S.bit_depth_chroma_minus8,C[19]=0,C[20]=0,C[21]=(3&S.constant_frame_rate)<<6|(7&S.num_temporal_layers)<<3|(S.temporal_id_nested?1:0)<<2|3,C[22]=3,C[23]=128|ct.kSliceVPS,C[24]=0,C[25]=1,C[26]=(65280&f.byteLength)>>8,C[27]=(255&f.byteLength)>>0,C.set(f,28),C[23+(5+f.byteLength)+0]=128|ct.kSliceSPS,C[23+(5+f.byteLength)+1]=0,C[23+(5+f.byteLength)+2]=1,C[23+(5+f.byteLength)+3]=(65280&c.byteLength)>>8,C[23+(5+f.byteLength)+4]=(255&c.byteLength)>>0,C.set(c,23+(5+f.byteLength)+5),C[23+(5+f.byteLength+5+c.byteLength)+0]=128|ct.kSlicePPS,C[23+(5+f.byteLength+5+c.byteLength)+1]=0,C[23+(5+f.byteLength+5+c.byteLength)+2]=1,C[23+(5+f.byteLength+5+c.byteLength)+3]=(65280&d.byteLength)>>8,C[23+(5+f.byteLength+5+c.byteLength)+4]=(255&d.byteLength)>>0,C.set(d,23+(5+f.byteLength+5+c.byteLength)+5)}return v.prototype.getData=function(){return this.data},v}(),lr=function(){},Xi=function(){},lt=function(){},Ar=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],dr=function(){function v(f){this.TAG="AC3Parser",this.data_=f,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&p.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return v.prototype.findNextSyncwordOffset=function(f){for(var c=f,d=this.data_;;){if(c+7>=d.byteLength)return this.eof_flag_=!0,d.byteLength;if((d[c+0]<<8|d[c+1]<<0)===2935)return c;c++}},v.prototype.readNextAC3Frame=function(){for(var f=this.data_,c=null;c==null&&!this.eof_flag_;){var d=this.current_syncword_offset_,S=f[d+4]>>6,O=[48e3,44200,33e3][S],C=63&f[d+4],V=2*Ar[S][C];if(isNaN(V)||d+V>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var X=this.findNextSyncwordOffset(d+V);this.current_syncword_offset_=X;var Z=f[d+5]>>3,ne=7&f[d+5],ce=f[d+6]>>5,ue=0;1&ce&&ce!==1&&(ue+=2),4&ce&&(ue+=2),ce===2&&(ue+=2);var me=(f[d+6]<<8|f[d+7]<<0)>>12-ue&1,Se=[2,1,2,3,3,4,4,5][ce]+me;(c=new lt).sampling_frequency=O,c.channel_count=Se,c.channel_mode=ce,c.bit_stream_identification=Z,c.low_frequency_effects_channel_on=me,c.bit_stream_mode=ne,c.frame_size_code=C,c.data=f.subarray(d,d+V)}return c},v.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},v.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},v}(),Tr=function(v){var f;f=[v.sampling_rate_code<<6|v.bit_stream_identification<<1|v.bit_stream_mode>>2,(3&v.bit_stream_mode)<<6|v.channel_mode<<3|v.low_frequency_effects_channel_on<<2|v.frame_size_code>>4,v.frame_size_code<<4&224],this.config=f,this.sampling_rate=v.sampling_frequency,this.bit_stream_identification=v.bit_stream_identification,this.bit_stream_mode=v.bit_stream_mode,this.low_frequency_effects_channel_on=v.low_frequency_effects_channel_on,this.channel_count=v.channel_count,this.channel_mode=v.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},Hi=function(){},ht=function(){function v(f){this.TAG="EAC3Parser",this.data_=f,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&p.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return v.prototype.findNextSyncwordOffset=function(f){for(var c=f,d=this.data_;;){if(c+7>=d.byteLength)return this.eof_flag_=!0,d.byteLength;if((d[c+0]<<8|d[c+1]<<0)===2935)return c;c++}},v.prototype.readNextEAC3Frame=function(){for(var f=this.data_,c=null;c==null&&!this.eof_flag_;){var d=this.current_syncword_offset_,S=new z(f.subarray(d+2)),O=(S.readBits(2),S.readBits(3),S.readBits(11)+1<<1),C=S.readBits(2),V=null,X=null;C===3?(V=[24e3,22060,16e3][C=S.readBits(2)],X=3):(V=[48e3,44100,32e3][C],X=S.readBits(2));var Z=S.readBits(3),ne=S.readBits(1),ce=S.readBits(5);if(d+O>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var ue=this.findNextSyncwordOffset(d+O);this.current_syncword_offset_=ue;var me=[2,1,2,3,3,4,4,5][Z]+ne;S.destroy(),(c=new Hi).sampling_frequency=V,c.channel_count=me,c.channel_mode=Z,c.bit_stream_identification=ce,c.low_frequency_effects_channel_on=ne,c.frame_size=O,c.num_blks=[1,2,3,6][X],c.data=f.subarray(d,d+O)}return c},v.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},v.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},v}(),ur=function(v){var f,c=Math.floor(v.frame_size*v.sampling_frequency/(16*v.num_blks));f=[255&c,248&c,v.sampling_rate_code<<6|v.bit_stream_identification<<1|0,0|v.channel_mode<<1|v.low_frequency_effects_channel_on<<0,0],this.config=f,this.sampling_rate=v.sampling_frequency,this.bit_stream_identification=v.bit_stream_identification,this.num_blks=v.num_blks,this.low_frequency_effects_channel_on=v.low_frequency_effects_channel_on,this.channel_count=v.channel_count,this.channel_mode=v.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},yi=function(){},sa=function(){function v(f){this.TAG="AV1OBUInMpegTsParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=f,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&p.a.e(this.TAG,"Could not find AV1 startcode until payload end!")}return v._ebsp2rbsp=function(f){for(var c=f,d=c.byteLength,S=new Uint8Array(d),O=0,C=0;C<d;C++)C>=2&&c[C]===3&&c[C-1]===0&&c[C-2]===0||(S[O]=c[C],O++);return new Uint8Array(S.buffer,0,O)},v.prototype.findNextStartCodeOffset=function(f){for(var c=f,d=this.data_;;){if(c+2>=d.byteLength)return this.eof_flag_=!0,d.byteLength;if((d[c+0]<<16|d[c+1]<<8|d[c+2])===1)return c;c++}},v.prototype.readNextOBUPayload=function(){for(var f=this.data_,c=null;c==null&&!this.eof_flag_;){var d=this.current_startcode_offset_+3,S=this.findNextStartCodeOffset(d);this.current_startcode_offset_=S,c=v._ebsp2rbsp(f.subarray(d,S))}return c},v}(),mi=function(){var v=function(f,c){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,S){d.__proto__=S}||function(d,S){for(var O in S)Object.prototype.hasOwnProperty.call(S,O)&&(d[O]=S[O])})(f,c)};return function(f,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function d(){this.constructor=f}v(f,c),f.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}}(),Di=function(){return(Di=Object.assign||function(v){for(var f,c=1,d=arguments.length;c<d;c++)for(var S in f=arguments[c])Object.prototype.hasOwnProperty.call(f,S)&&(v[S]=f[S]);return v}).apply(this,arguments)},cr=function(v){function f(c,d){var S=v.call(this)||this;return S.TAG="TSDemuxer",S.first_parse_=!0,S.media_info_=new m.a,S.timescale_=90,S.duration_=0,S.current_pmt_pid_=-1,S.program_pmt_map_={},S.pes_slice_queues_={},S.section_slice_queues_={},S.video_metadata_={vps:void 0,sps:void 0,pps:void 0,av1c:void 0,details:void 0},S.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},S.last_pcr_base_=NaN,S.timestamp_offset_=0,S.audio_last_sample_pts_=void 0,S.aac_last_incomplete_data_=null,S.has_video_=!1,S.has_audio_=!1,S.video_init_segment_dispatched_=!1,S.audio_init_segment_dispatched_=!1,S.video_metadata_changed_=!1,S.audio_metadata_changed_=!1,S.loas_previous_frame=null,S.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},S.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},S.ts_packet_size_=c.ts_packet_size,S.sync_offset_=c.sync_offset,S.config_=d,S}return mi(f,v),f.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,v.prototype.destroy.call(this)},f.probe=function(c){var d=new Uint8Array(c),S=-1,O=188;if(d.byteLength<=3*O)return{needMoreData:!0};for(;S===-1;){for(var C=Math.min(1e3,d.byteLength-3*O),V=0;V<C;){if(d[V]===71&&d[V+O]===71&&d[V+2*O]===71){S=V;break}V++}if(S===-1)if(O===188)O=192;else{if(O!==192)break;O=204}}return S===-1?{match:!1}:(O===192&&S>=4?(p.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),S-=4):O===204&&p.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:O,sync_offset:S})},f.prototype.bindDataSource=function(c){return c.onDataArrival=this.parseChunks.bind(this),this},f.prototype.resetMediaInfo=function(){this.media_info_=new m.a},f.prototype.parseChunks=function(c,d){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new E.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var S=0;for(this.first_parse_&&(this.first_parse_=!1,S=this.sync_offset_);S+this.ts_packet_size_<=c.byteLength;){var O=d+S;this.ts_packet_size_===192&&(S+=4);var C=new Uint8Array(c,S,188),V=C[0];if(V!==71){p.a.e(this.TAG,"sync_byte = ".concat(V,", not 0x47"));break}var X=(64&C[1])>>>6,Z=(C[1],(31&C[1])<<8|C[2]),ne=(48&C[3])>>>4,ce=15&C[3],ue=!(!this.pmt_||this.pmt_.pcr_pid!==Z),me={},Se=4;if(ne==2||ne==3){var ke=C[4];if(ke>0&&(ue||ne==3)&&(me.discontinuity_indicator=(128&C[5])>>>7,me.random_access_indicator=(64&C[5])>>>6,me.elementary_stream_priority_indicator=(32&C[5])>>>5,(16&C[5])>>>4)){var we=300*this.getPcrBase(C)+((1&C[10])<<8|C[11]);this.last_pcr_=we}if(ne==2||5+ke===188){S+=188,this.ts_packet_size_===204&&(S+=16);continue}Se=5+ke}if(ne==1||ne==3){if(Z===0||Z===this.current_pmt_pid_||this.pmt_!=null&&this.pmt_.pid_stream_type[Z]===N.kSCTE35){var Ve=188-Se;this.handleSectionSlice(c,S+Se,Ve,{pid:Z,file_position:O,payload_unit_start_indicator:X,continuity_conunter:ce,random_access_indicator:me.random_access_indicator})}else if(this.pmt_!=null&&this.pmt_.pid_stream_type[Z]!=null){Ve=188-Se;var Ne=this.pmt_.pid_stream_type[Z];Z!==this.pmt_.common_pids.h264&&Z!==this.pmt_.common_pids.h265&&Z!==this.pmt_.common_pids.av1&&Z!==this.pmt_.common_pids.adts_aac&&Z!==this.pmt_.common_pids.loas_aac&&Z!==this.pmt_.common_pids.ac3&&Z!==this.pmt_.common_pids.eac3&&Z!==this.pmt_.common_pids.opus&&Z!==this.pmt_.common_pids.mp3&&this.pmt_.pes_private_data_pids[Z]!==!0&&this.pmt_.timed_id3_pids[Z]!==!0&&this.pmt_.synchronous_klv_pids[Z]!==!0&&this.pmt_.asynchronous_klv_pids[Z]!==!0||this.handlePESSlice(c,S+Se,Ve,{pid:Z,stream_type:Ne,file_position:O,payload_unit_start_indicator:X,continuity_conunter:ce,random_access_indicator:me.random_access_indicator})}}S+=188,this.ts_packet_size_===204&&(S+=16)}return this.dispatchAudioVideoMediaSegment(),S},f.prototype.handleSectionSlice=function(c,d,S,O){var C=new Uint8Array(c,d,S),V=this.section_slice_queues_[O.pid];if(O.payload_unit_start_indicator){var X=C[0];if(V!=null&&V.total_length!==0){var Z=new Uint8Array(c,d+1,Math.min(S,X));V.slices.push(Z),V.total_length+=Z.byteLength,V.total_length===V.expected_length?this.emitSectionSlices(V,O):this.clearSlices(V,O)}for(var ne=1+X;ne<C.byteLength&&C[ne+0]!==255;){var ce=(15&C[ne+1])<<8|C[ne+2];this.section_slice_queues_[O.pid]=new _e,(V=this.section_slice_queues_[O.pid]).expected_length=ce+3,V.file_position=O.file_position,V.random_access_indicator=O.random_access_indicator,Z=new Uint8Array(c,d+ne,Math.min(S-ne,V.expected_length-V.total_length)),V.slices.push(Z),V.total_length+=Z.byteLength,V.total_length===V.expected_length?this.emitSectionSlices(V,O):V.total_length>=V.expected_length&&this.clearSlices(V,O),ne+=Z.byteLength}}else V!=null&&V.total_length!==0&&(Z=new Uint8Array(c,d,Math.min(S,V.expected_length-V.total_length)),V.slices.push(Z),V.total_length+=Z.byteLength,V.total_length===V.expected_length?this.emitSectionSlices(V,O):V.total_length>=V.expected_length&&this.clearSlices(V,O))},f.prototype.handlePESSlice=function(c,d,S,O){var C=new Uint8Array(c,d,S),V=C[0]<<16|C[1]<<8|C[2],X=(C[3],C[4]<<8|C[5]);if(O.payload_unit_start_indicator){if(V!==1)return void p.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value ".concat(V));var Z=this.pes_slice_queues_[O.pid];Z&&(Z.expected_length===0||Z.expected_length===Z.total_length?this.emitPESSlices(Z,O):this.clearSlices(Z,O)),this.pes_slice_queues_[O.pid]=new _e,this.pes_slice_queues_[O.pid].file_position=O.file_position,this.pes_slice_queues_[O.pid].random_access_indicator=O.random_access_indicator}if(this.pes_slice_queues_[O.pid]!=null){var ne=this.pes_slice_queues_[O.pid];ne.slices.push(C),O.payload_unit_start_indicator&&(ne.expected_length=X===0?0:X+6),ne.total_length+=C.byteLength,ne.expected_length>0&&ne.expected_length===ne.total_length?this.emitPESSlices(ne,O):ne.expected_length>0&&ne.expected_length<ne.total_length&&this.clearSlices(ne,O)}},f.prototype.emitSectionSlices=function(c,d){for(var S=new Uint8Array(c.total_length),O=0,C=0;O<c.slices.length;O++){var V=c.slices[O];S.set(V,C),C+=V.byteLength}c.slices=[],c.expected_length=-1,c.total_length=0;var X=new ve;X.pid=d.pid,X.data=S,X.file_position=c.file_position,X.random_access_indicator=c.random_access_indicator,this.parseSection(X)},f.prototype.emitPESSlices=function(c,d){for(var S=new Uint8Array(c.total_length),O=0,C=0;O<c.slices.length;O++){var V=c.slices[O];S.set(V,C),C+=V.byteLength}c.slices=[],c.expected_length=-1,c.total_length=0;var X=new ie;X.pid=d.pid,X.data=S,X.stream_type=d.stream_type,X.file_position=c.file_position,X.random_access_indicator=c.random_access_indicator,this.parsePES(X)},f.prototype.clearSlices=function(c,d){c.slices=[],c.expected_length=-1,c.total_length=0},f.prototype.parseSection=function(c){var d=c.data,S=c.pid;S===0?this.parsePAT(d):S===this.current_pmt_pid_?this.parsePMT(d):this.pmt_!=null&&this.pmt_.scte_35_pids[S]&&this.parseSCTE35(d)},f.prototype.parsePES=function(c){var d=c.data,S=d[0]<<16|d[1]<<8|d[2],O=d[3],C=d[4]<<8|d[5];if(S===1)if(O!==188&&O!==190&&O!==191&&O!==240&&O!==241&&O!==255&&O!==242&&O!==248){d[6];var V=(192&d[7])>>>6,X=d[8],Z=void 0,ne=void 0;V!==2&&V!==3||(Z=this.getTimestamp(d,9),ne=V===3?this.getTimestamp(d,14):Z);var ce=9+X,ue=void 0;if(C!==0){if(C<3+X)return void p.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");ue=C-3-X}else ue=d.byteLength-ce;var me=d.subarray(ce,ce+ue);switch(c.stream_type){case N.kMPEG1Audio:case N.kMPEG2Audio:this.parseMP3Payload(me,Z);break;case N.kPESPrivateData:this.pmt_.common_pids.av1===c.pid?this.parseAV1Payload(me,Z,ne,c.file_position,c.random_access_indicator):this.pmt_.common_pids.opus===c.pid?this.parseOpusPayload(me,Z):this.pmt_.common_pids.ac3===c.pid?this.parseAC3Payload(me,Z):this.pmt_.common_pids.eac3===c.pid?this.parseEAC3Payload(me,Z):this.pmt_.asynchronous_klv_pids[c.pid]?this.parseAsynchronousKLVMetadataPayload(me,c.pid,O):this.pmt_.smpte2038_pids[c.pid]?this.parseSMPTE2038MetadataPayload(me,Z,ne,c.pid,O):this.parsePESPrivateDataPayload(me,Z,ne,c.pid,O);break;case N.kADTSAAC:this.parseADTSAACPayload(me,Z);break;case N.kLOASAAC:this.parseLOASAACPayload(me,Z);break;case N.kAC3:this.parseAC3Payload(me,Z);break;case N.kEAC3:this.parseEAC3Payload(me,Z);break;case N.kMetadata:this.pmt_.timed_id3_pids[c.pid]?this.parseTimedID3MetadataPayload(me,Z,ne,c.pid,O):this.pmt_.synchronous_klv_pids[c.pid]&&this.parseSynchronousKLVMetadataPayload(me,Z,ne,c.pid,O);break;case N.kH264:this.parseH264Payload(me,Z,ne,c.file_position,c.random_access_indicator);break;case N.kH265:this.parseH265Payload(me,Z,ne,c.file_position,c.random_access_indicator)}}else(O===188||O===191||O===240||O===241||O===255||O===242||O===248)&&c.stream_type===N.kPESPrivateData&&(ce=6,ue=void 0,ue=C!==0?C:d.byteLength-ce,me=d.subarray(ce,ce+ue),this.parsePESPrivateDataPayload(me,void 0,void 0,c.pid,O));else p.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value ".concat(S))},f.prototype.parsePAT=function(c){var d=c[0];if(d===0){var S=(15&c[1])<<8|c[2],O=(c[3],c[4],(62&c[5])>>>1),C=1&c[5],V=c[6],X=(c[7],null);if(C===1&&V===0)(X=new K).version_number=O;else if((X=this.pat_)==null)return;for(var Z=S-5-4,ne=-1,ce=-1,ue=8;ue<8+Z;ue+=4){var me=c[ue]<<8|c[ue+1],Se=(31&c[ue+2])<<8|c[ue+3];me===0?X.network_pid=Se:(X.program_pmt_pid[me]=Se,ne===-1&&(ne=me),ce===-1&&(ce=Se))}C===1&&V===0&&(this.pat_==null&&p.a.v(this.TAG,"Parsed first PAT: ".concat(JSON.stringify(X))),this.pat_=X,this.current_program_=ne,this.current_pmt_pid_=ce)}else p.a.e(this.TAG,"parsePAT: table_id ".concat(d," is not corresponded to PAT!"))},f.prototype.parsePMT=function(c){var d=c[0];if(d===2){var S=(15&c[1])<<8|c[2],O=c[3]<<8|c[4],C=(62&c[5])>>>1,V=1&c[5],X=c[6],Z=(c[7],null);if(V===1&&X===0)(Z=new de).program_number=O,Z.version_number=C,this.program_pmt_map_[O]=Z;else if((Z=this.program_pmt_map_[O])==null)return;Z.pcr_pid=(31&c[8])<<8|c[9];for(var ne=(15&c[10])<<8|c[11],ce=12+ne,ue=S-9-ne-4,me=ce;me<ce+ue;){var Se=c[me],ke=(31&c[me+1])<<8|c[me+2],we=(15&c[me+3])<<8|c[me+4];Z.pid_stream_type[ke]=Se;var Ve=Z.common_pids.h264||Z.common_pids.h265,Ne=Z.common_pids.adts_aac||Z.common_pids.loas_aac||Z.common_pids.ac3||Z.common_pids.eac3||Z.common_pids.opus||Z.common_pids.mp3;if(Se!==N.kH264||Ve)if(Se!==N.kH265||Ve)if(Se!==N.kADTSAAC||Ne)if(Se!==N.kLOASAAC||Ne)if(Se!==N.kAC3||Ne)if(Se!==N.kEAC3||Ne)if(Se!==N.kMPEG1Audio&&Se!==N.kMPEG2Audio||Ne)if(Se===N.kPESPrivateData){if(Z.pes_private_data_pids[ke]=!0,we>0){for(var Ce=me+5;Ce<me+5+we;){var $e=c[Ce+0],tt=c[Ce+1];if($e===5){var Be=String.fromCharCode.apply(String,Array.from(c.subarray(Ce+2,Ce+2+tt)));Be==="VANC"?Z.smpte2038_pids[ke]=!0:Be==="AV01"?Z.common_pids.av1=ke:Be==="Opus"?Z.common_pids.opus=ke:Be==="KLVA"&&(Z.asynchronous_klv_pids[ke]=!0)}else if($e===127){if(ke===Z.common_pids.opus){var Qe=null;if(c[Ce+2]===128&&(Qe=c[Ce+3]),Qe==null){p.a.e(this.TAG,"Not Supported Opus channel count.");continue}var dt={codec:"opus",channel_count:15&Qe?15&Qe:2,channel_config_code:Qe,sample_rate:48e3},Je={codec:"opus",meta:dt};this.audio_init_segment_dispatched_==0?(this.audio_metadata_=dt,this.dispatchAudioInitSegment(Je)):this.detectAudioMetadataChange(Je)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(Je))}}else $e===128&&ke===Z.common_pids.av1&&(this.video_metadata_.av1c=c.subarray(Ce+2,Ce+2+tt));Ce+=2+tt}var rt=c.subarray(me+5,me+5+we);this.dispatchPESPrivateDataDescriptor(ke,Se,rt)}}else if(Se===N.kMetadata){if(we>0)for(Ce=me+5;Ce<me+5+we;){$e=c[Ce+0];var vt=c[Ce+1];if($e===38){var Tt=c[Ce+2]<<8|c[Ce+3]<<0,at=null;Tt===65535&&(at=String.fromCharCode.apply(String,Array.from(c.subarray(Ce+4,Ce+4+4))));var ut=null;if(c[Ce+4+(Tt===65535?4:0)]===255){var kt=4+(Tt===65535?4:0)+1;ut=String.fromCharCode.apply(String,Array.from(c.subarray(Ce+kt,Ce+kt+4)))}at==="ID3 "&&ut==="ID3 "?Z.timed_id3_pids[ke]=!0:ut==="KLVA"&&(Z.synchronous_klv_pids[ke]=!0)}Ce+=2+vt}}else Se===N.kSCTE35&&(Z.scte_35_pids[ke]=!0);else Z.common_pids.mp3=ke;else Z.common_pids.eac3=ke;else Z.common_pids.ac3=ke;else Z.common_pids.loas_aac=ke;else Z.common_pids.adts_aac=ke;else Z.common_pids.h265=ke;else Z.common_pids.h264=ke;me+=5+we}O===this.current_program_&&(this.pmt_==null&&p.a.v(this.TAG,"Parsed first PMT: ".concat(JSON.stringify(Z))),this.pmt_=Z,(Z.common_pids.h264||Z.common_pids.h265||Z.common_pids.av1)&&(this.has_video_=!0),(Z.common_pids.adts_aac||Z.common_pids.loas_aac||Z.common_pids.ac3||Z.common_pids.opus||Z.common_pids.mp3)&&(this.has_audio_=!0))}else p.a.e(this.TAG,"parsePMT: table_id ".concat(d," is not corresponded to PMT!"))},f.prototype.parseSCTE35=function(c){var d=nr(c);if(d.pts!=null){var S=Math.floor(d.pts/this.timescale_);d.pts=S}else d.nearest_pts=this.getNearestTimestampMilliseconds();this.onSCTE35Metadata&&this.onSCTE35Metadata(d)},f.prototype.parseAV1Payload=function(c,d,S,O,C){for(var V=new sa(c),X=null,Z=[],ne=0,ce=!1,ue=null;(X=V.readNextOBUPayload())!=null;){if((ue=x.parseOBUs(X,this.video_metadata_.details))&&ue.keyframe===!0)if(this.video_init_segment_dispatched_){if(this.detectVideoMetadataChange(null,ue)===!0){var me;this.video_metadata_changed_=!0,this.dispatchVideoMediaSegment(),(me=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+ue.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),me.set(ue.sequence_header_data,this.video_metadata_.av1c.byteLength),ue.av1c=me,this.dispatchVideoInitSegment()}}else(me=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+ue.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),me.set(ue.sequence_header_data,this.video_metadata_.av1c.byteLength),ue.av1c=me,this.video_metadata_.details=ue,this.dispatchVideoInitSegment();this.video_metadata_.details=ue,ce||(ce=ue.keyframe),Z.push({data:X}),ne+=X.byteLength}var Se=Math.floor(d/this.timescale_),ke=Math.floor(S/this.timescale_);if(Z.length){var we=this.video_track_,Ve={units:Z,length:ne,isKeyframe:ce,dts:ke,pts:Se,cts:Se-ke,file_position:O};we.samples.push(Ve),we.length+=ne}},f.prototype.parseH264Payload=function(c,d,S,O,C){for(var V=new Ie(c),X=null,Z=[],ne=0,ce=!1;(X=V.readNextNaluPayload())!=null;){var ue=new be(X);if(ue.type===k.kSliceSPS){var me=j.parseSPS(X.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(ue,me)===!0&&(p.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:ue,pps:void 0,av1c:void 0,details:me}):(this.video_metadata_.sps=ue,this.video_metadata_.details=me)}else ue.type===k.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=ue,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(ue.type===k.kSliceIDR||ue.type===k.kSliceNonIDR&&C===1)&&(ce=!0);this.video_init_segment_dispatched_&&(Z.push(ue),ne+=ue.data.byteLength)}var Se=Math.floor(d/this.timescale_),ke=Math.floor(S/this.timescale_);if(Z.length){var we=this.video_track_,Ve={units:Z,length:ne,isKeyframe:ce,dts:ke,pts:Se,cts:Se-ke,file_position:O};we.samples.push(Ve),we.length+=ne}},f.prototype.parseH265Payload=function(c,d,S,O,C){for(var V=new it(c),X=null,Z=[],ne=0,ce=!1;(X=V.readNextNaluPayload())!=null;){var ue=new sr(X);if(ue.type===ct.kSliceVPS){if(!this.video_init_segment_dispatched_){var me=oe.parseVPS(X.data);this.video_metadata_.vps=ue,this.video_metadata_.details=Di(Di({},this.video_metadata_.details),me)}}else ue.type===ct.kSliceSPS?(me=oe.parseSPS(X.data),this.video_init_segment_dispatched_?this.detectVideoMetadataChange(ue,me)===!0&&(p.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:ue,pps:void 0,av1c:void 0,details:me}):(this.video_metadata_.sps=ue,this.video_metadata_.details=Di(Di({},this.video_metadata_.details),me))):ue.type===ct.kSlicePPS?(!this.video_init_segment_dispatched_||this.video_metadata_changed_)&&(me=oe.parsePPS(X.data),this.video_metadata_.pps=ue,this.video_metadata_.details=Di(Di({},this.video_metadata_.details),me),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):ue.type!==ct.kSliceIDR_W_RADL&&ue.type!==ct.kSliceIDR_N_LP&&ue.type!==ct.kSliceCRA_NUT||(ce=!0);this.video_init_segment_dispatched_&&(Z.push(ue),ne+=ue.data.byteLength)}var Se=Math.floor(d/this.timescale_),ke=Math.floor(S/this.timescale_);if(Z.length){var we=this.video_track_,Ve={units:Z,length:ne,isKeyframe:ce,dts:ke,pts:Se,cts:Se-ke,file_position:O};we.samples.push(Ve),we.length+=ne}},f.prototype.detectVideoMetadataChange=function(c,d){if(d.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return p.a.v(this.TAG,"Video: Codec mimeType changed from "+"".concat(this.video_metadata_.details.codec_mimetype," to ").concat(d.codec_mimetype)),!0;if(d.codec_size.width!==this.video_metadata_.details.codec_size.width||d.codec_size.height!==this.video_metadata_.details.codec_size.height){var S=this.video_metadata_.details.codec_size,O=d.codec_size;return p.a.v(this.TAG,"Video: Coded Resolution changed from "+"".concat(S.width,"x").concat(S.height," to ").concat(O.width,"x").concat(O.height)),!0}return d.present_size.width!==this.video_metadata_.details.present_size.width&&(p.a.v(this.TAG,"Video: Present resolution width changed from "+"".concat(this.video_metadata_.details.present_size.width," to ").concat(d.present_size.width)),!0)},f.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},f.prototype.dispatchVideoInitSegment=function(){var c=this.video_metadata_.details,d={type:"video"};d.id=this.video_track_.id,d.timescale=1e3,d.duration=this.duration_,d.codecWidth=c.codec_size.width,d.codecHeight=c.codec_size.height,d.presentWidth=c.present_size.width,d.presentHeight=c.present_size.height,d.profile=c.profile_string,d.level=c.level_string,d.bitDepth=c.bit_depth,d.chromaFormat=c.chroma_format,d.sarRatio=c.sar_ratio,d.frameRate=c.frame_rate;var S=d.frameRate.fps_den,O=d.frameRate.fps_num;if(d.refSampleDuration=S/O*1e3,d.codec=c.codec_mimetype,this.video_metadata_.av1c)d.av1c=this.video_metadata_.av1c,this.video_init_segment_dispatched_==0&&p.a.v(this.TAG,"Generated first AV1 for mimeType: ".concat(d.codec));else if(this.video_metadata_.vps){var C=this.video_metadata_.vps.data.subarray(4),V=this.video_metadata_.sps.data.subarray(4),X=this.video_metadata_.pps.data.subarray(4),Z=new or(C,V,X,c);d.hvcc=Z.getData(),this.video_init_segment_dispatched_==0&&p.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: ".concat(d.codec))}else{V=this.video_metadata_.sps.data.subarray(4),X=this.video_metadata_.pps.data.subarray(4);var ne=new Oe(V,X,c);d.avcc=ne.getData(),this.video_init_segment_dispatched_==0&&p.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: ".concat(d.codec))}this.onTrackMetadata("video",d),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var ce=this.media_info_;ce.hasVideo=!0,ce.width=d.codecWidth,ce.height=d.codecHeight,ce.fps=d.frameRate.fps,ce.profile=d.profile,ce.level=d.level,ce.refFrames=c.ref_frames,ce.chromaFormat=c.chroma_format_string,ce.sarNum=d.sarRatio.width,ce.sarDen=d.sarRatio.height,ce.videoCodec=d.codec,ce.hasAudio&&ce.audioCodec?ce.mimeType='video/mp2t; codecs="'.concat(ce.videoCodec,",").concat(ce.audioCodec,'"'):ce.mimeType='video/mp2t; codecs="'.concat(ce.videoCodec,'"'),ce.isComplete()&&this.onMediaInfo(ce)},f.prototype.dispatchVideoMediaSegment=function(){this.isInitSegmentDispatched()&&this.video_track_.length&&this.onDataAvailable(null,this.video_track_)},f.prototype.dispatchAudioMediaSegment=function(){this.isInitSegmentDispatched()&&this.audio_track_.length&&this.onDataAvailable(this.audio_track_,null)},f.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},f.prototype.parseADTSAACPayload=function(c,d){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var S=new Uint8Array(c.byteLength+this.aac_last_incomplete_data_.byteLength);S.set(this.aac_last_incomplete_data_,0),S.set(c,this.aac_last_incomplete_data_.byteLength),c=S}var O,C;if(d!=null&&(C=d/this.timescale_),this.audio_metadata_.codec==="aac"){if(d==null&&this.audio_last_sample_pts_!=null)O=1024/this.audio_metadata_.sampling_frequency*1e3,C=this.audio_last_sample_pts_+O;else if(d==null)return void p.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){O=1024/this.audio_metadata_.sampling_frequency*1e3;var V=this.audio_last_sample_pts_+O;Math.abs(V-C)>1&&(p.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(V,"ms, PES pts: ").concat(C,"ms")),C=V)}}for(var X,Z=new Ke(c),ne=null,ce=C;(ne=Z.readNextAACFrame())!=null;){O=1024/ne.sampling_frequency*1e3;var ue={codec:"aac",data:ne};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:ne.audio_object_type,sampling_freq_index:ne.sampling_freq_index,sampling_frequency:ne.sampling_frequency,channel_config:ne.channel_config},this.dispatchAudioInitSegment(ue)):this.detectAudioMetadataChange(ue)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(ue)),X=ce;var me=Math.floor(ce),Se={unit:ne.data,length:ne.data.byteLength,pts:me,dts:me};this.audio_track_.samples.push(Se),this.audio_track_.length+=ne.data.byteLength,ce+=O}Z.hasIncompleteData()&&(this.aac_last_incomplete_data_=Z.getIncompleteData()),X&&(this.audio_last_sample_pts_=X)}},f.prototype.parseLOASAACPayload=function(c,d){var S;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var O=new Uint8Array(c.byteLength+this.aac_last_incomplete_data_.byteLength);O.set(this.aac_last_incomplete_data_,0),O.set(c,this.aac_last_incomplete_data_.byteLength),c=O}var C,V;if(d!=null&&(V=d/this.timescale_),this.audio_metadata_.codec==="aac"){if(d==null&&this.audio_last_sample_pts_!=null)C=1024/this.audio_metadata_.sampling_frequency*1e3,V=this.audio_last_sample_pts_+C;else if(d==null)return void p.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){C=1024/this.audio_metadata_.sampling_frequency*1e3;var X=this.audio_last_sample_pts_+C;Math.abs(X-V)>1&&(p.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(X,"ms, PES pts: ").concat(V,"ms")),V=X)}}for(var Z,ne=new st(c),ce=null,ue=V;(ce=ne.readNextAACFrame((S=this.loas_previous_frame)!==null&&S!==void 0?S:void 0))!=null;){this.loas_previous_frame=ce,C=1024/ce.sampling_frequency*1e3;var me={codec:"aac",data:ce};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:ce.audio_object_type,sampling_freq_index:ce.sampling_freq_index,sampling_frequency:ce.sampling_frequency,channel_config:ce.channel_config},this.dispatchAudioInitSegment(me)):this.detectAudioMetadataChange(me)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(me)),Z=ue;var Se=Math.floor(ue),ke={unit:ce.data,length:ce.data.byteLength,pts:Se,dts:Se};this.audio_track_.samples.push(ke),this.audio_track_.length+=ce.data.byteLength,ue+=C}ne.hasIncompleteData()&&(this.aac_last_incomplete_data_=ne.getIncompleteData()),Z&&(this.audio_last_sample_pts_=Z)}},f.prototype.parseAC3Payload=function(c,d){if(!this.has_video_||this.video_init_segment_dispatched_){var S,O;if(d!=null&&(O=d/this.timescale_),this.audio_metadata_.codec==="ac-3"){if(d==null&&this.audio_last_sample_pts_!=null)S=1536/this.audio_metadata_.sampling_frequency*1e3,O=this.audio_last_sample_pts_+S;else if(d==null)return void p.a.w(this.TAG,"AC3: Unknown pts")}for(var C,V=new dr(c),X=null,Z=O;(X=V.readNextAC3Frame())!=null;){S=1536/X.sampling_frequency*1e3;var ne={codec:"ac-3",data:X};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"ac-3",sampling_frequency:X.sampling_frequency,bit_stream_identification:X.bit_stream_identification,bit_stream_mode:X.bit_stream_mode,low_frequency_effects_channel_on:X.low_frequency_effects_channel_on,channel_mode:X.channel_mode},this.dispatchAudioInitSegment(ne)):this.detectAudioMetadataChange(ne)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(ne)),C=Z;var ce=Math.floor(Z),ue={unit:X.data,length:X.data.byteLength,pts:ce,dts:ce};this.audio_track_.samples.push(ue),this.audio_track_.length+=X.data.byteLength,Z+=S}C&&(this.audio_last_sample_pts_=C)}},f.prototype.parseEAC3Payload=function(c,d){if(!this.has_video_||this.video_init_segment_dispatched_){var S,O;if(d!=null&&(O=d/this.timescale_),this.audio_metadata_.codec==="ec-3"){if(d==null&&this.audio_last_sample_pts_!=null)S=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,O=this.audio_last_sample_pts_+S;else if(d==null)return void p.a.w(this.TAG,"EAC3: Unknown pts")}for(var C,V=new ht(c),X=null,Z=O;(X=V.readNextEAC3Frame())!=null;){S=1536/X.sampling_frequency*1e3;var ne={codec:"ec-3",data:X};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"ec-3",sampling_frequency:X.sampling_frequency,bit_stream_identification:X.bit_stream_identification,low_frequency_effects_channel_on:X.low_frequency_effects_channel_on,num_blks:X.num_blks,channel_mode:X.channel_mode},this.dispatchAudioInitSegment(ne)):this.detectAudioMetadataChange(ne)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(ne)),C=Z;var ce=Math.floor(Z),ue={unit:X.data,length:X.data.byteLength,pts:ce,dts:ce};this.audio_track_.samples.push(ue),this.audio_track_.length+=X.data.byteLength,Z+=S}C&&(this.audio_last_sample_pts_=C)}},f.prototype.parseOpusPayload=function(c,d){if(!this.has_video_||this.video_init_segment_dispatched_){var S,O;if(d!=null&&(O=d/this.timescale_),this.audio_metadata_.codec==="opus"){if(d==null&&this.audio_last_sample_pts_!=null)S=20,O=this.audio_last_sample_pts_+S;else if(d==null)return void p.a.w(this.TAG,"Opus: Unknown pts")}for(var C,V=O,X=0;X<c.length;){S=20;for(var Z=(16&c[X+1])!=0,ne=(8&c[X+1])!=0,ce=X+2,ue=0;c[ce]===255;)ue+=255,ce+=1;ue+=c[ce],ce+=1,ce+=Z?2:0,ce+=ne?2:0,C=V;var me=Math.floor(V),Se=c.slice(ce,ce+ue),ke={unit:Se,length:Se.byteLength,pts:me,dts:me};this.audio_track_.samples.push(ke),this.audio_track_.length+=Se.byteLength,V+=S,X=ce+ue}C&&(this.audio_last_sample_pts_=C)}},f.prototype.parseMP3Payload=function(c,d){if(!this.has_video_||this.video_init_segment_dispatched_){var S=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],O=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],C=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],V=c[1]>>>3&3,X=(6&c[1])>>1,Z=(240&c[2])>>>4,ne=(12&c[2])>>>2,ce=(c[3]>>>6&3)!==3?2:1,ue=0,me=34;switch(V){case 0:ue=[11025,12e3,8e3,0][ne];break;case 2:ue=[22050,24e3,16e3,0][ne];break;case 3:ue=[44100,48e3,32e3,0][ne]}switch(X){case 1:me=34,Z<C.length&&C[Z];break;case 2:me=33,Z<O.length&&O[Z];break;case 3:me=32,Z<S.length&&S[Z]}var Se=new Xi;Se.object_type=me,Se.sample_rate=ue,Se.channel_count=ce,Se.data=c;var ke={codec:"mp3",data:Se};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"mp3",object_type:me,sample_rate:ue,channel_count:ce},this.dispatchAudioInitSegment(ke)):this.detectAudioMetadataChange(ke)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(ke));var we={unit:c,length:c.byteLength,pts:d/this.timescale_,dts:d/this.timescale_};this.audio_track_.samples.push(we),this.audio_track_.length+=c.byteLength}},f.prototype.detectAudioMetadataChange=function(c){if(c.codec!==this.audio_metadata_.codec)return p.a.v(this.TAG,"Audio: Audio Codecs changed from "+"".concat(this.audio_metadata_.codec," to ").concat(c.codec)),!0;if(c.codec==="aac"&&this.audio_metadata_.codec==="aac"){if((d=c.data).audio_object_type!==this.audio_metadata_.audio_object_type)return p.a.v(this.TAG,"AAC: AudioObjectType changed from "+"".concat(this.audio_metadata_.audio_object_type," to ").concat(d.audio_object_type)),!0;if(d.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return p.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sampling_freq_index," to ").concat(d.sampling_freq_index)),!0;if(d.channel_config!==this.audio_metadata_.channel_config)return p.a.v(this.TAG,"AAC: Channel configuration changed from "+"".concat(this.audio_metadata_.channel_config," to ").concat(d.channel_config)),!0}else if(c.codec==="ac-3"&&this.audio_metadata_.codec==="ac-3"){var d;if((d=c.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return p.a.v(this.TAG,"AC3: Sampling Frequency changed from "+"".concat(this.audio_metadata_.sampling_frequency," to ").concat(d.sampling_frequency)),!0;if(d.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return p.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+"".concat(this.audio_metadata_.bit_stream_identification," to ").concat(d.bit_stream_identification)),!0;if(d.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return p.a.v(this.TAG,"AC3: BitStream Mode changed from "+"".concat(this.audio_metadata_.bit_stream_mode," to ").concat(d.bit_stream_mode)),!0;if(d.channel_mode!==this.audio_metadata_.channel_mode)return p.a.v(this.TAG,"AC3: Channel Mode changed from "+"".concat(this.audio_metadata_.channel_mode," to ").concat(d.channel_mode)),!0;if(d.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return p.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+"".concat(this.audio_metadata_.low_frequency_effects_channel_on," to ").concat(d.low_frequency_effects_channel_on)),!0}else if(c.codec==="opus"&&this.audio_metadata_.codec==="opus"){if((S=c.meta).sample_rate!==this.audio_metadata_.sample_rate)return p.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(S.sample_rate)),!0;if(S.channel_count!==this.audio_metadata_.channel_count)return p.a.v(this.TAG,"Opus: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(S.channel_count)),!0}else if(c.codec==="mp3"&&this.audio_metadata_.codec==="mp3"){var S;if((S=c.data).object_type!==this.audio_metadata_.object_type)return p.a.v(this.TAG,"MP3: AudioObjectType changed from "+"".concat(this.audio_metadata_.object_type," to ").concat(S.object_type)),!0;if(S.sample_rate!==this.audio_metadata_.sample_rate)return p.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(S.sample_rate)),!0;if(S.channel_count!==this.audio_metadata_.channel_count)return p.a.v(this.TAG,"MP3: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(S.channel_count)),!0}return!1},f.prototype.dispatchAudioInitSegment=function(c){var d={type:"audio"};if(d.id=this.audio_track_.id,d.timescale=1e3,d.duration=this.duration_,this.audio_metadata_.codec==="aac"){var S=c.codec==="aac"?c.data:null,O=new Ze(S);d.audioSampleRate=O.sampling_rate,d.channelCount=O.channel_count,d.codec=O.codec_mimetype,d.originalCodec=O.original_codec_mimetype,d.config=O.config,d.refSampleDuration=1024/d.audioSampleRate*d.timescale}else if(this.audio_metadata_.codec==="ac-3"){var C=c.codec==="ac-3"?c.data:null,V=new Tr(C);d.audioSampleRate=V.sampling_rate,d.channelCount=V.channel_count,d.codec=V.codec_mimetype,d.originalCodec=V.original_codec_mimetype,d.config=V.config,d.refSampleDuration=1536/d.audioSampleRate*d.timescale}else if(this.audio_metadata_.codec==="ec-3"){var X=c.codec==="ec-3"?c.data:null,Z=new ur(X);d.audioSampleRate=Z.sampling_rate,d.channelCount=Z.channel_count,d.codec=Z.codec_mimetype,d.originalCodec=Z.original_codec_mimetype,d.config=Z.config,d.refSampleDuration=256*Z.num_blks/d.audioSampleRate*d.timescale}else this.audio_metadata_.codec==="opus"?(d.audioSampleRate=this.audio_metadata_.sample_rate,d.channelCount=this.audio_metadata_.channel_count,d.channelConfigCode=this.audio_metadata_.channel_config_code,d.codec="opus",d.originalCodec="opus",d.config=void 0,d.refSampleDuration=20):this.audio_metadata_.codec==="mp3"&&(d.audioSampleRate=this.audio_metadata_.sample_rate,d.channelCount=this.audio_metadata_.channel_count,d.codec="mp3",d.originalCodec="mp3",d.config=void 0);this.audio_init_segment_dispatched_==0&&p.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: ".concat(d.codec)),this.onTrackMetadata("audio",d),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var ne=this.media_info_;ne.hasAudio=!0,ne.audioCodec=d.originalCodec,ne.audioSampleRate=d.audioSampleRate,ne.audioChannelCount=d.channelCount,ne.hasVideo&&ne.videoCodec?ne.mimeType='video/mp2t; codecs="'.concat(ne.videoCodec,",").concat(ne.audioCodec,'"'):ne.mimeType='video/mp2t; codecs="'.concat(ne.audioCodec,'"'),ne.isComplete()&&this.onMediaInfo(ne)},f.prototype.dispatchPESPrivateDataDescriptor=function(c,d,S){var O=new Xt;O.pid=c,O.stream_type=d,O.descriptor=S,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(O)},f.prototype.parsePESPrivateDataPayload=function(c,d,S,O,C){var V=new xt;if(V.pid=O,V.stream_id=C,V.len=c.byteLength,V.data=c,d!=null){var X=Math.floor(d/this.timescale_);V.pts=X}else V.nearest_pts=this.getNearestTimestampMilliseconds();if(S!=null){var Z=Math.floor(S/this.timescale_);V.dts=Z}this.onPESPrivateData&&this.onPESPrivateData(V)},f.prototype.parseTimedID3MetadataPayload=function(c,d,S,O,C){var V=new xt;if(V.pid=O,V.stream_id=C,V.len=c.byteLength,V.data=c,d!=null){var X=Math.floor(d/this.timescale_);V.pts=X}if(S!=null){var Z=Math.floor(S/this.timescale_);V.dts=Z}this.onTimedID3Metadata&&this.onTimedID3Metadata(V)},f.prototype.parseSynchronousKLVMetadataPayload=function(c,d,S,O,C){var V=new yi;if(V.pid=O,V.stream_id=C,V.len=c.byteLength,V.data=c,d!=null){var X=Math.floor(d/this.timescale_);V.pts=X}if(S!=null){var Z=Math.floor(S/this.timescale_);V.dts=Z}V.access_units=function(ne){for(var ce=[],ue=0;ue+5<ne.byteLength;){var me=ne[ue+0],Se=ne[ue+1],ke=ne[ue+2],we=ne[ue+3]<<8|ne[ue+4]<<0,Ve=ne.slice(ue+5,ue+5+we);ce.push({service_id:me,sequence_number:Se,flags:ke,data:Ve}),ue+=5+we}return ce}(c),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(V)},f.prototype.parseAsynchronousKLVMetadataPayload=function(c,d,S){var O=new xt;O.pid=d,O.stream_id=S,O.len=c.byteLength,O.data=c,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(O)},f.prototype.parseSMPTE2038MetadataPayload=function(c,d,S,O,C){var V=new lr;if(V.pid=O,V.stream_id=C,V.len=c.byteLength,V.data=c,d!=null){var X=Math.floor(d/this.timescale_);V.pts=X}if(V.nearest_pts=this.getNearestTimestampMilliseconds(),S!=null){var Z=Math.floor(S/this.timescale_);V.dts=Z}V.ancillaries=function(ne){for(var ce=new z(ne),ue=0,me=[];ue+=6,ce.readBits(6)===0;){var Se=ce.readBool();ue+=1;var ke=ce.readBits(11);ue+=11;var we=ce.readBits(12);ue+=12;var Ve=255&ce.readBits(10);ue+=10;var Ne=255&ce.readBits(10);ue+=10;var Ce=255&ce.readBits(10);ue+=10;for(var $e=new Uint8Array(Ce),tt=0;tt<Ce;tt++){var Be=255&ce.readBits(10);ue+=10,$e[tt]=Be}ce.readBits(10),ue+=10;var Qe="User Defined";Ve===65?Ne===7&&(Qe="SCTE-104"):Ve===95?Ne===220?Qe="ARIB STD-B37 (1SEG)":Ne===221?Qe="ARIB STD-B37 (ANALOG)":Ne===222?Qe="ARIB STD-B37 (SD)":Ne===223&&(Qe="ARIB STD-B37 (HD)"):Ve===97&&(Ne===1?Qe="EIA-708":Ne===2&&(Qe="EIA-608")),me.push({yc_indicator:Se,line_number:ke,horizontal_offset:we,did:Ve,sdid:Ne,user_data:$e,description:Qe,information:{}}),ce.readBits(8-(ue-Math.floor(ue/8))%8),ue+=(8-(ue-Math.floor(ue/8)))%8}return ce.destroy(),ce=null,me}(c),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(V)},f.prototype.getNearestTimestampMilliseconds=function(){return this.audio_last_sample_pts_!=null?Math.floor(this.audio_last_sample_pts_):this.last_pcr_!=null?Math.floor(this.last_pcr_/300/this.timescale_):void 0},f.prototype.getPcrBase=function(c){var d=33554432*c[6]+131072*c[7]+512*c[8]+2*c[9]+(128&c[10])/128+this.timestamp_offset_;return d+4294967296<this.last_pcr_base_&&(d+=8589934592,this.timestamp_offset_+=8589934592),this.last_pcr_base_=d,d},f.prototype.getTimestamp=function(c,d){var S=536870912*(14&c[d])+4194304*(255&c[d+1])+16384*(254&c[d+2])+128*(255&c[d+3])+(254&c[d+4])/2+this.timestamp_offset_;return S+4294967296<this.last_pcr_base_&&(S+=8589934592),S},f}(re),Ur=function(v,f,c){if(c||arguments.length===2)for(var d,S=0,O=f.length;S<O;S++)!d&&S in f||(d||(d=Array.prototype.slice.call(f,0,S)),d[S]=f[S]);return v.concat(d||Array.prototype.slice.call(f))},Lr=function(){function v(){}return v.init=function(){for(var f in v.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[],fLaC:[],dfLa:[]},v.types)v.types.hasOwnProperty(f)&&(v.types[f]=[f.charCodeAt(0),f.charCodeAt(1),f.charCodeAt(2),f.charCodeAt(3)]);var c=v.constants={};c.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),c.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),c.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),c.STSC=c.STCO=c.STTS,c.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),c.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),c.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),c.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),c.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),c.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},v.box=function(f){for(var c=8,d=null,S=Array.prototype.slice.call(arguments,1),O=S.length,C=0;C<O;C++)c+=S[C].byteLength;(d=new Uint8Array(c))[0]=c>>>24&255,d[1]=c>>>16&255,d[2]=c>>>8&255,d[3]=255&c,d.set(f,4);var V=8;for(C=0;C<O;C++)d.set(S[C],V),V+=S[C].byteLength;return d},v.generateInitSegment=function(f){var c=v.box(v.types.ftyp,v.constants.FTYP),d=v.moov(f),S=new Uint8Array(c.byteLength+d.byteLength);return S.set(c,0),S.set(d,c.byteLength),S},v.moov=function(f){var c=v.mvhd(f.timescale,f.duration),d=v.trak(f),S=v.mvex(f);return v.box(v.types.moov,c,d,S)},v.mvhd=function(f,c){return v.box(v.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,255&f,c>>>24&255,c>>>16&255,c>>>8&255,255&c,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},v.trak=function(f){return v.box(v.types.trak,v.tkhd(f),v.mdia(f))},v.tkhd=function(f){var c=f.id,d=f.duration,S=f.presentWidth,O=f.presentHeight;return v.box(v.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,255&c,0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,255&d,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,S>>>8&255,255&S,0,0,O>>>8&255,255&O,0,0]))},v.mdia=function(f){return v.box(v.types.mdia,v.mdhd(f),v.hdlr(f),v.minf(f))},v.mdhd=function(f){var c=f.timescale,d=f.duration;return v.box(v.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d>>>24&255,d>>>16&255,d>>>8&255,255&d,85,196,0,0]))},v.hdlr=function(f){var c=null;return c=f.type==="audio"?v.constants.HDLR_AUDIO:v.constants.HDLR_VIDEO,v.box(v.types.hdlr,c)},v.minf=function(f){var c=null;return c=f.type==="audio"?v.box(v.types.smhd,v.constants.SMHD):v.box(v.types.vmhd,v.constants.VMHD),v.box(v.types.minf,c,v.dinf(),v.stbl(f))},v.dinf=function(){return v.box(v.types.dinf,v.box(v.types.dref,v.constants.DREF))},v.stbl=function(f){return v.box(v.types.stbl,v.stsd(f),v.box(v.types.stts,v.constants.STTS),v.box(v.types.stsc,v.constants.STSC),v.box(v.types.stsz,v.constants.STSZ),v.box(v.types.stco,v.constants.STCO))},v.stsd=function(f){return f.type==="audio"?f.codec==="mp3"?v.box(v.types.stsd,v.constants.STSD_PREFIX,v.mp3(f)):f.codec==="ac-3"?v.box(v.types.stsd,v.constants.STSD_PREFIX,v.ac3(f)):f.codec==="ec-3"?v.box(v.types.stsd,v.constants.STSD_PREFIX,v.ec3(f)):f.codec==="opus"?v.box(v.types.stsd,v.constants.STSD_PREFIX,v.Opus(f)):f.codec=="flac"?v.box(v.types.stsd,v.constants.STSD_PREFIX,v.fLaC(f)):v.box(v.types.stsd,v.constants.STSD_PREFIX,v.mp4a(f)):f.type==="video"&&f.codec.startsWith("hvc1")?v.box(v.types.stsd,v.constants.STSD_PREFIX,v.hvc1(f)):f.type==="video"&&f.codec.startsWith("av01")?v.box(v.types.stsd,v.constants.STSD_PREFIX,v.av01(f)):v.box(v.types.stsd,v.constants.STSD_PREFIX,v.avc1(f))},v.mp3=function(f){var c=f.channelCount,d=f.audioSampleRate,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c,0,16,0,0,0,0,d>>>8&255,255&d,0,0]);return v.box(v.types[".mp3"],S)},v.mp4a=function(f){var c=f.channelCount,d=f.audioSampleRate,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c,0,16,0,0,0,0,d>>>8&255,255&d,0,0]);return v.box(v.types.mp4a,S,v.esds(f))},v.ac3=function(f){var c=f.channelCount,d=f.audioSampleRate,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c,0,16,0,0,0,0,d>>>8&255,255&d,0,0]);return v.box(v.types["ac-3"],S,v.box(v.types.dac3,new Uint8Array(f.config)))},v.ec3=function(f){var c=f.channelCount,d=f.audioSampleRate,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c,0,16,0,0,0,0,d>>>8&255,255&d,0,0]);return v.box(v.types["ec-3"],S,v.box(v.types.dec3,new Uint8Array(f.config)))},v.esds=function(f){var c=f.config||[],d=c.length,S=new Uint8Array([0,0,0,0,3,23+d,0,1,0,4,15+d,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([d]).concat(c).concat([6,1,2]));return v.box(v.types.esds,S)},v.Opus=function(f){var c=f.channelCount,d=f.audioSampleRate,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c,0,16,0,0,0,0,d>>>8&255,255&d,0,0]);return v.box(v.types.Opus,S,v.dOps(f))},v.dOps=function(f){var c=f.channelCount,d=f.channelConfigCode,S=f.audioSampleRate;if(f.config)return v.box(v.types.dOps,f.config);var O=[];switch(d){case 1:case 2:O=[0];break;case 0:O=[255,1,1,0,1];break;case 128:O=[255,2,0,0,1];break;case 3:O=[1,2,1,0,2,1];break;case 4:O=[1,2,2,0,1,2,3];break;case 5:O=[1,3,2,0,4,1,2,3];break;case 6:O=[1,4,2,0,4,1,2,3,5];break;case 7:O=[1,4,2,0,4,1,2,3,5,6];break;case 8:O=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:O=[1,1,2,0,1];break;case 131:O=[1,1,3,0,1,2];break;case 132:O=[1,1,4,0,1,2,3];break;case 133:O=[1,1,5,0,1,2,3,4];break;case 134:O=[1,1,6,0,1,2,3,4,5];break;case 135:O=[1,1,7,0,1,2,3,4,5,6];break;case 136:O=[1,1,8,0,1,2,3,4,5,6,7]}var C=new Uint8Array(Ur([0,c,0,0,S>>>24&255,S>>>17&255,S>>>8&255,S>>>0&255,0,0],O,!0));return v.box(v.types.dOps,C)},v.fLaC=function(f){var c=f.channelCount,d=Math.min(f.audioSampleRate,65535),S=f.sampleSize,O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c,0,S,0,0,0,0,d>>>8&255,255&d,0,0]);return v.box(v.types.fLaC,O,v.dfLa(f))},v.dfLa=function(f){var c=new Uint8Array(Ur([0,0,0,0],f.config,!0));return v.box(v.types.dfLa,c)},v.avc1=function(f){var c=f.avcc,d=f.codecWidth,S=f.codecHeight,O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>>8&255,255&d,S>>>8&255,255&S,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return v.box(v.types.avc1,O,v.box(v.types.avcC,c))},v.hvc1=function(f){var c=f.hvcc,d=f.codecWidth,S=f.codecHeight,O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>>8&255,255&d,S>>>8&255,255&S,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return v.box(v.types.hvc1,O,v.box(v.types.hvcC,c))},v.av01=function(f){var c=f.av1c,d=f.codecWidth||192,S=f.codecHeight||108,O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>>8&255,255&d,S>>>8&255,255&S,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return v.box(v.types.av01,O,v.box(v.types.av1C,c))},v.mvex=function(f){return v.box(v.types.mvex,v.trex(f))},v.trex=function(f){var c=f.id,d=new Uint8Array([0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,255&c,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return v.box(v.types.trex,d)},v.moof=function(f,c){return v.box(v.types.moof,v.mfhd(f.sequenceNumber),v.traf(f,c))},v.mfhd=function(f){var c=new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,255&f]);return v.box(v.types.mfhd,c)},v.traf=function(f,c){var d=f.id,S=v.box(v.types.tfhd,new Uint8Array([0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,255&d])),O=v.box(v.types.tfdt,new Uint8Array([0,0,0,0,c>>>24&255,c>>>16&255,c>>>8&255,255&c])),C=v.sdtp(f),V=v.trun(f,C.byteLength+16+16+8+16+8+8);return v.box(v.types.traf,S,O,V,C)},v.sdtp=function(f){for(var c=f.samples||[],d=c.length,S=new Uint8Array(4+d),O=0;O<d;O++){var C=c[O].flags;S[O+4]=C.isLeading<<6|C.dependsOn<<4|C.isDependedOn<<2|C.hasRedundancy}return v.box(v.types.sdtp,S)},v.trun=function(f,c){var d=f.samples||[],S=d.length,O=12+16*S,C=new Uint8Array(O);c+=8+O,C.set([0,0,15,1,S>>>24&255,S>>>16&255,S>>>8&255,255&S,c>>>24&255,c>>>16&255,c>>>8&255,255&c],0);for(var V=0;V<S;V++){var X=d[V].duration,Z=d[V].size,ne=d[V].flags,ce=d[V].cts;C.set([X>>>24&255,X>>>16&255,X>>>8&255,255&X,Z>>>24&255,Z>>>16&255,Z>>>8&255,255&Z,ne.isLeading<<2|ne.dependsOn,ne.isDependedOn<<6|ne.hasRedundancy<<4|ne.isNonSync,0,0,ce>>>24&255,ce>>>16&255,ce>>>8&255,255&ce],12+16*V)}return v.box(v.types.trun,C)},v.mdat=function(f){return v.box(v.types.mdat,f)},v}();Lr.init();var Ni=Lr,Ti=function(){function v(){}return v.getSilentFrame=function(f,c){if(f==="mp4a.40.2"){if(c===1)return new Uint8Array([0,200,0,128,35,128]);if(c===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(c===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(c===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(c===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(c===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(c===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(c===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(c===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},v}(),bi=w(11),Fi=function(){function v(f){this.TAG="MP4Remuxer",this._config=f,this._isLive=f.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new bi.c("audio"),this._videoSegmentInfoList=new bi.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!D.a.chrome||!(D.a.version.major<50||D.a.version.major===50&&D.a.version.build<2661)),this._fillSilentAfterSeek=D.a.msedge||D.a.msie,this._mp3UseMpegAudio=!D.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return v.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},v.prototype.bindDataSource=function(f){return f.onDataAvailable=this.remux.bind(this),f.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(v.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(f){this._onInitSegment=f},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(f){this._onMediaSegment=f},enumerable:!1,configurable:!0}),v.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},v.prototype.seek=function(f){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},v.prototype.remux=function(f,c){if(!this._onMediaSegment)throw new E.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(f,c),c&&this._remuxVideo(c),f&&this._remuxAudio(f)},v.prototype._onTrackMetadataReceived=function(f,c){var d=null,S="mp4",O=c.codec;if(f==="audio")this._audioMeta=c,c.codec==="mp3"&&this._mp3UseMpegAudio?(S="mpeg",O="",d=new Uint8Array):d=Ni.generateInitSegment(c);else{if(f!=="video")return;this._videoMeta=c,d=Ni.generateInitSegment(c)}if(!this._onInitSegment)throw new E.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(f,{type:f,data:d.buffer,codec:O,container:"".concat(f,"/").concat(S),mediaDuration:c.duration})},v.prototype._calculateDtsBase=function(f,c){this._dtsBaseInited||(f&&f.samples&&f.samples.length&&(this._audioDtsBase=f.samples[0].dts),c&&c.samples&&c.samples.length&&(this._videoDtsBase=c.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},v.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},v.prototype.flushStashedSamples=function(){var f=this._videoStashedLastSample,c=this._audioStashedLastSample,d={type:"video",id:1,sequenceNumber:0,samples:[],length:0};f!=null&&(d.samples.push(f),d.length=f.length);var S={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};c!=null&&(S.samples.push(c),S.length=c.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(d,!0),this._remuxAudio(S,!0)},v.prototype._remuxAudio=function(f,c){if(this._audioMeta!=null){var d,S=f,O=S.samples,C=void 0,V=-1,X=this._audioMeta.refSampleDuration,Z=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,ne=this._dtsBaseInited&&this._audioNextDts===void 0,ce=!1;if(O&&O.length!==0&&(O.length!==1||c)){var ue=0,me=null,Se=0;Z?(ue=0,Se=S.length):(ue=8,Se=8+S.length);var ke=null;if(O.length>1&&(Se-=(ke=O.pop()).length),this._audioStashedLastSample!=null){var we=this._audioStashedLastSample;this._audioStashedLastSample=null,O.unshift(we),Se+=we.length}ke!=null&&(this._audioStashedLastSample=ke);var Ve=O[0].dts-this._dtsBase;if(this._audioNextDts)C=Ve-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())C=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(ce=!0);else{var Ne=this._audioSegmentInfoList.getLastSampleBefore(Ve);if(Ne!=null){var Ce=Ve-(Ne.originalDts+Ne.duration);Ce<=3&&(Ce=0),C=Ve-(Ne.dts+Ne.duration+Ce)}else C=0}if(ce){var $e=Ve-C,tt=this._videoSegmentInfoList.getLastSegmentBefore(Ve);if(tt!=null&&tt.beginDts<$e){if(Ut=Ti.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var Be=tt.beginDts,Qe=$e-tt.beginDts;p.a.v(this.TAG,"InsertPrefixSilentAudio: dts: ".concat(Be,", duration: ").concat(Qe)),O.unshift({unit:Ut,dts:Be,pts:Be}),Se+=Ut.byteLength}}else ce=!1}for(var dt=[],Je=0;Je<O.length;Je++){var rt=(we=O[Je]).unit,vt=we.dts-this._dtsBase,Tt=(Be=vt,!1),at=null,ut=0;if(!(vt<-.001)){if(this._audioMeta.codec!=="mp3"&&X!=null){var kt=vt;if(this._audioNextDts&&(kt=this._audioNextDts),(C=vt-kt)<=-3*X){p.a.w(this.TAG,"Dropping 1 audio frame (originalDts: ".concat(vt," ms ,curRefDts: ").concat(kt," ms)  due to dtsCorrection: ").concat(C," ms overlap."));continue}if(C>=3*X&&this._fillAudioTimestampGap&&!D.a.safari){Tt=!0;var Ut,hi=Math.floor(C/X);p.a.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\n"+"originalDts: ".concat(vt," ms, curRefDts: ").concat(kt," ms, ")+"dtsCorrection: ".concat(Math.round(C)," ms, generate: ").concat(hi," frames")),Be=Math.floor(kt),ut=Math.floor(kt+X)-Be,(Ut=Ti.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))==null&&(p.a.w(this.TAG,"Unable to generate silent frame for "+"".concat(this._audioMeta.originalCodec," with ").concat(this._audioMeta.channelCount," channels, repeat last frame")),Ut=rt),at=[];for(var qt=0;qt<hi;qt++){kt+=X;var si=Math.floor(kt),Ft=Math.floor(kt+X)-si,ei={dts:si,pts:si,cts:0,unit:Ut,size:Ut.byteLength,duration:Ft,originalDts:vt,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};at.push(ei),Se+=ei.size}this._audioNextDts=kt+X}else Be=Math.floor(kt),ut=Math.floor(kt+X)-Be,this._audioNextDts=kt+X}else Be=vt-C,Je!==O.length-1?ut=O[Je+1].dts-this._dtsBase-C-Be:ke!=null?ut=ke.dts-this._dtsBase-C-Be:ut=dt.length>=1?dt[dt.length-1].duration:Math.floor(X),this._audioNextDts=Be+ut;V===-1&&(V=Be),dt.push({dts:Be,pts:Be,cts:0,unit:we.unit,size:we.unit.byteLength,duration:ut,originalDts:vt,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Tt&&dt.push.apply(dt,at)}}if(dt.length===0)return S.samples=[],void(S.length=0);for(Z?me=new Uint8Array(Se):((me=new Uint8Array(Se))[0]=Se>>>24&255,me[1]=Se>>>16&255,me[2]=Se>>>8&255,me[3]=255&Se,me.set(Ni.types.mdat,4)),Je=0;Je<dt.length;Je++)rt=dt[Je].unit,me.set(rt,ue),ue+=rt.byteLength;var Wt=dt[dt.length-1];d=Wt.dts+Wt.duration;var _t=new bi.b;_t.beginDts=V,_t.endDts=d,_t.beginPts=V,_t.endPts=d,_t.originalBeginDts=dt[0].originalDts,_t.originalEndDts=Wt.originalDts+Wt.duration,_t.firstSample=new bi.d(dt[0].dts,dt[0].pts,dt[0].duration,dt[0].originalDts,!1),_t.lastSample=new bi.d(Wt.dts,Wt.pts,Wt.duration,Wt.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(_t),S.samples=dt,S.sequenceNumber++;var fi=null;fi=Z?new Uint8Array:Ni.moof(S,V),S.samples=[],S.length=0;var Ei={type:"audio",data:this._mergeBoxes(fi,me).buffer,sampleCount:dt.length,info:_t};Z&&ne&&(Ei.timestampOffset=V),this._onMediaSegment("audio",Ei)}}},v.prototype._remuxVideo=function(f,c){if(this._videoMeta!=null){var d,S,O=f,C=O.samples,V=void 0,X=-1,Z=-1;if(C&&C.length!==0&&(C.length!==1||c)){var ne=8,ce=null,ue=8+f.length,me=null;if(C.length>1&&(ue-=(me=C.pop()).length),this._videoStashedLastSample!=null){var Se=this._videoStashedLastSample;this._videoStashedLastSample=null,C.unshift(Se),ue+=Se.length}me!=null&&(this._videoStashedLastSample=me);var ke=C[0].dts-this._dtsBase;if(this._videoNextDts)V=ke-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())V=0;else{var we=this._videoSegmentInfoList.getLastSampleBefore(ke);if(we!=null){var Ve=ke-(we.originalDts+we.duration);Ve<=3&&(Ve=0),V=ke-(we.dts+we.duration+Ve)}else V=0}for(var Ne=new bi.b,Ce=[],$e=0;$e<C.length;$e++){var tt=(Se=C[$e]).dts-this._dtsBase,Be=Se.isKeyframe,Qe=tt-V,dt=Se.cts,Je=Qe+dt;X===-1&&(X=Qe,Z=Je);var rt=0;if($e!==C.length-1?rt=C[$e+1].dts-this._dtsBase-V-Qe:me!=null?rt=me.dts-this._dtsBase-V-Qe:rt=Ce.length>=1?Ce[Ce.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),Be){var vt=new bi.d(Qe,Je,rt,Se.dts,!0);vt.fileposition=Se.fileposition,Ne.appendSyncPoint(vt)}Ce.push({dts:Qe,pts:Je,cts:dt,units:Se.units,size:Se.length,isKeyframe:Be,duration:rt,originalDts:tt,flags:{isLeading:0,dependsOn:Be?2:1,isDependedOn:Be?1:0,hasRedundancy:0,isNonSync:Be?0:1}})}for((ce=new Uint8Array(ue))[0]=ue>>>24&255,ce[1]=ue>>>16&255,ce[2]=ue>>>8&255,ce[3]=255&ue,ce.set(Ni.types.mdat,4),$e=0;$e<Ce.length;$e++)for(var Tt=Ce[$e].units;Tt.length;){var at=Tt.shift().data;ce.set(at,ne),ne+=at.byteLength}var ut=Ce[Ce.length-1];if(d=ut.dts+ut.duration,S=ut.pts+ut.duration,this._videoNextDts=d,Ne.beginDts=X,Ne.endDts=d,Ne.beginPts=Z,Ne.endPts=S,Ne.originalBeginDts=Ce[0].originalDts,Ne.originalEndDts=ut.originalDts+ut.duration,Ne.firstSample=new bi.d(Ce[0].dts,Ce[0].pts,Ce[0].duration,Ce[0].originalDts,Ce[0].isKeyframe),Ne.lastSample=new bi.d(ut.dts,ut.pts,ut.duration,ut.originalDts,ut.isKeyframe),this._isLive||this._videoSegmentInfoList.append(Ne),O.samples=Ce,O.sequenceNumber++,this._forceFirstIDR){var kt=Ce[0].flags;kt.dependsOn=2,kt.isNonSync=0}var Ut=Ni.moof(O,X);O.samples=[],O.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Ut,ce).buffer,sampleCount:Ce.length,info:Ne})}}},v.prototype._mergeBoxes=function(f,c){var d=new Uint8Array(f.byteLength+c.byteLength);return d.set(f,0),d.set(c,f.byteLength),d},v}(),jr=w(14),Gt=w(1),Vr=(w(2),function(){function v(f,c){this.TAG="TransmuxingController",this._emitter=new g.a,this._config=c,f.segments||(f.segments=[{duration:f.duration,filesize:f.filesize,url:f.url}]),typeof f.cors!="boolean"&&(f.cors=!0),typeof f.withCredentials!="boolean"&&(f.withCredentials=!1),this._mediaDataSource=f,this._currentSegmentIndex=0;var d=0;this._mediaDataSource.segments.forEach(function(S){S.timestampBase=d,d+=S.duration,S.cors=f.cors,S.withCredentials=f.withCredentials,c.referrerPolicy&&(S.referrerPolicy=c.referrerPolicy)}),isNaN(d)||this._mediaDataSource.duration===d||(this._mediaDataSource.duration=d),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return v.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},v.prototype.on=function(f,c){this._emitter.addListener(f,c)},v.prototype.off=function(f,c){this._emitter.removeListener(f,c)},v.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},v.prototype._loadSegment=function(f,c){this._currentSegmentIndex=f;var d=this._mediaDataSource.segments[f],S=this._ioctl=new jr.a(d,this._config,f);S.onError=this._onIOException.bind(this),S.onSeeked=this._onIOSeeked.bind(this),S.onComplete=this._onIOComplete.bind(this),S.onRedirect=this._onIORedirect.bind(this),S.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),c?this._demuxer.bindDataSource(this._ioctl):S.onDataArrival=this._onInitChunkArrival.bind(this),S.open(c)},v.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},v.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},v.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},v.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},v.prototype.seek=function(f){if(this._mediaInfo!=null&&this._mediaInfo.isSeekable()){var c=this._searchSegmentIndexContains(f);if(c===this._currentSegmentIndex){var d=this._mediaInfo.segments[c];if(d==null)this._pendingSeekTime=f;else{var S=d.getNearestKeyframe(f);this._remuxer.seek(S.milliseconds),this._ioctl.seek(S.fileposition),this._pendingResolveSeekPoint=S.milliseconds}}else{var O=this._mediaInfo.segments[c];O==null?(this._pendingSeekTime=f,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(c)):(S=O.getNearestKeyframe(f),this._internalAbort(),this._remuxer.seek(f),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[c].timestampBase,this._loadSegment(c,S.fileposition),this._pendingResolveSeekPoint=S.milliseconds,this._reportSegmentMediaInfo(c))}this._enableStatisticsReporter()}},v.prototype._searchSegmentIndexContains=function(f){for(var c=this._mediaDataSource.segments,d=c.length-1,S=0;S<c.length;S++)if(f<c[S].timestampBase){d=S-1;break}return d},v.prototype._onInitChunkArrival=function(f,c){var d=this,S=0;if(c>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,S=this._demuxer.parseChunks(f,c);else{var O=null;(O=Y.probe(f)).match&&(this._setupFLVDemuxerRemuxer(O),S=this._demuxer.parseChunks(f,c)),O.match||O.needMoreData||(O=cr.probe(f)).match&&(this._setupTSDemuxerRemuxer(O),S=this._demuxer.parseChunks(f,c)),O.match||O.needMoreData||(O=null,p.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then(function(){d._internalAbort()}),this._emitter.emit(Gt.a.DEMUX_ERROR,W.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return S},v.prototype._setupFLVDemuxerRemuxer=function(f){this._demuxer=new Y(f,this._config),this._remuxer||(this._remuxer=new Fi(this._config));var c=this._mediaDataSource;c.duration==null||isNaN(c.duration)||(this._demuxer.overridedDuration=c.duration),typeof c.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=c.hasAudio),typeof c.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=c.hasVideo),this._demuxer.timestampBase=c.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},v.prototype._setupTSDemuxerRemuxer=function(f){var c=this._demuxer=new cr(f,this._config);this._remuxer||(this._remuxer=new Fi(this._config)),c.onError=this._onDemuxException.bind(this),c.onMediaInfo=this._onMediaInfo.bind(this),c.onMetaDataArrived=this._onMetaDataArrived.bind(this),c.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),c.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),c.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),c.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),c.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),c.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),c.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},v.prototype._onMediaInfo=function(f){var c=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},f),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,m.a.prototype));var d=Object.assign({},f);Object.setPrototypeOf(d,m.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=d,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var S=c._pendingSeekTime;c._pendingSeekTime=null,c.seek(S)})},v.prototype._onMetaDataArrived=function(f){this._emitter.emit(Gt.a.METADATA_ARRIVED,f)},v.prototype._onScriptDataArrived=function(f){this._emitter.emit(Gt.a.SCRIPTDATA_ARRIVED,f)},v.prototype._onTimedID3Metadata=function(f){var c=this._remuxer.getTimestampBase();c!=null&&(f.pts!=null&&(f.pts-=c),f.dts!=null&&(f.dts-=c),this._emitter.emit(Gt.a.TIMED_ID3_METADATA_ARRIVED,f))},v.prototype._onSynchronousKLVMetadata=function(f){var c=this._remuxer.getTimestampBase();c!=null&&(f.pts!=null&&(f.pts-=c),f.dts!=null&&(f.dts-=c),this._emitter.emit(Gt.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,f))},v.prototype._onAsynchronousKLVMetadata=function(f){this._emitter.emit(Gt.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,f)},v.prototype._onSMPTE2038Metadata=function(f){var c=this._remuxer.getTimestampBase();c!=null&&(f.pts!=null&&(f.pts-=c),f.dts!=null&&(f.dts-=c),f.nearest_pts!=null&&(f.nearest_pts-=c),this._emitter.emit(Gt.a.SMPTE2038_METADATA_ARRIVED,f))},v.prototype._onSCTE35Metadata=function(f){var c=this._remuxer.getTimestampBase();c!=null&&(f.pts!=null&&(f.pts-=c),f.nearest_pts!=null&&(f.nearest_pts-=c),this._emitter.emit(Gt.a.SCTE35_METADATA_ARRIVED,f))},v.prototype._onPESPrivateDataDescriptor=function(f){this._emitter.emit(Gt.a.PES_PRIVATE_DATA_DESCRIPTOR,f)},v.prototype._onPESPrivateData=function(f){var c=this._remuxer.getTimestampBase();c!=null&&(f.pts!=null&&(f.pts-=c),f.nearest_pts!=null&&(f.nearest_pts-=c),f.dts!=null&&(f.dts-=c),this._emitter.emit(Gt.a.PES_PRIVATE_DATA_ARRIVED,f))},v.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},v.prototype._onIOComplete=function(f){var c=f+1;c<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(c)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(Gt.a.LOADING_COMPLETE),this._disableStatisticsReporter())},v.prototype._onIORedirect=function(f){var c=this._ioctl.extraData;this._mediaDataSource.segments[c].redirectedURL=f},v.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(Gt.a.RECOVERED_EARLY_EOF)},v.prototype._onIOException=function(f,c){p.a.e(this.TAG,"IOException: type = ".concat(f,", code = ").concat(c.code,", msg = ").concat(c.msg)),this._emitter.emit(Gt.a.IO_ERROR,f,c),this._disableStatisticsReporter()},v.prototype._onDemuxException=function(f,c){p.a.e(this.TAG,"DemuxException: type = ".concat(f,", info = ").concat(c)),this._emitter.emit(Gt.a.DEMUX_ERROR,f,c)},v.prototype._onRemuxerInitSegmentArrival=function(f,c){this._emitter.emit(Gt.a.INIT_SEGMENT,f,c)},v.prototype._onRemuxerMediaSegmentArrival=function(f,c){if(this._pendingSeekTime==null&&(this._emitter.emit(Gt.a.MEDIA_SEGMENT,f,c),this._pendingResolveSeekPoint!=null&&f==="video")){var d=c.info.syncPoints,S=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,D.a.safari&&d.length>0&&d[0].originalDts===S&&(S=d[0].pts),this._emitter.emit(Gt.a.RECOMMEND_SEEKPOINT,S)}},v.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},v.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},v.prototype._reportSegmentMediaInfo=function(f){var c=this._mediaInfo.segments[f],d=Object.assign({},c);d.duration=this._mediaInfo.duration,d.segmentCount=this._mediaInfo.segmentCount,delete d.segments,delete d.keyframesIndex,this._emitter.emit(Gt.a.MEDIA_INFO,d)},v.prototype._reportStatisticsInfo=function(){var f={};f.url=this._ioctl.currentURL,f.hasRedirect=this._ioctl.hasRedirect,f.hasRedirect&&(f.redirectedURL=this._ioctl.currentRedirectedURL),f.speed=this._ioctl.currentSpeed,f.loaderType=this._ioctl.loaderType,f.currentSegmentIndex=this._currentSegmentIndex,f.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(Gt.a.STATISTICS_INFO,f)},v}());J.a=Vr},function(R,J,w){var Q,g=w(0),p=function(){function ae(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return ae.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},ae.prototype.addBytes=function(B){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=B,this._totalBytes+=B):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=B,this._totalBytes+=B):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=B,this._totalBytes+=B,this._lastCheckpoint=this._now())},Object.defineProperty(ae.prototype,"currentKBps",{get:function(){this.addBytes(0);var B=(this._now()-this._lastCheckpoint)/1e3;return B==0&&(B=1),this._intervalBytes/B/1024},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"averageKBps",{get:function(){var B=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/B/1024},enumerable:!1,configurable:!0}),ae}(),D=w(2),m=w(5),y=w(3),_=(Q=function(ae,B){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,N){x.__proto__=N}||function(x,N){for(var Y in N)Object.prototype.hasOwnProperty.call(N,Y)&&(x[Y]=N[Y])})(ae,B)},function(ae,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function x(){this.constructor=ae}Q(ae,B),ae.prototype=B===null?Object.create(B):(x.prototype=B.prototype,new x)}),b=function(ae){function B(x,N){var Y=ae.call(this,"fetch-stream-loader")||this;return Y.TAG="FetchStreamLoader",Y._seekHandler=x,Y._config=N,Y._needStash=!0,Y._requestAbort=!1,Y._abortController=null,Y._contentLength=null,Y._receivedLength=0,Y}return _(B,ae),B.isSupported=function(){try{var x=m.a.msedge&&m.a.version.minor>=15048,N=!m.a.msedge||x;return self.fetch&&self.ReadableStream&&N}catch(Y){return!1}},B.prototype.destroy=function(){this.isWorking()&&this.abort(),ae.prototype.destroy.call(this)},B.prototype.open=function(x,N){var Y=this;this._dataSource=x,this._range=N;var re=x.url;this._config.reuseRedirectedURL&&x.redirectedURL!=null&&(re=x.redirectedURL);var K=this._seekHandler.getConfig(re,N),k=new self.Headers;if(typeof K.headers=="object"){var de=K.headers;for(var ie in de)de.hasOwnProperty(ie)&&k.append(ie,de[ie])}var ve={method:"GET",headers:k,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var ie in this._config.headers)k.append(ie,this._config.headers[ie]);x.cors===!1&&(ve.mode="same-origin"),x.withCredentials&&(ve.credentials="include"),x.referrerPolicy&&(ve.referrerPolicy=x.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,ve.signal=this._abortController.signal),this._status=D.c.kConnecting,self.fetch(K.url,ve).then(function(_e){if(Y._requestAbort)return Y._status=D.c.kIdle,void _e.body.cancel();if(_e.ok&&_e.status>=200&&_e.status<=299){if(_e.url!==K.url&&Y._onURLRedirect){var q=Y._seekHandler.removeURLParameters(_e.url);Y._onURLRedirect(q)}var H=_e.headers.get("Content-Length");return H!=null&&(Y._contentLength=parseInt(H),Y._contentLength!==0&&Y._onContentLengthKnown&&Y._onContentLengthKnown(Y._contentLength)),Y._pump.call(Y,_e.body.getReader())}if(Y._status=D.c.kError,!Y._onError)throw new y.d("FetchStreamLoader: Http code invalid, "+_e.status+" "+_e.statusText);Y._onError(D.b.HTTP_STATUS_CODE_INVALID,{code:_e.status,msg:_e.statusText})}).catch(function(_e){if(!Y._abortController||!Y._abortController.signal.aborted){if(Y._status=D.c.kError,!Y._onError)throw _e;Y._onError(D.b.EXCEPTION,{code:-1,msg:_e.message})}})},B.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==D.c.kBuffering||!m.a.chrome)&&this._abortController)try{this._abortController.abort()}catch(x){}},B.prototype._pump=function(x){var N=this;return x.read().then(function(Y){if(Y.done)if(N._contentLength!==null&&N._receivedLength<N._contentLength){N._status=D.c.kError;var re=D.b.EARLY_EOF,K={code:-1,msg:"Fetch stream meet Early-EOF"};if(!N._onError)throw new y.d(K.msg);N._onError(re,K)}else N._status=D.c.kComplete,N._onComplete&&N._onComplete(N._range.from,N._range.from+N._receivedLength-1);else{if(N._abortController&&N._abortController.signal.aborted)return void(N._status=D.c.kComplete);if(N._requestAbort===!0)return N._status=D.c.kComplete,x.cancel();N._status=D.c.kBuffering;var k=Y.value.buffer,de=N._range.from+N._receivedLength;N._receivedLength+=k.byteLength,N._onDataArrival&&N._onDataArrival(k,de,N._receivedLength),N._pump(x)}}).catch(function(Y){if(N._abortController&&N._abortController.signal.aborted)N._status=D.c.kComplete;else if(Y.code!==11||!m.a.msedge){N._status=D.c.kError;var re=0,K=null;if(Y.code!==19&&Y.message!=="network error"||!(N._contentLength===null||N._contentLength!==null&&N._receivedLength<N._contentLength)?(re=D.b.EXCEPTION,K={code:Y.code,msg:Y.message}):(re=D.b.EARLY_EOF,K={code:Y.code,msg:"Fetch stream meet Early-EOF"}),!N._onError)throw new y.d(K.msg);N._onError(re,K)}})},B}(D.a),E=function(){var ae=function(B,x){return(ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,Y){N.__proto__=Y}||function(N,Y){for(var re in Y)Object.prototype.hasOwnProperty.call(Y,re)&&(N[re]=Y[re])})(B,x)};return function(B,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function N(){this.constructor=B}ae(B,x),B.prototype=x===null?Object.create(x):(N.prototype=x.prototype,new N)}}(),L=function(ae){function B(x,N){var Y=ae.call(this,"xhr-moz-chunked-loader")||this;return Y.TAG="MozChunkedLoader",Y._seekHandler=x,Y._config=N,Y._needStash=!0,Y._xhr=null,Y._requestAbort=!1,Y._contentLength=null,Y._receivedLength=0,Y}return E(B,ae),B.isSupported=function(){try{var x=new XMLHttpRequest;return x.open("GET","https://example.com",!0),x.responseType="moz-chunked-arraybuffer",x.responseType==="moz-chunked-arraybuffer"}catch(N){return g.a.w("MozChunkedLoader",N.message),!1}},B.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),ae.prototype.destroy.call(this)},B.prototype.open=function(x,N){this._dataSource=x,this._range=N;var Y=x.url;this._config.reuseRedirectedURL&&x.redirectedURL!=null&&(Y=x.redirectedURL);var re=this._seekHandler.getConfig(Y,N);this._requestURL=re.url;var K=this._xhr=new XMLHttpRequest;if(K.open("GET",re.url,!0),K.responseType="moz-chunked-arraybuffer",K.onreadystatechange=this._onReadyStateChange.bind(this),K.onprogress=this._onProgress.bind(this),K.onloadend=this._onLoadEnd.bind(this),K.onerror=this._onXhrError.bind(this),x.withCredentials&&(K.withCredentials=!0),typeof re.headers=="object"){var k=re.headers;for(var de in k)k.hasOwnProperty(de)&&K.setRequestHeader(de,k[de])}if(typeof this._config.headers=="object"){k=this._config.headers;for(var de in k)k.hasOwnProperty(de)&&K.setRequestHeader(de,k[de])}this._status=D.c.kConnecting,K.send()},B.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=D.c.kComplete},B.prototype._onReadyStateChange=function(x){var N=x.target;if(N.readyState===2){if(N.responseURL!=null&&N.responseURL!==this._requestURL&&this._onURLRedirect){var Y=this._seekHandler.removeURLParameters(N.responseURL);this._onURLRedirect(Y)}if(N.status!==0&&(N.status<200||N.status>299)){if(this._status=D.c.kError,!this._onError)throw new y.d("MozChunkedLoader: Http code invalid, "+N.status+" "+N.statusText);this._onError(D.b.HTTP_STATUS_CODE_INVALID,{code:N.status,msg:N.statusText})}else this._status=D.c.kBuffering}},B.prototype._onProgress=function(x){if(this._status!==D.c.kError){this._contentLength===null&&x.total!==null&&x.total!==0&&(this._contentLength=x.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var N=x.target.response,Y=this._range.from+this._receivedLength;this._receivedLength+=N.byteLength,this._onDataArrival&&this._onDataArrival(N,Y,this._receivedLength)}},B.prototype._onLoadEnd=function(x){this._requestAbort!==!0?this._status!==D.c.kError&&(this._status=D.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},B.prototype._onXhrError=function(x){this._status=D.c.kError;var N=0,Y=null;if(this._contentLength&&x.loaded<this._contentLength?(N=D.b.EARLY_EOF,Y={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(N=D.b.EXCEPTION,Y={code:-1,msg:x.constructor.name+" "+x.type}),!this._onError)throw new y.d(Y.msg);this._onError(N,Y)},B}(D.a),I=function(){var ae=function(B,x){return(ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,Y){N.__proto__=Y}||function(N,Y){for(var re in Y)Object.prototype.hasOwnProperty.call(Y,re)&&(N[re]=Y[re])})(B,x)};return function(B,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function N(){this.constructor=B}ae(B,x),B.prototype=x===null?Object.create(x):(N.prototype=x.prototype,new N)}}(),z=(function(ae){function B(x,N){var Y=ae.call(this,"xhr-msstream-loader")||this;return Y.TAG="MSStreamLoader",Y._seekHandler=x,Y._config=N,Y._needStash=!0,Y._xhr=null,Y._reader=null,Y._totalRange=null,Y._currentRange=null,Y._currentRequestURL=null,Y._currentRedirectedURL=null,Y._contentLength=null,Y._receivedLength=0,Y._bufferLimit=16777216,Y._lastTimeBufferSize=0,Y._isReconnecting=!1,Y}I(B,ae),B.isSupported=function(){try{if(self.MSStream===void 0||self.MSStreamReader===void 0)return!1;var x=new XMLHttpRequest;return x.open("GET","https://example.com",!0),x.responseType="ms-stream",x.responseType==="ms-stream"}catch(N){return g.a.w("MSStreamLoader",N.message),!1}},B.prototype.destroy=function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),ae.prototype.destroy.call(this)},B.prototype.open=function(x,N){this._internalOpen(x,N,!1)},B.prototype._internalOpen=function(x,N,Y){this._dataSource=x,Y?this._currentRange=N:this._totalRange=N;var re=x.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?re=this._currentRedirectedURL:x.redirectedURL!=null&&(re=x.redirectedURL));var K=this._seekHandler.getConfig(re,N);this._currentRequestURL=K.url;var k=this._reader=new self.MSStreamReader;k.onprogress=this._msrOnProgress.bind(this),k.onload=this._msrOnLoad.bind(this),k.onerror=this._msrOnError.bind(this);var de=this._xhr=new XMLHttpRequest;if(de.open("GET",K.url,!0),de.responseType="ms-stream",de.onreadystatechange=this._xhrOnReadyStateChange.bind(this),de.onerror=this._xhrOnError.bind(this),x.withCredentials&&(de.withCredentials=!0),typeof K.headers=="object"){var ie=K.headers;for(var ve in ie)ie.hasOwnProperty(ve)&&de.setRequestHeader(ve,ie[ve])}if(typeof this._config.headers=="object"){ie=this._config.headers;for(var ve in ie)ie.hasOwnProperty(ve)&&de.setRequestHeader(ve,ie[ve])}this._isReconnecting?this._isReconnecting=!1:this._status=D.c.kConnecting,de.send()},B.prototype.abort=function(){this._internalAbort(),this._status=D.c.kComplete},B.prototype._internalAbort=function(){this._reader&&(this._reader.readyState===1&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)},B.prototype._xhrOnReadyStateChange=function(x){var N=x.target;if(N.readyState===2)if(N.status>=200&&N.status<=299){if(this._status=D.c.kBuffering,N.responseURL!=null){var Y=this._seekHandler.removeURLParameters(N.responseURL);N.responseURL!==this._currentRequestURL&&Y!==this._currentRedirectedURL&&(this._currentRedirectedURL=Y,this._onURLRedirect&&this._onURLRedirect(Y))}var re=N.getResponseHeader("Content-Length");if(re!=null&&this._contentLength==null){var K=parseInt(re);K>0&&(this._contentLength=K,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=D.c.kError,!this._onError)throw new y.d("MSStreamLoader: Http code invalid, "+N.status+" "+N.statusText);this._onError(D.b.HTTP_STATUS_CODE_INVALID,{code:N.status,msg:N.statusText})}else if(N.readyState===3&&N.status>=200&&N.status<=299){this._status=D.c.kBuffering;var k=N.response;this._reader.readAsArrayBuffer(k)}},B.prototype._xhrOnError=function(x){this._status=D.c.kError;var N=D.b.EXCEPTION,Y={code:-1,msg:x.constructor.name+" "+x.type};if(!this._onError)throw new y.d(Y.msg);this._onError(N,Y)},B.prototype._msrOnProgress=function(x){var N=x.target.result;if(N!=null){var Y=N.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=N.byteLength;var re=this._totalRange.from+this._receivedLength;this._receivedLength+=Y.byteLength,this._onDataArrival&&this._onDataArrival(Y,re,this._receivedLength),N.byteLength>=this._bufferLimit&&(g.a.v(this.TAG,"MSStream buffer exceeded max size near ".concat(re+Y.byteLength,", reconnecting...")),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()},B.prototype._doReconnectIfNeeded=function(){if(this._contentLength==null||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var x={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,x,!0)}},B.prototype._msrOnLoad=function(x){this._status=D.c.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)},B.prototype._msrOnError=function(x){this._status=D.c.kError;var N=0,Y=null;if(this._contentLength&&this._receivedLength<this._contentLength?(N=D.b.EARLY_EOF,Y={code:-1,msg:"MSStream meet Early-Eof"}):(N=D.b.EARLY_EOF,Y={code:-1,msg:x.constructor.name+" "+x.type}),!this._onError)throw new y.d(Y.msg);this._onError(N,Y)}}(D.a),function(){var ae=function(B,x){return(ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,Y){N.__proto__=Y}||function(N,Y){for(var re in Y)Object.prototype.hasOwnProperty.call(Y,re)&&(N[re]=Y[re])})(B,x)};return function(B,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function N(){this.constructor=B}ae(B,x),B.prototype=x===null?Object.create(x):(N.prototype=x.prototype,new N)}}()),j=function(ae){function B(x,N){var Y=ae.call(this,"xhr-range-loader")||this;return Y.TAG="RangeLoader",Y._seekHandler=x,Y._config=N,Y._needStash=!1,Y._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],Y._currentChunkSizeKB=384,Y._currentSpeedNormalized=0,Y._zeroSpeedChunkCount=0,Y._xhr=null,Y._speedSampler=new p,Y._requestAbort=!1,Y._waitForTotalLength=!1,Y._totalLengthReceived=!1,Y._currentRequestURL=null,Y._currentRedirectedURL=null,Y._currentRequestRange=null,Y._totalLength=null,Y._contentLength=null,Y._receivedLength=0,Y._lastTimeLoaded=0,Y}return z(B,ae),B.isSupported=function(){try{var x=new XMLHttpRequest;return x.open("GET","https://example.com",!0),x.responseType="arraybuffer",x.responseType==="arraybuffer"}catch(N){return g.a.w("RangeLoader",N.message),!1}},B.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),ae.prototype.destroy.call(this)},Object.defineProperty(B.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),B.prototype.open=function(x,N){this._dataSource=x,this._range=N,this._status=D.c.kConnecting;var Y=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(Y=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||Y?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},B.prototype._openSubRange=function(){var x=1024*this._currentChunkSizeKB,N=this._range.from+this._receivedLength,Y=N+x;this._contentLength!=null&&Y-this._range.from>=this._contentLength&&(Y=this._range.from+this._contentLength-1),this._currentRequestRange={from:N,to:Y},this._internalOpen(this._dataSource,this._currentRequestRange)},B.prototype._internalOpen=function(x,N){this._lastTimeLoaded=0;var Y=x.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?Y=this._currentRedirectedURL:x.redirectedURL!=null&&(Y=x.redirectedURL));var re=this._seekHandler.getConfig(Y,N);this._currentRequestURL=re.url;var K=this._xhr=new XMLHttpRequest;if(K.open("GET",re.url,!0),K.responseType="arraybuffer",K.onreadystatechange=this._onReadyStateChange.bind(this),K.onprogress=this._onProgress.bind(this),K.onload=this._onLoad.bind(this),K.onerror=this._onXhrError.bind(this),x.withCredentials&&(K.withCredentials=!0),typeof re.headers=="object"){var k=re.headers;for(var de in k)k.hasOwnProperty(de)&&K.setRequestHeader(de,k[de])}if(typeof this._config.headers=="object"){k=this._config.headers;for(var de in k)k.hasOwnProperty(de)&&K.setRequestHeader(de,k[de])}K.send()},B.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=D.c.kComplete},B.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},B.prototype._onReadyStateChange=function(x){var N=x.target;if(N.readyState===2){if(N.responseURL!=null){var Y=this._seekHandler.removeURLParameters(N.responseURL);N.responseURL!==this._currentRequestURL&&Y!==this._currentRedirectedURL&&(this._currentRedirectedURL=Y,this._onURLRedirect&&this._onURLRedirect(Y))}if(N.status>=200&&N.status<=299){if(this._waitForTotalLength)return;this._status=D.c.kBuffering}else{if(this._status=D.c.kError,!this._onError)throw new y.d("RangeLoader: Http code invalid, "+N.status+" "+N.statusText);this._onError(D.b.HTTP_STATUS_CODE_INVALID,{code:N.status,msg:N.statusText})}}},B.prototype._onProgress=function(x){if(this._status!==D.c.kError){if(this._contentLength===null){var N=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,N=!0;var Y=x.total;this._internalAbort(),Y!=null&Y!==0&&(this._totalLength=Y)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,N)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var re=x.loaded-this._lastTimeLoaded;this._lastTimeLoaded=x.loaded,this._speedSampler.addBytes(re)}},B.prototype._normalizeSpeed=function(x){var N=this._chunkSizeKBList,Y=N.length-1,re=0,K=0,k=Y;if(x<N[0])return N[0];for(;K<=k;){if((re=K+Math.floor((k-K)/2))===Y||x>=N[re]&&x<N[re+1])return N[re];N[re]<x?K=re+1:k=re-1}},B.prototype._onLoad=function(x){if(this._status!==D.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var N=this._speedSampler.lastSecondKBps;if(N===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(N=this._speedSampler.currentKBps)),N!==0){var Y=this._normalizeSpeed(N);this._currentSpeedNormalized!==Y&&(this._currentSpeedNormalized=Y,this._currentChunkSizeKB=Y)}var re=x.target.response,K=this._range.from+this._receivedLength;this._receivedLength+=re.byteLength;var k=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():k=!0,this._onDataArrival&&this._onDataArrival(re,K,this._receivedLength),k&&(this._status=D.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},B.prototype._onXhrError=function(x){this._status=D.c.kError;var N=0,Y=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(N=D.b.EARLY_EOF,Y={code:-1,msg:"RangeLoader meet Early-Eof"}):(N=D.b.EXCEPTION,Y={code:-1,msg:x.constructor.name+" "+x.type}),!this._onError)throw new y.d(Y.msg);this._onError(N,Y)},B}(D.a),W=function(){var ae=function(B,x){return(ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,Y){N.__proto__=Y}||function(N,Y){for(var re in Y)Object.prototype.hasOwnProperty.call(Y,re)&&(N[re]=Y[re])})(B,x)};return function(B,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function N(){this.constructor=B}ae(B,x),B.prototype=x===null?Object.create(x):(N.prototype=x.prototype,new N)}}(),oe=function(ae){function B(){var x=ae.call(this,"websocket-loader")||this;return x.TAG="WebSocketLoader",x._needStash=!0,x._ws=null,x._requestAbort=!1,x._receivedLength=0,x}return W(B,ae),B.isSupported=function(){try{return self.WebSocket!==void 0}catch(x){return!1}},B.prototype.destroy=function(){this._ws&&this.abort(),ae.prototype.destroy.call(this)},B.prototype.open=function(x){try{var N=this._ws=new self.WebSocket(x.url);N.binaryType="arraybuffer",N.onopen=this._onWebSocketOpen.bind(this),N.onclose=this._onWebSocketClose.bind(this),N.onmessage=this._onWebSocketMessage.bind(this),N.onerror=this._onWebSocketError.bind(this),this._status=D.c.kConnecting}catch(re){this._status=D.c.kError;var Y={code:re.code,msg:re.message};if(!this._onError)throw new y.d(Y.msg);this._onError(D.b.EXCEPTION,Y)}},B.prototype.abort=function(){var x=this._ws;!x||x.readyState!==0&&x.readyState!==1||(this._requestAbort=!0,x.close()),this._ws=null,this._status=D.c.kComplete},B.prototype._onWebSocketOpen=function(x){this._status=D.c.kBuffering},B.prototype._onWebSocketClose=function(x){this._requestAbort!==!0?(this._status=D.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},B.prototype._onWebSocketMessage=function(x){var N=this;if(x.data instanceof ArrayBuffer)this._dispatchArrayBuffer(x.data);else if(x.data instanceof Blob){var Y=new FileReader;Y.onload=function(){N._dispatchArrayBuffer(Y.result)},Y.readAsArrayBuffer(x.data)}else{this._status=D.c.kError;var re={code:-1,msg:"Unsupported WebSocket message type: "+x.data.constructor.name};if(!this._onError)throw new y.d(re.msg);this._onError(D.b.EXCEPTION,re)}},B.prototype._dispatchArrayBuffer=function(x){var N=x,Y=this._receivedLength;this._receivedLength+=N.byteLength,this._onDataArrival&&this._onDataArrival(N,Y,this._receivedLength)},B.prototype._onWebSocketError=function(x){this._status=D.c.kError;var N={code:x.code,msg:x.message};if(!this._onError)throw new y.d(N.msg);this._onError(D.b.EXCEPTION,N)},B}(D.a),F=function(){function ae(B){this._zeroStart=B||!1}return ae.prototype.getConfig=function(B,x){var N={};if(x.from!==0||x.to!==-1){var Y=void 0;Y=x.to!==-1?"bytes=".concat(x.from.toString(),"-").concat(x.to.toString()):"bytes=".concat(x.from.toString(),"-"),N.Range=Y}else this._zeroStart&&(N.Range="bytes=0-");return{url:B,headers:N}},ae.prototype.removeURLParameters=function(B){return B},ae}(),ee=function(){function ae(B,x){this._startName=B,this._endName=x}return ae.prototype.getConfig=function(B,x){var N=B;if(x.from!==0||x.to!==-1){var Y=!0;N.indexOf("?")===-1&&(N+="?",Y=!1),Y&&(N+="&"),N+="".concat(this._startName,"=").concat(x.from.toString()),x.to!==-1&&(N+="&".concat(this._endName,"=").concat(x.to.toString()))}return{url:N,headers:{}}},ae.prototype.removeURLParameters=function(B){var x=B.split("?")[0],N=void 0,Y=B.indexOf("?");Y!==-1&&(N=B.substring(Y+1));var re="";if(N!=null&&N.length>0)for(var K=N.split("&"),k=0;k<K.length;k++){var de=K[k].split("="),ie=k>0;de[0]!==this._startName&&de[0]!==this._endName&&(ie&&(re+="&"),re+=K[k])}return re.length===0?x:x+"?"+re},ae}(),fe=function(){function ae(B,x,N){this.TAG="IOController",this._config=x,this._extraData=N,this._stashInitialSize=65536,x.stashInitialSize!=null&&x.stashInitialSize>0&&(this._stashInitialSize=x.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=Math.max(this._stashSize,3145728),this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,x.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=B,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(B.url),this._refTotalLength=B.filesize?B.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new p,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return ae.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},ae.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},ae.prototype.isPaused=function(){return this._paused},Object.defineProperty(ae.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"extraData",{get:function(){return this._extraData},set:function(B){this._extraData=B},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(B){this._onDataArrival=B},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(B){this._onSeeked=B},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"onError",{get:function(){return this._onError},set:function(B){this._onError=B},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"onComplete",{get:function(){return this._onComplete},set:function(B){this._onComplete=B},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(B){this._onRedirect=B},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(B){this._onRecoveredEarlyEof=B},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"currentSpeed",{get:function(){return this._loaderClass===j?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(ae.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),ae.prototype._selectSeekHandler=function(){var B=this._config;if(B.seekType==="range")this._seekHandler=new F(this._config.rangeLoadZeroStart);else if(B.seekType==="param"){var x=B.seekParamStart||"bstart",N=B.seekParamEnd||"bend";this._seekHandler=new ee(x,N)}else{if(B.seekType!=="custom")throw new y.b("Invalid seekType in config: ".concat(B.seekType));if(typeof B.customSeekHandler!="function")throw new y.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new B.customSeekHandler}},ae.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=oe;else if(b.isSupported())this._loaderClass=b;else if(L.isSupported())this._loaderClass=L;else{if(!j.isSupported())throw new y.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=j}},ae.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},ae.prototype.open=function(B){this._currentRange={from:0,to:-1},B&&(this._currentRange.from=B),this._speedSampler.reset(),B||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},ae.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},ae.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},ae.prototype.resume=function(){if(this._paused){this._paused=!1;var B=this._resumeFrom;this._resumeFrom=0,this._internalSeek(B,!0)}},ae.prototype.seek=function(B){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(B,!0)},ae.prototype._internalSeek=function(B,x){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(x),this._loader.destroy(),this._loader=null;var N={from:B,to:-1};this._currentRange={from:N.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,N),this._onSeeked&&this._onSeeked()},ae.prototype.updateUrl=function(B){if(!B||typeof B!="string"||B.length===0)throw new y.b("Url must be a non-empty string!");this._dataSource.url=B},ae.prototype._expandBuffer=function(B){for(var x=this._stashSize;x+1048576<B;)x*=2;if((x+=1048576)!==this._bufferSize){var N=new ArrayBuffer(x);if(this._stashUsed>0){var Y=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(N,0,x).set(Y,0)}this._stashBuffer=N,this._bufferSize=x}},ae.prototype._normalizeSpeed=function(B){var x=this._speedNormalizeList,N=x.length-1,Y=0,re=0,K=N;if(B<x[0])return x[0];for(;re<=K;){if((Y=re+Math.floor((K-re)/2))===N||B>=x[Y]&&B<x[Y+1])return x[Y];x[Y]<B?re=Y+1:K=Y-1}},ae.prototype._adjustStashSize=function(B){var x=0;(x=this._config.isLive?B/8:B<512?B:B>=512&&B<=1024?Math.floor(1.5*B):2*B)>8192&&(x=8192);var N=1024*x+1048576;this._bufferSize<N&&this._expandBuffer(N),this._stashSize=1024*x},ae.prototype._dispatchChunks=function(B,x){return this._currentRange.to=x+B.byteLength-1,this._onDataArrival(B,x)},ae.prototype._onURLRedirect=function(B){this._redirectedURL=B,this._onRedirect&&this._onRedirect(B)},ae.prototype._onContentLengthKnown=function(B){B&&this._fullRequestFlag&&(this._totalLength=B,this._fullRequestFlag=!1)},ae.prototype._onLoaderChunkArrival=function(B,x,N){if(!this._onDataArrival)throw new y.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(B.byteLength);var Y=this._speedSampler.lastSecondKBps;if(Y!==0){var re=this._normalizeSpeed(Y);this._speedNormalized!==re&&(this._speedNormalized=re,this._adjustStashSize(re))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=x),this._stashUsed+B.byteLength<=this._stashSize)(de=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(B),this._stashUsed),this._stashUsed+=B.byteLength;else if(de=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var K=this._stashBuffer.slice(0,this._stashUsed);(ie=this._dispatchChunks(K,this._stashByteStart))<K.byteLength?ie>0&&(ve=new Uint8Array(K,ie),de.set(ve,0),this._stashUsed=ve.byteLength,this._stashByteStart+=ie):(this._stashUsed=0,this._stashByteStart+=ie),this._stashUsed+B.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+B.byteLength),de=new Uint8Array(this._stashBuffer,0,this._bufferSize)),de.set(new Uint8Array(B),this._stashUsed),this._stashUsed+=B.byteLength}else(ie=this._dispatchChunks(B,x))<B.byteLength&&((k=B.byteLength-ie)>this._bufferSize&&(this._expandBuffer(k),de=new Uint8Array(this._stashBuffer,0,this._bufferSize)),de.set(new Uint8Array(B,ie),0),this._stashUsed+=k,this._stashByteStart=x+ie);else if(this._stashUsed===0){var k;(ie=this._dispatchChunks(B,x))<B.byteLength&&((k=B.byteLength-ie)>this._bufferSize&&this._expandBuffer(k),(de=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(B,ie),0),this._stashUsed+=k,this._stashByteStart=x+ie)}else{var de,ie;if(this._stashUsed+B.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+B.byteLength),(de=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(B),this._stashUsed),this._stashUsed+=B.byteLength,(ie=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&ie>0){var ve=new Uint8Array(this._stashBuffer,ie);de.set(ve,0)}this._stashUsed-=ie,this._stashByteStart+=ie}}},ae.prototype._flushStashBuffer=function(B){if(this._stashUsed>0){var x=this._stashBuffer.slice(0,this._stashUsed),N=this._dispatchChunks(x,this._stashByteStart),Y=x.byteLength-N;if(N<x.byteLength){if(!B){if(N>0){var re=new Uint8Array(this._stashBuffer,0,this._bufferSize),K=new Uint8Array(x,N);re.set(K,0),this._stashUsed=K.byteLength,this._stashByteStart+=N}return 0}g.a.w(this.TAG,"".concat(Y," bytes unconsumed data remain when flush buffer, dropped"))}return this._stashUsed=0,this._stashByteStart=0,Y}return 0},ae.prototype._onLoaderComplete=function(B,x){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},ae.prototype._onLoaderError=function(B,x){switch(g.a.e(this.TAG,"Loader error, code = ".concat(x.code,", msg = ").concat(x.msg)),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,B=D.b.UNRECOVERABLE_EARLY_EOF),B){case D.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var N=this._currentRange.to+1;return void(N<this._totalLength&&(g.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(N,!1)))}B=D.b.UNRECOVERABLE_EARLY_EOF;break;case D.b.UNRECOVERABLE_EARLY_EOF:case D.b.CONNECTING_TIMEOUT:case D.b.HTTP_STATUS_CODE_INVALID:case D.b.EXCEPTION:}if(!this._onError)throw new y.d("IOException: "+x.msg);this._onError(B,x)},ae}();J.a=fe},function(R,J,w){var Q=function(){function g(){}return g.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(p,D){return p.__proto__=D,p},Object.assign=Object.assign||function(p){if(p==null)throw new TypeError("Cannot convert undefined or null to object");for(var D=Object(p),m=1;m<arguments.length;m++){var y=arguments[m];if(y!=null)for(var _ in y)y.hasOwnProperty(_)&&(D[_]=y[_])}return D},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(p,D){var m=D>0?0|D:0;return this.substring(m,m+p.length)===p}}),typeof self.Promise!="function"&&w(21).polyfill()},g}();Q.install(),J.a=Q},function(R,J,w){var Q=w(9),g=w.n(Q),p=w(0),D=w(5),m=w(7),y=w(3),_=function(){function b(E){this.TAG="MSEController",this._config=E,this._emitter=new g.a,this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onStartStreaming:this._onStartStreaming.bind(this),onEndStreaming:this._onEndStreaming.bind(this),onQualityChange:this._onQualityChange.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._useManagedMediaSource="ManagedMediaSource"in self&&!("MediaSource"in self),this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElementProxy=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]}}return b.prototype.destroy=function(){this._mediaSource&&this.shutdown(),this._mediaSourceObjectURL&&this.revokeObjectURL(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},b.prototype.on=function(E,L){this._emitter.addListener(E,L)},b.prototype.off=function(E,L){this._emitter.removeListener(E,L)},b.prototype.initialize=function(E){if(this._mediaSource)throw new y.a("MediaSource has been attached to an HTMLMediaElement!");this._useManagedMediaSource&&p.a.v(this.TAG,"Using ManagedMediaSource");var L=this._mediaSource=this._useManagedMediaSource?new self.ManagedMediaSource:new self.MediaSource;L.addEventListener("sourceopen",this.e.onSourceOpen),L.addEventListener("sourceended",this.e.onSourceEnded),L.addEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(L.addEventListener("startstreaming",this.e.onStartStreaming),L.addEventListener("endstreaming",this.e.onEndStreaming),L.addEventListener("qualitychange",this.e.onQualityChange)),this._mediaElementProxy=E},b.prototype.shutdown=function(){if(this._mediaSource){var E=this._mediaSource;for(var L in this._sourceBuffers){var I=this._pendingSegments[L];I.splice(0,I.length),this._pendingSegments[L]=null,this._pendingRemoveRanges[L]=null,this._lastInitSegments[L]=null;var z=this._sourceBuffers[L];if(z){if(E.readyState!=="closed"){try{E.removeSourceBuffer(z)}catch(j){p.a.e(this.TAG,j.message)}z.removeEventListener("error",this.e.onSourceBufferError),z.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[L]=null,this._sourceBuffers[L]=null}}if(E.readyState==="open")try{E.endOfStream()}catch(j){p.a.e(this.TAG,j.message)}this._mediaElementProxy=null,E.removeEventListener("sourceopen",this.e.onSourceOpen),E.removeEventListener("sourceended",this.e.onSourceEnded),E.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(E.removeEventListener("startstreaming",this.e.onStartStreaming),E.removeEventListener("endstreaming",this.e.onEndStreaming),E.removeEventListener("qualitychange",this.e.onQualityChange)),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._mediaSource=null}},b.prototype.isManagedMediaSource=function(){return this._useManagedMediaSource},b.prototype.getObject=function(){if(!this._mediaSource)throw new y.a("MediaSource has not been initialized yet!");return this._mediaSource},b.prototype.getHandle=function(){if(!this._mediaSource)throw new y.a("MediaSource has not been initialized yet!");return this._mediaSource.handle},b.prototype.getObjectURL=function(){if(!this._mediaSource)throw new y.a("MediaSource has not been initialized yet!");return this._mediaSourceObjectURL==null&&(this._mediaSourceObjectURL=URL.createObjectURL(this._mediaSource)),this._mediaSourceObjectURL},b.prototype.revokeObjectURL=function(){this._mediaSourceObjectURL&&(URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},b.prototype.appendInitSegment=function(E,L){if(L===void 0&&(L=void 0),!this._mediaSource||this._mediaSource.readyState!=="open"||this._mediaSource.streaming===!1)return this._pendingSourceBufferInit.push(E),void this._pendingSegments[E.type].push(E);var I=E,z="".concat(I.container);I.codec&&I.codec.length>0&&(I.codec==="opus"&&D.a.safari&&(I.codec="Opus"),z+=";codecs=".concat(I.codec));var j=!1;if(p.a.v(this.TAG,"Received Initialization Segment, mimeType: "+z),this._lastInitSegments[I.type]=I,z!==this._mimeTypes[I.type]){if(this._mimeTypes[I.type])p.a.v(this.TAG,"Notice: ".concat(I.type," mimeType changed, origin: ").concat(this._mimeTypes[I.type],", target: ").concat(z));else{j=!0;try{var W=this._sourceBuffers[I.type]=this._mediaSource.addSourceBuffer(z);W.addEventListener("error",this.e.onSourceBufferError),W.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(oe){return p.a.e(this.TAG,oe.message),void this._emitter.emit(m.a.ERROR,{code:oe.code,msg:oe.message})}}this._mimeTypes[I.type]=z}L||this._pendingSegments[I.type].push(I),j||this._sourceBuffers[I.type]&&!this._sourceBuffers[I.type].updating&&this._doAppendSegments(),D.a.safari&&I.container==="audio/mpeg"&&I.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=I.mediaDuration/1e3,this._updateMediaSourceDuration())},b.prototype.appendMediaSegment=function(E){var L=E;this._pendingSegments[L.type].push(L),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var I=this._sourceBuffers[L.type];!I||I.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},b.prototype.flush=function(){for(var E in this._sourceBuffers)if(this._sourceBuffers[E]){var L=this._sourceBuffers[E];if(this._mediaSource.readyState==="open")try{L.abort()}catch(F){p.a.e(this.TAG,F.message)}var I=this._pendingSegments[E];if(I.splice(0,I.length),this._mediaSource.readyState!=="closed"){for(var z=0;z<L.buffered.length;z++){var j=L.buffered.start(z),W=L.buffered.end(z);this._pendingRemoveRanges[E].push({start:j,end:W})}if(L.updating||this._doRemoveRanges(),D.a.safari){var oe=this._lastInitSegments[E];oe&&(this._pendingSegments[E].push(oe),L.updating||this._doAppendSegments())}}}},b.prototype.endOfStream=function(){var E=this._mediaSource,L=this._sourceBuffers;E&&E.readyState==="open"?L.video&&L.video.updating||L.audio&&L.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,E.endOfStream()):E&&E.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},b.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var E=this._mediaElementProxy.getCurrentTime();for(var L in this._sourceBuffers){var I=this._sourceBuffers[L];if(I){var z=I.buffered;if(z.length>=1&&E-z.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},b.prototype._doCleanupSourceBuffer=function(){var E=this._mediaElementProxy.getCurrentTime();for(var L in this._sourceBuffers){var I=this._sourceBuffers[L];if(I){for(var z=I.buffered,j=!1,W=0;W<z.length;W++){var oe=z.start(W),F=z.end(W);if(oe<=E&&E<F+3){if(E-oe>=this._config.autoCleanupMaxBackwardDuration){j=!0;var ee=E-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[L].push({start:oe,end:ee})}}else F<E&&(j=!0,this._pendingRemoveRanges[L].push({start:oe,end:F}))}j&&!I.updating&&this._doRemoveRanges()}}},b.prototype._updateMediaSourceDuration=function(){var E=this._sourceBuffers;if(this._mediaElementProxy.getReadyState()!==0&&this._mediaSource.readyState==="open"&&!(E.video&&E.video.updating||E.audio&&E.audio.updating)){var L=this._mediaSource.duration,I=this._pendingMediaDuration;I>0&&(isNaN(L)||I>L)&&(p.a.v(this.TAG,"Update MediaSource duration from ".concat(L," to ").concat(I)),this._mediaSource.duration=I),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},b.prototype._doRemoveRanges=function(){for(var E in this._pendingRemoveRanges)if(this._sourceBuffers[E]&&!this._sourceBuffers[E].updating)for(var L=this._sourceBuffers[E],I=this._pendingRemoveRanges[E];I.length&&!L.updating;){var z=I.shift();L.remove(z.start,z.end)}},b.prototype._doAppendSegments=function(){var E=this._pendingSegments;for(var L in E)if(this._sourceBuffers[L]&&!this._sourceBuffers[L].updating&&this._mediaSource.streaming!==!1&&E[L].length>0){var I=E[L].shift();if(typeof I.timestampOffset=="number"&&isFinite(I.timestampOffset)){var z=this._sourceBuffers[L].timestampOffset,j=I.timestampOffset/1e3;Math.abs(z-j)>.1&&(p.a.v(this.TAG,"Update MPEG audio timestampOffset from ".concat(z," to ").concat(j)),this._sourceBuffers[L].timestampOffset=j),delete I.timestampOffset}if(!I.data||I.data.byteLength===0)continue;try{this._sourceBuffers[L].appendBuffer(I.data),this._isBufferFull=!1}catch(W){this._pendingSegments[L].unshift(I),W.code===22?(this._isBufferFull||this._emitter.emit(m.a.BUFFER_FULL),this._isBufferFull=!0):(p.a.e(this.TAG,W.message),this._emitter.emit(m.a.ERROR,{code:W.code,msg:W.message}))}}},b.prototype._onSourceOpen=function(){if(p.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var E=this._pendingSourceBufferInit;E.length;){var L=E.shift();this.appendInitSegment(L,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(m.a.SOURCE_OPEN)},b.prototype._onStartStreaming=function(){p.a.v(this.TAG,"ManagedMediaSource onStartStreaming"),this._emitter.emit(m.a.START_STREAMING)},b.prototype._onEndStreaming=function(){p.a.v(this.TAG,"ManagedMediaSource onEndStreaming"),this._emitter.emit(m.a.END_STREAMING)},b.prototype._onQualityChange=function(){p.a.v(this.TAG,"ManagedMediaSource onQualityChange")},b.prototype._onSourceEnded=function(){p.a.v(this.TAG,"MediaSource onSourceEnded")},b.prototype._onSourceClose=function(){p.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(this._mediaSource.removeEventListener("startstreaming",this.e.onStartStreaming),this._mediaSource.removeEventListener("endstreaming",this.e.onEndStreaming),this._mediaSource.removeEventListener("qualitychange",this.e.onQualityChange)))},b.prototype._hasPendingSegments=function(){var E=this._pendingSegments;return E.video.length>0||E.audio.length>0},b.prototype._hasPendingRemoveRanges=function(){var E=this._pendingRemoveRanges;return E.video.length>0||E.audio.length>0},b.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(m.a.UPDATE_END)},b.prototype._onSourceBufferError=function(E){p.a.e(this.TAG,"SourceBuffer Error: ".concat(E))},b}();J.a=_},function(R,J,w){var Q=w(9),g=w.n(Q),p=w(18),D=w.n(p),m=w(0),y=w(8),_=w(13),b=w(1),E=(w(19),w(12)),L=function(){function I(z,j){if(this.TAG="Transmuxer",this._emitter=new g.a,j.enableWorker&&typeof Worker<"u")try{this._worker=D()(19),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[z,j]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},y.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:y.a.getConfig()})}catch(oe){m.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new _.a(z,j)}else this._controller=new _.a(z,j);if(this._controller){var W=this._controller;W.on(b.a.IO_ERROR,this._onIOError.bind(this)),W.on(b.a.DEMUX_ERROR,this._onDemuxError.bind(this)),W.on(b.a.INIT_SEGMENT,this._onInitSegment.bind(this)),W.on(b.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),W.on(b.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),W.on(b.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),W.on(b.a.MEDIA_INFO,this._onMediaInfo.bind(this)),W.on(b.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),W.on(b.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),W.on(b.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),W.on(b.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),W.on(b.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),W.on(b.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),W.on(b.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),W.on(b.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),W.on(b.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),W.on(b.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),W.on(b.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return I.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),y.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},I.prototype.on=function(z,j){this._emitter.addListener(z,j)},I.prototype.off=function(z,j){this._emitter.removeListener(z,j)},I.prototype.hasWorker=function(){return this._worker!=null},I.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},I.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},I.prototype.seek=function(z){this._worker?this._worker.postMessage({cmd:"seek",param:z}):this._controller.seek(z)},I.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},I.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},I.prototype._onInitSegment=function(z,j){var W=this;Promise.resolve().then(function(){W._emitter.emit(b.a.INIT_SEGMENT,z,j)})},I.prototype._onMediaSegment=function(z,j){var W=this;Promise.resolve().then(function(){W._emitter.emit(b.a.MEDIA_SEGMENT,z,j)})},I.prototype._onLoadingComplete=function(){var z=this;Promise.resolve().then(function(){z._emitter.emit(b.a.LOADING_COMPLETE)})},I.prototype._onRecoveredEarlyEof=function(){var z=this;Promise.resolve().then(function(){z._emitter.emit(b.a.RECOVERED_EARLY_EOF)})},I.prototype._onMediaInfo=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.MEDIA_INFO,z)})},I.prototype._onMetaDataArrived=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.METADATA_ARRIVED,z)})},I.prototype._onScriptDataArrived=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.SCRIPTDATA_ARRIVED,z)})},I.prototype._onTimedID3MetadataArrived=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.TIMED_ID3_METADATA_ARRIVED,z)})},I.prototype._onSynchronousKLVMetadataArrived=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,z)})},I.prototype._onAsynchronousKLVMetadataArrived=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,z)})},I.prototype._onSMPTE2038MetadataArrived=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.SMPTE2038_METADATA_ARRIVED,z)})},I.prototype._onSCTE35MetadataArrived=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.SCTE35_METADATA_ARRIVED,z)})},I.prototype._onPESPrivateDataDescriptor=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.PES_PRIVATE_DATA_DESCRIPTOR,z)})},I.prototype._onPESPrivateDataArrived=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.PES_PRIVATE_DATA_ARRIVED,z)})},I.prototype._onStatisticsInfo=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.STATISTICS_INFO,z)})},I.prototype._onIOError=function(z,j){var W=this;Promise.resolve().then(function(){W._emitter.emit(b.a.IO_ERROR,z,j)})},I.prototype._onDemuxError=function(z,j){var W=this;Promise.resolve().then(function(){W._emitter.emit(b.a.DEMUX_ERROR,z,j)})},I.prototype._onRecommendSeekpoint=function(z){var j=this;Promise.resolve().then(function(){j._emitter.emit(b.a.RECOMMEND_SEEKPOINT,z)})},I.prototype._onLoggingConfigChanged=function(z){this._worker&&this._worker.postMessage({cmd:"logging_config",param:z})},I.prototype._onWorkerMessage=function(z){var j=z.data,W=j.data;if(j.msg==="destroyed"||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(j.msg){case b.a.INIT_SEGMENT:case b.a.MEDIA_SEGMENT:this._emitter.emit(j.msg,W.type,W.data);break;case b.a.LOADING_COMPLETE:case b.a.RECOVERED_EARLY_EOF:this._emitter.emit(j.msg);break;case b.a.MEDIA_INFO:Object.setPrototypeOf(W,E.a.prototype),this._emitter.emit(j.msg,W);break;case b.a.METADATA_ARRIVED:case b.a.SCRIPTDATA_ARRIVED:case b.a.TIMED_ID3_METADATA_ARRIVED:case b.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case b.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case b.a.SMPTE2038_METADATA_ARRIVED:case b.a.SCTE35_METADATA_ARRIVED:case b.a.PES_PRIVATE_DATA_DESCRIPTOR:case b.a.PES_PRIVATE_DATA_ARRIVED:case b.a.STATISTICS_INFO:this._emitter.emit(j.msg,W);break;case b.a.IO_ERROR:case b.a.DEMUX_ERROR:this._emitter.emit(j.msg,W.type,W.info);break;case b.a.RECOMMEND_SEEKPOINT:this._emitter.emit(j.msg,W);break;case"logcat_callback":m.a.emitter.emit("log",W.type,W.logcat)}},I}();J.a=L},function(R,J,w){function Q(m){var y={};function _(E){if(y[E])return y[E].exports;var L=y[E]={i:E,l:!1,exports:{}};return m[E].call(L.exports,L,L.exports,_),L.l=!0,L.exports}_.m=m,_.c=y,_.i=function(E){return E},_.d=function(E,L,I){_.o(E,L)||Object.defineProperty(E,L,{configurable:!1,enumerable:!0,get:I})},_.r=function(E){Object.defineProperty(E,"__esModule",{value:!0})},_.n=function(E){var L=E&&E.__esModule?function(){return E.default}:function(){return E};return _.d(L,"a",L),L},_.o=function(E,L){return Object.prototype.hasOwnProperty.call(E,L)},_.p="/",_.oe=function(E){throw console.error(E),E};var b=_(_.s=ENTRY_MODULE);return b.default||b}function g(m){return(m+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function p(m,y,_){var b={};b[_]=[];var E=y.toString(),L=E.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!L)return b;for(var I,z=L[1],j=new RegExp("(\\\\n|\\W)"+g(z)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");I=j.exec(E);)I[3]!=="dll-reference"&&b[_].push(I[3]);for(j=new RegExp("\\("+g(z)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");I=j.exec(E);)m[I[2]]||(b[_].push(I[1]),m[I[2]]=w(I[1]).m),b[I[2]]=b[I[2]]||[],b[I[2]].push(I[4]);for(var W,oe=Object.keys(b),F=0;F<oe.length;F++)for(var ee=0;ee<b[oe[F]].length;ee++)W=b[oe[F]][ee],isNaN(1*W)||(b[oe[F]][ee]=1*b[oe[F]][ee]);return b}function D(m){return Object.keys(m).reduce(function(y,_){return y||m[_].length>0},!1)}R.exports=function(m,y){y=y||{};var _={main:w.m},b=y.all?{main:Object.keys(_.main)}:function(j,W){for(var oe={main:[W]},F={main:[]},ee={main:{}};D(oe);)for(var fe=Object.keys(oe),ae=0;ae<fe.length;ae++){var B=fe[ae],x=oe[B].pop();if(ee[B]=ee[B]||{},!ee[B][x]&&j[B][x]){ee[B][x]=!0,F[B]=F[B]||[],F[B].push(x);for(var N=p(j,j[B][x],B),Y=Object.keys(N),re=0;re<Y.length;re++)oe[Y[re]]=oe[Y[re]]||[],oe[Y[re]]=oe[Y[re]].concat(N[Y[re]])}}return F}(_,m),E="";Object.keys(b).filter(function(j){return j!=="main"}).forEach(function(j){for(var W=0;b[j][W];)W++;b[j].push(W),_[j][W]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",E=E+"var "+j+" = ("+Q.toString().replace("ENTRY_MODULE",JSON.stringify(W))+")({"+b[j].map(function(oe){return JSON.stringify(oe)+": "+_[j][oe].toString()}).join(",")+"});\n"}),E=E+"new (("+Q.toString().replace("ENTRY_MODULE",JSON.stringify(m))+")({"+b.main.map(function(j){return JSON.stringify(j)+": "+_.main[j].toString()}).join(",")+"}))(self);";var L=new self.Blob([E],{type:"text/javascript"});if(y.bare)return L;var I=(self.URL||self.webkitURL||self.mozURL||self.msURL).createObjectURL(L),z=new self.Worker(I);return z.objectURL=I,z}},function(R,J,w){w.r(J),w(0);var Q=w(8),g=w(15),p=w(13),D=w(1);J.default=function(m){var y=null,_=(function(k,de){m.postMessage({msg:"logcat_callback",data:{type:k,logcat:de}})}).bind(this);function b(k,de){var ie={msg:D.a.INIT_SEGMENT,data:{type:k,data:de}};m.postMessage(ie,[de.data])}function E(k,de){var ie={msg:D.a.MEDIA_SEGMENT,data:{type:k,data:de}};m.postMessage(ie,[de.data])}function L(){var k={msg:D.a.LOADING_COMPLETE};m.postMessage(k)}function I(){var k={msg:D.a.RECOVERED_EARLY_EOF};m.postMessage(k)}function z(k){var de={msg:D.a.MEDIA_INFO,data:k};m.postMessage(de)}function j(k){var de={msg:D.a.METADATA_ARRIVED,data:k};m.postMessage(de)}function W(k){var de={msg:D.a.SCRIPTDATA_ARRIVED,data:k};m.postMessage(de)}function oe(k){var de={msg:D.a.TIMED_ID3_METADATA_ARRIVED,data:k};m.postMessage(de)}function F(k){var de={msg:D.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:k};m.postMessage(de)}function ee(k){var de={msg:D.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:k};m.postMessage(de)}function fe(k){var de={msg:D.a.SMPTE2038_METADATA_ARRIVED,data:k};m.postMessage(de)}function ae(k){var de={msg:D.a.SCTE35_METADATA_ARRIVED,data:k};m.postMessage(de)}function B(k){var de={msg:D.a.PES_PRIVATE_DATA_DESCRIPTOR,data:k};m.postMessage(de)}function x(k){var de={msg:D.a.PES_PRIVATE_DATA_ARRIVED,data:k};m.postMessage(de)}function N(k){var de={msg:D.a.STATISTICS_INFO,data:k};m.postMessage(de)}function Y(k,de){m.postMessage({msg:D.a.IO_ERROR,data:{type:k,info:de}})}function re(k,de){m.postMessage({msg:D.a.DEMUX_ERROR,data:{type:k,info:de}})}function K(k){m.postMessage({msg:D.a.RECOMMEND_SEEKPOINT,data:k})}g.a.install(),m.addEventListener("message",function(k){switch(k.data.cmd){case"init":(y=new p.a(k.data.param[0],k.data.param[1])).on(D.a.IO_ERROR,Y.bind(this)),y.on(D.a.DEMUX_ERROR,re.bind(this)),y.on(D.a.INIT_SEGMENT,b.bind(this)),y.on(D.a.MEDIA_SEGMENT,E.bind(this)),y.on(D.a.LOADING_COMPLETE,L.bind(this)),y.on(D.a.RECOVERED_EARLY_EOF,I.bind(this)),y.on(D.a.MEDIA_INFO,z.bind(this)),y.on(D.a.METADATA_ARRIVED,j.bind(this)),y.on(D.a.SCRIPTDATA_ARRIVED,W.bind(this)),y.on(D.a.TIMED_ID3_METADATA_ARRIVED,oe.bind(this)),y.on(D.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,F.bind(this)),y.on(D.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,ee.bind(this)),y.on(D.a.SMPTE2038_METADATA_ARRIVED,fe.bind(this)),y.on(D.a.SCTE35_METADATA_ARRIVED,ae.bind(this)),y.on(D.a.PES_PRIVATE_DATA_DESCRIPTOR,B.bind(this)),y.on(D.a.PES_PRIVATE_DATA_ARRIVED,x.bind(this)),y.on(D.a.STATISTICS_INFO,N.bind(this)),y.on(D.a.RECOMMEND_SEEKPOINT,K.bind(this));break;case"destroy":y&&(y.destroy(),y=null),m.postMessage({msg:"destroyed"});break;case"start":y.start();break;case"stop":y.stop();break;case"seek":y.seek(k.data.param);break;case"pause":y.pause();break;case"resume":y.resume();break;case"logging_config":var de=k.data.param;Q.a.applyConfig(de),de.enableCallback===!0?Q.a.addLogListener(_):Q.a.removeLogListener(_)}})}},function(R,J,w){R.exports=w(25).default},function(R,J,w){(function(Q,g){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var p;p=function(){function D(Le){return typeof Le=="function"}var m=Array.isArray?Array.isArray:function(Le){return Object.prototype.toString.call(Le)==="[object Array]"},y=0,_=void 0,b=void 0,E=function(Le,Re){F[y]=Le,F[y+1]=Re,(y+=2)===2&&(b?b(ee):N())},L=typeof window<"u"?window:void 0,I=L||{},z=I.MutationObserver||I.WebKitMutationObserver,j=typeof self>"u"&&Q!==void 0&&{}.toString.call(Q)==="[object process]",W=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function oe(){var Le=setTimeout;return function(){return Le(ee,1)}}var F=new Array(1e3);function ee(){for(var Le=0;Le<y;Le+=2)(0,F[Le])(F[Le+1]),F[Le]=void 0,F[Le+1]=void 0;y=0}var fe,ae,B,x,N=void 0;function Y(Le,Re){var He=this,Ue=new this.constructor(k);Ue[K]===void 0&&Oe(Ue);var Ke=He._state;if(Ke){var st=arguments[Ke-1];E(function(){return be(Ke,Ue,st,He._result)})}else H(He,Ue,Le,Re);return Ue}function re(Le){if(Le&&typeof Le=="object"&&Le.constructor===this)return Le;var Re=new this(k);return ie(Re,Le),Re}j?N=function(){return Q.nextTick(ee)}:z?(ae=0,B=new z(ee),x=document.createTextNode(""),B.observe(x,{characterData:!0}),N=function(){x.data=ae=++ae%2}):W?((fe=new MessageChannel).port1.onmessage=ee,N=function(){return fe.port2.postMessage(0)}):N=L===void 0?function(){try{var Le=Function("return this")().require("vertx");return(_=Le.runOnLoop||Le.runOnContext)!==void 0?function(){_(ee)}:oe()}catch(Re){return oe()}}():oe();var K=Math.random().toString(36).substring(2);function k(){}function de(Le,Re,He){Re.constructor===Le.constructor&&He===Y&&Re.constructor.resolve===re?function(Ue,Ke){Ke._state===1?_e(Ue,Ke._result):Ke._state===2?q(Ue,Ke._result):H(Ke,void 0,function(st){return ie(Ue,st)},function(st){return q(Ue,st)})}(Le,Re):He===void 0?_e(Le,Re):D(He)?function(Ue,Ke,st){E(function(Ze){var xt=!1,Xt=function(ct,ri,Xe,Jt){try{ct.call(ri,Xe,Jt)}catch(Bt){return Bt}}(st,Ke,function(ct){xt||(xt=!0,Ke!==ct?ie(Ze,ct):_e(Ze,ct))},function(ct){xt||(xt=!0,q(Ze,ct))},Ze._label);!xt&&Xt&&(xt=!0,q(Ze,Xt))},Ue)}(Le,Re,He):_e(Le,Re)}function ie(Le,Re){if(Le===Re)q(Le,new TypeError("You cannot resolve a promise with itself"));else if(Ke=typeof(Ue=Re),Ue===null||Ke!=="object"&&Ke!=="function")_e(Le,Re);else{var He=void 0;try{He=Re.then}catch(st){return void q(Le,st)}de(Le,Re,He)}var Ue,Ke}function ve(Le){Le._onerror&&Le._onerror(Le._result),le(Le)}function _e(Le,Re){Le._state===void 0&&(Le._result=Re,Le._state=1,Le._subscribers.length!==0&&E(le,Le))}function q(Le,Re){Le._state===void 0&&(Le._state=2,Le._result=Re,E(ve,Le))}function H(Le,Re,He,Ue){var Ke=Le._subscribers,st=Ke.length;Le._onerror=null,Ke[st]=Re,Ke[st+1]=He,Ke[st+2]=Ue,st===0&&Le._state&&E(le,Le)}function le(Le){var Re=Le._subscribers,He=Le._state;if(Re.length!==0){for(var Ue=void 0,Ke=void 0,st=Le._result,Ze=0;Ze<Re.length;Ze+=3)Ue=Re[Ze],Ke=Re[Ze+He],Ue?be(He,Ue,Ke,st):Ke(st);Le._subscribers.length=0}}function be(Le,Re,He,Ue){var Ke=D(He),st=void 0,Ze=void 0,xt=!0;if(Ke){try{st=He(Ue)}catch(Xt){xt=!1,Ze=Xt}if(Re===st)return void q(Re,new TypeError("A promises callback cannot return that same promise."))}else st=Ue;Re._state!==void 0||(Ke&&xt?ie(Re,st):xt===!1?q(Re,Ze):Le===1?_e(Re,st):Le===2&&q(Re,st))}var Ie=0;function Oe(Le){Le[K]=Ie++,Le._state=void 0,Le._result=void 0,Le._subscribers=[]}var We=function(){function Le(Re,He){this._instanceConstructor=Re,this.promise=new Re(k),this.promise[K]||Oe(this.promise),m(He)?(this.length=He.length,this._remaining=He.length,this._result=new Array(this.length),this.length===0?_e(this.promise,this._result):(this.length=this.length||0,this._enumerate(He),this._remaining===0&&_e(this.promise,this._result))):q(this.promise,new Error("Array Methods must be provided an Array"))}return Le.prototype._enumerate=function(Re){for(var He=0;this._state===void 0&&He<Re.length;He++)this._eachEntry(Re[He],He)},Le.prototype._eachEntry=function(Re,He){var Ue=this._instanceConstructor,Ke=Ue.resolve;if(Ke===re){var st=void 0,Ze=void 0,xt=!1;try{st=Re.then}catch(ct){xt=!0,Ze=ct}if(st===Y&&Re._state!==void 0)this._settledAt(Re._state,He,Re._result);else if(typeof st!="function")this._remaining--,this._result[He]=Re;else if(Ue===et){var Xt=new Ue(k);xt?q(Xt,Ze):de(Xt,Re,st),this._willSettleAt(Xt,He)}else this._willSettleAt(new Ue(function(ct){return ct(Re)}),He)}else this._willSettleAt(Ke(Re),He)},Le.prototype._settledAt=function(Re,He,Ue){var Ke=this.promise;Ke._state===void 0&&(this._remaining--,Re===2?q(Ke,Ue):this._result[He]=Ue),this._remaining===0&&_e(Ke,this._result)},Le.prototype._willSettleAt=function(Re,He){var Ue=this;H(Re,void 0,function(Ke){return Ue._settledAt(1,He,Ke)},function(Ke){return Ue._settledAt(2,He,Ke)})},Le}(),et=function(){function Le(Re){this[K]=Ie++,this._result=this._state=void 0,this._subscribers=[],k!==Re&&(typeof Re!="function"&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof Le?function(He,Ue){try{Ue(function(Ke){ie(He,Ke)},function(Ke){q(He,Ke)})}catch(Ke){q(He,Ke)}}(this,Re):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return Le.prototype.catch=function(Re){return this.then(null,Re)},Le.prototype.finally=function(Re){var He=this.constructor;return D(Re)?this.then(function(Ue){return He.resolve(Re()).then(function(){return Ue})},function(Ue){return He.resolve(Re()).then(function(){throw Ue})}):this.then(Re,Re)},Le}();return et.prototype.then=Y,et.all=function(Le){return new We(this,Le).promise},et.race=function(Le){var Re=this;return m(Le)?new Re(function(He,Ue){for(var Ke=Le.length,st=0;st<Ke;st++)Re.resolve(Le[st]).then(He,Ue)}):new Re(function(He,Ue){return Ue(new TypeError("You must pass an array to race."))})},et.resolve=re,et.reject=function(Le){var Re=new this(k);return q(Re,Le),Re},et._setScheduler=function(Le){b=Le},et._setAsap=function(Le){E=Le},et._asap=E,et.polyfill=function(){var Le=void 0;if(g!==void 0)Le=g;else if(typeof self<"u")Le=self;else try{Le=Function("return this")()}catch(Ue){throw new Error("polyfill failed because global object is unavailable in this environment")}var Re=Le.Promise;if(Re){var He=null;try{He=Object.prototype.toString.call(Re.resolve())}catch(Ue){}if(He==="[object Promise]"&&!Re.cast)return}Le.Promise=et},et.Promise=et,et},R.exports=p()}).call(this,w(22),w(23))},function(R,J){var w,Q,g=R.exports={};function p(){throw new Error("setTimeout has not been defined")}function D(){throw new Error("clearTimeout has not been defined")}function m(W){if(w===setTimeout)return setTimeout(W,0);if((w===p||!w)&&setTimeout)return w=setTimeout,setTimeout(W,0);try{return w(W,0)}catch(oe){try{return w.call(null,W,0)}catch(F){return w.call(this,W,0)}}}(function(){try{w=typeof setTimeout=="function"?setTimeout:p}catch(W){w=p}try{Q=typeof clearTimeout=="function"?clearTimeout:D}catch(W){Q=D}})();var y,_=[],b=!1,E=-1;function L(){b&&y&&(b=!1,y.length?_=y.concat(_):E=-1,_.length&&I())}function I(){if(!b){var W=m(L);b=!0;for(var oe=_.length;oe;){for(y=_,_=[];++E<oe;)y&&y[E].run();E=-1,oe=_.length}y=null,b=!1,function(F){if(Q===clearTimeout)return clearTimeout(F);if((Q===D||!Q)&&clearTimeout)return Q=clearTimeout,clearTimeout(F);try{Q(F)}catch(ee){try{return Q.call(null,F)}catch(fe){return Q.call(this,F)}}}(W)}}function z(W,oe){this.fun=W,this.array=oe}function j(){}g.nextTick=function(W){var oe=new Array(arguments.length-1);if(arguments.length>1)for(var F=1;F<arguments.length;F++)oe[F-1]=arguments[F];_.push(new z(W,oe)),_.length!==1||b||m(I)},z.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=j,g.addListener=j,g.once=j,g.off=j,g.removeListener=j,g.removeAllListeners=j,g.emit=j,g.prependListener=j,g.prependOnceListener=j,g.listeners=function(W){return[]},g.binding=function(W){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(W){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},function(R,J){var w;w=function(){return this}();try{w=w||new Function("return this")()}catch(Q){typeof window=="object"&&(w=window)}R.exports=w},function(R,J,w){w.r(J);var Q=w(0),g=w(8),p=w(3),D=w(7),m=w(16),y=w(17),_=w(1),b=w(4),E=w(10);J.default=function(L){var I="PlayerEngineWorker",z=(function(q,H){L.postMessage({msg:"logcat_callback",type:q,logcat:H})}).bind(void 0),j=null,W=null,oe=null,F=null,ee=!1,fe=!1,ae=0,B=0,x=!1;function N(){oe&&(oe.shutdown(),oe.destroy(),oe=null)}function Y(){if(j==null||W==null)throw new p.a("Worker not initialized");if(F)throw new p.a("Transmuxer has been initialized");fe||(!W.deferLoadAfterSourceOpen||ee?((F=new y.a(j,W)).on(_.a.INIT_SEGMENT,function(q,H){oe.appendInitSegment(H)}),F.on(_.a.MEDIA_SEGMENT,function(q,H){oe.appendMediaSegment(H),L.postMessage({msg:"buffered_position_changed",buffered_position_milliseconds:H.info.endDts})}),F.on(_.a.LOADING_COMPLETE,function(){oe.endOfStream(),L.postMessage({msg:"player_event",event:b.a.LOADING_COMPLETE})}),F.on(_.a.RECOVERED_EARLY_EOF,function(){L.postMessage({msg:"player_event",event:b.a.RECOVERED_EARLY_EOF})}),F.on(_.a.IO_ERROR,function(q,H){L.postMessage({msg:"player_event",event:b.a.ERROR,error_type:E.b.NETWORK_ERROR,error_detail:q,info:H})}),F.on(_.a.DEMUX_ERROR,function(q,H){L.postMessage({msg:"player_event",event:b.a.ERROR,error_type:E.b.MEDIA_ERROR,error_detail:q,info:H})}),F.on(_.a.MEDIA_INFO,function(q){ve(_.a.MEDIA_INFO,q)}),F.on(_.a.STATISTICS_INFO,function(q){ve(_.a.STATISTICS_INFO,q)}),F.on(_.a.RECOMMEND_SEEKPOINT,function(q){(function(H){L.postMessage({msg:"transmuxing_event",event:_.a.RECOMMEND_SEEKPOINT,milliseconds:H})})(q)}),F.on(_.a.METADATA_ARRIVED,function(q){_e(b.a.METADATA_ARRIVED,q)}),F.on(_.a.SCRIPTDATA_ARRIVED,function(q){_e(b.a.SCRIPTDATA_ARRIVED,q)}),F.on(_.a.TIMED_ID3_METADATA_ARRIVED,function(q){_e(b.a.TIMED_ID3_METADATA_ARRIVED,q)}),F.on(_.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(q){_e(b.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,q)}),F.on(_.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(q){_e(b.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,q)}),F.on(_.a.SMPTE2038_METADATA_ARRIVED,function(q){_e(b.a.SMPTE2038_METADATA_ARRIVED,q)}),F.on(_.a.SCTE35_METADATA_ARRIVED,function(q){_e(b.a.SCTE35_METADATA_ARRIVED,q)}),F.on(_.a.PES_PRIVATE_DATA_DESCRIPTOR,function(q){_e(b.a.PES_PRIVATE_DATA_DESCRIPTOR,q)}),F.on(_.a.PES_PRIVATE_DATA_ARRIVED,function(q){_e(b.a.PES_PRIVATE_DATA_ARRIVED,q)}),F.open()):fe=!0)}function re(){oe&&oe.flush(),F&&(F.close(),F.destroy(),F=null)}function K(){ee=!0,fe&&(fe=!1,Y())}function k(){L.postMessage({msg:"mse_event",event:D.a.UPDATE_END})}function de(){Q.a.v(I,"MSE SourceBuffer is full, report to main thread"),L.postMessage({msg:"mse_event",event:D.a.BUFFER_FULL})}function ie(q){L.postMessage({msg:"player_event",event:b.a.ERROR,error_type:E.b.MEDIA_ERROR,error_detail:E.b.MEDIA_MSE_ERROR,info:q})}function ve(q,H){L.postMessage({msg:"transmuxing_event",event:q,info:H})}function _e(q,H){L.postMessage({msg:"player_event",event:q,extraData:H})}L.addEventListener("message",function(q){if(!x){var H=q.data;switch(H.cmd){case"logging_config":var le=H;g.a.applyConfig(le.logging_config),le.logging_config.enableCallback===!0?g.a.addLogListener(z):g.a.removeLogListener(z);break;case"init":j=(le=H).media_data_source,W=le.config;break;case"destroy":(function(){F&&re(),oe&&N(),x=!0,L.postMessage({msg:"destroyed"})})();break;case"initialize_mse":(function(){Q.a.v(I,"Initializing MediaSource in DedicatedWorker"),(oe=new m.a(W)).on(D.a.SOURCE_OPEN,K.bind(this)),oe.on(D.a.UPDATE_END,k.bind(this)),oe.on(D.a.BUFFER_FULL,de.bind(this)),oe.on(D.a.ERROR,ie.bind(this)),oe.initialize({getCurrentTime:function(){return ae},getReadyState:function(){return B}});var be=oe.getHandle();L.postMessage({msg:"mse_init",handle:be},[be])})();break;case"shutdown_mse":N();break;case"load":Y();break;case"unload":re();break;case"unbuffered_seek":le=H,oe.flush(),F.seek(le.milliseconds);break;case"timeupdate":ae=(le=H).current_time;break;case"readystatechange":B=(le=H).ready_state;break;case"pause_transmuxer":F.pause();break;case"resume_transmuxer":F.resume()}}})}},function(R,J,w){w.r(J);var Q=w(15),g=w(14),p={enableWorker:!1,enableWorkerForMSE:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyChasingOnPaused:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,liveSync:!1,liveSyncMaxLatency:1.2,liveSyncTargetLatency:.8,liveSyncPlaybackRate:1.2,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function D(){return Object.assign({},p)}var m=function(){function q(){}return q.supportMSEH264Playback=function(){var H=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),le=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');return H||le},q.supportMSEH265Playback=function(){var H=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"'),le=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"');return H||le},q.supportNetworkStreamIO=function(){var H=new g.a({},D()),le=H.loaderType;return H.destroy(),le=="fetch-stream-loader"||le=="xhr-moz-chunked-loader"},q.getNetworkLoaderTypeName=function(){var H=new g.a({},D()),le=H.loaderType;return H.destroy(),le},q.supportNativeMediaPlayback=function(H){q.videoElement==null&&(q.videoElement=window.document.createElement("video"));var le=q.videoElement.canPlayType(H);return le==="probably"||le=="maybe"},q.getFeatureList=function(){var H={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return H.msePlayback=q.supportMSEH264Playback(),H.networkStreamIO=q.supportNetworkStreamIO(),H.networkLoaderName=q.getNetworkLoaderTypeName(),H.mseLivePlayback=H.msePlayback&&H.networkStreamIO,H.mseH265Playback=q.supportMSEH265Playback(),H.nativeMP4H264Playback=q.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),H.nativeMP4H265Playback=q.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),H.nativeWebmVP8Playback=q.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),H.nativeWebmVP9Playback=q.supportNativeMediaPlayback('video/webm; codecs="vp9"'),H},q}(),y=w(2),_=w(0),b=w(9),E=w.n(b),L=w(16),I=w(4),z=w(17),j=w(7),W=w(10),oe=w(3),F=w(1),ee=w(5),fe=w(11),ae=function(){function q(H,le,be){this.TAG="SeekingHandler",this._config=null,this._media_element=null,this._always_seek_keyframe=!1,this._on_unbuffered_seek=null,this._request_set_current_time=!1,this._seek_request_record_clocktime=null,this._idr_sample_list=new fe.a,this.e=null,this._config=H,this._media_element=le,this._on_unbuffered_seek=be,this.e={onMediaSeeking:this._onMediaSeeking.bind(this)};var Ie=ee.a.chrome&&(ee.a.version.major<50||ee.a.version.major===50&&ee.a.version.build<2661);this._always_seek_keyframe=!!(Ie||ee.a.msedge||ee.a.msie),this._always_seek_keyframe&&(this._config.accurateSeek=!1),this._media_element.addEventListener("seeking",this.e.onMediaSeeking)}return q.prototype.destroy=function(){this._idr_sample_list.clear(),this._idr_sample_list=null,this._media_element.removeEventListener("seeking",this.e.onMediaSeeking),this._media_element=null,this._on_unbuffered_seek=null},q.prototype.seek=function(H){var le=this._isPositionBuffered(H),be=!1;if(H<1&&this._media_element.buffered.length>0){var Ie=this._media_element.buffered.start(0);(Ie<1&&H<Ie||ee.a.safari)&&(be=!0,H=ee.a.safari?.1:Ie)}if(be)this.directSeek(H);else if(le)if(this._always_seek_keyframe){var Oe=this._getNearestKeyframe(Math.floor(1e3*H));Oe!=null&&(H=Oe.dts/1e3),this.directSeek(H)}else this.directSeek(H);else this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*H)),this._config.accurateSeek&&this.directSeek(H)},q.prototype.directSeek=function(H){this._request_set_current_time=!0,this._media_element.currentTime=H},q.prototype.appendSyncPoints=function(H){this._idr_sample_list.appendArray(H)},q.prototype._onMediaSeeking=function(H){if(this._request_set_current_time)this._request_set_current_time=!1;else{var le=this._media_element.currentTime,be=this._media_element.buffered;if(le<1&&be.length>0){var Ie=be.start(0);if(Ie<1&&le<Ie||ee.a.safari){var Oe=ee.a.safari?.1:Ie;return void this.directSeek(Oe)}}if(this._isPositionBuffered(le)){if(this._always_seek_keyframe){var We=this._getNearestKeyframe(Math.floor(1e3*le));We!=null&&(le=We.dts/1e3,this.directSeek(le))}}else this._seek_request_record_clocktime=q._getClockTime(),window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)}},q.prototype._pollAndApplyUnbufferedSeek=function(){if(this._seek_request_record_clocktime!=null)if(this._seek_request_record_clocktime<=q._getClockTime()-100){var H=this._media_element.currentTime;this._seek_request_record_clocktime=null,this._isPositionBuffered(H)||(this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*H)),this._config.accurateSeek&&this.directSeek(H))}else window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)},q.prototype._isPositionBuffered=function(H){for(var le=this._media_element.buffered,be=0;be<le.length;be++){var Ie=le.start(be),Oe=le.end(be);if(H>=Ie&&H<Oe)return!0}return!1},q.prototype._getNearestKeyframe=function(H){return this._idr_sample_list.getLastSyncPointBeforeDts(H)},q._getClockTime=function(){return self.performance&&self.performance.now?self.performance.now():Date.now()},q}(),B=function(){function q(H,le,be,Ie){this.TAG="LoadingController",this._config=null,this._media_element=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null,this._paused=!1,this.e=null,this._config=H,this._media_element=le,this._on_pause_transmuxer=be,this._on_resume_transmuxer=Ie,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)}}return q.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this.e=null,this._media_element=null,this._config=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null},q.prototype.notifyBufferedPositionChanged=function(H){!this._config.isLive&&this._config.lazyLoad&&(H==null?this._suspendTransmuxerIfNeeded():this._suspendTransmuxerIfBufferedPositionExceeded(H))},q.prototype._onMediaTimeUpdate=function(H){this._paused&&this._resumeTransmuxerIfNeeded()},q.prototype._suspendTransmuxerIfNeeded=function(){for(var H=this._media_element.buffered,le=this._media_element.currentTime,be=0,Ie=0;Ie<H.length;Ie++){var Oe=H.start(Ie),We=H.end(Ie);if(Oe<=le&&le<We){be=We;break}}be>0&&this._suspendTransmuxerIfBufferedPositionExceeded(be)},q.prototype._suspendTransmuxerIfBufferedPositionExceeded=function(H){H>=this._media_element.currentTime+this._config.lazyLoadMaxDuration&&!this._paused&&(_.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this.suspendTransmuxer(),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate))},q.prototype.suspendTransmuxer=function(){this._paused=!0,this._on_pause_transmuxer()},q.prototype._resumeTransmuxerIfNeeded=function(){for(var H=this._media_element.buffered,le=this._media_element.currentTime,be=this._config.lazyLoadRecoverDuration,Ie=!1,Oe=0;Oe<H.length;Oe++){var We=H.start(Oe),et=H.end(Oe);if(le>=We&&le<et){le>=et-be&&(Ie=!0);break}}Ie&&(_.a.v(this.TAG,"Continue loading from paused position"),this.resumeTransmuxer(),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate))},q.prototype.resumeTransmuxer=function(){this._paused=!1,this._on_resume_transmuxer()},q}(),x=function(){function q(H,le){this.TAG="StartupStallJumper",this._media_element=null,this._on_direct_seek=null,this._canplay_received=!1,this.e=null,this._media_element=H,this._on_direct_seek=le,this.e={onMediaCanPlay:this._onMediaCanPlay.bind(this),onMediaStalled:this._onMediaStalled.bind(this),onMediaProgress:this._onMediaProgress.bind(this)},this._media_element.addEventListener("canplay",this.e.onMediaCanPlay),this._media_element.addEventListener("stalled",this.e.onMediaStalled),this._media_element.addEventListener("progress",this.e.onMediaProgress)}return q.prototype.destroy=function(){this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay),this._media_element.removeEventListener("stalled",this.e.onMediaStalled),this._media_element.removeEventListener("progress",this.e.onMediaProgress),this._media_element=null,this._on_direct_seek=null},q.prototype._onMediaCanPlay=function(H){this._canplay_received=!0,this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay)},q.prototype._onMediaStalled=function(H){this._detectAndFixStuckPlayback(!0)},q.prototype._onMediaProgress=function(H){this._detectAndFixStuckPlayback()},q.prototype._detectAndFixStuckPlayback=function(H){var le=this._media_element,be=le.buffered;H||!this._canplay_received||le.readyState<2?be.length>0&&le.currentTime<be.start(0)&&(_.a.w(this.TAG,"Playback seems stuck at ".concat(le.currentTime,", seek to ").concat(be.start(0))),this._on_direct_seek(be.start(0)),this._media_element.removeEventListener("progress",this.e.onMediaProgress)):this._media_element.removeEventListener("progress",this.e.onMediaProgress)},q}(),N=function(){function q(H,le,be){this._config=null,this._media_element=null,this._on_direct_seek=null,this._config=H,this._media_element=le,this._on_direct_seek=be}return q.prototype.destroy=function(){this._on_direct_seek=null,this._media_element=null,this._config=null},q.prototype.notifyBufferedRangeUpdate=function(){this._chaseLiveLatency()},q.prototype._chaseLiveLatency=function(){var H=this._media_element.buffered,le=this._media_element.currentTime,be=this._media_element.paused;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&H.length!=0&&(this._config.liveBufferLatencyChasingOnPaused||!be)){var Ie=H.end(H.length-1);if(Ie>this._config.liveBufferLatencyMaxLatency&&Ie-le>this._config.liveBufferLatencyMaxLatency){var Oe=Ie-this._config.liveBufferLatencyMinRemain;this._on_direct_seek(Oe)}}},q}(),Y=function(){function q(H,le){this._config=null,this._media_element=null,this.e=null,this._config=H,this._media_element=le,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)},this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate)}return q.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element=null,this._config=null},q.prototype._onMediaTimeUpdate=function(H){if(this._config.isLive&&this._config.liveSync){var le=this._getCurrentLatency();if(le>this._config.liveSyncMaxLatency){var be=Math.min(2,Math.max(1,this._config.liveSyncPlaybackRate));this._media_element.playbackRate=be}else le>this._config.liveSyncTargetLatency||this._media_element.playbackRate!==1&&this._media_element.playbackRate!==0&&(this._media_element.playbackRate=1)}},q.prototype._getCurrentLatency=function(){if(!this._media_element)return 0;var H=this._media_element.buffered,le=this._media_element.currentTime;return H.length==0?0:H.end(H.length-1)-le},q}(),re=function(){function q(H,le){this.TAG="PlayerEngineMainThread",this._emitter=new b,this._media_element=null,this._mse_controller=null,this._transmuxer=null,this._pending_seek_time=null,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._mse_source_opened=!1,this._has_pending_load=!1,this._loaded_metadata_received=!1,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=H,this._config=D(),typeof le=="object"&&Object.assign(this._config,le),H.isLive===!0&&(this._config.isLive=!0),this.e={onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this)}}return q.prototype.destroy=function(){this._emitter.emit(I.a.DESTROYING),this._transmuxer&&this.unload(),this._media_element&&this.detachMediaElement(),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},q.prototype.on=function(H,le){var be=this;this._emitter.addListener(H,le),H===I.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return be._emitter.emit(I.a.MEDIA_INFO,be.mediaInfo)}):H==I.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return be._emitter.emit(I.a.STATISTICS_INFO,be.statisticsInfo)})},q.prototype.off=function(H,le){this._emitter.removeListener(H,le)},q.prototype.attachMediaElement=function(H){var le=this;this._media_element=H,H.src="",H.removeAttribute("src"),H.srcObject=null,H.load(),H.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._mse_controller=new L.a(this._config),this._mse_controller.on(j.a.UPDATE_END,this._onMSEUpdateEnd.bind(this)),this._mse_controller.on(j.a.BUFFER_FULL,this._onMSEBufferFull.bind(this)),this._mse_controller.on(j.a.SOURCE_OPEN,this._onMSESourceOpen.bind(this)),this._mse_controller.on(j.a.ERROR,this._onMSEError.bind(this)),this._mse_controller.on(j.a.START_STREAMING,this._onMSEStartStreaming.bind(this)),this._mse_controller.on(j.a.END_STREAMING,this._onMSEEndStreaming.bind(this)),this._mse_controller.initialize({getCurrentTime:function(){return le._media_element.currentTime},getReadyState:function(){return le._media_element.readyState}}),this._mse_controller.isManagedMediaSource()?(H.disableRemotePlayback=!0,H.srcObject=this._mse_controller.getObject()):H.src=this._mse_controller.getObjectURL()},q.prototype.detachMediaElement=function(){this._media_element&&(this._mse_controller.shutdown(),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null,this._mse_controller.revokeObjectURL()),this._mse_controller&&(this._mse_controller.destroy(),this._mse_controller=null)},q.prototype.load=function(){var H=this;if(!this._media_element)throw new oe.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new oe.a("load() has been called, please call unload() first!");this._has_pending_load||(!this._config.deferLoadAfterSourceOpen||this._mse_source_opened?(this._transmuxer=new z.a(this._media_data_source,this._config),this._transmuxer.on(F.a.INIT_SEGMENT,function(le,be){H._mse_controller.appendInitSegment(be)}),this._transmuxer.on(F.a.MEDIA_SEGMENT,function(le,be){H._mse_controller.appendMediaSegment(be),!H._config.isLive&&le==="video"&&be.data&&be.data.byteLength>0&&"info"in be&&H._seeking_handler.appendSyncPoints(be.info.syncPoints),H._loading_controller.notifyBufferedPositionChanged(be.info.endDts/1e3)}),this._transmuxer.on(F.a.LOADING_COMPLETE,function(){H._mse_controller.endOfStream(),H._emitter.emit(I.a.LOADING_COMPLETE)}),this._transmuxer.on(F.a.RECOVERED_EARLY_EOF,function(){H._emitter.emit(I.a.RECOVERED_EARLY_EOF)}),this._transmuxer.on(F.a.IO_ERROR,function(le,be){H._emitter.emit(I.a.ERROR,W.b.NETWORK_ERROR,le,be)}),this._transmuxer.on(F.a.DEMUX_ERROR,function(le,be){H._emitter.emit(I.a.ERROR,W.b.MEDIA_ERROR,le,be)}),this._transmuxer.on(F.a.MEDIA_INFO,function(le){H._media_info=le,H._emitter.emit(I.a.MEDIA_INFO,Object.assign({},le))}),this._transmuxer.on(F.a.STATISTICS_INFO,function(le){H._statistics_info=H._fillStatisticsInfo(le),H._emitter.emit(I.a.STATISTICS_INFO,Object.assign({},le))}),this._transmuxer.on(F.a.RECOMMEND_SEEKPOINT,function(le){H._media_element&&!H._config.accurateSeek&&H._seeking_handler.directSeek(le/1e3)}),this._transmuxer.on(F.a.METADATA_ARRIVED,function(le){H._emitter.emit(I.a.METADATA_ARRIVED,le)}),this._transmuxer.on(F.a.SCRIPTDATA_ARRIVED,function(le){H._emitter.emit(I.a.SCRIPTDATA_ARRIVED,le)}),this._transmuxer.on(F.a.TIMED_ID3_METADATA_ARRIVED,function(le){H._emitter.emit(I.a.TIMED_ID3_METADATA_ARRIVED,le)}),this._transmuxer.on(F.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,function(le){H._emitter.emit(I.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,le)}),this._transmuxer.on(F.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,function(le){H._emitter.emit(I.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,le)}),this._transmuxer.on(F.a.SMPTE2038_METADATA_ARRIVED,function(le){H._emitter.emit(I.a.SMPTE2038_METADATA_ARRIVED,le)}),this._transmuxer.on(F.a.SCTE35_METADATA_ARRIVED,function(le){H._emitter.emit(I.a.SCTE35_METADATA_ARRIVED,le)}),this._transmuxer.on(F.a.PES_PRIVATE_DATA_DESCRIPTOR,function(le){H._emitter.emit(I.a.PES_PRIVATE_DATA_DESCRIPTOR,le)}),this._transmuxer.on(F.a.PES_PRIVATE_DATA_ARRIVED,function(le){H._emitter.emit(I.a.PES_PRIVATE_DATA_ARRIVED,le)}),this._seeking_handler=new ae(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new B(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new x(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new N(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new Y(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0),this._transmuxer.open()):this._has_pending_load=!0)},q.prototype.unload=function(){var H,le,be,Ie,Oe,We,et,Le,Re;(H=this._media_element)===null||H===void 0||H.pause(),(le=this._live_latency_synchronizer)===null||le===void 0||le.destroy(),this._live_latency_synchronizer=null,(be=this._live_latency_chaser)===null||be===void 0||be.destroy(),this._live_latency_chaser=null,(Ie=this._startup_stall_jumper)===null||Ie===void 0||Ie.destroy(),this._startup_stall_jumper=null,(Oe=this._loading_controller)===null||Oe===void 0||Oe.destroy(),this._loading_controller=null,(We=this._seeking_handler)===null||We===void 0||We.destroy(),this._seeking_handler=null,(et=this._mse_controller)===null||et===void 0||et.flush(),(Le=this._transmuxer)===null||Le===void 0||Le.close(),(Re=this._transmuxer)===null||Re===void 0||Re.destroy(),this._transmuxer=null},q.prototype.play=function(){return this._media_element.play()},q.prototype.pause=function(){this._media_element.pause()},q.prototype.seek=function(H){this._media_element&&this._seeking_handler?this._seeking_handler.seek(H):this._pending_seek_time=H},Object.defineProperty(q.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),q.prototype._onMSESourceOpen=function(){this._mse_source_opened=!0,this._has_pending_load&&(this._has_pending_load=!1,this.load())},q.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},q.prototype._onMSEBufferFull=function(){_.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},q.prototype._onMSEError=function(H){this._emitter.emit(I.a.ERROR,W.b.MEDIA_ERROR,W.a.MEDIA_MSE_ERROR,H)},q.prototype._onMSEStartStreaming=function(){this._loaded_metadata_received&&(this._config.isLive||(_.a.v(this.TAG,"Resume transmuxing task due to ManagedMediaSource onStartStreaming"),this._loading_controller.resumeTransmuxer()))},q.prototype._onMSEEndStreaming=function(){this._config.isLive||(_.a.v(this.TAG,"Suspend transmuxing task due to ManagedMediaSource onEndStreaming"),this._loading_controller.suspendTransmuxer())},q.prototype._onMediaLoadedMetadata=function(H){this._loaded_metadata_received=!0,this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},q.prototype._onRequestDirectSeek=function(H){this._seeking_handler.directSeek(H)},q.prototype._onRequiredUnbufferedSeek=function(H){this._mse_controller.flush(),this._transmuxer.seek(H)},q.prototype._onRequestPauseTransmuxer=function(){this._transmuxer.pause()},q.prototype._onRequestResumeTransmuxer=function(){this._transmuxer.resume()},q.prototype._fillStatisticsInfo=function(H){if(H.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return H;var le=!0,be=0,Ie=0;if(this._media_element.getVideoPlaybackQuality){var Oe=this._media_element.getVideoPlaybackQuality();be=Oe.totalVideoFrames,Ie=Oe.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(be=this._media_element.webkitDecodedFrameCount,Ie=this._media_element.webkitDroppedFrameCount):le=!1;return le&&(H.decodedFrames=be,H.droppedFrames=Ie),H},q}(),K=w(18),k=w(8),de=function(){function q(H,le){this.TAG="PlayerEngineDedicatedThread",this._emitter=new b,this._media_element=null,this._worker_destroying=!1,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._pending_seek_time=null,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=H,this._config=D(),typeof le=="object"&&Object.assign(this._config,le),H.isLive===!0&&(this._config.isLive=!0),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this),onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this),onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this),onMediaReadyStateChanged:this._onMediaReadyStateChange.bind(this)},k.a.registerListener(this.e.onLoggingConfigChanged),this._worker=K(24,{all:!0}),this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",media_data_source:this._media_data_source,config:this._config}),this._worker.postMessage({cmd:"logging_config",logging_config:k.a.getConfig()})}return q.isSupported=function(){return!!self.Worker&&(!(!self.MediaSource||!("canConstructInDedicatedWorker"in self.MediaSource)||self.MediaSource.canConstructInDedicatedWorker!==!0)||!(!self.ManagedMediaSource||!("canConstructInDedicatedWorker"in self.ManagedMediaSource)||self.ManagedMediaSource.canConstructInDedicatedWorker!==!0))},q.prototype.destroy=function(){this._emitter.emit(I.a.DESTROYING),this.unload(),this.detachMediaElement(),this._worker_destroying=!0,this._worker.postMessage({cmd:"destroy"}),k.a.removeListener(this.e.onLoggingConfigChanged),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},q.prototype.on=function(H,le){var be=this;this._emitter.addListener(H,le),H===I.a.MEDIA_INFO&&this._media_info?Promise.resolve().then(function(){return be._emitter.emit(I.a.MEDIA_INFO,be.mediaInfo)}):H==I.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then(function(){return be._emitter.emit(I.a.STATISTICS_INFO,be.statisticsInfo)})},q.prototype.off=function(H,le){this._emitter.removeListener(H,le)},q.prototype.attachMediaElement=function(H){this._media_element=H,this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.addEventListener("readystatechange",this.e.onMediaReadyStateChanged),this._worker.postMessage({cmd:"initialize_mse"})},q.prototype.detachMediaElement=function(){this._worker.postMessage({cmd:"shutdown_mse"}),this._media_element&&(this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.removeEventListener("readystatechange",this.e.onMediaReadyStateChanged),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null)},q.prototype.load=function(){this._worker.postMessage({cmd:"load"}),this._seeking_handler=new ae(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new B(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new x(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new N(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new Y(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0)},q.prototype.unload=function(){var H,le,be,Ie,Oe,We;(H=this._media_element)===null||H===void 0||H.pause(),this._worker.postMessage({cmd:"unload"}),(le=this._live_latency_synchronizer)===null||le===void 0||le.destroy(),this._live_latency_synchronizer=null,(be=this._live_latency_chaser)===null||be===void 0||be.destroy(),this._live_latency_chaser=null,(Ie=this._startup_stall_jumper)===null||Ie===void 0||Ie.destroy(),this._startup_stall_jumper=null,(Oe=this._loading_controller)===null||Oe===void 0||Oe.destroy(),this._loading_controller=null,(We=this._seeking_handler)===null||We===void 0||We.destroy(),this._seeking_handler=null},q.prototype.play=function(){return this._media_element.play()},q.prototype.pause=function(){this._media_element.pause()},q.prototype.seek=function(H){this._media_element&&this._seeking_handler?this._seeking_handler.seek(H):this._pending_seek_time=H},Object.defineProperty(q.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),q.prototype._onLoggingConfigChanged=function(H){var le;(le=this._worker)===null||le===void 0||le.postMessage({cmd:"logging_config",logging_config:H})},q.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},q.prototype._onMSEBufferFull=function(){_.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},q.prototype._onMediaLoadedMetadata=function(H){this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},q.prototype._onRequestDirectSeek=function(H){this._seeking_handler.directSeek(H)},q.prototype._onRequiredUnbufferedSeek=function(H){this._worker.postMessage({cmd:"unbuffered_seek",milliseconds:H})},q.prototype._onRequestPauseTransmuxer=function(){this._worker.postMessage({cmd:"pause_transmuxer"})},q.prototype._onRequestResumeTransmuxer=function(){this._worker.postMessage({cmd:"resume_transmuxer"})},q.prototype._onMediaTimeUpdate=function(H){this._worker.postMessage({cmd:"timeupdate",current_time:H.target.currentTime})},q.prototype._onMediaReadyStateChange=function(H){this._worker.postMessage({cmd:"readystatechange",ready_state:H.target.readyState})},q.prototype._onWorkerMessage=function(H){var le,be=H.data,Ie=be.msg;if(Ie=="destroyed"||this._worker_destroying)return this._worker_destroying=!1,(le=this._worker)===null||le===void 0||le.terminate(),void(this._worker=null);switch(Ie){case"mse_init":var Oe=be;"ManagedMediaSource"in self&&!("MediaSource"in self)&&(this._media_element.disableRemotePlayback=!0),this._media_element.srcObject=Oe.handle;break;case"mse_event":(Oe=be).event==j.a.UPDATE_END?this._onMSEUpdateEnd():Oe.event==j.a.BUFFER_FULL&&this._onMSEBufferFull();break;case"transmuxing_event":if((Oe=be).event==F.a.MEDIA_INFO){var We=be;this._media_info=We.info,this._emitter.emit(I.a.MEDIA_INFO,Object.assign({},We.info))}else if(Oe.event==F.a.STATISTICS_INFO){var et=be;this._statistics_info=this._fillStatisticsInfo(et.info),this._emitter.emit(I.a.STATISTICS_INFO,Object.assign({},et.info))}else if(Oe.event==F.a.RECOMMEND_SEEKPOINT){var Le=be;this._media_element&&!this._config.accurateSeek&&this._seeking_handler.directSeek(Le.milliseconds/1e3)}break;case"player_event":if((Oe=be).event==I.a.ERROR){var Re=be;this._emitter.emit(I.a.ERROR,Re.error_type,Re.error_detail,Re.info)}else if("extraData"in Oe){var He=be;this._emitter.emit(He.event,He.extraData)}break;case"logcat_callback":Oe=be,_.a.emitter.emit("log",Oe.type,Oe.logcat);break;case"buffered_position_changed":Oe=be,this._loading_controller.notifyBufferedPositionChanged(Oe.buffered_position_milliseconds/1e3)}},q.prototype._fillStatisticsInfo=function(H){if(H.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return H;var le=!0,be=0,Ie=0;if(this._media_element.getVideoPlaybackQuality){var Oe=this._media_element.getVideoPlaybackQuality();be=Oe.totalVideoFrames,Ie=Oe.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(be=this._media_element.webkitDecodedFrameCount,Ie=this._media_element.webkitDroppedFrameCount):le=!1;return le&&(H.decodedFrames=be,H.droppedFrames=Ie),H},q}(),ie=function(){function q(H,le){this.TAG="MSEPlayer",this._type="MSEPlayer",this._media_element=null,this._player_engine=null;var be=H.type.toLowerCase();if(be!=="mse"&&be!=="mpegts"&&be!=="m2ts"&&be!=="flv")throw new oe.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");if(le&&le.enableWorkerForMSE&&de.isSupported())try{this._player_engine=new de(H,le)}catch(Ie){_.a.e(this.TAG,"Error while initializing PlayerEngineDedicatedThread, fallback to PlayerEngineMainThread"),this._player_engine=new re(H,le)}else this._player_engine=new re(H,le)}return q.prototype.destroy=function(){this._player_engine.destroy(),this._player_engine=null,this._media_element=null},q.prototype.on=function(H,le){this._player_engine.on(H,le)},q.prototype.off=function(H,le){this._player_engine.off(H,le)},q.prototype.attachMediaElement=function(H){this._media_element=H,this._player_engine.attachMediaElement(H)},q.prototype.detachMediaElement=function(){this._media_element=null,this._player_engine.detachMediaElement()},q.prototype.load=function(){this._player_engine.load()},q.prototype.unload=function(){this._player_engine.unload()},q.prototype.play=function(){return this._player_engine.play()},q.prototype.pause=function(){this._player_engine.pause()},Object.defineProperty(q.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"buffered",{get:function(){return this._media_element.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"duration",{get:function(){return this._media_element.duration},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"volume",{get:function(){return this._media_element.volume},set:function(H){this._media_element.volume=H},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"muted",{get:function(){return this._media_element.muted},set:function(H){this._media_element.muted=H},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"currentTime",{get:function(){return this._media_element?this._media_element.currentTime:0},set:function(H){this._player_engine.seek(H)},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"mediaInfo",{get:function(){return this._player_engine.mediaInfo},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"statisticsInfo",{get:function(){return this._player_engine.statisticsInfo},enumerable:!1,configurable:!0}),q}(),ve=function(){function q(H,le){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new E.a,this._config=D(),typeof le=="object"&&Object.assign(this._config,le);var be=H.type.toLowerCase();if(be==="mse"||be==="mpegts"||be==="m2ts"||be==="flv")throw new oe.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(H.hasOwnProperty("segments"))throw new oe.b("NativePlayer(".concat(H.type,") doesn't support multipart playback!"));this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=H,this._mediaElement=null}return q.prototype.destroy=function(){this._emitter.emit(I.a.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},q.prototype.on=function(H,le){var be=this;H===I.a.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){be._emitter.emit(I.a.MEDIA_INFO,be.mediaInfo)}):H===I.a.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){be._emitter.emit(I.a.STATISTICS_INFO,be.statisticsInfo)}),this._emitter.addListener(H,le)},q.prototype.off=function(H,le){this._emitter.removeListener(H,le)},q.prototype.attachMediaElement=function(H){if(this._mediaElement=H,H.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{H.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(le){}},q.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},q.prototype.load=function(){if(!this._mediaElement)throw new oe.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},q.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},q.prototype.play=function(){return this._mediaElement.play()},q.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(q.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(H){this._mediaElement.volume=H},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(H){this._mediaElement.muted=H},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(H){this._mediaElement?this._mediaElement.currentTime=H:this._pendingSeekTime=H},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"mediaInfo",{get:function(){var H={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(H.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(H.width=this._mediaElement.videoWidth,H.height=this._mediaElement.videoHeight)),H},enumerable:!1,configurable:!0}),Object.defineProperty(q.prototype,"statisticsInfo",{get:function(){var H={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return H;var le=!0,be=0,Ie=0;if(this._mediaElement.getVideoPlaybackQuality){var Oe=this._mediaElement.getVideoPlaybackQuality();be=Oe.totalVideoFrames,Ie=Oe.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(be=this._mediaElement.webkitDecodedFrameCount,Ie=this._mediaElement.webkitDroppedFrameCount):le=!1;return le&&(H.decodedFrames=be,H.droppedFrames=Ie),H},enumerable:!1,configurable:!0}),q.prototype._onvLoadedMetadata=function(H){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(I.a.MEDIA_INFO,this.mediaInfo)},q.prototype._reportStatisticsInfo=function(){this._emitter.emit(I.a.STATISTICS_INFO,this.statisticsInfo)},q}();Q.a.install();var _e={createPlayer:function(q,H){var le=q;if(le==null||typeof le!="object")throw new oe.b("MediaDataSource must be an javascript object!");if(!le.hasOwnProperty("type"))throw new oe.b("MediaDataSource must has type field to indicate video file type!");switch(le.type){case"mse":case"mpegts":case"m2ts":case"flv":return new ie(le,H);default:return new ve(le,H)}},isSupported:function(){return m.supportMSEH264Playback()},getFeatureList:function(){return m.getFeatureList()}};_e.BaseLoader=y.a,_e.LoaderStatus=y.c,_e.LoaderErrors=y.b,_e.Events=I.a,_e.ErrorTypes=W.b,_e.ErrorDetails=W.a,_e.MSEPlayer=ie,_e.NativePlayer=ve,_e.LoggingControl=k.a,Object.defineProperty(_e,"version",{enumerable:!0,get:function(){return"1.8.0"}}),J.default=_e}])})})(qn);var To=qn.exports;const Yn=na(To);var Wn={exports:{}};(function(vi,ii){(function R(J){var w;w=function(){function Q(s,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(s,I(e.key),e)}}function g(s,n,t){return n&&Q(s.prototype,n),t&&Q(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function p(s,n,t){return(n=I(n))in s?Object.defineProperty(s,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[n]=t,s}function D(){return D=Object.assign?Object.assign.bind():function(s){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var e in t)({}).hasOwnProperty.call(t,e)&&(s[e]=t[e])}return s},D.apply(null,arguments)}function m(s){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},m(s)}function y(s,n){s.prototype=Object.create(n.prototype),s.prototype.constructor=s,L(s,n)}function _(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(_=function(){return!!s})()}function b(s,n){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(s);n&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,e)}return t}function E(s){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?b(Object(t),!0).forEach(function(e){p(s,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach(function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(t,e))})}return s}function L(s,n){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},L(s,n)}function I(s){var n=function(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}(s,"string");return typeof n=="symbol"?n:n+""}function z(s){var n=typeof Map=="function"?new Map:void 0;return z=function(t){if(t===null||!function(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch(r){return typeof i=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(n!==void 0){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return function(i,r,a){if(_())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,r);var l=new(i.bind.apply(i,o));return a&&L(l,a.prototype),l}(t,arguments,m(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),L(e,t)},z(s)}function j(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var W,oe,F={exports:{}},ee=(W||(W=1,function(s){var n=Object.prototype.hasOwnProperty,t="~";function e(){}function i(l,h,u){this.fn=l,this.context=h,this.once=u||!1}function r(l,h,u,A,M){if(typeof u!="function")throw new TypeError("The listener must be a function");var T=new i(u,A||l,M),P=t?t+h:h;return l._events[P]?l._events[P].fn?l._events[P]=[l._events[P],T]:l._events[P].push(T):(l._events[P]=T,l._eventsCount++),l}function a(l,h){--l._eventsCount==0?l._events=new e:delete l._events[h]}function o(){this._events=new e,this._eventsCount=0}Object.create&&(e.prototype=Object.create(null),new e().__proto__||(t=!1)),o.prototype.eventNames=function(){var l,h,u=[];if(this._eventsCount===0)return u;for(h in l=this._events)n.call(l,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},o.prototype.listeners=function(l){var h=t?t+l:l,u=this._events[h];if(!u)return[];if(u.fn)return[u.fn];for(var A=0,M=u.length,T=new Array(M);A<M;A++)T[A]=u[A].fn;return T},o.prototype.listenerCount=function(l){var h=t?t+l:l,u=this._events[h];return u?u.fn?1:u.length:0},o.prototype.emit=function(l,h,u,A,M,T){var P=t?t+l:l;if(!this._events[P])return!1;var U,G,$=this._events[P],te=arguments.length;if($.fn){switch($.once&&this.removeListener(l,$.fn,void 0,!0),te){case 1:return $.fn.call($.context),!0;case 2:return $.fn.call($.context,h),!0;case 3:return $.fn.call($.context,h,u),!0;case 4:return $.fn.call($.context,h,u,A),!0;case 5:return $.fn.call($.context,h,u,A,M),!0;case 6:return $.fn.call($.context,h,u,A,M,T),!0}for(G=1,U=new Array(te-1);G<te;G++)U[G-1]=arguments[G];$.fn.apply($.context,U)}else{var se,pe=$.length;for(G=0;G<pe;G++)switch($[G].once&&this.removeListener(l,$[G].fn,void 0,!0),te){case 1:$[G].fn.call($[G].context);break;case 2:$[G].fn.call($[G].context,h);break;case 3:$[G].fn.call($[G].context,h,u);break;case 4:$[G].fn.call($[G].context,h,u,A);break;default:if(!U)for(se=1,U=new Array(te-1);se<te;se++)U[se-1]=arguments[se];$[G].fn.apply($[G].context,U)}}return!0},o.prototype.on=function(l,h,u){return r(this,l,h,u,!1)},o.prototype.once=function(l,h,u){return r(this,l,h,u,!0)},o.prototype.removeListener=function(l,h,u,A){var M=t?t+l:l;if(!this._events[M])return this;if(!h)return a(this,M),this;var T=this._events[M];if(T.fn)T.fn!==h||A&&!T.once||u&&T.context!==u||a(this,M);else{for(var P=0,U=[],G=T.length;P<G;P++)(T[P].fn!==h||A&&!T[P].once||u&&T[P].context!==u)&&U.push(T[P]);U.length?this._events[M]=U.length===1?U[0]:U:a(this,M)}return this},o.prototype.removeAllListeners=function(l){var h;return l?(h=t?t+l:l,this._events[h]&&a(this,h)):(this._events=new e,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,s.exports=o}(F)),F.exports),fe=j(ee),ae={exports:{}},B=(oe||(oe=1,function(s,n){var t,e,i,r,a;t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,e=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(o,l,h){if(h=h||{},o=o.trim(),!(l=l.trim())){if(!h.alwaysNormalize)return o;var u=a.parseURL(o);if(!u)throw new Error("Error trying to parse base URL.");return u.path=a.normalizePath(u.path),a.buildURLFromParts(u)}var A=a.parseURL(l);if(!A)throw new Error("Error trying to parse relative URL.");if(A.scheme)return h.alwaysNormalize?(A.path=a.normalizePath(A.path),a.buildURLFromParts(A)):l;var M=a.parseURL(o);if(!M)throw new Error("Error trying to parse base URL.");if(!M.netLoc&&M.path&&M.path[0]!=="/"){var T=e.exec(M.path);M.netLoc=T[1],M.path=T[2]}M.netLoc&&!M.path&&(M.path="/");var P={scheme:M.scheme,netLoc:A.netLoc,path:null,params:A.params,query:A.query,fragment:A.fragment};if(!A.netLoc&&(P.netLoc=M.netLoc,A.path[0]!=="/"))if(A.path){var U=M.path,G=U.substring(0,U.lastIndexOf("/")+1)+A.path;P.path=a.normalizePath(G)}else P.path=M.path,A.params||(P.params=M.params,A.query||(P.query=M.query));return P.path===null&&(P.path=h.alwaysNormalize?a.normalizePath(A.path):A.path),a.buildURLFromParts(P)},parseURL:function(o){var l=t.exec(o);return l?{scheme:l[1]||"",netLoc:l[2]||"",path:l[3]||"",params:l[4]||"",query:l[5]||"",fragment:l[6]||""}:null},normalizePath:function(o){for(o=o.split("").reverse().join("").replace(i,"");o.length!==(o=o.replace(r,"")).length;);return o.split("").reverse().join("")},buildURLFromParts:function(o){return o.scheme+o.netLoc+o.path+o.params+o.query+o.fragment}},s.exports=a}(ae)),ae.exports),x=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},N=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=Y},Y=Number.MAX_SAFE_INTEGER||9007199254740991,re=function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s}({}),K=function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",s.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",s.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.ASSET_LIST_LOAD_ERROR="assetListLoadError",s.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",s.ASSET_LIST_PARSING_ERROR="assetListParsingError",s.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.ATTACH_MEDIA_ERROR="attachMediaError",s.UNKNOWN="unknown",s}({}),k=function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.MEDIA_ENDED="hlsMediaEnded",s.STALL_RESOLVED="hlsStallResolved",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFERED_TO_END="hlsBufferedToEnd",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s.ASSET_LIST_LOADING="hlsAssetListLoading",s.ASSET_LIST_LOADED="hlsAssetListLoaded",s.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",s.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",s.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",s.INTERSTITIAL_STARTED="hlsInterstitialStarted",s.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",s.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",s.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",s.INTERSTITIAL_ENDED="hlsInterstitialEnded",s.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",s.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",s.EVENT_CUE_ENTER="hlsEventCueEnter",s}({}),de="manifest",ie="level",ve="audioTrack",_e="subtitleTrack",q="main",H="audio",le="subtitle",be=function(){function s(t,e,i){e===void 0&&(e=0),i===void 0&&(i=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=i}var n=s.prototype;return n.sample=function(t,e){var i=Math.pow(this.alpha_,t);this.estimate_=e*(1-i)+i*this.estimate_,this.totalWeight_+=t},n.getTotalWeight=function(){return this.totalWeight_},n.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_},s}(),Ie=function(){function s(t,e,i,r){r===void 0&&(r=100),this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new be(t),this.fast_=new be(e),this.defaultTTFB_=r,this.ttfb_=new be(t)}var n=s.prototype;return n.update=function(t,e){var i=this.slow_,r=this.fast_,a=this.ttfb_;i.halfLife!==t&&(this.slow_=new be(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.fast_=new be(e,r.getEstimate(),r.getTotalWeight())),a.halfLife!==t&&(this.ttfb_=new be(t,a.getEstimate(),a.getTotalWeight()))},n.sample=function(t,e){var i=(t=Math.max(t,this.minDelayMs_))/1e3,r=8*e/i;this.fast_.sample(i,r),this.slow_.sample(i,r)},n.sampleTTFB=function(t){var e=t/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(i,Math.max(t,5))},n.canEstimate=function(){return this.fast_.getTotalWeight()>=this.minWeight_},n.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},n.getEstimateTTFB=function(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_},n.destroy=function(){},g(s,[{key:"defaultEstimate",get:function(){return this.defaultEstimate_}}])}(),Oe=function(s,n){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;var t="["+s+"]:";this.trace=We,this.debug=n.debug.bind(null,t),this.log=n.log.bind(null,t),this.warn=n.warn.bind(null,t),this.info=n.info.bind(null,t),this.error=n.error.bind(null,t)},We=function(){},et={trace:We,debug:We,log:We,warn:We,info:We,error:We};function Le(){return D({},et)}function Re(s,n,t){return n[s]?n[s].bind(n):function(e,i){var r=self.console[e];return r?r.bind(self.console,(i?"["+i+"] ":"")+"["+e+"] >"):We}(s,t)}var He=Le();function Ue(s,n,t){var e=Le();if(typeof console=="object"&&s===!0||typeof s=="object"){var i=["debug","log","info","warn","error"];i.forEach(function(r){e[r]=Re(r,s,t)});try{e.log('Debug logs enabled for "'+n+'" in hls.js version 1.6.5')}catch(r){return Le()}i.forEach(function(r){He[r]=Re(r,s)})}else D(He,e);return e}var Ke,st,Ze=He,xt=st?Ke:(st=1,Ke=void 0),Xt=j(xt);function ct(s,n){if(n===void 0&&(n=!1),typeof TextDecoder<"u"){var t=new TextDecoder("utf-8").decode(s);if(n){var e=t.indexOf("\0");return e!==-1?t.substring(0,e):t}return t.replace(/\0/g,"")}for(var i,r,a,o=s.length,l="",h=0;h<o;){if((i=s[h++])===0&&n)return l;if(i!==0&&i!==3)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(i);break;case 12:case 13:r=s[h++],l+=String.fromCharCode((31&i)<<6|63&r);break;case 14:r=s[h++],a=s[h++],l+=String.fromCharCode((15&i)<<12|(63&r)<<6|(63&a)<<0)}}return l}var ri=function(s){for(var n="",t=0;t<s.length;t++){var e=s[t].toString(16);e.length<2&&(e="0"+e),n+=e}return n},Xe=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}},Jt="audio",Bt="video",_i="audiovideo",Si=function(){function s(t){var e,i,r;this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof t=="string"&&(t={url:t}),this.base=t,(r=zi(e=this,i="stats"))&&(r.enumerable=!0,Object.defineProperty(e,i,r))}var n=s.prototype;return n.setByteRange=function(t,e){var i,r=t.split("@",2);i=r.length===1?(e==null?void 0:e.byteRangeEndOffset)||0:parseInt(r[1]),this._byteRange=[i,parseInt(r[0])+i]},n.clearElementaryStreamInfo=function(){var t=this.elementaryStreams;t[Jt]=null,t[Bt]=null,t[_i]=null},g(s,[{key:"baseurl",get:function(){return this.base.url}},{key:"byteRange",get:function(){return this._byteRange===null?[]:this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"elementaryStreams",get:function(){var t;return this._streams===null&&(this._streams=((t={})[Jt]=null,t[Bt]=null,t[_i]=null,t)),this._streams},set:function(t){this._streams=t}},{key:"hasStats",get:function(){return this._stats!==null}},{key:"hasStreams",get:function(){return this._streams!==null}},{key:"stats",get:function(){return this._stats===null&&(this._stats=new Xe),this._stats},set:function(t){this._stats=t}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=B.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(t){this._url=t}}])}();function Ht(s){return s.sn!=="initSegment"}var ui=function(s){function n(e,i){var r;return(r=s.call(this,i)||this)._decryptdata=null,r._programDateTime=null,r._ref=null,r._bitrate=void 0,r.rawProgramDateTime=null,r.tagList=[],r.duration=0,r.sn=0,r.levelkeys=void 0,r.type=void 0,r.loader=null,r.keyLoader=null,r.level=-1,r.cc=0,r.startPTS=void 0,r.endPTS=void 0,r.startDTS=void 0,r.endDTS=void 0,r.start=0,r.playlistOffset=0,r.deltaPTS=void 0,r.maxStartPTS=void 0,r.minEndPTS=void 0,r.data=void 0,r.bitrateTest=!1,r.title=null,r.initSegment=null,r.endList=void 0,r.gap=void 0,r.urlId=0,r.type=e,r}y(n,s);var t=n.prototype;return t.addStart=function(e){this.setStart(this.start+e)},t.setStart=function(e){this.start=e,this._ref&&(this._ref.start=e)},t.setDuration=function(e){this.duration=e,this._ref&&(this._ref.duration=e)},t.setKeyFormat=function(e){if(this.levelkeys){var i=this.levelkeys[e];i&&!this._decryptdata&&(this._decryptdata=i.getDecryptData(this.sn))}},t.abortRequests=function(){var e,i;(e=this.loader)==null||e.abort(),(i=this.keyLoader)==null||i.abort()},t.setElementaryStreamInfo=function(e,i,r,a,o,l){l===void 0&&(l=!1);var h=this.elementaryStreams,u=h[e];u?(u.startPTS=Math.min(u.startPTS,i),u.endPTS=Math.max(u.endPTS,r),u.startDTS=Math.min(u.startDTS,a),u.endDTS=Math.max(u.endDTS,o)):h[e]={startPTS:i,endPTS:r,startDTS:a,endDTS:o,partial:l}},g(n,[{key:"byteLength",get:function(){if(this.hasStats){var e=this.stats.total;if(e)return e}if(this.byteRange){var i=this.byteRange[0],r=this.byteRange[1];if(x(i)&&x(r))return r-i}return null}},{key:"bitrate",get:function(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null},set:function(e){this._bitrate=e}},{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{var i=Object.keys(this.levelkeys);if(i.length===1)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null)return null;var e=x(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var i=Object.keys(this.levelkeys),r=i.length;if(r>1||r===1&&this.levelkeys[i[0]].encrypted)return!0}return!1}},{key:"programDateTime",get:function(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime},set:function(e){x(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null}},{key:"ref",get:function(){return Ht(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}}])}(Si),Oi=function(s){function n(t,e,i,r,a){var o;(o=s.call(this,i)||this).fragOffset=0,o.duration=0,o.gap=!1,o.independent=!1,o.relurl=void 0,o.fragment=void 0,o.index=void 0,o.duration=t.decimalFloatingPoint("DURATION"),o.gap=t.bool("GAP"),o.independent=t.bool("INDEPENDENT"),o.relurl=t.enumeratedString("URI"),o.fragment=e,o.index=r;var l=t.enumeratedString("BYTERANGE");return l&&o.setByteRange(l,a),a&&(o.fragOffset=a.fragOffset+a.duration),o}return y(n,s),g(n,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var t=this.elementaryStreams;return!!(t.audio||t.video||t.audiovideo)}}])}(Si);function zi(s,n){var t=Object.getPrototypeOf(s);if(t){var e=Object.getOwnPropertyDescriptor(t,n);return e||zi(t,n)}}var Ai=Math.pow(2,32)-1,Pi=[].push,nr={video:1,audio:2,id3:3,text:4};function Yt(s){return String.fromCharCode.apply(null,s)}function sr(s,n){var t=s[n]<<8|s[n+1];return t<0?65536+t:t}function it(s,n){var t=lr(s,n);return t<0?4294967296+t:t}function or(s,n){var t=it(s,n);return t*=Math.pow(2,32),t+=it(s,n+4)}function lr(s,n){return s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]}function Xi(s,n,t){s[n]=t>>24,s[n+1]=t>>16&255,s[n+2]=t>>8&255,s[n+3]=255&t}function lt(s,n){var t=[];if(!n.length)return t;for(var e=s.byteLength,i=0;i<e;){var r=it(s,i),a=r>1?i+r:e;if(Yt(s.subarray(i+4,i+8))===n[0])if(n.length===1)t.push(s.subarray(i+8,a));else{var o=lt(s.subarray(i+8,a),n.slice(1));o.length&&Pi.apply(t,o)}i=a}return t}function Ar(s){var n=[],t=s[0],e=8,i=it(s,e);e+=4;var r=0,a=0;t===0?(r=it(s,e),a=it(s,e+4),e+=8):(r=or(s,e),a=or(s,e+8),e+=16),e+=2;var o=s.length+a,l=sr(s,e);e+=2;for(var h=0;h<l;h++){var u=e,A=it(s,u);u+=4;var M=2147483647&A;if((2147483648&A)>>>31==1)return Ze.warn("SIDX has hierarchical references (not supported)"),null;var T=it(s,u);u+=4,n.push({referenceSize:M,subsegmentDuration:T,info:{duration:T/i,start:o,end:o+M-1}}),o+=M,e=u+=4}return{earliestPresentationTime:r,timescale:i,version:t,referencesCount:l,references:n}}function dr(s){for(var n=[],t=lt(s,["moov","trak"]),e=0;e<t.length;e++){var i=t[e],r=lt(i,["tkhd"])[0];if(r){var a=r[0],o=it(r,a===0?12:20),l=lt(i,["mdia","mdhd"])[0];if(l){var h=it(l,(a=l[0])===0?12:20),u=lt(i,["mdia","hdlr"])[0];if(u){var A=Yt(u.subarray(8,12)),M={soun:Jt,vide:Bt}[A],T=Tr(lt(i,["mdia","minf","stbl","stsd"])[0]);M?(n[o]={timescale:h,type:M,stsd:T},n[M]=E({timescale:h,id:o},T)):n[o]={timescale:h,type:A,stsd:T}}}}}return lt(s,["moov","mvex","trex"]).forEach(function(P){var U=it(P,4),G=n[U];G&&(G.default={duration:it(P,12),flags:it(P,20)})}),n}function Tr(s){var n,t=s.subarray(8),e=t.subarray(86),i=Yt(t.subarray(4,8)),r=i,a=i==="enca"||i==="encv";if(a){var o=lt(t,[i])[0];lt(o.subarray(i==="enca"?28:78),["sinf"]).forEach(function(yt){var ft=lt(yt,["schm"])[0];if(ft){var gt=Yt(ft.subarray(4,8));if(gt==="cbcs"||gt==="cenc"){var nt=lt(yt,["frma"])[0];nt&&(r=Yt(nt))}}})}var l=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":var h=lt(e,["avcC"])[0];h&&h.length>3&&(r+="."+ur(h[1])+ur(h[2])+ur(h[3]),n=Hi(l==="avc1"?"dva1":"dvav",e));break;case"mp4a":var u=lt(t,[i])[0],A=lt(u.subarray(28),["esds"])[0];if(A&&A.length>7){var M=4;if(A[M++]!==3)break;M=ht(A,M),M+=2;var T=A[M++];if(128&T&&(M+=2),64&T&&(M+=A[M++]),A[M++]!==4)break;M=ht(A,M);var P=A[M++];if(P!==64||(r+="."+ur(P),M+=12,A[M++]!==5))break;M=ht(A,M);var U=A[M++],G=(248&U)>>3;G===31&&(G+=1+((7&U)<<3)+((224&A[M])>>5)),r+="."+G}break;case"hvc1":case"hev1":var $=lt(e,["hvcC"])[0];if($&&$.length>12){var te=$[1],se=["","A","B","C"][te>>6],pe=31&te,ye=it($,2),he=(32&te)>>5?"H":"L",ge=$[12],Ae=$.subarray(6,12);r+="."+se+pe,r+="."+function(yt){for(var ft=0,gt=0;gt<32;gt++)ft|=(yt>>gt&1)<<31-gt;return ft>>>0}(ye).toString(16).toUpperCase(),r+="."+he+ge;for(var Te="",Ee=Ae.length;Ee--;){var xe=Ae[Ee];(xe||Te)&&(Te="."+xe.toString(16).toUpperCase()+Te)}r+=Te}n=Hi(l=="hev1"?"dvhe":"dvh1",e);break;case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":r=Hi(r,e)||r;break;case"vp09":var Pe=lt(e,["vpcC"])[0];if(Pe&&Pe.length>6){var ze=Pe[4],Fe=Pe[5],Me=Pe[6]>>4&15;r+="."+yi(ze)+"."+yi(Fe)+"."+yi(Me)}break;case"av01":var De=lt(e,["av1C"])[0];if(De&&De.length>2){var je=De[1]>>>5,Ye=31&De[1],ot=De[2]>>>7?"H":"M",qe=(64&De[2])>>6,Lt=(32&De[2])>>5,It=je===2&&qe?Lt?12:10:qe?10:8,mt=(16&De[2])>>4,At=(8&De[2])>>3,Ct=(4&De[2])>>2,bt=3&De[2];r+="."+je+"."+yi(Ye)+ot+"."+yi(It)+"."+mt+"."+At+Ct+bt+"."+yi(1)+"."+yi(1)+"."+yi(1)+".0",n=Hi("dav1",e)}}return{codec:r,encrypted:a,supplemental:n}}function Hi(s,n){var t=lt(n,["dvvC"]),e=t.length?t[0]:lt(n,["dvcC"])[0];if(e){var i=e[2]>>1&127,r=e[2]<<5&32|e[3]>>3&31;return s+"."+yi(i)+"."+yi(r)}}function ht(s,n){for(var t=n+5;128&s[n++]&&n<t;);return n}function ur(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function yi(s){return(s<10?"0":"")+s}function sa(s,n){if(!s||!n)return s;var t=n.keyId;return t&&n.isCommonEncryption&&lt(s,["moov","trak"]).forEach(function(e){var i=lt(e,["mdia","minf","stbl","stsd"])[0].subarray(8),r=lt(i,["enca"]),a=r.length>0;a||(r=lt(i,["encv"])),r.forEach(function(o){lt(a?o.subarray(28):o.subarray(78),["sinf"]).forEach(function(l){var h=function(A){var M=lt(A,["schm"])[0];if(M){var T=Yt(M.subarray(4,8));if(T==="cbcs"||T==="cenc")return lt(A,["schi","tenc"])[0]}return null}(l);if(h){var u=h.subarray(8,24);u.some(function(A){return A!==0})||(Ze.log("[eme] Patching keyId in 'enc"+(a?"a":"v")+">sinf>>tenc' box: "+ri(u)+" -> "+ri(t)),h.set(t,8))}})})}),s}function mi(s,n){var t=new Uint8Array(s.length+n.length);return t.set(s),t.set(n,s.length),t}function Di(s,n){var t=[],e=n.samples,i=n.timescale,r=n.id,a=!1;return lt(e,["moof"]).map(function(o){var l=o.byteOffset-8;lt(o,["traf"]).map(function(h){var u=lt(h,["tfdt"]).map(function(A){var M=A[0],T=it(A,4);return M===1&&(T*=Math.pow(2,32),T+=it(A,8)),T/i})[0];return u!==void 0&&(s=u),lt(h,["tfhd"]).map(function(A){var M=it(A,4),T=16777215&it(A,0),P=0,U=(16&T)!=0,G=0,$=(32&T)!=0,te=8;M===r&&(1&T&&(te+=8),2&T&&(te+=4),8&T&&(P=it(A,te),te+=4),U&&(G=it(A,te),te+=4),$&&(te+=4),n.type==="video"&&(a=cr(n.codec)),lt(h,["trun"]).map(function(se){var pe=se[0],ye=16777215&it(se,0),he=(1&ye)!=0,ge=0,Ae=(4&ye)!=0,Te=(256&ye)!=0,Ee=0,xe=(512&ye)!=0,Pe=0,ze=(1024&ye)!=0,Fe=(2048&ye)!=0,Me=0,De=it(se,4),je=8;he&&(ge=it(se,je),je+=4),Ae&&(je+=4);for(var Ye=ge+l,ot=0;ot<De;ot++){if(Te?(Ee=it(se,je),je+=4):Ee=P,xe?(Pe=it(se,je),je+=4):Pe=G,ze&&(je+=4),Fe&&(Me=pe===0?it(se,je):lr(se,je),je+=4),n.type===Bt)for(var qe=0;qe<Pe;){var Lt=it(e,Ye);Ur(a,e[Ye+=4])&&Lr(e.subarray(Ye,Ye+Lt),a?2:1,s+Me/i,t),Ye+=Lt,qe+=Lt+4}s+=Ee/i}}))})})}),t}function cr(s){if(!s)return!1;var n=s.substring(0,4);return n==="hvc1"||n==="hev1"||n==="dvh1"||n==="dvhe"}function Ur(s,n){if(s){var t=n>>1&63;return t===39||t===40}return(31&n)==6}function Lr(s,n,t,e){var i=Ni(s),r=0;r+=n;for(var a=0,o=0,l=0;r<i.length;){a=0;do{if(r>=i.length)break;a+=l=i[r++]}while(l===255);o=0;do{if(r>=i.length)break;o+=l=i[r++]}while(l===255);var h=i.length-r,u=r;if(o<h)r+=o;else if(o>h){Ze.error("Malformed SEI payload. "+o+" is too small, only "+h+" bytes left to parse.");break}if(a===4){if(i[u++]===181){var A=sr(i,u);if(u+=2,A===49){var M=it(i,u);if(u+=4,M===1195456820){var T=i[u++];if(T===3){var P=i[u++],U=64&P,G=U?2+3*(31&P):0,$=new Uint8Array(G);if(U){$[0]=P;for(var te=1;te<G;te++)$[te]=i[u++]}e.push({type:T,payloadType:a,pts:t,bytes:$})}}}}}else if(a===5&&o>16){for(var se=[],pe=0;pe<16;pe++){var ye=i[u++].toString(16);se.push(ye.length==1?"0"+ye:ye),pe!==3&&pe!==5&&pe!==7&&pe!==9||se.push("-")}for(var he=o-16,ge=new Uint8Array(he),Ae=0;Ae<he;Ae++)ge[Ae]=i[u++];e.push({payloadType:a,pts:t,uuid:se.join(""),userData:ct(ge),userDataBytes:ge})}}}function Ni(s){for(var n=s.byteLength,t=[],e=1;e<n-2;)s[e]===0&&s[e+1]===0&&s[e+2]===3?(t.push(e+2),e+=2):e++;if(t.length===0)return s;var i=n-t.length,r=new Uint8Array(i),a=0;for(e=0;e<i;a++,e++)a===t[0]&&(a++,t.shift()),r[e]=s[a];return r}function Ti(s){if(s===void 0&&(s=!0),typeof self<"u")return(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}var bi=function(){return/\(Windows.+Firefox\//i.test(navigator.userAgent)},Fi={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function jr(s,n){var t=Fi[n];return!!t&&!!t[s.slice(0,4)]}function Gt(s,n,t){return t===void 0&&(t=!0),!s.split(",").some(function(e){return!Vr(e,n,t)})}function Vr(s,n,t){var e;t===void 0&&(t=!0);var i=Ti(t);return(e=i==null?void 0:i.isTypeSupported(v(s,n)))!=null&&e}function v(s,n){return n+"/mp4;codecs="+s}function f(s){if(s){var n=s.substring(0,4);return Fi.video[n]}return 2}function c(s){var n=bi();return s.split(",").reduce(function(t,e){var i=n&&cr(e)?9:Fi.video[e];return i?(2*i+t)/(t?3:2):(Fi.audio[e]+t)/(t?2:1)},0)}var d={},S=/flac|opus|mp4a\.40\.34/i;function O(s,n){return n===void 0&&(n=!0),s.replace(S,function(t){return function(e,i){if(i===void 0&&(i=!0),d[e])return d[e];for(var r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e],a=0;a<r.length;a++){var o;if(Vr(r[a],"audio",i))return d[e]=r[a],r[a];if(r[a]==="mp3"&&(o=Ti(i))!=null&&o.isTypeSupported("audio/mpeg"))return""}return e}(t.toLowerCase(),n)})}function C(s,n){if(s&&(s.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(s)!==-1))return s;if(n){var t=n.split(",");if(t.length>1){if(s){for(var e=t.length;e--;)if(t[e].substring(0,4)===s.substring(0,4))return t[e]}return t[0]}}return n||s}function V(s){if(s.startsWith("av01.")){for(var n=s.split("."),t=["0","111","01","01","01","0"],e=n.length;e>4&&e<10;e++)n[e]=t[e-4];return n.join(".")}return s}function X(s){var n=Ti(s)||{isTypeSupported:function(){return!1}};return{mpeg:n.isTypeSupported("audio/mpeg"),mp3:n.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:!1}}function Z(s){return s.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}var ne=["NONE","TYPE-0","TYPE-1",null],ce=["SDR","PQ","HLG"],ue="",me="YES",Se="v2";function ke(s){var n=s.canSkipUntil,t=s.canSkipDateRanges,e=s.age;return n&&e<n/2?t?Se:me:ue}var we=function(){function s(n,t,e){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=n,this.part=t,this.skip=e}return s.prototype.addDirectives=function(n){var t=new self.URL(n);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href},s}(),Ve=function(){function s(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(function(r){return!!r}).map(function(r){return r.substring(0,4)}).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;var i=(e=t.supplemental)==null?void 0:e.videoCodec;i&&i!==t.videoCodec&&(this.codecSet+=","+i.substring(0,4))}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}var n=s.prototype;return n.hasAudioGroup=function(t){return Ne(this._audioGroups,t)},n.hasSubtitleGroup=function(t){return Ne(this._subtitleGroups,t)},n.addGroupId=function(t,e){if(e){if(t==="audio"){var i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(e)===-1&&i.push(e)}else if(t==="text"){var r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(e)===-1&&r.push(e)}}},n.addFallback=function(){},g(s,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"averageBitrate",get:function(){return this._avgBitrate||this.realBitrate||this.bitrate}},{key:"attrs",get:function(){return this._attrs[0]}},{key:"codecs",get:function(){return this.attrs.CODECS||""}},{key:"pathwayId",get:function(){return this.attrs["PATHWAY-ID"]||"."}},{key:"videoRange",get:function(){return this.attrs["VIDEO-RANGE"]||"SDR"}},{key:"score",get:function(){return this.attrs.optionalFloat("SCORE",0)}},{key:"uri",get:function(){return this.url[0]||""}},{key:"audioGroups",get:function(){return this._audioGroups}},{key:"subtitleGroups",get:function(){return this._subtitleGroups}},{key:"urlId",get:function(){return 0},set:function(t){}},{key:"audioGroupIds",get:function(){return this.audioGroups?[this.audioGroupId]:void 0}},{key:"textGroupIds",get:function(){return this.subtitleGroups?[this.textGroupId]:void 0}},{key:"audioGroupId",get:function(){var t;return(t=this.audioGroups)==null?void 0:t[0]}},{key:"textGroupId",get:function(){var t;return(t=this.subtitleGroups)==null?void 0:t[0]}}])}();function Ne(s,n){return!(!n||!s)&&s.indexOf(n)!==-1}function Ce(s,n){var t=!1,e=[];if(s&&(t=s!=="SDR",e=[s]),n){var i=(e=n.allowedVideoRanges||ce.slice(0)).join("")!=="SDR"&&!n.videoCodec;(t=n.preferHDR!==void 0?n.preferHDR:i&&function(){if(typeof matchMedia=="function"){var r=matchMedia("(dynamic-range: high)"),a=matchMedia("bad query");if(r.media!==a.media)return r.matches===!0}return!1}())||(e=["SDR"])}return{preferHDR:t,allowedVideoRanges:e}}var $e=function(s,n){return JSON.stringify(s,function(t){var e=new WeakSet;return function(i,r){if(t&&(r=t(i,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}}(n))};function tt(s,n){Ze.log('[abr] start candidates with "'+s+'" ignored because '+n)}function Be(s){return s.reduce(function(n,t){var e=n.groups[t.groupId];e||(e=n.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),e.tracks.push(t);var i=t.channels||"2";return e.channels[i]=(e.channels[i]||0)+1,e.hasDefault=e.hasDefault||t.default,e.hasAutoSelect=e.hasAutoSelect||t.autoselect,e.hasDefault&&(n.hasDefaultAudio=!0),e.hasAutoSelect&&(n.hasAutoSelectAudio=!0),n},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Qe(s,n){var t;return!!s&&s!==((t=n.loadLevelObj)==null?void 0:t.uri)}var dt=function(s){function n(e){var i;return(i=s.call(this,"abr",e.logger)||this).hls=void 0,i.lastLevelLoadSec=0,i.lastLoadedFragLevel=-1,i.firstSelection=-1,i._nextAutoLevel=-1,i.nextAutoLevelKey="",i.audioTracksByGroup=null,i.codecTiers=null,i.timer=-1,i.fragCurrent=null,i.partCurrent=null,i.bitrateTestDelay=0,i.rebufferNotice=-1,i.bwEstimator=void 0,i._abandonRulesCheck=function(r){var a,o=i,l=o.fragCurrent,h=o.partCurrent,u=o.hls,A=u.autoLevelEnabled,M=u.media;if(l&&M){var T=performance.now(),P=h?h.stats:l.stats,U=h?h.duration:l.duration,G=T-P.loading.start,$=u.minAutoLevel,te=l.level,se=i._nextAutoLevel;if(P.aborted||P.loaded&&P.loaded===P.total||te<=$)return i.clearTimer(),void(i._nextAutoLevel=-1);if(A){var pe=se>-1&&se!==te,ye=!!r||pe;if(ye||!M.paused&&M.playbackRate&&M.readyState){var he=u.mainForwardBufferInfo;if(ye||he!==null){var ge=i.bwEstimator.getEstimateTTFB(),Ae=Math.abs(M.playbackRate);if(!(G<=Math.max(ge,U/(2*Ae)*1e3))){var Te=he?he.len/Ae:0,Ee=P.loading.first?P.loading.first-P.loading.start:-1,xe=P.loaded&&Ee>-1,Pe=i.getBwEstimate(),ze=u.levels,Fe=ze[te],Me=Math.max(P.loaded,Math.round(U*(l.bitrate||Fe.averageBitrate)/8)),De=xe?G-Ee:G;De<1&&xe&&(De=Math.min(G,8*P.loaded/Pe));var je=xe?1e3*P.loaded/De:0,Ye=ge/1e3,ot=je?(Me-P.loaded)/je:8*Me/Pe+Ye;if(!(ot<=Te)){var qe,Lt=je?8*je:Pe,It=((a=(r==null?void 0:r.details)||i.hls.latestLevelDetails)==null?void 0:a.live)===!0,mt=i.hls.config.abrBandWidthUpFactor,At=Number.POSITIVE_INFINITY;for(qe=te-1;qe>$;qe--){var Ct=ze[qe].maxBitrate,bt=!ze[qe].details||It;if((At=i.getTimeToLoadFrag(Ye,Lt,U*Ct,bt))<Math.min(Te,U+Ye))break}if(!(At>=ot||At>10*U)){xe?i.bwEstimator.sample(G-Math.min(ge,Ee),P.loaded):i.bwEstimator.sampleTTFB(G);var yt=ze[qe].maxBitrate;i.getBwEstimate()*mt>yt&&i.resetEstimator(yt);var ft=i.findBestLevel(yt,$,qe,0,Te,1,1);ft>-1&&(qe=ft),i.warn("Fragment "+l.sn+(h?" part "+h.index:"")+" of level "+te+" is loading too slowly;\n      Fragment duration: "+l.duration.toFixed(3)+"\n      Time to underbuffer: "+Te.toFixed(3)+" s\n      Estimated load time for current fragment: "+ot.toFixed(3)+" s\n      Estimated load time for down switch fragment: "+At.toFixed(3)+" s\n      TTFB estimate: "+(0|Ee)+" ms\n      Current BW estimate: "+(x(Pe)?0|Pe:"Unknown")+" bps\n      New BW estimate: "+(0|i.getBwEstimate())+" bps\n      Switching to level "+qe+" @ "+(0|yt)+" bps"),u.nextLoadLevel=u.nextAutoLevel=qe,i.clearTimer();var gt=function(){if(i.clearTimer(),i.fragCurrent===l&&i.hls.loadLevel===qe&&qe>0){var nt=i.getStarvationDelay();if(i.warn("Aborting inflight request "+(qe>0?"and switching down":"")+"\n      Fragment duration: "+l.duration.toFixed(3)+" s\n      Time to underbuffer: "+nt.toFixed(3)+" s"),l.abortRequests(),i.fragCurrent=i.partCurrent=null,qe>$){var pt=i.findBestLevel(i.hls.levels[$].bitrate,$,qe,0,nt,1,1);pt===-1&&(pt=$),i.hls.nextLoadLevel=i.hls.nextAutoLevel=pt,i.resetEstimator(i.hls.levels[pt].bitrate)}}};pe||ot>2*At?gt():i.timer=self.setInterval(gt,1e3*At),u.trigger(k.FRAG_LOAD_EMERGENCY_ABORTED,{frag:l,part:h,stats:P})}}}}}}}},i.hls=e,i.bwEstimator=i.initEstimator(),i.registerListeners(),i}y(n,s);var t=n.prototype;return t.resetEstimator=function(e){e&&(this.log("setting initial bwe to "+e),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()},t.initEstimator=function(){var e=this.hls.config;return new Ie(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)},t.registerListeners=function(){var e=this.hls;e.on(k.MANIFEST_LOADING,this.onManifestLoading,this),e.on(k.FRAG_LOADING,this.onFragLoading,this),e.on(k.FRAG_LOADED,this.onFragLoaded,this),e.on(k.FRAG_BUFFERED,this.onFragBuffered,this),e.on(k.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(k.LEVEL_LOADED,this.onLevelLoaded,this),e.on(k.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(k.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(k.ERROR,this.onError,this)},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(k.MANIFEST_LOADING,this.onManifestLoading,this),e.off(k.FRAG_LOADING,this.onFragLoading,this),e.off(k.FRAG_LOADED,this.onFragLoaded,this),e.off(k.FRAG_BUFFERED,this.onFragBuffered,this),e.off(k.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(k.LEVEL_LOADED,this.onLevelLoaded,this),e.off(k.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(k.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(k.ERROR,this.onError,this))},t.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null},t.onManifestLoading=function(e,i){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()},t.onLevelsUpdated=function(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null},t.onMaxAutoLevelUpdated=function(){this.firstSelection=-1,this.nextAutoLevelKey=""},t.onFragLoading=function(e,i){var r,a=i.frag;this.ignoreFragment(a)||(a.bitrateTest||(this.fragCurrent=a,this.partCurrent=(r=i.part)!=null?r:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100))},t.onLevelSwitching=function(e,i){this.clearTimer()},t.onError=function(e,i){if(!i.fatal)switch(i.details){case K.BUFFER_ADD_CODEC_ERROR:case K.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case K.FRAG_LOAD_TIMEOUT:var r=i.frag,a=this.fragCurrent,o=this.partCurrent;if(r&&a&&r.sn===a.sn&&r.level===a.level){var l=performance.now(),h=o?o.stats:r.stats,u=l-h.loading.start,A=h.loading.first?h.loading.first-h.loading.start:-1;if(h.loaded&&A>-1){var M=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(u-Math.min(M,A),h.loaded)}else this.bwEstimator.sampleTTFB(u)}}},t.getTimeToLoadFrag=function(e,i,r,a){return e+r/i+(a?e+this.lastLevelLoadSec:0)},t.onLevelLoaded=function(e,i){var r=this.hls.config,a=i.stats.loading,o=a.end-a.first;x(o)&&(this.lastLevelLoadSec=o/1e3),i.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(i.levelInfo)},t.onFragLoaded=function(e,i){var r=i.frag,a=i.part,o=a?a.stats:r.stats;if(r.type===q&&this.bwEstimator.sampleTTFB(o.loading.first-o.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),r.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){var l=a?a.duration:r.duration,h=this.hls.levels[r.level],u=(h.loaded?h.loaded.bytes:0)+o.loaded,A=(h.loaded?h.loaded.duration:0)+l;h.loaded={bytes:u,duration:A},h.realBitrate=Math.round(8*u/A)}if(r.bitrateTest){var M={stats:o,frag:r,part:a,id:r.type};this.onFragBuffered(k.FRAG_BUFFERED,M),r.bitrateTest=!1}else this.lastLoadedFragLevel=r.level}},t.onFragBuffered=function(e,i){var r=i.frag,a=i.part,o=a!=null&&a.stats.loaded?a.stats:r.stats;if(!o.aborted&&!this.ignoreFragment(r)){var l=o.parsing.end-o.loading.start-Math.min(o.loading.first-o.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(l,o.loaded),o.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}},t.ignoreFragment=function(e){return e.type!==q||e.sn==="initSegment"},t.clearTimer=function(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)},t.getAutoLevelKey=function(){return this.getBwEstimate()+"_"+this.getStarvationDelay().toFixed(2)},t.getNextABRAutoLevel=function(){var e=this.fragCurrent,i=this.partCurrent,r=this.hls;if(r.levels.length<=1)return r.loadLevel;var a=r.maxAutoLevel,o=r.config,l=r.minAutoLevel,h=i?i.duration:e?e.duration:0,u=this.getBwEstimate(),A=this.getStarvationDelay(),M=o.abrBandWidthFactor,T=o.abrBandWidthUpFactor;if(A){var P=this.findBestLevel(u,l,a,A,0,M,T);if(P>=0)return this.rebufferNotice=-1,P}var U=h?Math.min(h,o.maxStarvationDelay):o.maxStarvationDelay;if(!A){var G=this.bitrateTestDelay;G&&(U=(h?Math.min(h,o.maxLoadingDelay):o.maxLoadingDelay)-G,this.info("bitrate test took "+Math.round(1e3*G)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*U)+" ms"),M=T=1)}var $=this.findBestLevel(u,l,a,A,U,M,T);if(this.rebufferNotice!==$&&(this.rebufferNotice=$,this.info((A?"rebuffering expected":"buffer is empty")+", optimal quality level "+$)),$>-1)return $;var te=r.levels[l],se=r.loadLevelObj;return se&&(te==null?void 0:te.bitrate)<se.bitrate?l:r.loadLevel},t.getStarvationDelay=function(){var e=this.hls,i=e.media;if(!i)return 1/0;var r=i&&i.playbackRate!==0?Math.abs(i.playbackRate):1,a=e.mainForwardBufferInfo;return(a?a.len:0)/r},t.getBwEstimate=function(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate},t.findBestLevel=function(e,i,r,a,o,l,h){var u,A=this,M=a+o,T=this.lastLoadedFragLevel,P=T===-1?this.hls.firstLevel:T,U=this.fragCurrent,G=this.partCurrent,$=this.hls,te=$.levels,se=$.allAudioTracks,pe=$.loadLevel,ye=$.config;if(te.length===1)return 0;var he,ge=te[P],Ae=!((u=this.hls.latestLevelDetails)==null||!u.live),Te=pe===-1||T===-1,Ee="SDR",xe=(ge==null?void 0:ge.frameRate)||0,Pe=ye.audioPreference,ze=ye.videoPreference,Fe=(this.audioTracksByGroup||(this.audioTracksByGroup=Be(se)),-1);if(Te){if(this.firstSelection!==-1)return this.firstSelection;var Me=this.codecTiers||(this.codecTiers=function(gt,nt,pt,Mt){return gt.slice(pt,Mt+1).reduce(function(Rt,Dt,Ot){if(!Dt.codecSet)return Rt;var wt=Dt.audioGroups,St=Rt[Dt.codecSet];St||(Rt[Dt.codecSet]=St={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:Ot,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!wt,fragmentError:0}),St.minBitrate=Math.min(St.minBitrate,Dt.bitrate);var ci=Math.min(Dt.height,Dt.width);return St.minHeight=Math.min(St.minHeight,ci),St.minFramerate=Math.min(St.minFramerate,Dt.frameRate),St.minIndex=Math.min(St.minIndex,Ot),St.maxScore=Math.max(St.maxScore,Dt.score),St.fragmentError+=Dt.fragmentError,St.videoRanges[Dt.videoRange]=(St.videoRanges[Dt.videoRange]||0)+1,Rt},{})}(te,0,i,r)),De=function(gt,nt,pt,Mt,Rt){for(var Dt=Object.keys(gt),Ot=Mt==null?void 0:Mt.channels,wt=Mt==null?void 0:Mt.audioCodec,St=Rt==null?void 0:Rt.videoCodec,ci=Ot&&parseInt(Ot)===2,li=!1,ni=!1,di=1/0,jt=1/0,Zt=1/0,pi=1/0,Ki=0,wi=[],rr=Ce(nt,Rt),Qi=rr.preferHDR,Sr=rr.allowedVideoRanges,ar=function(){var Pt=gt[Dt[Kt]];li||(li=Pt.channels[2]>0),di=Math.min(di,Pt.minHeight),jt=Math.min(jt,Pt.minFramerate),Zt=Math.min(Zt,Pt.minBitrate),Sr.filter(function(Vt){return Pt.videoRanges[Vt]>0}).length>0&&(ni=!0)},Kt=Dt.length;Kt--;)ar();di=x(di)?di:0,jt=x(jt)?jt:0;var ti=Math.max(1080,di),Zi=Math.max(30,jt);Zt=x(Zt)?Zt:pt,pt=Math.max(Zt,pt),ni||(nt=void 0);var Ii=Dt.length>1;return{codecSet:Dt.reduce(function(Pt,Vt){var Nt=gt[Vt];if(Vt===Pt)return Pt;if(wi=ni?Sr.filter(function(Ci){return Nt.videoRanges[Ci]>0}):[],Ii){if(Nt.minBitrate>pt)return tt(Vt,"min bitrate of "+Nt.minBitrate+" > current estimate of "+pt),Pt;if(!Nt.hasDefaultAudio)return tt(Vt,"no renditions with default or auto-select sound found"),Pt;if(wt&&Vt.indexOf(wt.substring(0,4))%5!=0)return tt(Vt,'audio codec preference "'+wt+'" not found'),Pt;if(Ot&&!ci){if(!Nt.channels[Ot])return tt(Vt,"no renditions with "+Ot+" channel sound found (channels options: "+Object.keys(Nt.channels)+")"),Pt}else if((!wt||ci)&&li&&Nt.channels[2]===0)return tt(Vt,"no renditions with stereo sound found"),Pt;if(Nt.minHeight>ti)return tt(Vt,"min resolution of "+Nt.minHeight+" > maximum of "+ti),Pt;if(Nt.minFramerate>Zi)return tt(Vt,"min framerate of "+Nt.minFramerate+" > maximum of "+Zi),Pt;if(!wi.some(function(Ci){return Nt.videoRanges[Ci]>0}))return tt(Vt,"no variants with VIDEO-RANGE of "+$e(wi)+" found"),Pt;if(St&&Vt.indexOf(St.substring(0,4))%5!=0)return tt(Vt,'video codec preference "'+St+'" not found'),Pt;if(Nt.maxScore<Ki)return tt(Vt,"max score of "+Nt.maxScore+" < selected max of "+Ki),Pt}return Pt&&(c(Vt)>=c(Pt)||Nt.fragmentError>gt[Pt].fragmentError)?Pt:(pi=Nt.minIndex,Ki=Nt.maxScore,Vt)},void 0),videoRanges:wi,preferHDR:Qi,minFramerate:jt,minBitrate:Zt,minIndex:pi}}(Me,Ee,e,Pe,ze),je=De.codecSet,Ye=De.videoRanges,ot=De.minFramerate,qe=De.minBitrate,Lt=De.minIndex,It=De.preferHDR;Fe=Lt,he=je,Ee=It?Ye[Ye.length-1]:Ye[0],xe=ot,e=Math.max(e,qe),this.log("picked start tier "+$e(De))}else he=ge==null?void 0:ge.codecSet,Ee=ge==null?void 0:ge.videoRange;for(var mt,At=G?G.duration:U?U.duration:0,Ct=this.bwEstimator.getEstimateTTFB()/1e3,bt=[],yt=function(){var gt,nt=te[ft],pt=ft>P;if(!nt)return 0;if((he&&nt.codecSet!==he||Ee&&nt.videoRange!==Ee||pt&&xe>nt.frameRate||!pt&&xe>0&&xe<nt.frameRate||nt.supportedResult&&((gt=nt.supportedResult.decodingInfoResults)==null||!gt[0].smooth))&&(!Te||ft!==Fe))return bt.push(ft),0;var Mt,Rt=nt.details,Dt=(G?Rt==null?void 0:Rt.partTarget:Rt==null?void 0:Rt.averagetargetduration)||At;Mt=pt?h*e:l*e;var Ot=At&&a>=2*At&&o===0?nt.averageBitrate:nt.maxBitrate,wt=A.getTimeToLoadFrag(Ct,Mt,Ot*Dt,Rt===void 0);if(Mt>=Ot&&(ft===T||nt.loadError===0&&nt.fragmentError===0)&&(wt<=Ct||!x(wt)||Ae&&!A.bitrateTestDelay||wt<M)){var St=A.forcedAutoLevel;return ft===pe||St!==-1&&St===pe||(bt.length&&A.trace("Skipped level(s) "+bt.join(",")+" of "+r+' max with CODECS and VIDEO-RANGE:"'+te[bt[0]].codecs+'" '+te[bt[0]].videoRange+'; not compatible with "'+he+'" '+Ee),A.info("switch candidate:"+P+"->"+ft+" adjustedbw("+Math.round(Mt)+")-bitrate="+Math.round(Mt-Ot)+" ttfb:"+Ct.toFixed(1)+" avgDuration:"+Dt.toFixed(1)+" maxFetchDuration:"+M.toFixed(1)+" fetchDuration:"+wt.toFixed(1)+" firstSelection:"+Te+" codecSet:"+nt.codecSet+" videoRange:"+nt.videoRange+" hls.loadLevel:"+pe)),Te&&(A.firstSelection=ft),{v:ft}}},ft=r;ft>=i;ft--)if((mt=yt())!==0&&mt)return mt.v;return-1},t.deriveNextAutoLevel=function(e){var i=this.hls,r=i.maxAutoLevel,a=i.minAutoLevel;return Math.min(Math.max(e,a),r)},g(n,[{key:"firstAutoLevel",get:function(){var e=this.hls,i=e.maxAutoLevel,r=e.minAutoLevel,a=this.getBwEstimate(),o=this.hls.config.maxStarvationDelay,l=this.findBestLevel(a,r,i,0,o,1,1);if(l>-1)return l;var h=this.hls.firstLevel,u=Math.min(Math.max(h,r),i);return this.warn("Could not find best starting auto level. Defaulting to first in playlist "+h+" clamped to "+u),u}},{key:"forcedAutoLevel",get:function(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}},{key:"nextAutoLevel",get:function(){var e=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(!(e===-1||i&&r&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return e;var a=i&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){var o=this.hls.levels;if(o.length>Math.max(e,a)&&o[e].loadError<=o[a].loadError)return e}return this._nextAutoLevel=a,this.nextAutoLevelKey=this.getAutoLevelKey(),a},set:function(e){var i=this.deriveNextAutoLevel(e);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}}])}(Oe),Je=function(){function s(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}var n=s.prototype;return n.destroy=function(){this.tracks=this.queues=null},n.append=function(t,e,i){if(this.queues!==null&&this.tracks!==null){var r=this.queues[e];r.push(t),r.length!==1||i||this.executeNext(e)}},n.appendBlocker=function(t){var e=this;return new Promise(function(i){var r={label:"async-blocker",execute:i,onStart:function(){},onComplete:function(){},onError:function(){}};e.append(r,t)})},n.prependBlocker=function(t){var e=this;return new Promise(function(i){if(e.queues){var r={label:"async-blocker-prepend",execute:i,onStart:function(){},onComplete:function(){},onError:function(){}};e.queues[t].unshift(r)}})},n.removeBlockers=function(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(function(t){var e,i=(e=t[0])==null?void 0:e.label;i!=="async-blocker"&&i!=="async-blocker-prepend"||(t[0].execute(),t.splice(0,1))})},n.unblockAudio=function(t){this.queues!==null&&this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")},n.executeNext=function(t){if(this.queues!==null&&this.tracks!==null){var e=this.queues[t];if(e.length){var i=e[0];try{i.execute()}catch(o){var r;if(i.onError(o),this.queues===null||this.tracks===null)return;var a=(r=this.tracks[t])==null?void 0:r.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(t)}}}},n.shiftAndExecuteNext=function(t){this.queues!==null&&(this.queues[t].shift(),this.executeNext(t))},n.current=function(t){var e;return((e=this.queues)==null?void 0:e[t][0])||null},n.toString=function(){var t=this.queues,e=this.tracks;return t===null||e===null?"<destroyed>":"\n"+this.list("video")+"\n"+this.list("audio")+"\n"+this.list("audiovideo")+"}"},n.list=function(t){var e,i;return(e=this.queues)!=null&&e[t]||(i=this.tracks)!=null&&i[t]?t+": ("+this.listSbInfo(t)+") "+this.listOps(t):""},n.listSbInfo=function(t){var e,i=(e=this.tracks)==null?void 0:e[t],r=i==null?void 0:i.buffer;return r?"SourceBuffer"+(r.updating?" updating":"")+(i.ended?" ended":"")+(i.ending?" ending":""):"none"},n.listOps=function(t){var e;return((e=this.queues)==null?void 0:e[t].map(function(i){return i.label}).join(", "))||""},s}(),rt=function(s,n){for(var t=0,e=s.length-1,i=null,r=null;t<=e;){var a=n(r=s[i=(t+e)/2|0]);if(a>0)t=i+1;else{if(!(a<0))return r;e=i-1}}return null};function vt(s,n,t,e,i){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=.005);var r=null;if(s){r=n[1+s.sn-n[0].sn]||null;var a=s.endDTS-t;a>0&&a<15e-7&&(t+=15e-7),r&&s.level!==r.level&&r.end<=s.end&&(r=n[2+s.sn-n[0].sn]||null)}else t===0&&n[0].start===0&&(r=n[0]);if(r&&((!s||s.level===r.level)&&Tt(t,e,r)===0||function(l,h,u){if(h&&h.start===0&&h.level<l.level&&(h.endPTS||0)>0){var A=h.tagList.reduce(function(M,T){return T[0]==="INF"&&(M+=parseFloat(T[1])),M},u);return l.start<=A}return!1}(r,s,Math.min(i,e))))return r;var o=rt(n,Tt.bind(null,t,e));return!o||o===s&&r?r:o}function Tt(s,n,t){if(s===void 0&&(s=0),n===void 0&&(n=0),t.start<=s&&t.start+t.duration>s)return 0;var e=Math.min(n,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-e<=s?1:t.start-e>s&&t.start?-1:0}function at(s,n,t){var e=1e3*Math.min(n,t.duration+(t.deltaPTS?t.deltaPTS:0));return(t.endProgramDateTime||0)-e>s}function ut(s){switch(s.details){case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_TIMEOUT:case K.LEVEL_LOAD_TIMEOUT:case K.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function kt(s,n){var t=ut(n);return s.default[(t?"timeout":"error")+"Retry"]}function Ut(s,n){var t=s.backoff==="linear"?1:Math.pow(2,n);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function hi(s){return E(E({},s),{errorRetry:null,timeoutRetry:null})}function qt(s,n,t,e){if(!s)return!1;var i=e==null?void 0:e.code,r=n<s.maxNumRetry&&(function(a){return a===0&&navigator.onLine===!1||!!a&&(a<400||a>499)}(i)||!!t);return s.shouldRetry?s.shouldRetry(s,n,t,e,r):r}var si=0,Ft=2,ei=3,Wt=5,_t=0,fi=1,Ei=2,hr=function(s){function n(e){var i;return(i=s.call(this,"error-controller",e.logger)||this).hls=void 0,i.playlistError=0,i.penalizedRenditions={},i.hls=e,i.registerListeners(),i}y(n,s);var t=n.prototype;return t.registerListeners=function(){var e=this.hls;e.on(k.ERROR,this.onError,this),e.on(k.MANIFEST_LOADING,this.onManifestLoading,this),e.on(k.LEVEL_UPDATED,this.onLevelUpdated,this)},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(k.ERROR,this.onError,this),e.off(k.ERROR,this.onErrorOut,this),e.off(k.MANIFEST_LOADING,this.onManifestLoading,this),e.off(k.LEVEL_UPDATED,this.onLevelUpdated,this))},t.destroy=function(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}},t.startLoad=function(e){},t.stopLoad=function(){this.playlistError=0},t.getVariantLevelIndex=function(e){return(e==null?void 0:e.type)===q?e.level:this.hls.loadLevel},t.onManifestLoading=function(){this.playlistError=0,this.penalizedRenditions={}},t.onLevelUpdated=function(){this.playlistError=0},t.onError=function(e,i){var r;if(!i.fatal){var a=this.hls,o=i.context;switch(i.details){case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:return void(i.errorAction=this.getFragRetryOrSwitchAction(i));case K.FRAG_PARSING_ERROR:if((r=i.frag)!=null&&r.gap)return void(i.errorAction=Ji());case K.FRAG_GAP:case K.FRAG_DECRYPT_ERROR:return i.errorAction=this.getFragRetryOrSwitchAction(i),void(i.errorAction.action=Ft);case K.LEVEL_EMPTY_ERROR:case K.LEVEL_PARSING_ERROR:var l,h,u=i.parent===q?i.level:a.loadLevel;return void(i.details===K.LEVEL_EMPTY_ERROR&&(l=i.context)!=null&&(h=l.levelDetails)!=null&&h.live?i.errorAction=this.getPlaylistRetryOrSwitchAction(i,u):(i.levelRetry=!1,i.errorAction=this.getLevelSwitchAction(i,u)));case K.LEVEL_LOAD_ERROR:case K.LEVEL_LOAD_TIMEOUT:return void(typeof(o==null?void 0:o.level)=="number"&&(i.errorAction=this.getPlaylistRetryOrSwitchAction(i,o.level)));case K.AUDIO_TRACK_LOAD_ERROR:case K.AUDIO_TRACK_LOAD_TIMEOUT:case K.SUBTITLE_LOAD_ERROR:case K.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){var A=a.loadLevelObj;if(A&&(o.type===ve&&A.hasAudioGroup(o.groupId)||o.type===_e&&A.hasSubtitleGroup(o.groupId)))return i.errorAction=this.getPlaylistRetryOrSwitchAction(i,a.loadLevel),i.errorAction.action=Ft,void(i.errorAction.flags=fi)}return;case K.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var M=a.loadLevelObj,T=M==null?void 0:M.attrs["HDCP-LEVEL"];return void(T?i.errorAction={action:Ft,flags:Ei,hdcpLevel:T}:this.keySystemError(i));case K.BUFFER_ADD_CODEC_ERROR:case K.REMUX_ALLOC_ERROR:case K.BUFFER_APPEND_ERROR:var P;return void(i.errorAction||(i.errorAction=this.getLevelSwitchAction(i,(P=i.level)!=null?P:a.loadLevel)));case K.INTERNAL_EXCEPTION:case K.BUFFER_APPENDING_ERROR:case K.BUFFER_FULL_ERROR:case K.LEVEL_SWITCH_ERROR:case K.BUFFER_STALLED_ERROR:case K.BUFFER_SEEK_OVER_HOLE:case K.BUFFER_NUDGE_ON_STALL:return void(i.errorAction=Ji())}i.type===re.KEY_SYSTEM_ERROR&&this.keySystemError(i)}},t.keySystemError=function(e){var i=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,i)},t.getPlaylistRetryOrSwitchAction=function(e,i){var r=kt(this.hls.config.playlistLoadPolicy,e),a=this.playlistError++;if(qt(r,a,ut(e),e.response))return{action:Wt,flags:_t,retryConfig:r,retryCount:a};var o=this.getLevelSwitchAction(e,i);return r&&(o.retryConfig=r,o.retryCount=a),o},t.getFragRetryOrSwitchAction=function(e){var i=this.hls,r=this.getVariantLevelIndex(e.frag),a=i.levels[r],o=i.config,l=o.fragLoadPolicy,h=o.keyLoadPolicy,u=kt(e.details.startsWith("key")?h:l,e),A=i.levels.reduce(function(T,P){return T+P.fragmentError},0);if(a&&(e.details!==K.FRAG_GAP&&a.fragmentError++,qt(u,A,ut(e),e.response)))return{action:Wt,flags:_t,retryConfig:u,retryCount:A};var M=this.getLevelSwitchAction(e,r);return u&&(M.retryConfig=u,M.retryCount=A),M},t.getLevelSwitchAction=function(e,i){var r=this.hls;i==null&&(i=r.loadLevel);var a=this.hls.levels[i];if(a){var o,l,h=e.details;a.loadError++,h===K.BUFFER_APPEND_ERROR&&a.fragmentError++;var u=-1,A=r.levels,M=r.loadLevel,T=r.minAutoLevel,P=r.maxAutoLevel;r.autoLevelEnabled||r.config.preserveManualLevelOnError||(r.loadLevel=-1);for(var U,G=(o=e.frag)==null?void 0:o.type,$=(G===H&&h===K.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(h===K.BUFFER_ADD_CODEC_ERROR||h===K.BUFFER_APPEND_ERROR))&&A.some(function(Ae){var Te=Ae.audioCodec;return a.audioCodec!==Te}),te=e.sourceBufferName==="video"&&(h===K.BUFFER_ADD_CODEC_ERROR||h===K.BUFFER_APPEND_ERROR)&&A.some(function(Ae){var Te=Ae.codecSet,Ee=Ae.audioCodec;return a.codecSet!==Te&&a.audioCodec===Ee}),se=(l=e.context)!=null?l:{},pe=se.type,ye=se.groupId,he=function(){var Ae=(ge+M)%A.length;if(Ae!==M&&Ae>=T&&Ae<=P&&A[Ae].loadError===0){var Te,Ee,xe=A[Ae];if(h===K.FRAG_GAP&&G===q&&e.frag){var Pe=A[Ae].details;if(Pe){var ze=vt(e.frag,Pe.fragments,e.frag.start);if(ze!=null&&ze.gap)return 0}}else if(pe===ve&&xe.hasAudioGroup(ye)||pe===_e&&xe.hasSubtitleGroup(ye)||G===H&&(Te=a.audioGroups)!=null&&Te.some(function(Fe){return xe.hasAudioGroup(Fe)})||G===le&&(Ee=a.subtitleGroups)!=null&&Ee.some(function(Fe){return xe.hasSubtitleGroup(Fe)})||$&&a.audioCodec===xe.audioCodec||!$&&a.audioCodec!==xe.audioCodec||te&&a.codecSet===xe.codecSet)return 0;return u=Ae,1}},ge=A.length;ge--&&((U=he())===0||U!==1););if(u>-1&&r.loadLevel!==u)return e.levelRetry=!0,this.playlistError=0,{action:Ft,flags:_t,nextAutoLevel:u}}return{action:Ft,flags:fi}},t.onErrorOut=function(e,i){var r;switch((r=i.errorAction)==null?void 0:r.action){case si:break;case Ft:this.sendAlternateToPenaltyBox(i),i.errorAction.resolved||i.details===K.FRAG_GAP?/MediaSource readyState: ended/.test(i.error.message)&&(this.warn('MediaSource ended after "'+i.sourceBufferName+'" sourceBuffer append error. Attempting to recover from media error.'),this.hls.recoverMediaError()):i.fatal=!0}i.fatal&&this.hls.stopLoad()},t.sendAlternateToPenaltyBox=function(e){var i=this.hls,r=e.errorAction;if(r){var a=r.flags,o=r.hdcpLevel,l=r.nextAutoLevel;switch(a){case _t:this.switchLevel(e,l);break;case Ei:o&&(i.maxHdcpLevel=ne[ne.indexOf(o)-1],r.resolved=!0),this.warn('Restricting playback to HDCP-LEVEL of "'+i.maxHdcpLevel+'" or lower')}r.resolved||this.switchLevel(e,l)}},t.switchLevel=function(e,i){if(i!==void 0&&e.errorAction&&(this.warn("switching to level "+i+" after "+e.details),this.hls.nextAutoLevel=i,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===K.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo"))for(var r=Z(e.mimeType),a=this.hls.levels,o=a.length;o--;)a[o][e.sourceBufferName+"Codec"]===r&&this.hls.removeLevel(o)},n}(Oe);function Ji(s){var n={action:si,flags:_t};return s&&(n.resolved=!0),n}var Gr={length:0,start:function(){return 0},end:function(){return 0}},Et=function(){function s(){}return s.isBuffered=function(n,t){if(n){for(var e=s.getBuffered(n),i=e.length;i--;)if(t>=e.start(i)&&t<=e.end(i))return!0}return!1},s.bufferedRanges=function(n){if(n){var t=s.getBuffered(n);return s.timeRangesToArray(t)}return[]},s.timeRangesToArray=function(n){for(var t=[],e=0;e<n.length;e++)t.push({start:n.start(e),end:n.end(e)});return t},s.bufferInfo=function(n,t,e){if(n){var i=s.bufferedRanges(n);if(i.length)return s.bufferedInfo(i,t,e)}return{len:0,start:t,end:t,bufferedIndex:-1}},s.bufferedInfo=function(n,t,e){t=Math.max(0,t),n.length>1&&n.sort(function(G,$){return G.start-$.start||$.end-G.end});var i=-1,r=[];if(e)for(var a=0;a<n.length;a++){t>=n[a].start&&t<=n[a].end&&(i=a);var o=r.length;if(o){var l=r[o-1].end;n[a].start-l<e?n[a].end>l&&(r[o-1].end=n[a].end):r.push(n[a])}else r.push(n[a])}else r=n;for(var h,u=0,A=t,M=t,T=0;T<r.length;T++){var P=r[T].start,U=r[T].end;if(i===-1&&t>=P&&t<=U&&(i=T),t+e>=P&&t<U)A=P,u=(M=U)-t;else if(t+e<P){h=P;break}}return{len:u,start:A||0,end:M||0,nextStart:h,buffered:n,bufferedIndex:i}},s.getBuffered=function(n){try{return n.buffered||Gr}catch(t){return Ze.log("failed to get media.buffered",t),Gr}},s}(),Yi=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,$i="HlsJsTrackRemovedError",zr=function(s){function n(t){var e;return(e=s.call(this,t)||this).name=$i,e}return y(n,s),n}(z(Error)),wr=function(s){function n(e,i){var r,a;return(r=s.call(this,"buffer-controller",e.logger)||this).hls=void 0,r.fragmentTracker=void 0,r.details=null,r._objectUrl=null,r.operationQueue=null,r.bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.lastMpegAudioChunk=null,r.blockedAudioAppend=null,r.lastVideoAppendEnd=0,r.appendSource=void 0,r.transferData=void 0,r.overrides=void 0,r.appendErrors={audio:0,video:0,audiovideo:0},r.tracks={},r.sourceBuffers=[[null,null],[null,null]],r._onEndStreaming=function(o){var l;r.hls&&((l=r.mediaSource)==null?void 0:l.readyState)==="open"&&r.hls.pauseBuffering()},r._onStartStreaming=function(o){r.hls&&r.hls.resumeBuffering()},r._onMediaSourceOpen=function(o){var l=r,h=l.media,u=l.mediaSource;o&&r.log("Media source opened"),h&&u&&(u.removeEventListener("sourceopen",r._onMediaSourceOpen),h.removeEventListener("emptied",r._onMediaEmptied),r.updateDuration(),r.hls.trigger(k.MEDIA_ATTACHED,{media:h,mediaSource:u}),r.mediaSource!==null&&r.checkPendingTracks())},r._onMediaSourceClose=function(){r.log("Media source closed")},r._onMediaSourceEnded=function(){r.log("Media source ended")},r._onMediaEmptied=function(){var o=r,l=o.mediaSrc,h=o._objectUrl;l!==h&&r.error("Media element src was set while attaching MediaSource ("+h+" > "+l+")")},r.hls=e,r.fragmentTracker=i,r.appendSource=(a=Ti(e.config.preferManagedMediaSource),typeof self<"u"&&a===self.ManagedMediaSource),r.initTracks(),r.registerListeners(),r}y(n,s);var t=n.prototype;return t.hasSourceTypes=function(){return Object.keys(this.tracks).length>0},t.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null},t.registerListeners=function(){var e=this.hls;e.on(k.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(k.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(k.MANIFEST_LOADING,this.onManifestLoading,this),e.on(k.MANIFEST_PARSED,this.onManifestParsed,this),e.on(k.BUFFER_RESET,this.onBufferReset,this),e.on(k.BUFFER_APPENDING,this.onBufferAppending,this),e.on(k.BUFFER_CODECS,this.onBufferCodecs,this),e.on(k.BUFFER_EOS,this.onBufferEos,this),e.on(k.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(k.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(k.FRAG_PARSED,this.onFragParsed,this),e.on(k.FRAG_CHANGED,this.onFragChanged,this),e.on(k.ERROR,this.onError,this)},t.unregisterListeners=function(){var e=this.hls;e.off(k.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(k.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(k.MANIFEST_LOADING,this.onManifestLoading,this),e.off(k.MANIFEST_PARSED,this.onManifestParsed,this),e.off(k.BUFFER_RESET,this.onBufferReset,this),e.off(k.BUFFER_APPENDING,this.onBufferAppending,this),e.off(k.BUFFER_CODECS,this.onBufferCodecs,this),e.off(k.BUFFER_EOS,this.onBufferEos,this),e.off(k.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(k.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(k.FRAG_PARSED,this.onFragParsed,this),e.off(k.FRAG_CHANGED,this.onFragChanged,this),e.off(k.ERROR,this.onError,this)},t.transferMedia=function(){var e=this,i=this.media,r=this.mediaSource;if(!i)return null;var a={};if(this.operationQueue){var o=this.isUpdating();o||this.operationQueue.removeBlockers();var l=this.isQueued();(o||l)&&this.warn("Transfering MediaSource with"+(l?" operations in queue":"")+(o?" updating SourceBuffer(s)":"")+" "+this.operationQueue),this.operationQueue.destroy()}var h=this.transferData;return!this.sourceBufferCount&&h&&h.mediaSource===r?D(a,h.tracks):this.sourceBuffers.forEach(function(u){var A=u[0];A&&(a[A]=D({},e.tracks[A]),e.removeBuffer(A)),u[0]=u[1]=null}),{media:i,mediaSource:r,tracks:a}},t.initTracks=function(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0},t.onManifestLoading=function(){this.bufferCodecEventsTotal=0,this.details=null},t.onManifestParsed=function(e,i){var r,a=2;(i.audio&&!i.video||!i.altAudio)&&(a=1),this.bufferCodecEventsTotal=a,this.log(a+" bufferCodec event(s) expected."),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&a&&this.bufferCreated()},t.onMediaAttaching=function(e,i){var r=this.media=i.media,a=Ti(this.appendSource);if(this.transferData=this.overrides=void 0,r&&a){var o=!!i.mediaSource;(o||i.overrides)&&(this.transferData=i,this.overrides=i.overrides);var l=this.mediaSource=i.mediaSource||new a;if(this.assignMediaSource(l),o)this._objectUrl=r.src,this.attachTransferred();else{var h=this._objectUrl=self.URL.createObjectURL(l);if(this.appendSource)try{r.removeAttribute("src");var u=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||u&&l instanceof u,fr(r),function(A,M){var T=self.document.createElement("source");T.type="video/mp4",T.src=M,A.appendChild(T)}(r,h),r.load()}catch(A){r.src=h}else r.src=h}r.addEventListener("emptied",this._onMediaEmptied)}},t.assignMediaSource=function(e){var i,r;this.log((((i=this.transferData)==null?void 0:i.mediaSource)===e?"transferred":"created")+" media source: "+((r=e.constructor)==null?void 0:r.name)),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))},t.attachTransferred=function(){var e=this,i=this.media,r=this.transferData;if(r&&i){var a=this.tracks,o=r.tracks,l=o?Object.keys(o):null,h=l?l.length:0,u=function(){e.media&&e.mediaSourceOpenOrEnded&&e._onMediaSourceOpen()};if(o&&l&&h){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log("attachTransferred: (bufferCodecEventsTotal "+this.bufferCodecEventsTotal+")\nrequired tracks: "+$e(a,function(P,U){return P==="initSegment"?void 0:U})+";\ntransfer tracks: "+$e(o,function(P,U){return P==="initSegment"?void 0:U})+"}"),!function(P,U){var G=Object.keys(P),$=Object.keys(U),te=G.length,se=$.length;return!te||!se||te===se&&!G.some(function(pe){return $.indexOf(pe)===-1})}(o,a)){r.mediaSource=null,r.tracks=void 0;var A=i.currentTime,M=this.details,T=Math.max(A,(M==null?void 0:M.fragments[0].start)||0);return T-A>1?void this.log("attachTransferred: waiting for playback to reach new tracks start time "+A+" -> "+T):(this.warn('attachTransferred: resetting MediaSource for incompatible tracks ("'+Object.keys(o)+'"->"'+Object.keys(a)+'") start time: '+T+" currentTime: "+A),this.onMediaDetaching(k.MEDIA_DETACHING,{}),this.onMediaAttaching(k.MEDIA_ATTACHING,r),void(i.currentTime=T))}this.transferData=void 0,l.forEach(function(P){var U=P,G=o[U];if(G){var $=G.buffer;if($){var te=e.fragmentTracker,se=G.id;if(te.hasFragments(se)||te.hasParts(se)){var pe=Et.getBuffered($);te.detectEvictedFragments(U,pe,se,null,!0)}var ye=Bi(U),he=[U,$];e.sourceBuffers[ye]=he,$.updating&&e.operationQueue&&e.operationQueue.prependBlocker(U),e.trackSourceBuffer(U,G)}}}),u(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),u()}},t.onMediaDetaching=function(e,i){var r=this,a=!!i.transferMedia;this.transferData=this.overrides=void 0;var o=this.media,l=this.mediaSource,h=this._objectUrl;if(l){if(this.log("media source "+(a?"transferring":"detaching")),a)this.sourceBuffers.forEach(function(T){var P=T[0];P&&r.removeBuffer(P)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){var u=l.readyState==="open";try{for(var A=l.sourceBuffers,M=A.length;M--;)u&&A[M].abort(),l.removeSourceBuffer(A[M]);u&&l.endOfStream()}catch(T){this.warn("onMediaDetaching: "+T.message+" while calling endOfStream")}}this.sourceBufferCount&&this.onBufferReset()}l.removeEventListener("sourceopen",this._onMediaSourceOpen),l.removeEventListener("sourceended",this._onMediaSourceEnded),l.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(l.removeEventListener("startstreaming",this._onStartStreaming),l.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}o&&(o.removeEventListener("emptied",this._onMediaEmptied),a||(h&&self.URL.revokeObjectURL(h),this.mediaSrc===h?(o.removeAttribute("src"),this.appendSource&&fr(o),o.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(k.MEDIA_DETACHED,i)},t.onBufferReset=function(){var e=this;this.sourceBuffers.forEach(function(i){var r=i[0];r&&e.resetBuffer(r)}),this.initTracks()},t.resetBuffer=function(e){var i,r=(i=this.tracks[e])==null?void 0:i.buffer;if(this.removeBuffer(e),r)try{var a;(a=this.mediaSource)!=null&&a.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(o){this.warn("onBufferReset "+e,o)}delete this.tracks[e]},t.removeBuffer=function(e){this.removeBufferListeners(e),this.sourceBuffers[Bi(e)]=[null,null];var i=this.tracks[e];i&&(i.buffer=void 0)},t.resetQueue=function(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Je(this.tracks)},t.onBufferCodecs=function(e,i){var r=this,a=this.tracks,o=Object.keys(i);this.log('BUFFER_CODECS: "'+o+'" (current SB count '+this.sourceBufferCount+")");var l="audiovideo"in i&&(a.audio||a.video)||a.audiovideo&&("audio"in i||"video"in i),h=!l&&this.sourceBufferCount&&this.media&&o.some(function(u){return!a[u]});l||h?this.warn('Unsupported transition between "'+Object.keys(a)+'" and "'+o+'" SourceBuffers'):(o.forEach(function(u){var A,M,T,P=i[u],U=P.id,G=P.codec,$=P.levelCodec,te=P.container,se=P.metadata,pe=P.supplemental,ye=a[u],he=(A=r.transferData)==null||(M=A.tracks)==null?void 0:M[u],ge=he!=null&&he.buffer?he:ye,Ae=(ge==null?void 0:ge.pendingCodec)||(ge==null?void 0:ge.codec),Te=ge==null?void 0:ge.levelCodec;ye||(ye=a[u]={buffer:void 0,listeners:[],codec:G,supplemental:pe,container:te,levelCodec:$,metadata:se,id:U});var Ee=C(Ae,Te),xe=Ee==null?void 0:Ee.replace(Yi,"$1"),Pe=C(G,$),ze=(T=Pe)==null?void 0:T.replace(Yi,"$1");Pe&&Ee&&xe!==ze&&(u.slice(0,5)==="audio"&&(Pe=O(Pe,r.appendSource)),r.log("switching codec "+Ae+" to "+Pe),Pe!==(ye.pendingCodec||ye.codec)&&(ye.pendingCodec=Pe),ye.container=te,r.appendChangeType(u,te,Pe))}),(this.tracksReady||this.sourceBufferCount)&&(i.tracks=this.sourceBufferTracks),this.sourceBufferCount||this.mediaSourceOpenOrEnded&&this.checkPendingTracks())},t.appendChangeType=function(e,i,r){var a=this,o=i+";codecs="+r,l={label:"change-type="+o,execute:function(){var h=a.tracks[e];if(h){var u=h.buffer;u!=null&&u.changeType&&(a.log("changing "+e+" sourceBuffer type to "+o),u.changeType(o),h.codec=r,h.container=i)}a.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(h){a.warn("Failed to change "+e+" SourceBuffer type",h)}};this.append(l,e,this.isPending(this.tracks[e]))},t.blockAudio=function(e){var i,r=this,a=e.start,o=a+.05*e.duration;if(((i=this.fragmentTracker.getAppendedFrag(a,q))==null?void 0:i.gap)!==!0){var l={label:"block-audio",execute:function(){var h,u=r.tracks.video;(r.lastVideoAppendEnd>o||u!=null&&u.buffer&&Et.isBuffered(u.buffer,o)||((h=r.fragmentTracker.getAppendedFrag(o,q))==null?void 0:h.gap)===!0)&&(r.blockedAudioAppend=null,r.shiftAndExecuteNext("audio"))},onStart:function(){},onComplete:function(){},onError:function(h){r.warn("Error executing block-audio operation",h)}};this.blockedAudioAppend={op:l,frag:e},this.append(l,"audio",!0)}},t.unblockAudio=function(){var e=this.blockedAudioAppend,i=this.operationQueue;e&&i&&(this.blockedAudioAppend=null,i.unblockAudio(e.op))},t.onBufferAppending=function(e,i){var r=this,a=this.tracks,o=i.data,l=i.type,h=i.parent,u=i.frag,A=i.part,M=i.chunkMeta,T=M.buffering[l],P=u.sn,U=self.performance.now();T.start=U;var G=u.stats.buffering,$=A?A.stats.buffering:null;G.start===0&&(G.start=U),$&&$.start===0&&($.start=U);var te=a.audio,se=!1;l==="audio"&&(te==null?void 0:te.container)==="audio/mpeg"&&(se=!this.lastMpegAudioChunk||M.id===1||this.lastMpegAudioChunk.sn!==M.sn,this.lastMpegAudioChunk=M);var pe=this.tracks.video,ye=pe==null?void 0:pe.buffer;if(ye&&P!=="initSegment"){var he=A||u,ge=this.blockedAudioAppend;if(l!=="audio"||h==="main"||this.blockedAudioAppend){if(l==="video"){var Ae=he.end;if(ge){var Te=ge.frag.start;(Ae>Te||Ae<this.lastVideoAppendEnd||Et.isBuffered(ye,Te))&&this.unblockAudio()}this.lastVideoAppendEnd=Ae}}else{var Ee=he.start+.05*he.duration,xe=ye.buffered,Pe=this.currentOp("video");xe.length||Pe?!Pe&&!Et.isBuffered(ye,Ee)&&this.lastVideoAppendEnd<Ee&&this.blockAudio(he):this.blockAudio(he)}}var ze=(A||u).start,Fe={label:"append-"+l,execute:function(){if(T.executeStart=self.performance.now(),se){var Me=r.tracks[l];if(Me){var De=Me.buffer;if(De){var je=ze-De.timestampOffset;Math.abs(je)>=.1&&(r.log("Updating audio SourceBuffer timestampOffset to "+ze+" (delta: "+je+") sn: "+P+")"),De.timestampOffset=ze)}}}r.appendExecutor(o,l)},onStart:function(){},onComplete:function(){var Me=self.performance.now();T.executeEnd=T.end=Me,G.first===0&&(G.first=Me),$&&$.first===0&&($.first=Me);var De={};r.sourceBuffers.forEach(function(je){var Ye=je[0],ot=je[1];Ye&&(De[Ye]=Et.getBuffered(ot))}),r.appendErrors[l]=0,l==="audio"||l==="video"?r.appendErrors.audiovideo=0:(r.appendErrors.audio=0,r.appendErrors.video=0),r.hls.trigger(k.BUFFER_APPENDED,{type:l,frag:u,part:A,chunkMeta:M,parent:u.type,timeRanges:De})},onError:function(Me){var De,je={type:re.MEDIA_ERROR,parent:u.type,details:K.BUFFER_APPEND_ERROR,sourceBufferName:l,frag:u,part:A,chunkMeta:M,error:Me,err:Me,fatal:!1},Ye=(De=r.media)==null?void 0:De.error;if(Me.code===DOMException.QUOTA_EXCEEDED_ERR)je.details=K.BUFFER_FULL_ERROR;else if(Me.code===DOMException.INVALID_STATE_ERR&&r.mediaSourceOpenOrEnded&&!Ye)je.errorAction=Ji(!0);else if(Me.name===$i&&r.sourceBufferCount===0)je.errorAction=Ji(!0);else{var ot=++r.appendErrors[l];r.warn("Failed "+ot+"/"+r.hls.config.appendErrorMaxRetry+' times to append segment in "'+l+'" sourceBuffer ('+(Ye||"no media error")+")"),(ot>=r.hls.config.appendErrorMaxRetry||Ye)&&(je.fatal=!0)}r.hls.trigger(k.ERROR,je)}};this.append(Fe,l,this.isPending(this.tracks[l]))},t.getFlushOp=function(e,i,r){var a=this;return this.log('queuing "'+e+'" remove '+i+"-"+r),{label:"remove",execute:function(){a.removeExecutor(e,i,r)},onStart:function(){},onComplete:function(){a.hls.trigger(k.BUFFER_FLUSHED,{type:e})},onError:function(o){a.warn("Failed to remove "+i+"-"+r+' from "'+e+'" SourceBuffer',o)}}},t.onBufferFlushing=function(e,i){var r=this,a=i.type,o=i.startOffset,l=i.endOffset;a?this.append(this.getFlushOp(a,o,l),a):this.sourceBuffers.forEach(function(h){var u=h[0];u&&r.append(r.getFlushOp(u,o,l),u)})},t.onFragParsed=function(e,i){var r=this,a=i.frag,o=i.part,l=[],h=o?o.elementaryStreams:a.elementaryStreams;h[_i]?l.push("audiovideo"):(h[Jt]&&l.push("audio"),h[Bt]&&l.push("video")),l.length===0&&this.warn("Fragments must have at least one ElementaryStreamType set. type: "+a.type+" level: "+a.level+" sn: "+a.sn),this.blockBuffers(function(){var u=self.performance.now();a.stats.buffering.end=u,o&&(o.stats.buffering.end=u);var A=o?o.stats:a.stats;r.hls.trigger(k.FRAG_BUFFERED,{frag:a,part:o,stats:A,id:a.type})},l).catch(function(u){r.warn("Fragment buffered callback "+u),r.stepOperationQueue(r.sourceBufferTypes)})},t.onFragChanged=function(e,i){this.trimBuffers()},t.onBufferEos=function(e,i){var r,a=this;this.sourceBuffers.forEach(function(l){var h=l[0];if(h){var u=a.tracks[h];i.type&&i.type!==h||(u.ending=!0,u.ended||(u.ended=!0,a.log(h+" buffer reached EOS")))}});var o=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(function(l){var h,u=l[0];return u&&!((h=a.tracks[u])!=null&&h.ended)})&&(o?(this.log("Queueing EOS"),this.blockUntilOpen(function(){a.tracksEnded();var l=a.mediaSource;l&&l.readyState==="open"?(a.log("Calling mediaSource.endOfStream()"),l.endOfStream(),a.hls.trigger(k.BUFFERED_TO_END,void 0)):l&&a.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: "+l.readyState)})):(this.tracksEnded(),this.hls.trigger(k.BUFFERED_TO_END,void 0)))},t.tracksEnded=function(){var e=this;this.sourceBuffers.forEach(function(i){var r=i[0];if(r!==null){var a=e.tracks[r];a&&(a.ending=!1)}})},t.onLevelUpdated=function(e,i){var r=i.details;r.fragments.length&&(this.details=r,this.updateDuration())},t.updateDuration=function(){var e=this,i=this.getDurationAndRange();i&&this.blockUntilOpen(function(){return e.updateMediaSource(i)})},t.onError=function(e,i){if(i.details===K.BUFFER_APPEND_ERROR&&i.frag){var r,a=(r=i.errorAction)==null?void 0:r.nextAutoLevel;x(a)&&a!==i.frag.level&&this.resetAppendErrors()}},t.resetAppendErrors=function(){this.appendErrors={audio:0,video:0,audiovideo:0}},t.trimBuffers=function(){var e=this.hls,i=this.details,r=this.media;if(r&&i!==null&&this.sourceBufferCount){var a=e.config,o=r.currentTime,l=i.levelTargetDuration,h=i.live&&a.liveBackBufferLength!==null?a.liveBackBufferLength:a.backBufferLength;if(x(h)&&h>=0){var u=Math.max(h,l),A=Math.floor(o/l)*l-u;this.flushBackBuffer(o,l,A)}if(x(a.frontBufferFlushThreshold)&&a.frontBufferFlushThreshold>0){var M=Math.max(a.maxBufferLength,a.frontBufferFlushThreshold),T=Math.max(M,l),P=Math.floor(o/l)*l+T;this.flushFrontBuffer(o,l,P)}}},t.flushBackBuffer=function(e,i,r){var a=this;this.sourceBuffers.forEach(function(o){var l=o[0],h=o[1];if(h){var u=Et.getBuffered(h);if(u.length>0&&r>u.start(0)){var A;a.hls.trigger(k.BACK_BUFFER_REACHED,{bufferEnd:r});var M=a.tracks[l];if((A=a.details)!=null&&A.live)a.hls.trigger(k.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(M!=null&&M.ended)return void a.log("Cannot flush "+l+" back buffer while SourceBuffer is in ended state");a.hls.trigger(k.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:l})}}})},t.flushFrontBuffer=function(e,i,r){var a=this;this.sourceBuffers.forEach(function(o){var l=o[0],h=o[1];if(h){var u=Et.getBuffered(h),A=u.length;if(A<2)return;var M=u.start(A-1),T=u.end(A-1);if(r>M||e>=M&&e<=T)return;a.hls.trigger(k.BUFFER_FLUSHING,{startOffset:M,endOffset:1/0,type:l})}})},t.getDurationAndRange=function(){var e,i=this.details,r=this.mediaSource;if(!i||!this.media||(r==null?void 0:r.readyState)!=="open")return null;var a=i.edge;if(i.live&&this.hls.config.liveDurationInfinity){if(i.fragments.length&&i.live&&r.setLiveSeekableRange){var o=Math.max(0,i.fragmentStart);return{duration:1/0,start:o,end:Math.max(o,a)}}return{duration:1/0}}var l=(e=this.overrides)==null?void 0:e.duration;if(l)return x(l)?{duration:l}:null;var h=this.media.duration;return a>(x(r.duration)?r.duration:0)&&a>h||!x(h)?{duration:a}:null},t.updateMediaSource=function(e){var i=e.duration,r=e.start,a=e.end,o=this.mediaSource;this.media&&o&&o.readyState==="open"&&(o.duration!==i&&(x(i)&&this.log("Updating MediaSource duration to "+i.toFixed(3)),o.duration=i),r!==void 0&&a!==void 0&&(this.log("MediaSource duration is set to "+o.duration+". Setting seekable range to "+r+"-"+a+"."),o.setLiveSeekableRange(r,a)))},t.checkPendingTracks=function(){var e=this.bufferCodecEventsTotal,i=this.pendingTrackCount,r=this.tracks;if(this.log("checkPendingTracks (pending: "+i+" codec events expected: "+e+") "+$e(r)),this.tracksReady){var a,o=(a=this.transferData)==null?void 0:a.tracks;o&&Object.keys(o).length?this.attachTransferred():this.createSourceBuffers()}},t.bufferCreated=function(){var e=this;if(this.sourceBufferCount){var i={};this.sourceBuffers.forEach(function(a){var o=a[0],l=a[1];if(o){var h=e.tracks[o];i[o]={buffer:l,container:h.container,codec:h.codec,supplemental:h.supplemental,levelCodec:h.levelCodec,id:h.id,metadata:h.metadata}}}),this.hls.trigger(k.BUFFER_CREATED,{tracks:i}),this.log("SourceBuffers created. Running queue: "+this.operationQueue),this.sourceBuffers.forEach(function(a){var o=a[0];e.executeNext(o)})}else{var r=new Error("could not create source buffer for media codec(s)");this.hls.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:r,reason:r.message})}},t.createSourceBuffers=function(){var e=this.tracks,i=this.sourceBuffers,r=this.mediaSource;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(var a in e){var o=a,l=e[o];if(this.isPending(l)){var h=this.getTrackCodec(l,o),u=l.container+";codecs="+h;l.codec=h,this.log("creating sourceBuffer("+u+")"+(this.currentOp(o)?" Queued":"")+" "+$e(l));try{var A=r.addSourceBuffer(u),M=Bi(o),T=[o,A];i[M]=T,l.buffer=A}catch(U){var P;return this.error("error while trying to add sourceBuffer: "+U.message),this.shiftAndExecuteNext(o),(P=this.operationQueue)==null||P.removeBlockers(),delete this.tracks[o],void this.hls.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:U,sourceBufferName:o,mimeType:u,parent:l.id})}this.trackSourceBuffer(o,l)}}this.bufferCreated()},t.getTrackCodec=function(e,i){var r=e.supplemental,a=e.codec;r&&(i==="video"||i==="audiovideo")&&Gt(r,"video")&&(a=function(l,h){var u=[];if(l)for(var A=l.split(","),M=0;M<A.length;M++)jr(A[M],"video")||u.push(A[M]);return h&&u.push(h),u.join(",")}(a,r));var o=C(a,e.levelCodec);return o?i.slice(0,5)==="audio"?O(o,this.appendSource):o:""},t.trackSourceBuffer=function(e,i){var r=this,a=i.buffer;if(a){var o=this.getTrackCodec(i,e);this.tracks[e]={buffer:a,codec:o,container:i.container,levelCodec:i.levelCodec,supplemental:i.supplemental,metadata:i.metadata,id:i.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",function(l,h){var u=h.removedRanges;u!=null&&u.length&&r.hls.trigger(k.BUFFER_FLUSHED,{type:l})})}},t.onSBUpdateStart=function(e){var i=this.currentOp(e);i&&i.onStart()},t.onSBUpdateEnd=function(e){var i;if(((i=this.mediaSource)==null?void 0:i.readyState)!=="closed"){var r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}else this.resetBuffer(e)},t.onSBUpdateError=function(e,i){var r,a=new Error(e+" SourceBuffer error. MediaSource readyState: "+((r=this.mediaSource)==null?void 0:r.readyState));this.error(""+a,i),this.hls.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:a,fatal:!1});var o=this.currentOp(e);o&&o.onError(a)},t.removeExecutor=function(e,i,r){var a=this.media,o=this.mediaSource,l=this.tracks[e],h=l==null?void 0:l.buffer;if(!a||!o||!h)return this.warn("Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void this.shiftAndExecuteNext(e);var u=x(a.duration)?a.duration:1/0,A=x(o.duration)?o.duration:1/0,M=Math.max(0,i),T=Math.min(r,u,A);T>M&&(!l.ending||l.ended)?(l.ended=!1,this.log("Removing ["+M+","+T+"] from the "+e+" SourceBuffer"),h.remove(M,T)):this.shiftAndExecuteNext(e)},t.appendExecutor=function(e,i){var r=this.tracks[i],a=r==null?void 0:r.buffer;if(!a)throw new zr("Attempting to append to the "+i+" SourceBuffer, but it does not exist");r.ending=!1,r.ended=!1,a.appendBuffer(e)},t.blockUntilOpen=function(e){var i=this;if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(function(r){i.warn("SourceBuffer blocked callback "+r),i.stepOperationQueue(i.sourceBufferTypes)});else try{e()}catch(r){this.warn("Callback run without blocking "+this.operationQueue+" "+r)}},t.isUpdating=function(){return this.sourceBuffers.some(function(e){var i=e[0],r=e[1];return i&&r.updating})},t.isQueued=function(){var e=this;return this.sourceBuffers.some(function(i){var r=i[0];return r&&!!e.currentOp(r)})},t.isPending=function(e){return!!e&&!e.buffer},t.blockBuffers=function(e,i){var r=this;if(i===void 0&&(i=this.sourceBufferTypes),!i.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);var a=this.operationQueue,o=i.map(function(l){return r.appendBlocker(l)});return i.length>1&&this.blockedAudioAppend&&this.unblockAudio(),Promise.all(o).then(function(l){a===r.operationQueue&&(e(),r.stepOperationQueue(r.sourceBufferTypes))})},t.stepOperationQueue=function(e){var i=this;e.forEach(function(r){var a,o=(a=i.tracks[r])==null?void 0:a.buffer;o&&!o.updating&&i.shiftAndExecuteNext(r)})},t.append=function(e,i,r){this.operationQueue&&this.operationQueue.append(e,i,r)},t.appendBlocker=function(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)},t.currentOp=function(e){return this.operationQueue?this.operationQueue.current(e):null},t.executeNext=function(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)},t.shiftAndExecuteNext=function(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)},t.addBufferListener=function(e,i,r){var a=this.tracks[e];if(a){var o=a.buffer;if(o){var l=r.bind(this,e);a.listeners.push({event:i,listener:l}),o.addEventListener(i,l)}}},t.removeBufferListeners=function(e){var i=this.tracks[e];if(i){var r=i.buffer;r&&(i.listeners.forEach(function(a){r.removeEventListener(a.event,a.listener)}),i.listeners.length=0)}},g(n,[{key:"mediaSourceOpenOrEnded",get:function(){var e,i=(e=this.mediaSource)==null?void 0:e.readyState;return i==="open"||i==="ended"}},{key:"sourceBufferTracks",get:function(){var e=this;return Object.keys(this.tracks).reduce(function(i,r){var a=e.tracks[r];return i[r]={id:a.id,container:a.container,codec:a.codec,levelCodec:a.levelCodec},i},{})}},{key:"bufferedToEnd",get:function(){var e=this;return this.sourceBufferCount>0&&!this.sourceBuffers.some(function(i){var r,a,o=i[0];return o&&(!((r=e.tracks[o])!=null&&r.ended)||((a=e.tracks[o])==null?void 0:a.ending))})}},{key:"tracksReady",get:function(){var e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}},{key:"mediaSrc",get:function(){var e,i,r=((e=this.media)==null||(i=e.querySelector)==null?void 0:i.call(e,"source"))||this.media;return r==null?void 0:r.src}},{key:"pendingTrackCount",get:function(){var e=this;return Object.keys(this.tracks).reduce(function(i,r){return i+(e.isPending(e.tracks[r])?1:0)},0)}},{key:"sourceBufferCount",get:function(){return this.sourceBuffers.reduce(function(e,i){return e+(i[0]?1:0)},0)}},{key:"sourceBufferTypes",get:function(){return this.sourceBuffers.map(function(e){return e[0]}).filter(function(e){return!!e})}}])}(Oe);function fr(s){var n=s.querySelectorAll("source");[].slice.call(n).forEach(function(t){s.removeChild(t)})}function Bi(s){return s==="audio"?1:0}var xr=function(){function s(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var n=s.prototype;return n.setStreamController=function(t){this.streamController=t},n.destroy=function(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},n.registerListeners=function(){var t=this.hls;t.on(k.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(k.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(k.MANIFEST_PARSED,this.onManifestParsed,this),t.on(k.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(k.BUFFER_CODECS,this.onBufferCodecs,this),t.on(k.MEDIA_DETACHING,this.onMediaDetaching,this)},n.unregisterListener=function(){var t=this.hls;t.off(k.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(k.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(k.MANIFEST_PARSED,this.onManifestParsed,this),t.off(k.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(k.BUFFER_CODECS,this.onBufferCodecs,this),t.off(k.MEDIA_DETACHING,this.onMediaDetaching,this)},n.onFpsDropLevelCapping=function(t,e){var i=this.hls.levels[e.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})},n.onMediaAttaching=function(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()},n.onManifestParsed=function(t,e){var i=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,i.config.capLevelToPlayerSize&&e.video&&this.startCapping()},n.onLevelsUpdated=function(t,e){this.timer&&x(this.autoLevelCapping)&&this.detectPlayerSize()},n.onBufferCodecs=function(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},n.onMediaDetaching=function(){this.stopCapping(),this.media=null},n.detectPlayerSize=function(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);var t=this.hls.levels;if(t.length){var e=this.hls,i=this.getMaxLevel(t.length-1);i!==this.autoLevelCapping&&e.logger.log("Setting autoLevelCapping to "+i+": "+t[i].height+"p@"+t[i].bitrate+" for media "+this.mediaWidth+"x"+this.mediaHeight),e.autoLevelCapping=i,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},n.getMaxLevel=function(t){var e=this,i=this.hls.levels;if(!i.length)return-1;var r=i.filter(function(a,o){return e.isLevelAllowed(a)&&o<=t});return this.clientRect=null,s.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},n.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},n.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},n.getDimensions=function(){if(this.clientRect)return this.clientRect;var t=this.media,e={width:0,height:0};if(t){var i=t.getBoundingClientRect();e.width=i.width,e.height=i.height,e.width||e.height||(e.width=i.right-i.left||t.width||0,e.height=i.bottom-i.top||t.height||0)}return this.clientRect=e,e},n.isLevelAllowed=function(t){return!this.restrictedLevels.some(function(e){return t.bitrate===e.bitrate&&t.width===e.width&&t.height===e.height})},s.getMaxLevelByMediaSize=function(t,e,i){if(t==null||!t.length)return-1;for(var r,a,o=t.length-1,l=Math.max(e,i),h=0;h<t.length;h+=1){var u=t[h];if((u.width>=l||u.height>=l)&&(r=u,!(a=t[h+1])||r.width!==a.width||r.height!==a.height)){o=h;break}}return o},g(s,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(e){}return Math.min(t,this.hls.config.maxDevicePixelRatio)}}])}(),kr=/^(\d+)x(\d+)$/,er=/(.+?)=(".*?"|.*?)(?:,|$)/g,$t=function(){function s(t,e){typeof t=="string"&&(t=s.parseAttrList(t,e)),D(this,t)}var n=s.prototype;return n.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},n.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var i=new Uint8Array(e.length/2),r=0;r<e.length/2;r++)i[r]=parseInt(e.slice(2*r,2*r+2),16);return i}return null},n.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},n.decimalFloatingPoint=function(t){return parseFloat(this[t])},n.optionalFloat=function(t,e){var i=this[t];return i?parseFloat(i):e},n.enumeratedString=function(t){return this[t]},n.enumeratedStringList=function(t,e){var i=this[t];return(i?i.split(/[ ,]+/):[]).reduce(function(r,a){return r[a.toLowerCase()]=!0,r},e)},n.bool=function(t){return this[t]==="YES"},n.decimalResolution=function(t){var e=kr.exec(this[t]);if(e!==null)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},s.parseAttrList=function(t,e){var i,r={};for(er.lastIndex=0;(i=er.exec(t))!==null;){var a=i[1].trim(),o=i[2],l=o.indexOf('"')===0&&o.lastIndexOf('"')===o.length-1,h=!1;if(l)o=o.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":h=!0}if(!(e&&(l||h))){if(!h&&!l)switch(a){case"CLOSED-CAPTIONS":if(o==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Ze.warn(t+": attribute "+a+" is missing quotes")}}r[a]=o}return r},g(s,[{key:"clientAttrs",get:function(){return Object.keys(this).filter(function(t){return t.substring(0,2)==="X-"})}}])}();function Hr(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"||s==="SCTE35-CMD"}var pr=function(){return g(function(s,n,t){var e;if(t===void 0&&(t=0),this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(n==null?void 0:n.tagAnchor)||null,this.tagOrder=(e=n==null?void 0:n.tagOrder)!=null?e:t,n){var i=n.attr;for(var r in i)if(Object.prototype.hasOwnProperty.call(s,r)&&s[r]!==i[r]){Ze.warn('DATERANGE tag attribute: "'+r+'" does not match for tags with ID: "'+s.ID+'"'),this._badValueForSameId=r;break}s=D(new $t({}),i,s)}if(this.attr=s,n?(this._startDate=n._startDate,this._cue=n._cue,this._endDate=n._endDate,this._dateAtEnd=n._dateAtEnd):this._startDate=new Date(s["START-DATE"]),"END-DATE"in this.attr){var a=(n==null?void 0:n.endDate)||new Date(this.attr["END-DATE"]);x(a.getTime())&&(this._endDate=a)}},[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"cue",get:function(){var s=this._cue;return s===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):s}},{key:"startTime",get:function(){var s=this.tagAnchor;return s===null||s.programDateTime===null?(Ze.warn('Expected tagAnchor Fragment with PDT set for DateRange "'+this.id+'": '+s),NaN):s.start+(this.startDate.getTime()-s.programDateTime)/1e3}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){var s=this._endDate||this._dateAtEnd;if(s)return s;var n=this.duration;return n!==null?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*n):null}},{key:"duration",get:function(){if("DURATION"in this.attr){var s=this.attr.decimalFloatingPoint("DURATION");if(x(s))return s}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}},{key:"endOnNext",get:function(){return this.attr.bool("END-ON-NEXT")}},{key:"isInterstitial",get:function(){return this.class==="com.apple.hls.interstitial"}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&x(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}])}(),Yr=function(){function s(n){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=n}return s.prototype.reloaded=function(n){if(!n)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-n.lastPartSn,e=this.lastPartIndex-n.lastPartIndex;this.updated=this.endSN!==n.endSN||!!e||!!t||!this.live,this.advanced=this.endSN>n.endSN||t>0||t===0&&e>0,this.updated||this.advanced?this.misses=Math.floor(.6*n.misses):this.misses=n.misses+1},g(s,[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&x(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var n=this.driftEndTime-this.driftStartTime;return n>0?1e3*(this.driftEnd-this.driftStart)/n:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var n;return(n=this.partList)!=null&&n.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var n;return(n=this.fragments)!=null&&n.length?this.fragments[this.fragments.length-1].end:0}},{key:"fragmentStart",get:function(){var n;return(n=this.fragments)!=null&&n.length?this.fragments[0].start:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var n;return(n=this.partList)!=null&&n.length?this.partList[this.partList.length-1].index:-1}},{key:"maxPartIndex",get:function(){var n=this.partList;if(n){var t=this.lastPartIndex;if(t!==-1){for(var e=n.length;e--;)if(n[e].index>t)return n[e].index;return t}}return 0}},{key:"lastPartSn",get:function(){var n;return(n=this.partList)!=null&&n.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}},{key:"expired",get:function(){if(this.live&&this.age&&this.misses<3){var n=this.partEnd-this.fragmentStart;return this.age>Math.max(n,this.totalduration)+this.levelTargetDuration}return!1}}])}(),tr=0,mr=1;function qi(s){return s==="AES-128"||s==="AES-256"||s==="AES-256-CTR"}function Rr(s){switch(s){case"AES-128":case"AES-256":return tr;case"AES-256-CTR":return mr;default:throw new Error("invalid full segment method "+s)}}var Kn=function(){function s(t,e,i,r,a){r===void 0&&(r=[1]),a===void 0&&(a=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=i,this.keyFormatVersions=r,this.iv=a,this.encrypted=!!t&&t!=="NONE",this.isCommonEncryption=this.encrypted&&!qi(t)}s.clearKeyUriToKeyIdMap=function(){};var n=s.prototype;return n.isSupported=function(){if(this.method){if(qi(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES"}return!1},n.getDecryptData=function(t){if(!this.encrypted||!this.uri)return null;if(qi(this.method)&&this.uri&&!this.iv){typeof t!="number"&&(Ze.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),t=0);var e=function(i){for(var r=new Uint8Array(16),a=12;a<16;a++)r[a]=i>>8*(15-a)&255;return r}(t);return new s(this.method,this.uri,"identity",this.keyFormatVersions,e)}return this},s}(),Da=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ma=/#EXT-X-MEDIA:(.*)/g,Qn=/^#EXT(?:INF|-X-TARGETDURATION):/m,oa=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Zn=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),Dr=function(){function s(){}return s.findGroup=function(n,t){for(var e=0;e<n.length;e++){var i=n[e];if(i.id===t)return i}},s.resolve=function(n,t){return B.buildAbsoluteURL(t,n,{alwaysNormalize:!0})},s.isMediaPlaylist=function(n){return Qn.test(n)},s.parseMasterPlaylist=function(n,t){var e,i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:!1},r=[];for(Da.lastIndex=0;(e=Da.exec(n))!=null;)if(e[1]){var a,o=new $t(e[1],i),l=e[2],h={attrs:o,bitrate:o.decimalInteger("BANDWIDTH")||o.decimalInteger("AVERAGE-BANDWIDTH"),name:o.NAME,url:s.resolve(l,t)},u=o.decimalResolution("RESOLUTION");u&&(h.width=u.width,h.height=u.height),Pa(o.CODECS,h);var A=o["SUPPLEMENTAL-CODECS"];A&&(h.supplemental={},Pa(A,h.supplemental)),(a=h.unknownCodecs)!=null&&a.length||r.push(h),i.levels.push(h)}else if(e[3]){var M=e[3],T=e[4];switch(M){case"SESSION-DATA":var P=new $t(T,i),U=P["DATA-ID"];U&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[U]=P);break;case"SESSION-KEY":var G=Ca(T,t,i);G.encrypted&&G.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(G)):Ze.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+T+'"');break;case"DEFINE":break;case"CONTENT-STEERING":var $=new $t(T,i);i.contentSteering={uri:s.resolve($["SERVER-URI"],t),pathwayId:$["PATHWAY-ID"]||"."};break;case"START":i.startTimeOffset=Oa(T)}}var te=r.length>0&&r.length<i.levels.length;return i.levels=te?r:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i},s.parseMasterPlaylistMedia=function(n,t,e){var i,r={},a=e.levels,o={AUDIO:a.map(function(pe){return{id:pe.attrs.AUDIO,audioCodec:pe.audioCodec}}),SUBTITLES:a.map(function(pe){return{id:pe.attrs.SUBTITLES,textCodec:pe.textCodec}}),"CLOSED-CAPTIONS":[]},l=0;for(Ma.lastIndex=0;(i=Ma.exec(n))!==null;){var h=new $t(i[1],e),u=h.TYPE;if(u){var A=o[u],M=r[u]||[];r[u]=M;var T=h.LANGUAGE,P=h["ASSOC-LANGUAGE"],U=h.CHANNELS,G=h.CHARACTERISTICS,$=h["INSTREAM-ID"],te={attrs:h,bitrate:0,id:l++,groupId:h["GROUP-ID"]||"",name:h.NAME||T||"",type:u,default:h.bool("DEFAULT"),autoselect:h.bool("AUTOSELECT"),forced:h.bool("FORCED"),lang:T,url:h.URI?s.resolve(h.URI,t):""};if(P&&(te.assocLang=P),U&&(te.channels=U),G&&(te.characteristics=G),$&&(te.instreamId=$),A!=null&&A.length){var se=s.findGroup(A,te.groupId)||A[0];Na(te,se,"audioCodec"),Na(te,se,"textCodec")}M.push(te)}}return r},s.parseLevelPlaylist=function(n,t,e,i,r,a){var o,l,h,u,A,M={url:t},T=new Yr(t),P=T.fragments,U=[],G=null,$=0,te=0,se=0,pe=0,ye=0,he=null,ge=new ui(i,M),Ae=-1,Te=!1,Ee=null;if(oa.lastIndex=0,T.m3u8=n,T.hasVariableRefs=!1,((o=oa.exec(n))==null?void 0:o[0])!=="#EXTM3U")return T.playlistParsingError=new Error("Missing format identifier #EXTM3U"),T;for(;(l=oa.exec(n))!==null;){Te&&(Te=!1,(ge=new ui(i,M)).playlistOffset=se,ge.start=se,ge.sn=$,ge.cc=pe,ye&&(ge.bitrate=ye),ge.level=e,G&&(ge.initSegment=G,G.rawProgramDateTime&&(ge.rawProgramDateTime=G.rawProgramDateTime,G.rawProgramDateTime=null),Ee&&(ge.setByteRange(Ee),Ee=null)));var xe=l[1];if(xe){ge.duration=parseFloat(xe);var Pe=(" "+l[2]).slice(1);ge.title=Pe||null,ge.tagList.push(Pe?["INF",xe,Pe]:["INF",xe])}else if(l[3]){if(x(ge.duration)){ge.playlistOffset=se,ge.start=se,u&&Ba(ge,u,T),ge.sn=$,ge.level=e,ge.cc=pe,P.push(ge);var ze=(" "+l[3]).slice(1);ge.relurl=ze,la(ge,he,U),he=ge,se+=ge.duration,$++,te=0,Te=!0}}else{if(!(l=l[0].match(Zn))){Ze.warn("No matches on slow regex match for level playlist!");continue}for(h=1;h<l.length&&l[h]===void 0;h++);var Fe=(" "+l[h]).slice(1),Me=(" "+l[h+1]).slice(1),De=l[h+2]?(" "+l[h+2]).slice(1):null;switch(Fe){case"BYTERANGE":he?ge.setByteRange(Me,he):ge.setByteRange(Me);break;case"PROGRAM-DATE-TIME":ge.rawProgramDateTime=Me,ge.tagList.push(["PROGRAM-DATE-TIME",Me]),Ae===-1&&(Ae=P.length);break;case"PLAYLIST-TYPE":T.type&&Ui(T,Fe,l),T.type=Me.toUpperCase();break;case"MEDIA-SEQUENCE":T.startSN!==0?Ui(T,Fe,l):P.length>0&&Ua(T,Fe,l),$=T.startSN=parseInt(Me);break;case"SKIP":T.skippedSegments&&Ui(T,Fe,l);var je=new $t(Me,T),Ye=je.decimalInteger("SKIPPED-SEGMENTS");if(x(Ye)){T.skippedSegments+=Ye;for(var ot=Ye;ot--;)P.push(null);$+=Ye}var qe=je.enumeratedString("RECENTLY-REMOVED-DATERANGES");qe&&(T.recentlyRemovedDateranges=(T.recentlyRemovedDateranges||[]).concat(qe.split("	")));break;case"TARGETDURATION":T.targetduration!==0&&Ui(T,Fe,l),T.targetduration=Math.max(parseInt(Me),1);break;case"VERSION":T.version!==null&&Ui(T,Fe,l),T.version=parseInt(Me);break;case"INDEPENDENT-SEGMENTS":case"DEFINE":break;case"ENDLIST":T.live||Ui(T,Fe,l),T.live=!1;break;case"#":(Me||De)&&ge.tagList.push(De?[Me,De]:[Me]);break;case"DISCONTINUITY":pe++,ge.tagList.push(["DIS"]);break;case"GAP":ge.gap=!0,ge.tagList.push([Fe]);break;case"BITRATE":ge.tagList.push([Fe,Me]),ye=1e3*parseInt(Me),x(ye)?ge.bitrate=ye:ye=0;break;case"DATERANGE":var Lt=new $t(Me,T),It=new pr(Lt,T.dateRanges[Lt.ID],T.dateRangeTagCount);T.dateRangeTagCount++,It.isValid||T.skippedSegments?T.dateRanges[It.id]=It:Ze.warn('Ignoring invalid DATERANGE tag: "'+Me+'"'),ge.tagList.push(["EXT-X-DATERANGE",Me]);break;case"DISCONTINUITY-SEQUENCE":T.startCC!==0?Ui(T,Fe,l):P.length>0&&Ua(T,Fe,l),T.startCC=pe=parseInt(Me);break;case"KEY":var mt=Ca(Me,t,T);if(mt.isSupported()){if(mt.method==="NONE"){u=void 0;break}u||(u={}),u[mt.keyFormat]&&(u=D({},u)),u[mt.keyFormat]=mt}else Ze.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+Me+'"');break;case"START":T.startTimeOffset=Oa(Me);break;case"MAP":var At=new $t(Me,T);if(ge.duration){var Ct=new ui(i,M);Fa(Ct,At,e,u),G=Ct,ge.initSegment=G,G.rawProgramDateTime&&!ge.rawProgramDateTime&&(ge.rawProgramDateTime=G.rawProgramDateTime)}else{var bt=ge.byteRangeEndOffset;if(bt){var yt=ge.byteRangeStartOffset;Ee=bt-yt+"@"+yt}else Ee=null;Fa(ge,At,e,u),G=ge,Te=!0}G.cc=pe;break;case"SERVER-CONTROL":A&&Ui(T,Fe,l),A=new $t(Me),T.canBlockReload=A.bool("CAN-BLOCK-RELOAD"),T.canSkipUntil=A.optionalFloat("CAN-SKIP-UNTIL",0),T.canSkipDateRanges=T.canSkipUntil>0&&A.bool("CAN-SKIP-DATERANGES"),T.partHoldBack=A.optionalFloat("PART-HOLD-BACK",0),T.holdBack=A.optionalFloat("HOLD-BACK",0);break;case"PART-INF":T.partTarget&&Ui(T,Fe,l);var ft=new $t(Me);T.partTarget=ft.decimalFloatingPoint("PART-TARGET");break;case"PART":var gt=T.partList;gt||(gt=T.partList=[]);var nt=te>0?gt[gt.length-1]:void 0,pt=te++,Mt=new $t(Me,T),Rt=new Oi(Mt,ge,M,pt,nt);gt.push(Rt),ge.duration+=Rt.duration;break;case"PRELOAD-HINT":var Dt=new $t(Me,T);T.preloadHint=Dt;break;case"RENDITION-REPORT":var Ot=new $t(Me,T);T.renditionReports=T.renditionReports||[],T.renditionReports.push(Ot);break;default:Ze.warn("line parsed but not handled: "+l)}}}he&&!he.relurl?(P.pop(),se-=he.duration,T.partList&&(T.fragmentHint=he)):T.partList&&(la(ge,he,U),ge.cc=pe,T.fragmentHint=ge,u&&Ba(ge,u,T)),T.targetduration||(T.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));var wt=P.length,St=P[0],ci=P[wt-1];if((se+=T.skippedSegments*T.targetduration)>0&&wt&&ci){T.averagetargetduration=se/wt;var li=ci.sn;T.endSN=li!=="initSegment"?li:0,T.live||(ci.endList=!0),St&&T.startCC===void 0&&(T.startCC=St.cc),Ae>0&&(function(ni,di){for(var jt=ni[di],Zt=di;Zt--;){var pi=ni[Zt];if(!pi)return;pi.programDateTime=jt.programDateTime-1e3*pi.duration,jt=pi}}(P,Ae),St&&U.unshift(St))}else T.endSN=0,T.startCC=0;return T.fragmentHint&&(se+=T.fragmentHint.duration),T.totalduration=se,U.length&&T.dateRangeTagCount&&St&&Ia(U,T),T.endCC=pe,T},s}();function Ia(s,n){var t=s.length;if(t)for(var e=s[t-1],i=n.live?1/0:n.totalduration,r=Object.keys(n.dateRanges),a=r.length;a--;){var o=n.dateRanges[r[a]],l=o.startDate.getTime();o.tagAnchor=e.ref;for(var h=t;h--;){var u=Xn(n,l,s,h,i);if(u!==-1){o.tagAnchor=n.fragments[u].ref;break}}}}function Xn(s,n,t,e,i){var r=t[e];if(r){var a,o=r.programDateTime;if((n>=o||e===0)&&n<=o+1e3*((((a=t[e+1])==null?void 0:a.start)||i)-r.start)){var l=t[e].sn-s.startSN,h=s.fragments;if(h.length>t.length)for(var u=(t[e+1]||h[h.length-1]).sn-s.startSN;u>l;u--){var A=h[u].programDateTime;if(n>=A&&n<A+1e3*h[u].duration)return u}return l}}return-1}function Ca(s,n,t){var e,i,r=new $t(s,t),a=(e=r.METHOD)!=null?e:"",o=r.URI,l=r.hexadecimalInteger("IV"),h=r.KEYFORMATVERSIONS,u=(i=r.KEYFORMAT)!=null?i:"identity";o&&r.IV&&!l&&Ze.error("Invalid IV: "+r.IV);var A=o?Dr.resolve(o,n):"",M=(h||"1").split("/").map(Number).filter(Number.isFinite);return new Kn(a,A,u,M,l)}function Oa(s){var n=new $t(s).decimalFloatingPoint("TIME-OFFSET");return x(n)?n:null}function Pa(s,n){var t=(s||"").split(/[ ,]+/).filter(function(e){return e});["video","audio","text"].forEach(function(e){var i=t.filter(function(r){return jr(r,e)});i.length&&(n[e+"Codec"]=i.map(function(r){return r.split("/")[0]}).join(","),t=t.filter(function(r){return i.indexOf(r)===-1}))}),n.unknownCodecs=t}function Na(s,n,t){var e=n[t];e&&(s[t]=e)}function la(s,n,t){s.rawProgramDateTime?t.push(s):n!=null&&n.programDateTime&&(s.programDateTime=n.endProgramDateTime)}function Fa(s,n,t,e){s.relurl=n.URI,n.BYTERANGE&&s.setByteRange(n.BYTERANGE),s.level=t,s.sn="initSegment",e&&(s.levelkeys=e),s.initSegment=null}function Ba(s,n,t){s.levelkeys=n;var e=t.encryptedFragments;e.length&&e[e.length-1].levelkeys===n||!Object.keys(n).some(function(i){return n[i].isCommonEncryption})||e.push(s)}function Ui(s,n,t){s.playlistParsingError=new Error("#EXT-X-"+n+" must not appear more than once ("+t[0]+")")}function Ua(s,n,t){s.playlistParsingError=new Error("#EXT-X-"+n+" must appear before the first Media Segment ("+t[0]+")")}function da(s,n){var t=n.startPTS;if(x(t)){var e,i=0;n.sn>s.sn?(i=t-s.start,e=s):(i=s.start-t,e=n),e.duration!==i&&e.setDuration(i)}else n.sn>s.sn?s.cc===n.cc&&s.minEndPTS?n.setStart(s.start+(s.minEndPTS-s.start)):n.setStart(s.start+s.duration):n.setStart(Math.max(s.start-n.duration,0))}function ja(s,n,t,e,i,r){e-t<=0&&(Ze.warn("Fragment should have a positive duration",n),e=t+n.duration,r=i+n.duration);var a=t,o=e,l=n.startPTS,h=n.endPTS;if(x(l)){var u=Math.abs(l-t);x(n.deltaPTS)?n.deltaPTS=Math.max(u,n.deltaPTS):n.deltaPTS=u,a=Math.max(t,l),t=Math.min(t,l),i=Math.min(i,n.startDTS),o=Math.min(e,h),e=Math.max(e,h),r=Math.max(r,n.endDTS)}var A=t-n.start;n.start!==0&&n.setStart(t),n.setDuration(e-n.start),n.startPTS=t,n.maxStartPTS=a,n.startDTS=i,n.endPTS=e,n.minEndPTS=o,n.endDTS=r;var M,T=n.sn;if(!s||T<s.startSN||T>s.endSN)return 0;var P=T-s.startSN,U=s.fragments;for(U[P]=n,M=P;M>0;M--)da(U[M],U[M-1]);for(M=P;M<U.length-1;M++)da(U[M],U[M+1]);return s.fragmentHint&&da(U[U.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,A}function Jn(s,n){if(s!==n){for(var t,e=null,i=s.fragments,r=i.length-1;r>=0;r--){var a=i[r].initSegment;if(a){e=a;break}}s.fragmentHint&&delete s.fragmentHint.endPTS,function(G,$,te){for(var se=$.skippedSegments,pe=Math.max(G.startSN,$.startSN)-$.startSN,ye=(G.fragmentHint?1:0)+(se?$.endSN:Math.min(G.endSN,$.endSN))-$.startSN,he=$.startSN-G.startSN,ge=$.fragmentHint?$.fragments.concat($.fragmentHint):$.fragments,Ae=G.fragmentHint?G.fragments.concat(G.fragmentHint):G.fragments,Te=pe;Te<=ye;Te++){var Ee=Ae[he+Te],xe=ge[Te];if(se&&!xe&&Ee&&(xe=$.fragments[Te]=Ee),Ee&&xe){if(te(Ee,xe,Te,ge),Ee.url&&Ee.url!==xe.url)return void($.playlistParsingError=Va("media sequence mismatch "+xe.sn+":",G,$,0,xe));if(Ee.cc!==xe.cc)return void($.playlistParsingError=Va("discontinuity sequence mismatch ("+Ee.cc+"!="+xe.cc+")",G,$,0,xe))}}}(s,n,function(G,$,te,se){if((!n.startCC||n.skippedSegments)&&$.cc!==G.cc){for(var pe=G.cc-$.cc,ye=te;ye<se.length;ye++)se[ye].cc+=pe;n.endCC=se[se.length-1].cc}x(G.startPTS)&&x(G.endPTS)&&($.setStart($.startPTS=G.startPTS),$.startDTS=G.startDTS,$.maxStartPTS=G.maxStartPTS,$.endPTS=G.endPTS,$.endDTS=G.endDTS,$.minEndPTS=G.minEndPTS,$.setDuration(G.endPTS-G.startPTS),$.duration&&(t=$),n.PTSKnown=n.alignedSliding=!0),G.hasStreams&&($.elementaryStreams=G.elementaryStreams),$.loader=G.loader,G.hasStats&&($.stats=G.stats),G.initSegment&&($.initSegment=G.initSegment,e=G.initSegment)});var o=n.fragments,l=n.fragmentHint?o.concat(n.fragmentHint):o;if(e&&l.forEach(function(G){var $;!G||G.initSegment&&G.initSegment.relurl!==(($=e)==null?void 0:$.relurl)||(G.initSegment=e)}),n.skippedSegments){if(n.deltaUpdateFailed=o.some(function(G){return!G}),n.deltaUpdateFailed){Ze.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var h=n.skippedSegments;h--;)o.shift();n.startSN=o[0].sn}else{n.canSkipDateRanges&&(n.dateRanges=function(G,$){var te=$.dateRanges,se=$.recentlyRemovedDateranges,pe=D({},G);se&&se.forEach(function(he){delete pe[he]});var ye=Object.keys(pe).length;return ye&&Object.keys(te).forEach(function(he){var ge=pe[he],Ae=new pr(te[he].attr,ge);Ae.isValid?(pe[he]=Ae,ge||(Ae.tagOrder+=ye)):Ze.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+$e(te[he].attr)+'"')}),pe}(s.dateRanges,n));var u=s.fragments.filter(function(G){return G.rawProgramDateTime});if(s.hasProgramDateTime&&!n.hasProgramDateTime)for(var A=1;A<l.length;A++)l[A].programDateTime===null&&la(l[A],l[A-1],u);Ia(u,n)}n.endCC=o[o.length-1].cc}if(!n.startCC){var M,T=Ha(s,n.startSN-1);n.startCC=(M=T==null?void 0:T.cc)!=null?M:o[0].cc}(function(G,$,te){if(G&&$)for(var se=0,pe=0,ye=G.length;pe<=ye;pe++){var he=G[pe],ge=$[pe+se];he&&ge&&he.index===ge.index&&he.fragment.sn===ge.fragment.sn?te(he,ge):se--}})(s.partList,n.partList,function(G,$){$.elementaryStreams=G.elementaryStreams,$.stats=G.stats}),t?ja(n,t,t.startPTS,t.endPTS,t.startDTS,t.endDTS):Ga(s,n),o.length&&(n.totalduration=n.edge-o[0].start),n.driftStartTime=s.driftStartTime,n.driftStart=s.driftStart;var P=n.advancedDateTime;if(n.advanced&&P){var U=n.edge;n.driftStart||(n.driftStartTime=P,n.driftStart=U),n.driftEndTime=P,n.driftEnd=U}else n.driftEndTime=s.driftEndTime,n.driftEnd=s.driftEnd,n.advancedDateTime=s.advancedDateTime;n.requestScheduled===-1&&(n.requestScheduled=s.requestScheduled)}}function Va(s,n,t,e,i){return new Error(s+" "+i.url+"\nPlaylist starting @"+n.startSN+"\n"+n.m3u8+"\n\nPlaylist starting @"+t.startSN+"\n"+t.m3u8)}function Ga(s,n,t){t===void 0&&(t=!0);var e=n.startSN+n.skippedSegments-s.startSN,i=s.fragments,r=e>=0,a=0;if(r&&e<i.length)a=i[e].start;else if(r&&n.startSN===s.endSN+1)a=s.fragmentEnd;else if(r&&t)a=s.fragmentStart+e*n.levelTargetDuration;else{if(n.skippedSegments||n.fragmentStart!==0)return;a=s.fragmentStart}(function(o,l){if(l){for(var h=o.fragments,u=o.skippedSegments;u<h.length;u++)h[u].addStart(l);o.fragmentHint&&o.fragmentHint.addStart(l)}})(n,a)}function za(s,n){n===void 0&&(n=1/0);var t=1e3*s.targetduration;if(s.updated){var e=s.fragments;if(e.length&&4*t>n){var i=1e3*e[e.length-1].duration;i<t&&(t=i)}}else t/=2;return Math.round(t)}function Ha(s,n,t){if(!s)return null;var e=s.fragments[n-s.startSN];return e||((e=s.fragmentHint)&&e.sn===n?e:n<s.startSN&&t&&t.sn===n?t:null)}function Ya(s,n,t){return s?$a(s.partList,n,t):null}function $a(s,n,t){if(s)for(var e=s.length;e--;){var i=s[e];if(i.index===t&&i.fragment.sn===n)return i}return null}function qa(s){s.forEach(function(n,t){var e;(e=n.details)==null||e.fragments.forEach(function(i){i.level=t,i.initSegment&&(i.initSegment.level=t)})})}var es=function(s){function n(e){var i;return(i=s.call(this,"content-steering",e.logger)||this).hls=void 0,i.loader=null,i.uri=null,i.pathwayId=".",i._pathwayPriority=null,i.timeToLoad=300,i.reloadTimer=-1,i.updated=0,i.started=!1,i.enabled=!0,i.levels=null,i.audioTracks=null,i.subtitleTracks=null,i.penalizedPathways={},i.hls=e,i.registerListeners(),i}y(n,s);var t=n.prototype;return t.registerListeners=function(){var e=this.hls;e.on(k.MANIFEST_LOADING,this.onManifestLoading,this),e.on(k.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(k.MANIFEST_PARSED,this.onManifestParsed,this),e.on(k.ERROR,this.onError,this)},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(k.MANIFEST_LOADING,this.onManifestLoading,this),e.off(k.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(k.MANIFEST_PARSED,this.onManifestParsed,this),e.off(k.ERROR,this.onError,this))},t.pathways=function(){return(this.levels||[]).reduce(function(e,i){return e.indexOf(i.pathwayId)===-1&&e.push(i.pathwayId),e},[])},t.startLoad=function(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){var e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}},t.stopLoad=function(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()},t.clearTimeout=function(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)},t.destroy=function(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null},t.removeLevel=function(e){var i=this.levels;i&&(this.levels=i.filter(function(r){return r!==e}))},t.onManifestLoading=function(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null},t.onManifestLoaded=function(e,i){var r=i.contentSteering;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())},t.onManifestParsed=function(e,i){this.audioTracks=i.audioTracks,this.subtitleTracks=i.subtitleTracks},t.onError=function(e,i){var r=i.errorAction;if((r==null?void 0:r.action)===Ft&&r.flags===fi){var a=this.levels,o=this._pathwayPriority,l=this.pathwayId;if(i.context){var h=i.context,u=h.groupId,A=h.pathwayId,M=h.type;u&&a?l=this.getPathwayForGroupId(u,M,l):A&&(l=A)}l in this.penalizedPathways||(this.penalizedPathways[l]=performance.now()),!o&&a&&(o=this.pathways()),o&&o.length>1&&(this.updatePathwayPriority(o),r.resolved=this.pathwayId!==l),r.resolved||this.warn("Could not resolve "+i.details+' ("'+i.error.message+'") with content-steering for Pathway: '+l+" levels: "+(a&&a.length)+" priorities: "+$e(o)+" penalized: "+$e(this.penalizedPathways))}},t.filterParsedLevels=function(e){this.levels=e;var i=this.getLevelsForPathway(this.pathwayId);if(i.length===0){var r=e[0].pathwayId;this.log("No levels found in Pathway "+this.pathwayId+'. Setting initial Pathway to "'+r+'"'),i=this.getLevelsForPathway(r),this.pathwayId=r}return i.length!==e.length&&this.log("Found "+i.length+"/"+e.length+' levels in Pathway "'+this.pathwayId+'"'),i},t.getLevelsForPathway=function(e){return this.levels===null?[]:this.levels.filter(function(i){return e===i.pathwayId})},t.updatePathwayPriority=function(e){var i;this._pathwayPriority=e;var r=this.penalizedPathways,a=performance.now();Object.keys(r).forEach(function(M){a-r[M]>3e5&&delete r[M]});for(var o=0;o<e.length;o++){var l=e[o];if(!(l in r)){if(l===this.pathwayId)return;var h=this.hls.nextLoadLevel,u=this.hls.levels[h];if((i=this.getLevelsForPathway(l)).length>0){this.log('Setting Pathway to "'+l+'"'),this.pathwayId=l,qa(i),this.hls.trigger(k.LEVELS_UPDATED,{levels:i});var A=this.hls.levels[h];u&&A&&this.levels&&(A.attrs["STABLE-VARIANT-ID"]!==u.attrs["STABLE-VARIANT-ID"]&&A.bitrate!==u.bitrate&&this.log("Unstable Pathways change from bitrate "+u.bitrate+" to "+A.bitrate),this.hls.nextLoadLevel=h);break}}}},t.getPathwayForGroupId=function(e,i,r){for(var a=this.getLevelsForPathway(r).concat(this.levels||[]),o=0;o<a.length;o++)if(i===ve&&a[o].hasAudioGroup(e)||i===_e&&a[o].hasSubtitleGroup(e))return a[o].pathwayId;return r},t.clonePathways=function(e){var i=this,r=this.levels;if(r){var a={},o={};e.forEach(function(l){var h=l.ID,u=l["BASE-ID"],A=l["URI-REPLACEMENT"];if(!r.some(function(T){return T.pathwayId===h})){var M=i.getLevelsForPathway(u).map(function(T){var P=new $t(T.attrs);P["PATHWAY-ID"]=h;var U=P.AUDIO&&P.AUDIO+"_clone_"+h,G=P.SUBTITLES&&P.SUBTITLES+"_clone_"+h;U&&(a[P.AUDIO]=U,P.AUDIO=U),G&&(o[P.SUBTITLES]=G,P.SUBTITLES=G);var $=Ka(T.uri,P["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",A),te=new Ve({attrs:P,audioCodec:T.audioCodec,bitrate:T.bitrate,height:T.height,name:T.name,url:$,videoCodec:T.videoCodec,width:T.width});if(T.audioGroups)for(var se=1;se<T.audioGroups.length;se++)te.addGroupId("audio",T.audioGroups[se]+"_clone_"+h);if(T.subtitleGroups)for(var pe=1;pe<T.subtitleGroups.length;pe++)te.addGroupId("text",T.subtitleGroups[pe]+"_clone_"+h);return te});r.push.apply(r,M),Wa(i.audioTracks,a,A,h),Wa(i.subtitleTracks,o,A,h)}})}},t.loadSteeringManifest=function(e){var i,r=this,a=this.hls.config,o=a.loader;this.loader&&this.loader.destroy(),this.loader=new o(a);try{i=new self.URL(e)}catch(P){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+e)}if(i.protocol!=="data:"){var l=0|(this.hls.bandwidthEstimate||a.abrEwmaDefaultEstimate);i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+l)}var h={responseType:"json",url:i.href},u=a.steeringManifestLoadPolicy.default,A=u.errorRetry||u.timeoutRetry||{},M={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:A.maxNumRetry||0,retryDelay:A.retryDelayMs||0,maxRetryDelay:A.maxRetryDelayMs||0},T={onSuccess:function(P,U,G,$){r.log('Loaded steering manifest: "'+i+'"');var te=P.data;if((te==null?void 0:te.VERSION)===1){r.updated=performance.now(),r.timeToLoad=te.TTL;var se=te["RELOAD-URI"],pe=te["PATHWAY-CLONES"],ye=te["PATHWAY-PRIORITY"];if(se)try{r.uri=new self.URL(se,i).href}catch(ge){return r.enabled=!1,void r.log("Failed to parse Steering Manifest RELOAD-URI: "+se)}r.scheduleRefresh(r.uri||G.url),pe&&r.clonePathways(pe);var he={steeringManifest:te,url:i.toString()};r.hls.trigger(k.STEERING_MANIFEST_LOADED,he),ye&&r.updatePathwayPriority(ye)}else r.log("Steering VERSION "+te.VERSION+" not supported!")},onError:function(P,U,G,$){if(r.log("Error loading steering manifest: "+P.code+" "+P.text+" ("+U.url+")"),r.stopLoad(),P.code===410)return r.enabled=!1,void r.log("Steering manifest "+U.url+" no longer available");var te=1e3*r.timeToLoad;if(P.code!==429)r.scheduleRefresh(r.uri||U.url,te);else{var se=r.loader;if(typeof(se==null?void 0:se.getResponseHeader)=="function"){var pe=se.getResponseHeader("Retry-After");pe&&(te=1e3*parseFloat(pe))}r.log("Steering manifest "+U.url+" rate limited")}},onTimeout:function(P,U,G){r.log("Timeout loading steering manifest ("+U.url+")"),r.scheduleRefresh(r.uri||U.url)}};this.log("Requesting steering manifest: "+i),this.loader.load(h,M,T)},t.scheduleRefresh=function(e,i){var r=this;i===void 0&&(i=1e3*this.timeToLoad),this.clearTimeout(),this.reloadTimer=self.setTimeout(function(){var a,o=(a=r.hls)==null?void 0:a.media;!o||o.ended?r.scheduleRefresh(e,1e3*r.timeToLoad):r.loadSteeringManifest(e)},i)},g(n,[{key:"pathwayPriority",get:function(){return this._pathwayPriority},set:function(e){this.updatePathwayPriority(e)}}])}(Oe);function Wa(s,n,t,e){s&&Object.keys(n).forEach(function(i){var r=s.filter(function(a){return a.groupId===i}).map(function(a){var o=D({},a);return o.details=void 0,o.attrs=new $t(o.attrs),o.url=o.attrs.URI=Ka(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=n[i],o.attrs["PATHWAY-ID"]=e,o});s.push.apply(s,r)})}function Ka(s,n,t,e){var i,r=e.HOST,a=e.PARAMS,o=e[t];n&&(i=o==null?void 0:o[n])&&(s=i);var l=new self.URL(s);return r&&!i&&(l.host=r),a&&Object.keys(a).sort().forEach(function(h){h&&l.searchParams.set(h,a[h])}),l.href}var ts=function(){function s(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}var n=s.prototype;return n.setStreamController=function(t){this.streamController=t},n.registerListeners=function(){this.hls.on(k.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(k.MEDIA_DETACHING,this.onMediaDetaching,this)},n.unregisterListeners=function(){this.hls.off(k.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(k.MEDIA_DETACHING,this.onMediaDetaching,this)},n.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},n.onMediaAttaching=function(t,e){var i=this.hls.config;if(i.capLevelOnFPSDrop){var r=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}},n.onMediaDetaching=function(){this.media=null},n.checkFPS=function(t,e,i){var r=performance.now();if(e){if(this.lastTime){var a=r-this.lastTime,o=i-this.lastDroppedFrames,l=e-this.lastDecodedFrames,h=1e3*o/a,u=this.hls;if(u.trigger(k.FPS_DROP,{currentDropped:o,currentDecoded:l,totalDroppedFrames:i}),h>0&&o>u.config.fpsDroppedMonitoringThreshold*l){var A=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+A),A>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=A)&&(A-=1,u.trigger(k.FPS_DROP_LEVEL_CAPPING,{level:A,droppedLevel:u.currentLevel}),u.autoLevelCapping=A,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=e}},n.checkFPSInterval=function(){var t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},s}(),is=function(){function s(){this.chunks=[],this.dataLength=0}var n=s.prototype;return n.push=function(t){this.chunks.push(t),this.dataLength+=t.length},n.flush=function(){var t,e=this.chunks,i=this.dataLength;return e.length?(t=e.length===1?e[0]:function(r,a){for(var o=new Uint8Array(a),l=0,h=0;h<r.length;h++){var u=r[h];o.set(u,l),l+=u.length}return o}(e,i),this.reset(),t):new Uint8Array(0)},n.reset=function(){this.chunks.length=0,this.dataLength=0},s}();function Qa(s,n){return n+10<=s.length&&s[n]===51&&s[n+1]===68&&s[n+2]===73&&s[n+3]<255&&s[n+4]<255&&s[n+6]<128&&s[n+7]<128&&s[n+8]<128&&s[n+9]<128}function ua(s,n){return n+10<=s.length&&s[n]===73&&s[n+1]===68&&s[n+2]===51&&s[n+3]<255&&s[n+4]<255&&s[n+6]<128&&s[n+7]<128&&s[n+8]<128&&s[n+9]<128}function $r(s,n){var t=0;return t=(127&s[n])<<21,t|=(127&s[n+1])<<14,t|=(127&s[n+2])<<7,t|=127&s[n+3]}function qr(s,n){for(var t=n,e=0;ua(s,n);)e+=10,e+=$r(s,n+6),Qa(s,n+10)&&(e+=10),n+=e;if(e>0)return s.subarray(t,t+e)}function Za(s,n){return s[n]===255&&(246&s[n+1])==240}function Xa(s,n){return 1&s[n+1]?7:9}function ca(s,n){return(3&s[n+3])<<11|s[n+4]<<3|(224&s[n+5])>>>5}function Wr(s,n){return n+1<s.length&&Za(s,n)}function rs(s,n){if(Wr(s,n)){var t=Xa(s,n);if(n+t>=s.length)return!1;var e=ca(s,n);if(e<=t)return!1;var i=n+e;return i===s.length||Wr(s,i)}return!1}function Ja(s,n,t,e,i){if(!s.samplerate){var r=function(a,o,l,h){var u=o[l+2],A=u>>2&15;if(!(A>12)){var M=1+(u>>6&3),T=o[l+3]>>6&3|(1&u)<<2,P="mp4a.40."+M,U=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][A],G=A;M!==5&&M!==29||(G-=3);var $=[M<<3|(14&G)>>1,(1&G)<<7|T<<3];return Ze.log("manifest codec:"+h+", parsed codec:"+P+", channels:"+T+", rate:"+U+" (ADTS object type:"+M+" sampling index:"+A+")"),{config:$,samplerate:U,channelCount:T,codec:P,parsedCodec:P,manifestCodec:h}}var te=new Error("invalid ADTS sampling index:"+A);a.emit(k.ERROR,k.ERROR,{type:re.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!0,error:te,reason:te.message})}(n,t,e,i);if(!r)return;D(s,r)}}function en(s){return 9216e4/s}function tn(s,n,t,e,i){var r,a=e+i*en(s.samplerate),o=function(P,U){var G=Xa(P,U);if(U+G<=P.length){var $=ca(P,U)-G;if($>0)return{headerLength:G,frameLength:$}}}(n,t);if(o){var l=o.frameLength,h=o.headerLength,u=h+l,A=Math.max(0,t+u-n.length);A?(r=new Uint8Array(u-h)).set(n.subarray(t+h,n.length),0):r=n.subarray(t+h,t+u);var M={unit:r,pts:a};return A||s.samples.push(M),{sample:M,length:u,missing:A}}var T=n.length-t;return(r=new Uint8Array(T)).set(n.subarray(t,n.length),0),{sample:{unit:r,pts:a},length:T,missing:-1}}function as(s,n){return ua(s,n)&&$r(s,n+6)+10<=s.length-n}function ha(s,n,t){return n===void 0&&(n=0),t===void 0&&(t=1/0),function(e,i,r,a){var o=function(U){return U instanceof ArrayBuffer?U:U.buffer}(e),l=1;"BYTES_PER_ELEMENT"in a&&(l=a.BYTES_PER_ELEMENT);var h,u=(h=e)&&h.buffer instanceof ArrayBuffer&&h.byteLength!==void 0&&h.byteOffset!==void 0?e.byteOffset:0,A=(u+e.byteLength)/l,M=(u+i)/l,T=Math.floor(Math.max(0,Math.min(M,A))),P=Math.floor(Math.min(T+Math.max(r,0),A));return new a(o,T,P-T)}(s,n,t,Uint8Array)}function ns(s){var n={key:s.type,description:"",data:"",mimeType:null,pictureType:null};if(!(s.size<2))if(s.data[0]===3){var t=s.data.subarray(1).indexOf(0);if(t!==-1){var e=ct(ha(s.data,1,t)),i=s.data[2+t],r=s.data.subarray(3+t).indexOf(0);if(r!==-1){var a,o=ct(ha(s.data,3+t,r));return a=e==="-->"?ct(ha(s.data,4+t+r)):function(l){return l instanceof ArrayBuffer?l:l.byteOffset==0&&l.byteLength==l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer}(s.data.subarray(4+t+r)),n.mimeType=e,n.pictureType=i,n.description=o,n.data=a,n}}}else console.log("Ignore frame with unrecognized character encoding")}function ss(s){return s.type==="PRIV"?function(n){if(!(n.size<2)){var t=ct(n.data,!0),e=new Uint8Array(n.data.subarray(t.length+1));return{key:n.type,info:t,data:e.buffer}}}(s):s.type[0]==="W"?function(n){if(n.type==="WXXX"){if(n.size<2)return;var t=1,e=ct(n.data.subarray(t),!0);t+=e.length+1;var i=ct(n.data.subarray(t));return{key:n.type,info:e,data:i}}var r=ct(n.data);return{key:n.type,info:"",data:r}}(s):s.type==="APIC"?ns(s):function(n){if(!(n.size<2)){if(n.type==="TXXX"){var t=1,e=ct(n.data.subarray(t),!0);t+=e.length+1;var i=ct(n.data.subarray(t));return{key:n.type,info:e,data:i}}var r=ct(n.data.subarray(1));return{key:n.type,info:"",data:r}}}(s)}function os(s){var n=String.fromCharCode(s[0],s[1],s[2],s[3]),t=$r(s,4);return{type:n,size:t,data:s.subarray(10,10+t)}}var Kr=10,ls=10;function rn(s){for(var n=0,t=[];ua(s,n);){var e=$r(s,n+6);s[n+5]>>6&1&&(n+=Kr);for(var i=(n+=Kr)+e;n+ls<i;){var r=os(s.subarray(n)),a=ss(r);a&&t.push(a),n+=r.size+Kr}Qa(s,n)&&(n+=Kr)}return t}function an(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"}function ds(s){if(s.data.byteLength===8){var n=new Uint8Array(s.data),t=1&n[3],e=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7];return e/=45,t&&(e+=4772185884e-2),Math.round(e)}}function nn(s){for(var n=rn(s),t=0;t<n.length;t++){var e=n[t];if(an(e))return ds(e)}}var gi=function(s){return s.audioId3="org.id3",s.dateRange="com.apple.quicktime.HLS",s.emsg="https://aomedia.org/emsg/ID3",s.misbklv="urn:misb:KLV:bin:1910.1",s}({});function Mi(s,n){return s===void 0&&(s=""),n===void 0&&(n=9e4),{type:s,id:-1,pid:-1,inputTimeScale:n,sequenceNumber:-1,samples:[],dropped:0}}var sn=function(){function s(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var n=s.prototype;return n.resetInitSegment=function(t,e,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},n.resetTimeStamp=function(t){this.initPTS=t,this.resetContiguity()},n.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},n.canParse=function(t,e){return!1},n.appendFrame=function(t,e,i){},n.demux=function(t,e){this.cachedData&&(t=mi(this.cachedData,t),this.cachedData=null);var i,r=qr(t,0),a=r?r.length:0,o=this._audioTrack,l=this._id3Track,h=r?nn(r):void 0,u=t.length;for((this.basePTS===null||this.frameIndex===0&&x(h))&&(this.basePTS=us(h,e,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:gi.audioId3,duration:Number.POSITIVE_INFINITY});a<u;){if(this.canParse(t,a)){var A=this.appendFrame(o,t,a);A?(this.frameIndex++,this.lastPTS=A.sample.pts,i=a+=A.length):a=u}else as(t,a)?(r=qr(t,a),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:gi.audioId3,duration:Number.POSITIVE_INFINITY}),i=a+=r.length):a++;if(a===u&&i!==u){var M=t.slice(i);this.cachedData?this.cachedData=mi(this.cachedData,M):this.cachedData=M}}return{audioTrack:o,videoTrack:Mi(),id3Track:l,textTrack:Mi()}},n.demuxSampleAes=function(t,e,i){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},n.flush=function(t){var e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:Mi(),id3Track:this._id3Track,textTrack:Mi()}},n.destroy=function(){this.cachedData=null,this._audioTrack=this._id3Track=void 0},s}(),us=function(s,n,t){return x(s)?90*s:9e4*n+(t?9e4*t.baseTime/t.timescale:0)},Qr=null,cs=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],hs=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],fs=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ps=[0,1,1,4];function on(s,n,t,e,i){if(!(t+24>n.length)){var r=ln(n,t);if(r&&t+r.frameLength<=n.length){var a=e+i*(9e4*r.samplesPerFrame/r.sampleRate),o={unit:n.subarray(t,t+r.frameLength),pts:a,dts:a};return s.config=[],s.channelCount=r.channelCount,s.samplerate=r.sampleRate,s.samples.push(o),{sample:o,length:r.frameLength,missing:0}}}}function ln(s,n){var t=s[n+1]>>3&3,e=s[n+1]>>1&3,i=s[n+2]>>4&15,r=s[n+2]>>2&3;if(t!==1&&i!==0&&i!==15&&r!==3){var a=s[n+2]>>1&1,o=s[n+3]>>6,l=1e3*cs[14*(t===3?3-e:e===3?3:4)+i-1],h=hs[3*(t===3?0:t===2?1:2)+r],u=o===3?1:2,A=fs[t][e],M=ps[e],T=8*A*M,P=Math.floor(A*l/h+a)*M;if(Qr===null){var U=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Qr=U?parseInt(U[1]):0}return Qr&&Qr<=87&&e===2&&l>=224e3&&o===0&&(s[n+3]=128|s[n+3]),{sampleRate:h,channelCount:u,frameLength:P,samplesPerFrame:T}}}function fa(s,n){return s[n]===255&&(224&s[n+1])==224&&(6&s[n+1])!=0}function dn(s,n){return n+1<s.length&&fa(s,n)}function un(s,n){if(n+1<s.length&&fa(s,n)){var t=ln(s,n),e=4;t!=null&&t.frameLength&&(e=t.frameLength);var i=n+e;return i===s.length||dn(s,i)}return!1}var ms=function(s){function n(e,i){var r;return(r=s.call(this)||this).observer=void 0,r.config=void 0,r.observer=e,r.config=i,r}y(n,s);var t=n.prototype;return t.resetInitSegment=function(e,i,r,a){s.prototype.resetInitSegment.call(this,e,i,r,a),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:i,duration:a,inputTimeScale:9e4,dropped:0}},n.probe=function(e,i){if(!e)return!1;var r=qr(e,0),a=(r==null?void 0:r.length)||0;if(un(e,a))return!1;for(var o=e.length;a<o;a++)if(rs(e,a))return i.log("ADTS sync word found !"),!0;return!1},t.canParse=function(e,i){return function(r,a){return function(o,l){return l+5<o.length}(r,a)&&Za(r,a)&&ca(r,a)<=r.length-a}(e,i)},t.appendFrame=function(e,i,r){Ja(e,this.observer,i,r,e.manifestCodec);var a=tn(e,i,r,this.basePTS,this.frameIndex);if(a&&a.missing===0)return a},n}(sn),gs=function(s){function n(){return s.apply(this,arguments)||this}y(n,s);var t=n.prototype;return t.resetInitSegment=function(e,i,r,a){s.prototype.resetInitSegment.call(this,e,i,r,a),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:i,duration:a,inputTimeScale:9e4,dropped:0}},n.probe=function(e){if(!e)return!1;var i=qr(e,0),r=(i==null?void 0:i.length)||0;if(i&&e[r]===11&&e[r+1]===119&&nn(i)!==void 0&&function(o,l){var h=0,u=5;l+=u;for(var A=new Uint32Array(1),M=new Uint32Array(1),T=new Uint8Array(1);u>0;){T[0]=o[l];var P=Math.min(u,8),U=8-P;M[0]=4278190080>>>24+U<<U,A[0]=(T[0]&M[0])>>U,h=h?h<<P|A[0]:A[0],l+=1,u-=P}return h}(e,r)<=16)return!1;for(var a=e.length;r<a;r++)if(un(e,r))return Ze.log("MPEG Audio sync word found !"),!0;return!1},t.canParse=function(e,i){return function(r,a){return fa(r,a)&&4<=r.length-a}(e,i)},t.appendFrame=function(e,i,r){if(this.basePTS!==null)return on(e,i,r,this.basePTS,this.frameIndex)},n}(sn),vs=function(){function s(n,t,e){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=n,this.aesIV=t,this.aesMode=e}return s.prototype.decrypt=function(n,t){switch(this.aesMode){case tr:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,n);case mr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,n);default:throw new Error("[AESCrypto] invalid aes mode "+this.aesMode)}},s}(),_s=function(){function s(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var n=s.prototype;return n.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),i=new Uint32Array(4),r=0;r<4;r++)i[r]=e.getUint32(4*r);return i},n.initTable=function(){var t=this.sBox,e=this.invSBox,i=this.subMix,r=i[0],a=i[1],o=i[2],l=i[3],h=this.invSubMix,u=h[0],A=h[1],M=h[2],T=h[3],P=new Uint32Array(256),U=0,G=0,$=0;for($=0;$<256;$++)P[$]=$<128?$<<1:$<<1^283;for($=0;$<256;$++){var te=G^G<<1^G<<2^G<<3^G<<4;te=te>>>8^255&te^99,t[U]=te,e[te]=U;var se=P[U],pe=P[se],ye=P[pe],he=257*P[te]^16843008*te;r[U]=he<<24|he>>>8,a[U]=he<<16|he>>>16,o[U]=he<<8|he>>>24,l[U]=he,he=16843009*ye^65537*pe^257*se^16843008*U,u[te]=he<<24|he>>>8,A[te]=he<<16|he>>>16,M[te]=he<<8|he>>>24,T[te]=he,U?(U=se^P[P[P[ye^se]]],G^=P[P[G]]):U=G=1}},n.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),i=!0,r=0;r<e.length&&i;)i=e[r]===this.key[r],r++;if(!i){this.key=e;var a=this.keySize=e.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);var o,l,h,u,A=this.ksRows=4*(a+6+1),M=this.keySchedule=new Uint32Array(A),T=this.invKeySchedule=new Uint32Array(A),P=this.sBox,U=this.rcon,G=this.invSubMix,$=G[0],te=G[1],se=G[2],pe=G[3];for(o=0;o<A;o++)o<a?h=M[o]=e[o]:(u=h,o%a==0?(u=P[(u=u<<8|u>>>24)>>>24]<<24|P[u>>>16&255]<<16|P[u>>>8&255]<<8|P[255&u],u^=U[o/a|0]<<24):a>6&&o%a==4&&(u=P[u>>>24]<<24|P[u>>>16&255]<<16|P[u>>>8&255]<<8|P[255&u]),M[o]=h=(M[o-a]^u)>>>0);for(l=0;l<A;l++)o=A-l,u=3&l?M[o]:M[o-4],T[l]=l<4||o<=4?u:$[P[u>>>24]]^te[P[u>>>16&255]]^se[P[u>>>8&255]]^pe[P[255&u]],T[l]=T[l]>>>0}},n.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},n.decrypt=function(t,e,i){for(var r,a,o,l,h,u,A,M,T,P,U,G,$,te,se=this.keySize+6,pe=this.invKeySchedule,ye=this.invSBox,he=this.invSubMix,ge=he[0],Ae=he[1],Te=he[2],Ee=he[3],xe=this.uint8ArrayToUint32Array_(i),Pe=xe[0],ze=xe[1],Fe=xe[2],Me=xe[3],De=new Int32Array(t),je=new Int32Array(De.length),Ye=this.networkToHostOrderSwap;e<De.length;){for(T=Ye(De[e]),P=Ye(De[e+1]),U=Ye(De[e+2]),G=Ye(De[e+3]),h=T^pe[0],u=G^pe[1],A=U^pe[2],M=P^pe[3],$=4,te=1;te<se;te++)r=ge[h>>>24]^Ae[u>>16&255]^Te[A>>8&255]^Ee[255&M]^pe[$],a=ge[u>>>24]^Ae[A>>16&255]^Te[M>>8&255]^Ee[255&h]^pe[$+1],o=ge[A>>>24]^Ae[M>>16&255]^Te[h>>8&255]^Ee[255&u]^pe[$+2],l=ge[M>>>24]^Ae[h>>16&255]^Te[u>>8&255]^Ee[255&A]^pe[$+3],h=r,u=a,A=o,M=l,$+=4;r=ye[h>>>24]<<24^ye[u>>16&255]<<16^ye[A>>8&255]<<8^ye[255&M]^pe[$],a=ye[u>>>24]<<24^ye[A>>16&255]<<16^ye[M>>8&255]<<8^ye[255&h]^pe[$+1],o=ye[A>>>24]<<24^ye[M>>16&255]<<16^ye[h>>8&255]<<8^ye[255&u]^pe[$+2],l=ye[M>>>24]<<24^ye[h>>16&255]<<16^ye[u>>8&255]<<8^ye[255&A]^pe[$+3],je[e]=Ye(r^Pe),je[e+1]=Ye(l^ze),je[e+2]=Ye(o^Fe),je[e+3]=Ye(a^Me),Pe=T,ze=P,Fe=U,Me=G,e+=4}return je.buffer},s}(),ys=function(){function s(n,t,e){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=n,this.key=t,this.aesMode=e}return s.prototype.expandKey=function(){var n=function(t){switch(t){case tr:return"AES-CBC";case mr:return"AES-CTR";default:throw new Error("[FastAESKey] invalid aes mode "+t)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:n},!1,["encrypt","decrypt"])},s}(),pa=function(){function s(t,e){var i=(e===void 0?{}:e).removePKCS7Padding,r=i===void 0||i;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=r,r)try{var a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(o){}this.useSoftware=!this.subtle}var n=s.prototype;return n.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},n.isSync=function(){return this.useSoftware},n.flush=function(){var t=this.currentResult,e=this.remainderData;if(!t||e)return this.reset(),null;var i,r,a,o=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?(r=(i=o).byteLength,(a=r&&new DataView(i.buffer).getUint8(r-1))?i.slice(0,r-a):i):o},n.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},n.decrypt=function(t,e,i,r){var a=this;return this.useSoftware?new Promise(function(o,l){var h=ArrayBuffer.isView(t)?t:new Uint8Array(t);a.softwareDecrypt(h,e,i,r);var u=a.flush();u?o(u.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),e,i,r)},n.softwareDecrypt=function(t,e,i,r){var a=this.currentIV,o=this.currentResult,l=this.remainderData;if(r!==tr||e.byteLength!==16)return Ze.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),l&&(t=mi(l,t),this.remainderData=null);var h=this.getValidChunk(t);if(!h.length)return null;a&&(i=a);var u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new _s),u.expandKey(e);var A=o;return this.currentResult=u.decrypt(h.buffer,0,i),this.currentIV=h.slice(-16).buffer,A||null},n.webCryptoDecrypt=function(t,e,i,r){var a=this;if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,i,r));this.key=e,this.fastAesKey=new ys(this.subtle,e,r)}return this.fastAesKey.expandKey().then(function(o){return a.subtle?(a.logOnce("WebCrypto AES decrypt"),new vs(a.subtle,new Uint8Array(i),r).decrypt(t.buffer,o)):Promise.reject(new Error("web crypto not initialized"))}).catch(function(o){return Ze.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+o.name+": "+o.message),a.onWebCryptoError(t,e,i,r)})},n.onWebCryptoError=function(t,e,i,r){var a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,i,r);var o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")},n.getValidChunk=function(t){var e=t,i=t.length-t.length%16;return i!==t.length&&(e=t.slice(0,i),this.remainderData=t.slice(i)),e},n.logOnce=function(t){this.logEnabled&&(Ze.log("[decrypter]: "+t),this.logEnabled=!1)},s}(),bs=/\/emsg[-/]ID3/i,Es=function(){function s(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}var n=s.prototype;return n.resetTimeStamp=function(){},n.resetInitSegment=function(t,e,i,r){var a=this.videoTrack=Mi("video",1),o=this.audioTrack=Mi("audio",1),l=this.txtTrack=Mi("text",1);if(this.id3Track=Mi("id3",1),this.timeOffset=0,t!=null&&t.byteLength){var h=dr(t);if(h.video){var u=h.video,A=u.id,M=u.timescale,T=u.codec,P=u.supplemental;a.id=A,a.timescale=l.timescale=M,a.codec=T,a.supplemental=P}if(h.audio){var U=h.audio,G=U.id,$=U.timescale,te=U.codec;o.id=G,o.timescale=$,o.codec=te}l.id=nr.text,a.sampleDuration=0,a.duration=o.duration=r}},n.resetContiguity=function(){this.remainderData=null},s.probe=function(t){return function(e){for(var i=e.byteLength,r=0;r<i;){var a=it(e,r);if(a>8&&e[r+4]===109&&e[r+5]===111&&e[r+6]===111&&e[r+7]===102)return!0;r=a>1?r+a:i}return!1}(t)},n.demux=function(t,e){this.timeOffset=e;var i=t,r=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=mi(this.remainderData,t));var o=function(h){var u={valid:null,remainder:null},A=lt(h,["moof"]);if(A.length<2)return u.remainder=h,u;var M=A[A.length-1];return u.valid=h.slice(0,M.byteOffset-8),u.remainder=h.slice(M.byteOffset-8),u}(i);this.remainderData=o.remainder,r.samples=o.valid||new Uint8Array}else r.samples=i;var l=this.extractID3Track(r,e);return a.samples=Di(e,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}},n.flush=function(){var t=this.timeOffset,e=this.videoTrack,i=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;var r=this.extractID3Track(e,this.timeOffset);return i.samples=Di(t,e),{videoTrack:e,audioTrack:Mi(),id3Track:r,textTrack:Mi()}},n.extractID3Track=function(t,e){var i=this,r=this.id3Track;if(t.samples.length){var a=lt(t.samples,["emsg"]);a&&a.forEach(function(o){var l=function(T){var P=T[0],U="",G="",$=0,te=0,se=0,pe=0,ye=0,he=0;if(P===0){for(;Yt(T.subarray(he,he+1))!=="\0";)U+=Yt(T.subarray(he,he+1)),he+=1;for(U+=Yt(T.subarray(he,he+1)),he+=1;Yt(T.subarray(he,he+1))!=="\0";)G+=Yt(T.subarray(he,he+1)),he+=1;G+=Yt(T.subarray(he,he+1)),he+=1,$=it(T,12),te=it(T,16),pe=it(T,20),ye=it(T,24),he=28}else if(P===1){$=it(T,he+=4);var ge=it(T,he+=4),Ae=it(T,he+=4);for(he+=4,se=Math.pow(2,32)*ge+Ae,N(se)||(se=Number.MAX_SAFE_INTEGER,Ze.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),pe=it(T,he),ye=it(T,he+=4),he+=4;Yt(T.subarray(he,he+1))!=="\0";)U+=Yt(T.subarray(he,he+1)),he+=1;for(U+=Yt(T.subarray(he,he+1)),he+=1;Yt(T.subarray(he,he+1))!=="\0";)G+=Yt(T.subarray(he,he+1)),he+=1;G+=Yt(T.subarray(he,he+1)),he+=1}return{schemeIdUri:U,value:G,timeScale:$,presentationTime:se,presentationTimeDelta:te,eventDuration:pe,id:ye,payload:T.subarray(he,T.byteLength)}}(o);if(bs.test(l.schemeIdUri)){var h=cn(l,e),u=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;u<=.001&&(u=Number.POSITIVE_INFINITY);var A=l.payload;r.samples.push({data:A,len:A.byteLength,dts:h,pts:h,type:gi.emsg,duration:u})}else if(i.config.enableEmsgKLVMetadata&&l.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){var M=cn(l,e);r.samples.push({data:l.payload,len:l.payload.byteLength,dts:M,pts:M,type:gi.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r},n.demuxSampleAes=function(t,e,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},n.destroy=function(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0},s}();function cn(s,n){return x(s.presentationTime)?s.presentationTime/s.timeScale:n+s.presentationTimeDelta/s.timeScale}var Ss=function(){function s(t,e,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new pa(e,{removePKCS7Padding:!1})}var n=s.prototype;return n.decryptBuffer=function(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,tr)},n.decryptAacSample=function(t,e,i){var r=this,a=t[e].unit;if(!(a.length<=16)){var o=a.subarray(16,a.length-a.length%16),l=o.buffer.slice(o.byteOffset,o.byteOffset+o.length);this.decryptBuffer(l).then(function(h){var u=new Uint8Array(h);a.set(u,16),r.decrypter.isSync()||r.decryptAacSamples(t,e+1,i)})}},n.decryptAacSamples=function(t,e,i){for(;;e++){if(e>=t.length)return void i();if(!(t[e].unit.length<32||(this.decryptAacSample(t,e,i),this.decrypter.isSync())))return}},n.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,i=new Int8Array(e),r=0,a=32;a<t.length-16;a+=160,r+=16)i.set(t.subarray(a,a+16),r);return i},n.getAvcDecryptedUnit=function(t,e){for(var i=new Uint8Array(e),r=0,a=32;a<t.length-16;a+=160,r+=16)t.set(i.subarray(r,r+16),a);return t},n.decryptAvcSample=function(t,e,i,r,a){var o=this,l=Ni(a.data),h=this.getAvcEncryptedData(l);this.decryptBuffer(h.buffer).then(function(u){a.data=o.getAvcDecryptedUnit(l,u),o.decrypter.isSync()||o.decryptAvcSamples(t,e,i+1,r)})},n.decryptAvcSamples=function(t,e,i,r){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,i=0){if(e>=t.length)return void r();for(var a=t[e].units;!(i>=a.length);i++){var o=a[i];if(!(o.data.length<=48||o.type!==1&&o.type!==5||(this.decryptAvcSample(t,e,i,r,o),this.decrypter.isSync())))return}}},s}(),As=function(){function s(){this.VideoSample=null}var n=s.prototype;return n.createVideoSample=function(t,e,i){return{key:t,frame:!1,pts:e,dts:i,units:[],length:0}},n.getLastNalUnit=function(t){var e,i,r=this.VideoSample;if(r&&r.units.length!==0||(r=t[t.length-1]),(e=r)!=null&&e.units){var a=r.units;i=a[a.length-1]}return i},n.pushAccessUnit=function(t,e){if(t.units.length&&t.frame){if(t.pts===void 0){var i=e.samples,r=i.length;if(!r)return void e.dropped++;var a=i[r-1];t.pts=a.pts,t.dts=a.dts}e.samples.push(t)}},n.parseNALu=function(t,e,i){var r,a,o=e.byteLength,l=t.naluState||0,h=l,u=[],A=0,M=-1,T=0;for(l===-1&&(M=0,T=this.getNALuType(e,0),l=0,A=1);A<o;)if(r=e[A++],l)if(l!==1)if(r)if(r===1){if(a=A-l-1,M>=0){var P={data:e.subarray(M,a),type:T};u.push(P)}else{var U=this.getLastNalUnit(t.samples);U&&(h&&A<=4-h&&U.state&&(U.data=U.data.subarray(0,U.data.byteLength-h)),a>0&&(U.data=mi(U.data,e.subarray(0,a)),U.state=0))}A<o?(M=A,T=this.getNALuType(e,A),l=0):l=-1}else l=0;else l=3;else l=r?0:2;else l=r?0:1;if(M>=0&&l>=0){var G={data:e.subarray(M,o),type:T,state:l};u.push(G)}if(u.length===0){var $=this.getLastNalUnit(t.samples);$&&($.data=mi($.data,e))}return t.naluState=l,u},s}(),hn=function(){function s(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}var n=s.prototype;return n.loadWord=function(){var t=this.data,e=this.bytesAvailable,i=t.byteLength-e,r=new Uint8Array(4),a=Math.min(4,e);if(a===0)throw new Error("no bytes available");r.set(t.subarray(i,i+a)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a},n.skipBits=function(t){var e;t=Math.min(t,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,t-=(e=t>>3)<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)},n.readBits=function(t){var e=Math.min(this.bitsAvailable,t),i=this.word>>>32-e;if(t>32&&Ze.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(e=t-e)>0&&this.bitsAvailable?i<<e|this.readBits(e):i},n.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(this.word&2147483648>>>t)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},n.skipUEG=function(){this.skipBits(1+this.skipLZ())},n.skipEG=function(){this.skipBits(1+this.skipLZ())},n.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},n.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},n.readBoolean=function(){return this.readBits(1)===1},n.readUByte=function(){return this.readBits(8)},n.readUShort=function(){return this.readBits(16)},n.readUInt=function(){return this.readBits(32)},s}(),fn=function(s){function n(){return s.apply(this,arguments)||this}y(n,s);var t=n.prototype;return t.parsePES=function(e,i,r,a){var o,l=this,h=this.parseNALu(e,r.data,a),u=this.VideoSample,A=!1;r.data=null,u&&h.length&&!e.audFound&&(this.pushAccessUnit(u,e),u=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),h.forEach(function(M){var T,P;switch(M.type){case 1:var U=!1;o=!0;var G,$=M.data;if(A&&$.length>4){var te=l.readSliceType($);te!==2&&te!==4&&te!==7&&te!==9||(U=!0)}U&&(G=u)!=null&&G.frame&&!u.key&&(l.pushAccessUnit(u,e),u=l.VideoSample=null),u||(u=l.VideoSample=l.createVideoSample(!0,r.pts,r.dts)),u.frame=!0,u.key=U;break;case 5:o=!0,(T=u)!=null&&T.frame&&!u.key&&(l.pushAccessUnit(u,e),u=l.VideoSample=null),u||(u=l.VideoSample=l.createVideoSample(!0,r.pts,r.dts)),u.key=!0,u.frame=!0;break;case 6:o=!0,Lr(M.data,1,r.pts,i.samples);break;case 7:var se,pe;o=!0,A=!0;var ye=M.data,he=l.readSPS(ye);if(!e.sps||e.width!==he.width||e.height!==he.height||((se=e.pixelRatio)==null?void 0:se[0])!==he.pixelRatio[0]||((pe=e.pixelRatio)==null?void 0:pe[1])!==he.pixelRatio[1]){e.width=he.width,e.height=he.height,e.pixelRatio=he.pixelRatio,e.sps=[ye];for(var ge=ye.subarray(1,4),Ae="avc1.",Te=0;Te<3;Te++){var Ee=ge[Te].toString(16);Ee.length<2&&(Ee="0"+Ee),Ae+=Ee}e.codec=Ae}break;case 8:o=!0,e.pps=[M.data];break;case 9:o=!0,e.audFound=!0,(P=u)!=null&&P.frame&&(l.pushAccessUnit(u,e),u=null),u||(u=l.VideoSample=l.createVideoSample(!1,r.pts,r.dts));break;case 12:o=!0;break;default:o=!1}u&&o&&u.units.push(M)}),a&&u&&(this.pushAccessUnit(u,e),this.VideoSample=null)},t.getNALuType=function(e,i){return 31&e[i]},t.readSliceType=function(e){var i=new hn(e);return i.readUByte(),i.readUEG(),i.readUEG()},t.skipScalingList=function(e,i){for(var r=8,a=8,o=0;o<e;o++)a!==0&&(a=(r+i.readEG()+256)%256),r=a===0?r:a},t.readSPS=function(e){var i,r,a,o=new hn(e),l=0,h=0,u=0,A=0,M=o.readUByte.bind(o),T=o.readBits.bind(o),P=o.readUEG.bind(o),U=o.readBoolean.bind(o),G=o.skipBits.bind(o),$=o.skipEG.bind(o),te=o.skipUEG.bind(o),se=this.skipScalingList.bind(this);M();var pe=M();if(T(5),G(3),M(),te(),pe===100||pe===110||pe===122||pe===244||pe===44||pe===83||pe===86||pe===118||pe===128){var ye=P();if(ye===3&&G(1),te(),te(),G(1),U())for(r=ye!==3?8:12,a=0;a<r;a++)U()&&se(a<6?16:64,o)}te();var he=P();if(he===0)P();else if(he===1)for(G(1),$(),$(),i=P(),a=0;a<i;a++)$();te(),G(1);var ge=P(),Ae=P(),Te=T(1);Te===0&&G(1),G(1),U()&&(l=P(),h=P(),u=P(),A=P());var Ee=[1,1];if(U()&&U())switch(M()){case 1:Ee=[1,1];break;case 2:Ee=[12,11];break;case 3:Ee=[10,11];break;case 4:Ee=[16,11];break;case 5:Ee=[40,33];break;case 6:Ee=[24,11];break;case 7:Ee=[20,11];break;case 8:Ee=[32,11];break;case 9:Ee=[80,33];break;case 10:Ee=[18,11];break;case 11:Ee=[15,11];break;case 12:Ee=[64,33];break;case 13:Ee=[160,99];break;case 14:Ee=[4,3];break;case 15:Ee=[3,2];break;case 16:Ee=[2,1];break;case 255:Ee=[M()<<8|M(),M()<<8|M()]}return{width:Math.ceil(16*(ge+1)-2*l-2*h),height:(2-Te)*(Ae+1)*16-(Te?2:4)*(u+A),pixelRatio:Ee}},n}(As),oi=188,Ts=function(){function s(t,e,i,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=r,this.videoParser=null}s.probe=function(t,e){var i=s.syncOffset(t);return i>0&&e.warn("MPEG2-TS detected but first sync word found @ offset "+i),i!==-1},s.syncOffset=function(t){for(var e=t.length,i=Math.min(940,e-oi)+1,r=0;r<i;){for(var a=!1,o=-1,l=0,h=r;h<e;h+=oi){if(t[h]!==71||e-h!==oi&&t[h+oi]!==71){if(l)return-1;break}if(l++,o===-1&&(o=h)!==0&&(i=Math.min(o+18612,t.length-oi)+1),a||(a=ma(t,h)===0),a&&l>1&&(o===0&&l>2||h+oi>i))return o}r++}return-1},s.createTrack=function(t,e){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:nr[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?e:void 0}};var n=s.prototype;return n.resetInitSegment=function(t,e,i,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=s.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=s.createTrack("audio",r),this._id3Track=s.createTrack("id3"),this._txtTrack=s.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=i},n.resetTimeStamp=function(){},n.resetContiguity=function(){var t=this._audioTrack,e=this._videoTrack,i=this._id3Track;t&&(t.pesData=null),e&&(e.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null},n.demux=function(t,e,i,r){var a;i===void 0&&(i=!1),r===void 0&&(r=!1),i||(this.sampleAes=null);var o=this._videoTrack,l=this._audioTrack,h=this._id3Track,u=this._txtTrack,A=o.pid,M=o.pesData,T=l.pid,P=h.pid,U=l.pesData,G=h.pesData,$=null,te=this.pmtParsed,se=this._pmtId,pe=t.length;if(this.remainderData&&(pe=(t=mi(this.remainderData,t)).length,this.remainderData=null),pe<oi&&!r)return this.remainderData=t,{audioTrack:l,videoTrack:o,id3Track:h,textTrack:u};var ye=Math.max(0,s.syncOffset(t));(pe-=(pe-ye)%oi)<t.byteLength&&!r&&(this.remainderData=new Uint8Array(t.buffer,pe,t.buffer.byteLength-pe));for(var he=0,ge=ye;ge<pe;ge+=oi)if(t[ge]===71){var Ae=!!(64&t[ge+1]),Te=ma(t,ge),Ee=void 0;if((48&t[ge+3])>>4>1){if((Ee=ge+5+t[ge+4])===ge+oi)continue}else Ee=ge+4;switch(Te){case A:Ae&&(M&&(a=gr(M,this.logger))&&(this.videoParser===null&&o.segmentCodec==="avc"&&(this.videoParser=new fn),this.videoParser!==null&&this.videoParser.parsePES(o,u,a,!1)),M={data:[],size:0}),M&&(M.data.push(t.subarray(Ee,ge+oi)),M.size+=ge+oi-Ee);break;case T:if(Ae){if(U&&(a=gr(U,this.logger)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,a);break;case"mp3":this.parseMPEGPES(l,a)}U={data:[],size:0}}U&&(U.data.push(t.subarray(Ee,ge+oi)),U.size+=ge+oi-Ee);break;case P:Ae&&(G&&(a=gr(G,this.logger))&&this.parseID3PES(h,a),G={data:[],size:0}),G&&(G.data.push(t.subarray(Ee,ge+oi)),G.size+=ge+oi-Ee);break;case 0:Ae&&(Ee+=t[Ee]+1),se=this._pmtId=Ls(t,Ee);break;case se:Ae&&(Ee+=t[Ee]+1);var xe=ws(t,Ee,this.typeSupported,i,this.observer,this.logger);(A=xe.videoPid)>0&&(o.pid=A,o.segmentCodec=xe.segmentVideoCodec),(T=xe.audioPid)>0&&(l.pid=T,l.segmentCodec=xe.segmentAudioCodec),(P=xe.id3Pid)>0&&(h.pid=P),$===null||te||(this.logger.warn("MPEG-TS PMT found at "+ge+" after unknown PID '"+$+"'. Backtracking to sync byte @"+ye+" to parse all TS packets."),$=null,ge=ye-188),te=this.pmtParsed=!0;break;case 17:case 8191:break;default:$=Te}}else he++;he>0&&Zr(this.observer,new Error("Found "+he+" TS packet/s that do not start with 0x47"),void 0,this.logger),o.pesData=M,l.pesData=U,h.pesData=G;var Pe={audioTrack:l,videoTrack:o,id3Track:h,textTrack:u};return r&&this.extractRemainingSamples(Pe),Pe},n.flush=function(){var t,e=this.remainderData;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t},n.extractRemainingSamples=function(t){var e,i=t.audioTrack,r=t.videoTrack,a=t.id3Track,o=t.textTrack,l=r.pesData,h=i.pesData,u=a.pesData;if(l&&(e=gr(l,this.logger))?(this.videoParser===null&&r.segmentCodec==="avc"&&(this.videoParser=new fn),this.videoParser!==null&&(this.videoParser.parsePES(r,o,e,!0),r.pesData=null)):r.pesData=l,h&&(e=gr(h,this.logger))){switch(i.segmentCodec){case"aac":this.parseAACPES(i,e);break;case"mp3":this.parseMPEGPES(i,e)}i.pesData=null}else h!=null&&h.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),i.pesData=h;u&&(e=gr(u,this.logger))?(this.parseID3PES(a,e),a.pesData=null):a.pesData=u},n.demuxSampleAes=function(t,e,i){var r=this.demux(t,i,!0,!this.config.progressive),a=this.sampleAes=new Ss(this.observer,this.config,e);return this.decrypt(r,a)},n.decrypt=function(t,e){return new Promise(function(i){var r=t.audioTrack,a=t.videoTrack;r.samples&&r.segmentCodec==="aac"?e.decryptAacSamples(r.samples,0,function(){a.samples?e.decryptAvcSamples(a.samples,0,0,function(){i(t)}):i(t)}):a.samples&&e.decryptAvcSamples(a.samples,0,0,function(){i(t)})})},n.destroy=function(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0},n.parseAACPES=function(t,e){var i,r,a,o=0,l=this.aacOverFlow,h=e.data;if(l){this.aacOverFlow=null;var u=l.missing,A=l.sample.unit.byteLength;if(u===-1)h=mi(l.sample.unit,h);else{var M=A-u;l.sample.unit.set(h.subarray(0,u),M),t.samples.push(l.sample),o=l.missing}}for(i=o,r=h.length;i<r-1&&!Wr(h,i);i++);if(i!==o){var T,P=i<r-1;if(T=P?"AAC PES did not start with ADTS header,offset:"+i:"No ADTS header found in AAC PES",Zr(this.observer,new Error(T),P,this.logger),!P)return}if(Ja(t,this.observer,h,i,this.audioCodec),e.pts!==void 0)a=e.pts;else{if(!l)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var U=en(t.samplerate);a=l.sample.pts+U}for(var G,$=0;i<r;){if(i+=(G=tn(t,h,i,a,$)).length,G.missing){this.aacOverFlow=G;break}for($++;i<r-1&&!Wr(h,i);i++);}},n.parseMPEGPES=function(t,e){var i=e.data,r=i.length,a=0,o=0,l=e.pts;if(l!==void 0)for(;o<r;)if(dn(i,o)){var h=on(t,i,o,l,a);if(!h)break;o+=h.length,a++}else o++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},n.parseAC3PES=function(t,e){},n.parseID3PES=function(t,e){if(e.pts!==void 0){var i=D({},e,{type:this._videoTrack?gi.emsg:gi.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(i)}else this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},s}();function ma(s,n){return((31&s[n+1])<<8)+s[n+2]}function Ls(s,n){return(31&s[n+10])<<8|s[n+11]}function ws(s,n,t,e,i,r){var a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=n+3+((15&s[n+1])<<8|s[n+2])-4;for(n+=12+((15&s[n+10])<<8|s[n+11]);n<o;){var l=ma(s,n),h=(15&s[n+3])<<8|s[n+4];switch(s[n]){case 207:if(!e){ga("ADTS AAC",r);break}case 15:a.audioPid===-1&&(a.audioPid=l);break;case 21:a.id3Pid===-1&&(a.id3Pid=l);break;case 219:if(!e){ga("H.264",r);break}case 27:a.videoPid===-1&&(a.videoPid=l);break;case 3:case 4:t.mpeg||t.mp3?a.audioPid===-1&&(a.audioPid=l,a.segmentAudioCodec="mp3"):r.log("MPEG audio found, not supported in this browser");break;case 193:if(!e){ga("AC-3",r);break}case 129:r.warn("AC-3 in M2TS support not included in build");break;case 6:if(a.audioPid===-1&&h>0)for(var u=n+5,A=h;A>2;){s[u]===106&&r.warn("AC-3 in M2TS support not included in build");var M=s[u+1]+2;u+=M,A-=M}break;case 194:case 135:return Zr(i,new Error("Unsupported EC-3 in M2TS found"),void 0,r),a;case 36:return Zr(i,new Error("Unsupported HEVC in M2TS found"),void 0,r),a}n+=h+5}return a}function Zr(s,n,t,e){e.warn("parsing error: "+n.message),s.emit(k.ERROR,k.ERROR,{type:re.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:n,reason:n.message})}function ga(s,n){n.log(s+" with AES-128-CBC encryption found in unencrypted stream")}function gr(s,n){var t,e,i,r,a,o=0,l=s.data;if(!s||s.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=mi(l[0],l[1]),l.splice(1,1);if(((t=l[0])[0]<<16)+(t[1]<<8)+t[2]===1){if((e=(t[4]<<8)+t[5])&&e>s.size-6)return null;var h=t[7];192&h&&(r=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&h?r-(a=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(n.warn(Math.round((r-a)/9e4)+"s delta between PTS and DTS, align them"),r=a):a=r);var u=(i=t[8])+9;if(s.size<=u)return null;s.size-=u;for(var A=new Uint8Array(s.size),M=0,T=l.length;M<T;M++){var P=(t=l[M]).byteLength;if(u){if(u>P){u-=P;continue}t=t.subarray(u),P-=u,u=0}A.set(t,o),o+=P}return e&&(e-=i+3),{data:A,pts:r,dts:a,len:e}}return null}var xs=function(){function s(){}return s.getSilentFrame=function(n,t){if(n==="mp4a.40.2"){if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},s}(),Wi=Math.pow(2,32)-1,ai=function(){function s(){}return s.init=function(){var n;for(n in s.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},s.types)s.types.hasOwnProperty(n)&&(s.types[n]=[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),e=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);s.HDLR_TYPES={video:t,audio:e};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);s.STTS=s.STSC=s.STCO=r,s.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),s.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),s.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),s.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);s.FTYP=s.box(s.types.ftyp,a,l,a,o),s.DINF=s.box(s.types.dinf,s.box(s.types.dref,i))},s.box=function(n){for(var t=8,e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];for(var a=i.length,o=a;a--;)t+=i[a].byteLength;var l=new Uint8Array(t);for(l[0]=t>>24&255,l[1]=t>>16&255,l[2]=t>>8&255,l[3]=255&t,l.set(n,4),a=0,t=8;a<o;a++)l.set(i[a],t),t+=i[a].byteLength;return l},s.hdlr=function(n){return s.box(s.types.hdlr,s.HDLR_TYPES[n])},s.mdat=function(n){return s.box(s.types.mdat,n)},s.mdhd=function(n,t){t*=n;var e=Math.floor(t/(Wi+1)),i=Math.floor(t%(Wi+1));return s.box(s.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,e>>24,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},s.mdia=function(n){return s.box(s.types.mdia,s.mdhd(n.timescale||0,n.duration||0),s.hdlr(n.type),s.minf(n))},s.mfhd=function(n){return s.box(s.types.mfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]))},s.minf=function(n){return n.type==="audio"?s.box(s.types.minf,s.box(s.types.smhd,s.SMHD),s.DINF,s.stbl(n)):s.box(s.types.minf,s.box(s.types.vmhd,s.VMHD),s.DINF,s.stbl(n))},s.moof=function(n,t,e){return s.box(s.types.moof,s.mfhd(n),s.traf(e,t))},s.moov=function(n){for(var t=n.length,e=[];t--;)e[t]=s.trak(n[t]);return s.box.apply(null,[s.types.moov,s.mvhd(n[0].timescale||0,n[0].duration||0)].concat(e).concat(s.mvex(n)))},s.mvex=function(n){for(var t=n.length,e=[];t--;)e[t]=s.trex(n[t]);return s.box.apply(null,[s.types.mvex].concat(e))},s.mvhd=function(n,t){t*=n;var e=Math.floor(t/(Wi+1)),i=Math.floor(t%(Wi+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,255&n,e>>24,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s.box(s.types.mvhd,r)},s.sdtp=function(n){var t,e,i=n.samples||[],r=new Uint8Array(4+i.length);for(t=0;t<i.length;t++)e=i[t].flags,r[t+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return s.box(s.types.sdtp,r)},s.stbl=function(n){return s.box(s.types.stbl,s.stsd(n),s.box(s.types.stts,s.STTS),s.box(s.types.stsc,s.STSC),s.box(s.types.stsz,s.STSZ),s.box(s.types.stco,s.STCO))},s.avc1=function(n){var t,e,i,r=[],a=[];for(t=0;t<n.sps.length;t++)i=(e=n.sps[t]).byteLength,r.push(i>>>8&255),r.push(255&i),r=r.concat(Array.prototype.slice.call(e));for(t=0;t<n.pps.length;t++)i=(e=n.pps[t]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(e));var o=s.box(s.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|n.sps.length].concat(r).concat([n.pps.length]).concat(a))),l=n.width,h=n.height,u=n.pixelRatio[0],A=n.pixelRatio[1];return s.box(s.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,h>>8&255,255&h,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,s.box(s.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),s.box(s.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,A>>24,A>>16&255,A>>8&255,255&A])))},s.esds=function(n){var t=n.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2].concat(t,[6,1,2]))},s.audioStsd=function(n){var t=n.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])},s.mp4a=function(n){return s.box(s.types.mp4a,s.audioStsd(n),s.box(s.types.esds,s.esds(n)))},s.mp3=function(n){return s.box(s.types[".mp3"],s.audioStsd(n))},s.ac3=function(n){return s.box(s.types["ac-3"],s.audioStsd(n),s.box(s.types.dac3,n.config))},s.stsd=function(n){var t=n.segmentCodec;if(n.type==="audio"){if(t==="aac")return s.box(s.types.stsd,s.STSD,s.mp4a(n));if(t==="mp3"&&n.codec==="mp3")return s.box(s.types.stsd,s.STSD,s.mp3(n))}else{if(!n.pps||!n.sps)throw new Error("video track missing pps or sps");if(t==="avc")return s.box(s.types.stsd,s.STSD,s.avc1(n))}throw new Error("unsupported "+n.type+" segment codec ("+t+"/"+n.codec+")")},s.tkhd=function(n){var t=n.id,e=(n.duration||0)*(n.timescale||0),i=n.width||0,r=n.height||0,a=Math.floor(e/(Wi+1)),o=Math.floor(e%(Wi+1));return s.box(s.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))},s.traf=function(n,t){var e=s.sdtp(n),i=n.id,r=Math.floor(t/(Wi+1)),a=Math.floor(t%(Wi+1));return s.box(s.types.traf,s.box(s.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),s.box(s.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,a>>24,a>>16&255,a>>8&255,255&a])),s.trun(n,e.length+16+20+8+16+8+8),e)},s.trak=function(n){return n.duration=n.duration||4294967295,s.box(s.types.trak,s.tkhd(n),s.mdia(n))},s.trex=function(n){var t=n.id;return s.box(s.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},s.trun=function(n,t){var e,i,r,a,o,l,h=n.samples||[],u=h.length,A=12+16*u,M=new Uint8Array(A);for(t+=8+A,M.set([n.type==="video"?1:0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),e=0;e<u;e++)r=(i=h[e]).duration,a=i.size,o=i.flags,l=i.cts,M.set([r>>>24&255,r>>>16&255,r>>>8&255,255&r,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*e);return s.box(s.types.trun,M)},s.initSegment=function(n){s.types||s.init();var t=s.moov(n);return mi(s.FTYP,t)},s.hvc1=function(n){return new Uint8Array},s}();function Mr(s,n){return function(t,e,i,r){var a=t*e*i;return Math.round(a)}(s,1e3,1/9e4)}ai.types=void 0,ai.HDLR_TYPES=void 0,ai.STTS=void 0,ai.STSC=void 0,ai.STCO=void 0,ai.STSZ=void 0,ai.VMHD=void 0,ai.SMHD=void 0,ai.STSD=void 0,ai.FTYP=void 0,ai.DINF=void 0;var vr=null,va=null;function pn(s,n,t,e){return{duration:n,size:t,cts:e,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:s?2:1,isNonSync:s?0:1}}}var _a=function(){function s(t,e,i,r){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=i,this.logger=r,this.ISGenerated=!1,vr===null){var a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);vr=a?parseInt(a[1]):0}if(va===null){var o=navigator.userAgent.match(/Safari\/(\d+)/i);va=o?parseInt(o[1]):0}}var n=s.prototype;return n.destroy=function(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null},n.resetTimeStamp=function(t){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t},n.resetNextTimestamp=function(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},n.resetInitSegment=function(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0},n.getVideoStartPts=function(t){var e=!1,i=t[0].pts,r=t.reduce(function(a,o){var l=o.pts,h=l-a;return h<-4294967296&&(e=!0,h=(l=Li(l,i))-a),h>0?a:l},i);return e&&this.logger.debug("PTS rollover detected"),r},n.remux=function(t,e,i,r,a,o,l,h){var u,A,M,T,P,U,G=a,$=a,te=t.pid>-1,se=e.pid>-1,pe=e.samples.length,ye=t.samples.length>0,he=l&&pe>0||pe>1;if((!te||ye)&&(!se||he)||this.ISGenerated||l){if(this.ISGenerated){var ge,Ae,Te,Ee,xe=this.videoTrackConfig;(xe&&(e.width!==xe.width||e.height!==xe.height||((ge=e.pixelRatio)==null?void 0:ge[0])!==((Ae=xe.pixelRatio)==null?void 0:Ae[0])||((Te=e.pixelRatio)==null?void 0:Te[1])!==((Ee=xe.pixelRatio)==null?void 0:Ee[1]))||!xe&&he||this.nextAudioPts===null&&ye)&&this.resetInitSegment()}this.ISGenerated||(M=this.generateIS(t,e,a,o));var Pe,ze=this.isVideoContiguous,Fe=-1;if(he&&(Fe=function(ot){for(var qe=0;qe<ot.length;qe++)if(ot[qe].key)return qe;return-1}(e.samples),!ze&&this.config.forceKeyFrameOnDiscontinuity))if(U=!0,Fe>0){this.logger.warn("[mp4-remuxer]: Dropped "+Fe+" out of "+pe+" video samples due to a missing keyframe");var Me=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(Fe),e.dropped+=Fe,Pe=$+=(e.samples[0].pts-Me)/e.inputTimeScale}else Fe===-1&&(this.logger.warn("[mp4-remuxer]: No keyframe found out of "+pe+" video samples"),U=!1);if(this.ISGenerated){if(ye&&he){var De=this.getVideoStartPts(e.samples),je=(Li(t.samples[0].pts,De)-De)/e.inputTimeScale;G+=Math.max(0,je),$+=Math.max(0,-je)}if(ye){if(t.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),M=this.generateIS(t,e,a,o)),A=this.remuxAudio(t,G,this.isAudioContiguous,o,se||he||h===H?$:void 0),he){var Ye=A?A.endPTS-A.startPTS:0;e.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),M=this.generateIS(t,e,a,o)),u=this.remuxVideo(e,$,ze,Ye)}}else he&&(u=this.remuxVideo(e,$,ze,0));u&&(u.firstKeyFrame=Fe,u.independent=Fe!==-1,u.firstKeyFramePTS=Pe)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(P=mn(i,a,this._initPTS,this._initDTS)),r.samples.length&&(T=gn(r,a,this._initPTS))),{audio:A,video:u,initSegment:M,independent:U,text:T,id3:P}},n.generateIS=function(t,e,i,r){var a,o,l,h,u=t.samples,A=e.samples,M=this.typeSupported,T={},P=this._initPTS,U=!P||r,G="audio/mp4";if(U&&(a=o=1/0),t.config&&u.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":M.mpeg?(G="audio/mpeg",t.codec=""):M.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3"}T.audio={id:"audio",container:G,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&M.mpeg?new Uint8Array(0):ai.initSegment([t]),metadata:{channelCount:t.channelCount}},U&&(h=t.id,l=t.inputTimeScale,P&&l===P.timescale?U=!1:a=o=u[0].pts-Math.round(l*i))}if(e.sps&&e.pps&&A.length){if(e.timescale=e.inputTimeScale,T.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:ai.initSegment([e]),metadata:{width:e.width,height:e.height}},U)if(h=e.id,l=e.inputTimeScale,P&&l===P.timescale)U=!1;else{var $=this.getVideoStartPts(A),te=Math.round(l*i);o=Math.min(o,Li(A[0].dts,$)-te),a=Math.min(a,$-te)}this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(T).length)return this.ISGenerated=!0,U?(this._initPTS={baseTime:a,timescale:l},this._initDTS={baseTime:o,timescale:l}):a=l=void 0,{tracks:T,initPTS:a,timescale:l,trackId:h}},n.remuxVideo=function(t,e,i,r){var a,o,l=t.inputTimeScale,h=t.samples,u=[],A=h.length,M=this._initPTS,T=this.nextAvcDts,P=8,U=this.videoSampleDuration,G=Number.POSITIVE_INFINITY,$=Number.NEGATIVE_INFINITY,te=!1;if(!i||T===null){var se=e*l,pe=h[0].pts-Li(h[0].dts,h[0].pts);vr&&T!==null&&Math.abs(se-pe-T)<15e3?i=!0:T=se-pe}for(var ye=M.baseTime*l/M.timescale,he=0;he<A;he++){var ge=h[he];ge.pts=Li(ge.pts-ye,T),ge.dts=Li(ge.dts-ye,T),ge.dts<h[he>0?he-1:he].dts&&(te=!0)}te&&h.sort(function(Ci,xi){var xa=Ci.dts-xi.dts,to=Ci.pts-xi.pts;return xa||to}),a=h[0].dts;var Ae=(o=h[h.length-1].dts)-a,Te=Ae?Math.round(Ae/(A-1)):U||t.inputTimeScale/30;if(i){var Ee=a-T,xe=Ee>Te,Pe=Ee<-1;if((xe||Pe)&&(xe?this.logger.warn((t.segmentCodec||"").toUpperCase()+": "+Mr(Ee)+" ms ("+Ee+"dts) hole between fragments detected at "+e.toFixed(3)):this.logger.warn((t.segmentCodec||"").toUpperCase()+": "+Mr(-Ee)+" ms ("+Ee+"dts) overlapping between fragments detected at "+e.toFixed(3)),!Pe||T>=h[0].pts||vr)){a=T;var ze=h[0].pts-Ee;if(xe)h[0].dts=a,h[0].pts=ze;else for(var Fe=!0,Me=0;Me<h.length&&!(h[Me].dts>ze&&Fe);Me++){var De=h[Me].pts;if(h[Me].dts-=Ee,h[Me].pts-=Ee,Me<h.length-1){var je=h[Me+1].pts;Fe=je<=h[Me].pts==je<=De}}this.logger.log("Video: Initial PTS/DTS adjusted: "+Mr(ze)+"/"+Mr(a)+", delta: "+Mr(Ee)+" ms")}}for(var Ye=0,ot=0,qe=a=Math.max(0,a),Lt=0;Lt<A;Lt++){for(var It=h[Lt],mt=It.units,At=mt.length,Ct=0,bt=0;bt<At;bt++)Ct+=mt[bt].data.length;ot+=Ct,Ye+=At,It.length=Ct,It.dts<qe?(It.dts=qe,qe+=Te/4|0||1):qe=It.dts,G=Math.min(It.pts,G),$=Math.max(It.pts,$)}o=h[A-1].dts;var yt,ft=ot+4*Ye+8;try{yt=new Uint8Array(ft)}catch(Ci){return void this.observer.emit(k.ERROR,k.ERROR,{type:re.MUX_ERROR,details:K.REMUX_ALLOC_ERROR,fatal:!1,error:Ci,bytes:ft,reason:"fail allocating video mdat "+ft})}var gt=new DataView(yt.buffer);gt.setUint32(0,ft),yt.set(ai.types.mdat,4);for(var nt=!1,pt=Number.POSITIVE_INFINITY,Mt=Number.POSITIVE_INFINITY,Rt=Number.NEGATIVE_INFINITY,Dt=Number.NEGATIVE_INFINITY,Ot=0;Ot<A;Ot++){for(var wt=h[Ot],St=wt.units,ci=0,li=0,ni=St.length;li<ni;li++){var di=St[li],jt=di.data,Zt=di.data.byteLength;gt.setUint32(P,Zt),P+=4,yt.set(jt,P),P+=Zt,ci+=4+Zt}var pi=void 0;if(Ot<A-1)U=h[Ot+1].dts-wt.dts,pi=h[Ot+1].pts-wt.pts;else{var Ki=this.config,wi=Ot>0?wt.dts-h[Ot-1].dts:Te;if(pi=Ot>0?wt.pts-h[Ot-1].pts:Te,Ki.stretchShortVideoTrack&&this.nextAudioPts!==null){var rr=Math.floor(Ki.maxBufferHole*l),Qi=(r?G+r*l:this.nextAudioPts)-wt.pts;Qi>rr?((U=Qi-wi)<0?U=wi:nt=!0,this.logger.log("[mp4-remuxer]: It is approximately "+Qi/90+" ms to the next segment; using duration "+U/90+" ms for the last video frame.")):U=wi}else U=wi}var Sr=Math.round(wt.pts-wt.dts);pt=Math.min(pt,U),Rt=Math.max(Rt,U),Mt=Math.min(Mt,pi),Dt=Math.max(Dt,pi),u.push(pn(wt.key,U,ci,Sr))}if(u.length){if(vr){if(vr<70){var ar=u[0].flags;ar.dependsOn=2,ar.isNonSync=0}}else if(va&&Dt-Mt<Rt-pt&&Te/Rt<.025&&u[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var Kt=a,ti=0,Zi=u.length;ti<Zi;ti++){var Ii=Kt+u[ti].duration,Pt=Kt+u[ti].cts;if(ti<Zi-1){var Vt=Ii+u[ti+1].cts;u[ti].duration=Vt-Pt}else u[ti].duration=ti?u[ti-1].duration:Te;u[ti].cts=0,Kt=Ii}}}U=nt||!U?Te:U,this.nextAvcDts=T=o+U,this.videoSampleDuration=U,this.isVideoContiguous=!0;var Nt={data1:ai.moof(t.sequenceNumber++,a,D(t,{samples:u})),data2:yt,startPTS:G/l,endPTS:($+U)/l,startDTS:a/l,endDTS:T/l,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:t.dropped};return t.samples=[],t.dropped=0,Nt},n.getSamplesPerFrame=function(t){switch(t.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}},n.remuxAudio=function(t,e,i,r,a){var o=t.inputTimeScale,l=o/(t.samplerate?t.samplerate:o),h=this.getSamplesPerFrame(t),u=h*l,A=this._initPTS,M=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,T=[],P=a!==void 0,U=t.samples,G=M?0:8,$=this.nextAudioPts||-1,te=e*o,se=A.baseTime*o/A.timescale;if(this.isAudioContiguous=i=i||U.length&&$>0&&(r&&Math.abs(te-$)<9e3||Math.abs(Li(U[0].pts-se,te)-$)<20*u),U.forEach(function(Mt){Mt.pts=Li(Mt.pts-se,te)}),!i||$<0){if(U=U.filter(function(Mt){return Mt.pts>=0}),!U.length)return;$=a===0?0:r&&!P?Math.max(0,te):U[0].pts}if(t.segmentCodec==="aac")for(var pe=this.config.maxAudioFramesDrift,ye=0,he=$;ye<U.length;ye++){var ge=U[ye],Ae=ge.pts,Te=Ae-he,Ee=Math.abs(1e3*Te/o);if(Te<=-pe*u&&P)ye===0&&(this.logger.warn("Audio frame @ "+(Ae/o).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*Te/o)+" ms."),this.nextAudioPts=$=he=Ae);else if(Te>=pe*u&&Ee<1e4&&P){var xe=Math.round(Te/u);(he=Ae-xe*u)<0&&(xe--,he+=u),ye===0&&(this.nextAudioPts=$=he),this.logger.warn("[mp4-remuxer]: Injecting "+xe+" audio frame @ "+(he/o).toFixed(3)+"s due to "+Math.round(1e3*Te/o)+" ms gap.");for(var Pe=0;Pe<xe;Pe++){var ze=Math.max(he,0),Fe=xs.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);Fe||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Fe=ge.unit.subarray()),U.splice(ye,0,{unit:Fe,pts:ze}),he+=u,ye++}}ge.pts=he,he+=u}for(var Me,De=null,je=null,Ye=0,ot=U.length;ot--;)Ye+=U[ot].unit.byteLength;for(var qe=0,Lt=U.length;qe<Lt;qe++){var It=U[qe],mt=It.unit,At=It.pts;if(je!==null)T[qe-1].duration=Math.round((At-je)/l);else{if(i&&t.segmentCodec==="aac"&&(At=$),De=At,!(Ye>0))return;Ye+=G;try{Me=new Uint8Array(Ye)}catch(Mt){return void this.observer.emit(k.ERROR,k.ERROR,{type:re.MUX_ERROR,details:K.REMUX_ALLOC_ERROR,fatal:!1,error:Mt,bytes:Ye,reason:"fail allocating audio mdat "+Ye})}M||(new DataView(Me.buffer).setUint32(0,Ye),Me.set(ai.types.mdat,4))}Me.set(mt,G);var Ct=mt.byteLength;G+=Ct,T.push(pn(!0,h,Ct,0)),je=At}var bt=T.length;if(bt){var yt=T[T.length-1];this.nextAudioPts=$=je+l*yt.duration;var ft=M?new Uint8Array(0):ai.moof(t.sequenceNumber++,De/l,D({},t,{samples:T}));t.samples=[];var gt=De/o,nt=$/o,pt={data1:ft,data2:Me,startPTS:gt,endPTS:nt,startDTS:gt,endDTS:nt,type:"audio",hasAudio:!0,hasVideo:!1,nb:bt};return this.isAudioContiguous=!0,pt}},s}();function Li(s,n){var t;if(n===null)return s;for(t=n<s?-8589934592:8589934592;Math.abs(s-n)>4294967296;)s+=t;return s}function mn(s,n,t,e){var i=s.samples.length;if(i){for(var r=s.inputTimeScale,a=0;a<i;a++){var o=s.samples[a];o.pts=Li(o.pts-t.baseTime*r/t.timescale,n*r)/r,o.dts=Li(o.dts-e.baseTime*r/e.timescale,n*r)/r}var l=s.samples;return s.samples=[],{samples:l}}}function gn(s,n,t){var e=s.samples.length;if(e){for(var i=s.inputTimeScale,r=0;r<e;r++){var a=s.samples[r];a.pts=Li(a.pts-t.baseTime*i/t.timescale,n*i)/i}s.samples.sort(function(l,h){return l.pts-h.pts});var o=s.samples;return s.samples=[],{samples:o}}}var ji,ks=function(){function s(t,e,i,r){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,this.logger=r}var n=s.prototype;return n.destroy=function(){},n.resetTimeStamp=function(t){this.initPTS=t,this.lastEndTime=null},n.resetNextTimestamp=function(){this.isVideoContiguous=!1,this.lastEndTime=null},n.resetInitSegment=function(t,e,i,r){this.audioCodec=e,this.videoCodec=i,this.generateInitSegment(sa(t,r)),this.emitInitSegment=!0},n.generateInitSegment=function(t){var e=this.audioCodec,i=this.videoCodec;if(t==null||!t.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var r=this.initData=dr(t);r.audio&&(e=vn(r.audio,Jt,this.logger)),r.video&&(i=vn(r.video,Bt,this.logger));var a={};r.audio&&r.video?a.audiovideo={container:"video/mp4",codec:e+","+i,supplemental:r.video.supplemental,initSegment:t,id:"main"}:r.audio?a.audio={container:"audio/mp4",codec:e,initSegment:t,id:"audio"}:r.video?a.video={container:"video/mp4",codec:i,supplemental:r.video.supplemental,initSegment:t,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a},n.remux=function(t,e,i,r,a,o){var l,h,u=this.initPTS,A=this.lastEndTime,M={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};x(A)||(A=this.lastEndTime=a||0);var T=e.samples;if(T==null||!T.length)return M;var P={initPTS:void 0,timescale:void 0,trackId:void 0},U=this.initData;if((l=U)!=null&&l.length||(this.generateInitSegment(T),U=this.initData),(h=U)==null||!h.length)return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),M;this.emitInitSegment&&(P.tracks=this.initTracks,this.emitInitSegment=!1);var G,$=function(qe,Lt,It){for(var mt={},At=lt(qe,["moof","traf"]),Ct=0;Ct<At.length;Ct++){var bt=At[Ct],yt=lt(bt,["tfhd"])[0],ft=it(yt,4),gt=Lt[ft];if(gt){var nt=mt[ft]||(mt[ft]={start:NaN,duration:0,sampleCount:0,timescale:gt.timescale,type:gt.type}),pt=lt(bt,["tfdt"])[0];if(pt){var Mt=pt[0],Rt=it(pt,4);Mt===1&&(Rt===Ai?It.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(Rt*=Ai+1,Rt+=it(pt,8))),x(Rt)&&(!x(nt.start)||Rt<nt.start)&&(nt.start=Rt)}var Dt=gt.default,Ot=it(yt,0)|(Dt==null?void 0:Dt.flags),wt=(Dt==null?void 0:Dt.duration)||0;8&Ot&&(wt=it(yt,2&Ot?12:8));for(var St=lt(bt,["trun"]),ci=nt.start||0,li=0,ni=wt,di=0;di<St.length;di++){var jt=St[di],Zt=it(jt,4),pi=nt.sampleCount;nt.sampleCount+=Zt;var Ki=1&jt[3],wi=4&jt[3],rr=1&jt[2],Qi=2&jt[2],Sr=4&jt[2],ar=8&jt[2],Kt=8,ti=Zt;for(Ki&&(Kt+=4),wi&&Zt&&(1&jt[Kt+1]||nt.keyFrameIndex!==void 0||(nt.keyFrameIndex=pi),Kt+=4,rr?(ni=it(jt,Kt),Kt+=4):ni=wt,Qi&&(Kt+=4),ar&&(Kt+=4),ci+=ni,li+=ni,ti--);ti--;)rr?(ni=it(jt,Kt),Kt+=4):ni=wt,Qi&&(Kt+=4),Sr&&(1&jt[Kt+1]||nt.keyFrameIndex===void 0&&(nt.keyFrameIndex=nt.sampleCount-(ti+1),nt.keyFrameStart=ci),Kt+=4),ar&&(Kt+=4),ci+=ni,li+=ni;!li&&wt&&(li+=wt*Zt)}nt.duration+=li}}if(!Object.keys(mt).some(function(xi){return mt[xi].duration})){for(var Zi=1/0,Ii=0,Pt=lt(qe,["sidx"]),Vt=0;Vt<Pt.length;Vt++){var Nt=Ar(Pt[Vt]);if(Nt!=null&&Nt.references){Zi=Math.min(Zi,Nt.earliestPresentationTime/Nt.timescale);var Ci=Nt.references.reduce(function(xi,xa){return xi+xa.info.duration||0},0);Ii=Math.max(Ii,Ci+Nt.earliestPresentationTime/Nt.timescale)}}Ii&&x(Ii)&&Object.keys(mt).forEach(function(xi){mt[xi].duration||(mt[xi].duration=Ii*mt[xi].timescale-mt[xi].start)})}return mt}(T,U,this.logger),te=U.audio?$[U.audio.id]:null,se=U.video?$[U.video.id]:null,pe=Xr(se,1/0),ye=Xr(te,1/0),he=Xr(se,0,!0),ge=Xr(te,0,!0),Ae=a,Te=0;if(te&&(!se||!u&&ye<pe||u&&u.trackId===U.audio.id)?(P.trackId=U.audio.id,G=te,Te=ge-ye):se&&(P.trackId=U.video.id,G=se,Te=he-pe),G){var Ee=G.timescale;Ae=G.start/Ee,P.timescale=Ee,u||(P.initPTS=G.start-a*Ee,this.initPTS=u={baseTime:P.initPTS,timescale:Ee,trackId:P.trackId})}!o&&u||!function(qe,Lt,It,mt){if(qe===null)return!0;var At=Math.max(mt,1),Ct=Lt-qe.baseTime/qe.timescale;return Math.abs(Ct-It)>At}(u,Ae,a,Te)&&P.timescale===u.timescale||(P.initPTS=Ae-a,u&&u.timescale===1&&this.logger.warn("Adjusting initPTS @"+a+" from "+u.baseTime/u.timescale+" to "+P.initPTS),this.initPTS=u={baseTime:P.initPTS,timescale:1});var xe=t?Ae-u.baseTime/u.timescale:A;(function(qe,Lt,It){lt(Lt,["moof","traf"]).forEach(function(mt){lt(mt,["tfhd"]).forEach(function(At){var Ct=it(At,4),bt=qe[Ct];if(bt){var yt=bt.timescale||9e4;lt(mt,["tfdt"]).forEach(function(ft){var gt=ft[0],nt=It*yt;if(nt){var pt=it(ft,4);if(gt===0)pt-=nt,Xi(ft,4,pt=Math.max(pt,0));else{pt*=Math.pow(2,32),pt+=it(ft,8),pt-=nt,pt=Math.max(pt,0);var Mt=Math.floor(pt/(Ai+1)),Rt=Math.floor(pt%(Ai+1));Xi(ft,4,Mt),Xi(ft,8,Rt)}}})}})})})(U,T,u.baseTime/u.timescale);var Pe=xe+Te;Te>0?this.lastEndTime=Pe:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var ze=!!U.audio,Fe=!!U.video,Me="";ze&&(Me+="audio"),Fe&&(Me+="video");var De={data1:T,startPTS:xe,startDTS:xe,endPTS:Pe,endDTS:Pe,type:Me,hasAudio:ze,hasVideo:Fe,nb:1,dropped:0};M.audio=ze&&!Fe?De:void 0,M.video=Fe?De:void 0;var je=se==null?void 0:se.sampleCount;if(je){var Ye=se.keyFrameIndex,ot=Ye!==-1;De.nb=je,De.dropped=Ye===0||this.isVideoContiguous?0:ot?Ye:je,De.independent=ot,De.firstKeyFrame=Ye,ot&&se.keyFrameStart&&(De.firstKeyFramePTS=se.keyFrameStart-u.baseTime/u.timescale),this.isVideoContiguous||(M.independent=ot),this.isVideoContiguous||(this.isVideoContiguous=ot),De.dropped&&this.logger.warn("fmp4 does not start with IDR: firstIDR "+Ye+"/"+je+" dropped: "+De.dropped+" pts: "+(De.firstKeyFramePTS||"NA"))}return M.initSegment=P,M.id3=mn(i,a,u,u),r.samples.length&&(M.text=gn(r,a,u)),M},s}();function Xr(s,n,t){return t===void 0&&(t=!1),(s==null?void 0:s.start)!==void 0?(s.start+(t?s.duration:0))/s.timescale:n}function vn(s,n,t){var e=s==null?void 0:s.codec;return e&&e.length>4?e:n===Jt?e==="ec-3"||e==="ac-3"||e==="alac"?e:e==="fLaC"||e==="Opus"?O(e,!1):(t.warn('Unhandled audio codec "'+e+'" in mp4 MAP'),e||"mp4a"):(t.warn('Unhandled video codec "'+e+'" in mp4 MAP'),e||"avc1")}try{ji=self.performance.now.bind(self.performance)}catch(s){ji=Date.now}var ya=[{demux:Es,remux:ks},{demux:Ts,remux:_a},{demux:ms,remux:_a},{demux:gs,remux:_a}],ba=function(){function s(t,e,i,r,a,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=i,this.id=a,this.logger=o}var n=s.prototype;return n.configure=function(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()},n.push=function(t,e,i,r){var a=this,o=i.transmuxing;o.executeStart=ji();var l=new Uint8Array(t),h=this.currentTransmuxState,u=this.transmuxConfig;r&&(this.currentTransmuxState=r);var A=r||h,M=A.contiguous,T=A.discontinuity,P=A.trackSwitch,U=A.accurateTimeOffset,G=A.timeOffset,$=A.initSegmentChange,te=u.audioCodec,se=u.videoCodec,pe=u.defaultInitPts,ye=u.duration,he=u.initSegmentData,ge=function(De,je){var Ye=null;return De.byteLength>0&&(je==null?void 0:je.key)!=null&&je.iv!==null&&je.method!=null&&(Ye=je),Ye}(l,e);if(ge&&qi(ge.method)){var Ae=this.getDecrypter(),Te=Rr(ge.method);if(!Ae.isSync())return this.asyncResult=!0,this.decryptionPromise=Ae.webCryptoDecrypt(l,ge.key.buffer,ge.iv.buffer,Te).then(function(De){var je=a.push(De,null,i);return a.decryptionPromise=null,je}),this.decryptionPromise;var Ee=Ae.softwareDecrypt(l,ge.key.buffer,ge.iv.buffer,Te);if(i.part>-1){var xe=Ae.flush();Ee=xe&&xe.buffer}if(!Ee)return o.executeEnd=ji(),Ea(i);l=new Uint8Array(Ee)}var Pe=this.needsProbing(T,P);if(Pe){var ze=this.configureTransmuxer(l);if(ze)return this.logger.warn("[transmuxer] "+ze.message),this.observer.emit(k.ERROR,k.ERROR,{type:re.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:ze,reason:ze.message}),o.executeEnd=ji(),Ea(i)}(T||P||$||Pe)&&this.resetInitSegment(he,te,se,ye,e),(T||$||Pe)&&this.resetInitialTimestamp(pe),M||this.resetContiguity();var Fe=this.transmux(l,ge,G,U,i);this.asyncResult=ir(Fe);var Me=this.currentTransmuxState;return Me.contiguous=!0,Me.discontinuity=!1,Me.trackSwitch=!1,o.executeEnd=ji(),Fe},n.flush=function(t){var e=this,i=t.transmuxing;i.executeStart=ji();var r=this.decrypter,a=this.currentTransmuxState,o=this.decryptionPromise;if(o)return this.asyncResult=!0,o.then(function(){return e.flush(t)});var l=[],h=a.timeOffset;if(r){var u=r.flush();u&&l.push(this.push(u.buffer,null,t))}var A=this.demuxer,M=this.remuxer;if(!A||!M){i.executeEnd=ji();var T=[Ea(t)];return this.asyncResult?Promise.resolve(T):T}var P=A.flush(h);return ir(P)?(this.asyncResult=!0,P.then(function(U){return e.flushRemux(l,U,t),l})):(this.flushRemux(l,P,t),this.asyncResult?Promise.resolve(l):l)},n.flushRemux=function(t,e,i){var r=e.audioTrack,a=e.videoTrack,o=e.id3Track,l=e.textTrack,h=this.currentTransmuxState,u=h.accurateTimeOffset,A=h.timeOffset;this.logger.log("[transmuxer.ts]: Flushed "+this.id+" sn: "+i.sn+(i.part>-1?" part: "+i.part:"")+" of "+(this.id===q?"level":"track")+" "+i.level);var M=this.remuxer.remux(r,a,o,l,A,u,!0,this.id);t.push({remuxResult:M,chunkMeta:i}),i.transmuxing.executeEnd=ji()},n.resetInitialTimestamp=function(t){var e=this.demuxer,i=this.remuxer;e&&i&&(e.resetTimeStamp(t),i.resetTimeStamp(t))},n.resetContiguity=function(){var t=this.demuxer,e=this.remuxer;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())},n.resetInitSegment=function(t,e,i,r,a){var o=this.demuxer,l=this.remuxer;o&&l&&(o.resetInitSegment(t,e,i,r),l.resetInitSegment(t,e,i,a))},n.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},n.transmux=function(t,e,i,r,a){return e&&e.method==="SAMPLE-AES"?this.transmuxSampleAes(t,e,i,r,a):this.transmuxUnencrypted(t,i,r,a)},n.transmuxUnencrypted=function(t,e,i,r){var a=this.demuxer.demux(t,e,!1,!this.config.progressive),o=a.audioTrack,l=a.videoTrack,h=a.id3Track,u=a.textTrack;return{remuxResult:this.remuxer.remux(o,l,h,u,e,i,!1,this.id),chunkMeta:r}},n.transmuxSampleAes=function(t,e,i,r,a){var o=this;return this.demuxer.demuxSampleAes(t,e,i).then(function(l){return{remuxResult:o.remuxer.remux(l.audioTrack,l.videoTrack,l.id3Track,l.textTrack,i,r,!1,o.id),chunkMeta:a}})},n.configureTransmuxer=function(t){for(var e,i=this.config,r=this.observer,a=this.typeSupported,o=0,l=ya.length;o<l;o++){var h;if((h=ya[o].demux)!=null&&h.probe(t,this.logger)){e=ya[o];break}}if(!e)return new Error("Failed to find demuxer by probing fragment data");var u=this.demuxer,A=this.remuxer,M=e.remux,T=e.demux;A&&A instanceof M||(this.remuxer=new M(r,i,a,this.logger)),u&&u instanceof T||(this.demuxer=new T(r,i,a,this.logger),this.probe=T.probe)},n.needsProbing=function(t,e){return!this.demuxer||!this.remuxer||t||e},n.getDecrypter=function(){var t=this.decrypter;return t||(t=this.decrypter=new pa(this.config)),t},s}(),Ea=function(s){return{remuxResult:{},chunkMeta:s}};function ir(s){return"then"in s&&s.then instanceof Function}var Rs=function(s,n,t,e,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=s,this.videoCodec=n,this.initSegmentData=t,this.duration=e,this.defaultInitPts=i||null},Ds=function(s,n,t,e,i,r){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=s,this.contiguous=n,this.accurateTimeOffset=t,this.trackSwitch=e,this.timeOffset=i,this.initSegmentChange=r},Ms=/(\d+)-(\d+)\/(\d+)/,_n=function(){function s(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||Is,this.controller=new self.AbortController,this.stats=new Xe}var n=s.prototype;return n.destroy=function(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null},n.abortInternal=function(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())},n.abort=function(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},n.load=function(t,e,i){var r=this,a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();var o=function(T,P){var U={method:"GET",mode:"cors",credentials:"same-origin",signal:P,headers:new self.Headers(D({},T.headers))};return T.rangeEnd&&U.headers.set("Range","bytes="+T.rangeStart+"-"+String(T.rangeEnd-1)),U}(t,this.controller.signal),l=t.responseType==="arraybuffer",h=l?"byteLength":"length",u=e.loadPolicy,A=u.maxTimeToFirstByteMs,M=u.maxLoadTimeMs;this.context=t,this.config=e,this.callbacks=i,this.request=this.fetchSetup(t,o),self.clearTimeout(this.requestTimeout),e.timeout=A&&x(A)?A:M,this.requestTimeout=self.setTimeout(function(){r.callbacks&&(r.abortInternal(),r.callbacks.onTimeout(a,t,r.response))},e.timeout),(ir(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(function(T){var P;r.response=r.loader=T;var U=Math.max(self.performance.now(),a.loading.start);if(self.clearTimeout(r.requestTimeout),e.timeout=M,r.requestTimeout=self.setTimeout(function(){r.callbacks&&(r.abortInternal(),r.callbacks.onTimeout(a,t,r.response))},M-(U-a.loading.start)),!T.ok){var G=T.status,$=T.statusText;throw new Cs($||"fetch, bad network response",G,T)}a.loading.first=U,a.total=function(se){var pe=se.get("Content-Range");if(pe){var ye=function(ge){var Ae=Ms.exec(ge);if(Ae)return parseInt(Ae[2])-parseInt(Ae[1])+1}(pe);if(x(ye))return ye}var he=se.get("Content-Length");if(he)return parseInt(he)}(T.headers)||a.total;var te=(P=r.callbacks)==null?void 0:P.onProgress;return te&&x(e.highWaterMark)?r.loadProgressively(T,a,t,e.highWaterMark,te):l?T.arrayBuffer():t.responseType==="json"?T.json():T.text()}).then(function(T){var P,U,G=r.response;if(!G)throw new Error("loader destroyed");self.clearTimeout(r.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first);var $=T[h];$&&(a.loaded=a.total=$);var te={url:G.url,data:T,code:G.status},se=(P=r.callbacks)==null?void 0:P.onProgress;se&&!x(e.highWaterMark)&&se(a,t,T,G),(U=r.callbacks)==null||U.onSuccess(te,a,t,G)}).catch(function(T){var P;if(self.clearTimeout(r.requestTimeout),!a.aborted){var U=T&&T.code||0,G=T?T.message:null;(P=r.callbacks)==null||P.onError({code:U,text:G},t,T?T.details:null,a)}})},n.getCacheAge=function(){var t=null;if(this.response){var e=this.response.headers.get("age");t=e?parseFloat(e):null}return t},n.getResponseHeader=function(t){return this.response?this.response.headers.get(t):null},n.loadProgressively=function(t,e,i,r,a){r===void 0&&(r=0);var o=new is,l=t.body.getReader(),h=function(){return l.read().then(function(u){if(u.done)return o.dataLength&&a(e,i,o.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));var A=u.value,M=A.length;return e.loaded+=M,M<r||o.dataLength?(o.push(A),o.dataLength>=r&&a(e,i,o.flush().buffer,t)):a(e,i,A.buffer,t),h()}).catch(function(){return Promise.reject()})};return h()},s}();function Is(s,n){return new self.Request(s.url,n)}var Cs=function(s){function n(t,e,i){var r;return(r=s.call(this,t)||this).code=void 0,r.details=void 0,r.code=e,r.details=i,r}return y(n,s),n}(z(Error)),Os=/^age:\s*[\d.]+\s*$/im,yn=function(){function s(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new Xe,this.retryDelay=0}var n=s.prototype;return n.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null},n.abortInternal=function(){var t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))},n.abort=function(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},n.load=function(t,e,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=i,this.loadInternal()},n.loadInternal=function(){var t=this,e=this.config,i=this.context;if(e&&i){var r=this.loader=new self.XMLHttpRequest,a=this.stats;a.loading.first=0,a.loaded=0,a.aborted=!1;var o=this.xhrSetup;o?Promise.resolve().then(function(){if(t.loader===r&&!t.stats.aborted)return o(r,i.url)}).catch(function(l){if(t.loader===r&&!t.stats.aborted)return r.open("GET",i.url,!0),o(r,i.url)}).then(function(){t.loader!==r||t.stats.aborted||t.openAndSendXhr(r,i,e)}).catch(function(l){var h;(h=t.callbacks)==null||h.onError({code:r.status,text:l.message},i,r,a)}):this.openAndSendXhr(r,i,e)}},n.openAndSendXhr=function(t,e,i){t.readyState||t.open("GET",e.url,!0);var r=e.headers,a=i.loadPolicy,o=a.maxTimeToFirstByteMs,l=a.maxLoadTimeMs;if(r)for(var h in r)t.setRequestHeader(h,r[h]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),i.timeout=o&&x(o)?o:l,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),t.send()},n.readystatechange=function(){var t=this.context,e=this.loader,i=this.stats;if(t&&e){var r=e.readyState,a=this.config;if(!i.aborted&&r>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;var o=e.status,l=e.responseType==="text"?e.responseText:null;if(o>=200&&o<300){var h=l!=null?l:e.response;if(h!=null){var u,A;i.loading.end=Math.max(self.performance.now(),i.loading.first);var M=e.responseType==="arraybuffer"?h.byteLength:h.length;i.loaded=i.total=M,i.bwEstimate=8e3*i.total/(i.loading.end-i.loading.first);var T=(u=this.callbacks)==null?void 0:u.onProgress;T&&T(i,t,h,e);var P={url:e.responseURL,data:h,code:o};return void((A=this.callbacks)==null||A.onSuccess(P,i,t,e))}}var U,G=a.loadPolicy.errorRetry;qt(G,i.retry,!1,{url:t.url,data:void 0,code:o})?this.retry(G):(Ze.error(o+" while loading "+t.url),(U=this.callbacks)==null||U.onError({code:o,text:e.statusText},t,e,i))}}},n.loadtimeout=function(){if(this.config){var t=this.config.loadPolicy.timeoutRetry;if(qt(t,this.stats.retry,!0))this.retry(t);else{var e;Ze.warn("timeout while loading "+((e=this.context)==null?void 0:e.url));var i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}},n.retry=function(t){var e=this.context,i=this.stats;this.retryDelay=Ut(t,i.retry),i.retry++,Ze.warn((status?"HTTP Status "+status:"Timeout")+" while loading "+(e==null?void 0:e.url)+", retrying "+i.retry+"/"+t.maxNumRetry+" in "+this.retryDelay+"ms"),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)},n.loadprogress=function(t){var e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)},n.getCacheAge=function(){var t=null;if(this.loader&&Os.test(this.loader.getAllResponseHeaders())){var e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t},n.getResponseHeader=function(t){return this.loader&&new RegExp("^"+t+":\\s*[\\d.]+\\s*$","im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null},s}(),bn={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},Ps=E(E({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:yn,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:dt,bufferController:wr,capLevelController:xr,errorController:hr,fpsController:ts,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:null,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!1,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!1,preserveManualLevelOnError:!1,certLoadPolicy:{default:bn},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:bn},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:Xt,enableWebVTT:!1,enableIMSC1:!1,enableCEA708Captions:!1,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:void 0,subtitleTrackController:void 0,timelineController:void 0,audioStreamController:void 0,audioTrackController:void 0,emeController:void 0,cmcdController:void 0,contentSteeringController:es,interstitialsController:void 0});function Sa(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(Sa):Object.keys(s).reduce(function(n,t){return n[t]=Sa(s[t]),n},{}):s}function Ns(s,n){var t=s.loader;t!==_n&&t!==yn?(n.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(s.loader=_n,s.progressive=!0,s.enableSoftwareAES=!0,n.log("[config]: Progressive streaming enabled, using FetchLoader"))}var En="NOT_LOADED",Sn="APPENDING",Ir="PARTIAL",Cr="OK",Fs=function(){function s(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}var n=s.prototype;return n._registerListeners=function(){var t=this.hls;t.on(k.MANIFEST_LOADING,this.onManifestLoading,this),t.on(k.BUFFER_APPENDED,this.onBufferAppended,this),t.on(k.FRAG_BUFFERED,this.onFragBuffered,this),t.on(k.FRAG_LOADED,this.onFragLoaded,this)},n._unregisterListeners=function(){var t=this.hls;t.off(k.MANIFEST_LOADING,this.onManifestLoading,this),t.off(k.BUFFER_APPENDED,this.onBufferAppended,this),t.off(k.FRAG_BUFFERED,this.onFragBuffered,this),t.off(k.FRAG_LOADED,this.onFragLoaded,this)},n.destroy=function(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null},n.getAppendedFrag=function(t,e){var i=this.activePartLists[e];if(i)for(var r=i.length;r--;){var a=i[r];if(!a)break;var o=a.end;if(a.start<=t&&o!==null&&t<=o)return a}return this.getBufferedFrag(t,e)},n.getBufferedFrag=function(t,e){return this.getFragAtPos(t,e,!0)},n.getFragAtPos=function(t,e,i){for(var r=this.fragments,a=Object.keys(r),o=a.length;o--;){var l=r[a[o]];if((l==null?void 0:l.body.type)===e&&(!i||l.buffered)){var h=l.body;if(h.start<=t&&t<=h.end)return h}}return null},n.detectEvictedFragments=function(t,e,i,r,a){var o=this;this.timeRanges&&(this.timeRanges[t]=e);var l=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(function(h){var u=o.fragments[h];if(u&&!(l>=u.body.sn))if(u.buffered||u.loaded&&!a){var A=u.range[t];A&&(A.time.length!==0?A.time.some(function(M){var T=!o.isTimeBuffered(M.startPTS,M.endPTS,e);return T&&o.removeFragment(u.body),T}):o.removeFragment(u.body))}else u.body.type===i&&o.removeFragment(u.body)})},n.detectPartialFragments=function(t){var e=this,i=this.timeRanges;if(i&&t.frag.sn!=="initSegment"){var r=t.frag,a=_r(r),o=this.fragments[a];if(!(!o||o.buffered&&r.gap)){var l=!r.relurl;Object.keys(i).forEach(function(h){var u=r.elementaryStreams[h];if(u){var A=i[h],M=l||u.partial===!0;o.range[h]=e.getBufferedTimes(r,t.part,M,A)}}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=r.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),Jr(o)||this.removeParts(r.sn-1,r.type)):this.removeFragment(o.body)}}},n.removeParts=function(t,e){var i=this.activePartLists[e];i&&(this.activePartLists[e]=An(i,function(r){return r.fragment.sn>=t}))},n.fragBuffered=function(t,e){var i=_r(t),r=this.fragments[i];!r&&e&&(r=this.fragments[i]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)},n.getBufferedTimes=function(t,e,i,r){for(var a={time:[],partial:i},o=t.start,l=t.end,h=t.minEndPTS||l,u=t.maxStartPTS||o,A=0;A<r.length;A++){var M=r.start(A)-this.bufferPadding,T=r.end(A)+this.bufferPadding;if(u>=M&&h<=T){a.time.push({startPTS:Math.max(o,r.start(A)),endPTS:Math.min(l,r.end(A))});break}if(o<T&&l>M){var P=Math.max(o,r.start(A)),U=Math.min(l,r.end(A));U>P&&(a.partial=!0,a.time.push({startPTS:P,endPTS:U}))}else if(l<=M)break}return a},n.getPartialFragment=function(t){var e,i,r,a=null,o=0,l=this.bufferPadding,h=this.fragments;return Object.keys(h).forEach(function(u){var A=h[u];A&&Jr(A)&&(i=A.body.start-l,r=A.body.end+l,t>=i&&t<=r&&(e=Math.min(t-i,r-t),o<=e&&(a=A.body,o=e)))}),a},n.isEndListAppended=function(t){var e=this.endListFragments[t];return e!==void 0&&(e.buffered||Jr(e))},n.getState=function(t){var e=_r(t),i=this.fragments[e];return i?i.buffered?Jr(i)?Ir:Cr:Sn:En},n.isTimeBuffered=function(t,e,i){for(var r,a,o=0;o<i.length;o++){if(r=i.start(o)-this.bufferPadding,a=i.end(o)+this.bufferPadding,t>=r&&e<=a)return!0;if(e<=r)return!1}return!1},n.onManifestLoading=function(){this.removeAllFragments()},n.onFragLoaded=function(t,e){if(e.frag.sn!=="initSegment"&&!e.frag.bitrateTest){var i=e.frag,r=e.part?null:e,a=_r(i);this.fragments[a]={body:i,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}},n.onBufferAppended=function(t,e){var i=e.frag,r=e.part,a=e.timeRanges,o=e.type;if(i.sn!=="initSegment"){var l=i.type;if(r){var h=this.activePartLists[l];h||(this.activePartLists[l]=h=[]),h.push(r)}this.timeRanges=a;var u=a[o];this.detectEvictedFragments(o,u,l,r)}},n.onFragBuffered=function(t,e){this.detectPartialFragments(e)},n.hasFragment=function(t){var e=_r(t);return!!this.fragments[e]},n.hasFragments=function(t){var e=this.fragments,i=Object.keys(e);if(!t)return i.length>0;for(var r=i.length;r--;){var a=e[i[r]];if((a==null?void 0:a.body.type)===t)return!0}return!1},n.hasParts=function(t){var e;return!((e=this.activePartLists[t])==null||!e.length)},n.removeFragmentsInRange=function(t,e,i,r,a){var o=this;r&&!this.hasGaps||Object.keys(this.fragments).forEach(function(l){var h=o.fragments[l];if(h){var u=h.body;u.type!==i||r&&!u.gap||u.start<e&&u.end>t&&(h.buffered||a)&&o.removeFragment(u)}})},n.removeFragment=function(t){var e=_r(t);t.clearElementaryStreamInfo();var i=this.activePartLists[t.type];if(i){var r=t.sn;this.activePartLists[t.type]=An(i,function(a){return a.fragment.sn!==r})}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]},n.removeAllFragments=function(){var t,e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;var i=(t=this.hls)==null||(e=t.latestLevelDetails)==null?void 0:e.partList;i&&i.forEach(function(r){return r.clearElementaryStreamInfo()})},s}();function Jr(s){var n,t,e;return s.buffered&&(s.body.gap||((n=s.range.video)==null?void 0:n.partial)||((t=s.range.audio)==null?void 0:t.partial)||((e=s.range.audiovideo)==null?void 0:e.partial))}function _r(s){return s.type+"_"+s.level+"_"+s.sn}function An(s,n){return s.filter(function(t){var e=n(t);return e||t.clearElementaryStreamInfo(),e})}var Tn=Math.pow(2,17),Bs=function(){function s(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}var n=s.prototype;return n.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},n.abort=function(){this.loader&&this.loader.abort()},n.load=function(t,e){var i=this,r=t.url;if(!r)return Promise.reject(new Vi({type:re.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error("Fragment does not have a "+(r?"part list":"url")),networkDetails:null}));this.abort();var a=this.config,o=a.fLoader,l=a.loader;return new Promise(function(h,u){if(i.loader&&i.loader.destroy(),t.gap){if(t.tagList.some(function(G){return G[0]==="GAP"}))return void u(wn(t));t.gap=!1}var A=i.loader=o?new o(a):new l(a),M=Ln(t);t.loader=A;var T=hi(a.fragLoadPolicy.default),P={loadPolicy:T,timeout:T.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?1/0:Tn};t.stats=A.stats;var U={onSuccess:function(G,$,te,se){i.resetLoader(t,A);var pe=G.data;te.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(pe.slice(0,16)),pe=pe.slice(16)),h({frag:t,part:null,payload:pe,networkDetails:se})},onError:function(G,$,te,se){i.resetLoader(t,A),u(new Vi({type:re.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:E({url:r,data:void 0},G),error:new Error("HTTP Error "+G.code+" "+G.text),networkDetails:te,stats:se}))},onAbort:function(G,$,te){i.resetLoader(t,A),u(new Vi({type:re.NETWORK_ERROR,details:K.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:te,stats:G}))},onTimeout:function(G,$,te){i.resetLoader(t,A),u(new Vi({type:re.NETWORK_ERROR,details:K.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error("Timeout after "+P.timeout+"ms"),networkDetails:te,stats:G}))}};e&&(U.onProgress=function(G,$,te,se){return e({frag:t,part:null,payload:te,networkDetails:se})}),A.load(M,P,U)})},n.loadPart=function(t,e,i){var r=this;this.abort();var a=this.config,o=a.fLoader,l=a.loader;return new Promise(function(h,u){if(r.loader&&r.loader.destroy(),t.gap||e.gap)u(wn(t,e));else{var A=r.loader=o?new o(a):new l(a),M=Ln(t,e);t.loader=A;var T=hi(a.fragLoadPolicy.default),P={loadPolicy:T,timeout:T.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Tn};e.stats=A.stats,A.load(M,P,{onSuccess:function(U,G,$,te){r.resetLoader(t,A),r.updateStatsFromPart(t,e);var se={frag:t,part:e,payload:U.data,networkDetails:te};i(se),h(se)},onError:function(U,G,$,te){r.resetLoader(t,A),u(new Vi({type:re.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:E({url:M.url,data:void 0},U),error:new Error("HTTP Error "+U.code+" "+U.text),networkDetails:$,stats:te}))},onAbort:function(U,G,$){t.stats.aborted=e.stats.aborted,r.resetLoader(t,A),u(new Vi({type:re.NETWORK_ERROR,details:K.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:$,stats:U}))},onTimeout:function(U,G,$){r.resetLoader(t,A),u(new Vi({type:re.NETWORK_ERROR,details:K.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error("Timeout after "+P.timeout+"ms"),networkDetails:$,stats:U}))}})}})},n.updateStatsFromPart=function(t,e){var i=t.stats,r=e.stats,a=r.total;if(i.loaded+=r.loaded,a){var o=Math.round(t.duration/e.duration),l=Math.min(Math.round(i.loaded/a),o),h=(o-l)*Math.round(i.loaded/l);i.total=i.loaded+h}else i.total=Math.max(i.loaded,i.total);var u=i.loading,A=r.loading;u.start?u.first+=A.first-A.start:(u.start=A.start,u.first=A.first),u.end=A.end},n.resetLoader=function(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()},s}();function Ln(s,n){n===void 0&&(n=null);var t,e=n||s,i={frag:s,part:n,responseType:"arraybuffer",url:e.url,headers:{},rangeStart:0,rangeEnd:0},r=e.byteRangeStartOffset,a=e.byteRangeEndOffset;if(x(r)&&x(a)){var o,l=r,h=a;if(s.sn==="initSegment"&&((t=(o=s.decryptdata)==null?void 0:o.method)==="AES-128"||t==="AES-256")){var u=a-r;u%16&&(h=a+(16-u%16)),r!==0&&(i.resetIV=!0,l=r-16)}i.rangeStart=l,i.rangeEnd=h}return i}function wn(s,n){var t=new Error("GAP "+(s.gap?"tag":"attribute")+" found"),e={type:re.MEDIA_ERROR,details:K.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return n&&(e.part=n),(n||s).stats.aborted=!0,new Vi(e)}var Vi=function(s){function n(t){var e;return(e=s.call(this,t.error.message)||this).data=void 0,e.data=t,e}return y(n,s),n}(z(Error)),xn=function(s){function n(e,i){var r;return(r=s.call(this,e,i)||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(r),r}y(n,s);var t=n.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.onHandlerDestroyed=function(){},t.hasInterval=function(){return!!this._tickInterval},t.hasNextTick=function(){return!!this._tickTimer},t.setInterval=function(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)},t.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},t.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},t.doTick=function(){},n}(Oe),kn=function(s,n,t,e,i,r){e===void 0&&(e=0),i===void 0&&(i=-1),r===void 0&&(r=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=s,this.sn=n,this.id=t,this.size=e,this.part=i,this.partial=r};function Or(s,n){for(var t=0,e=s.length;t<e;t++){var i;if(((i=s[t])==null?void 0:i.cc)===n)return s[t]}return null}function Rn(s,n){if(s){var t=s.start+n;s.start=s.startPTS=t,s.endPTS=t+s.duration}}function Dn(s,n){for(var t=n.fragments,e=0,i=t.length;e<i;e++)Rn(t[e],s);n.fragmentHint&&Rn(n.fragmentHint,s),n.alignedSliding=!0}function Us(s,n){s&&(function(t,e){if(function(o,l){return!!(o&&l.startCC<o.endCC&&l.endCC>o.startCC)}(e,t)){var i=Math.min(e.endCC,t.endCC),r=Or(e.fragments,i),a=Or(t.fragments,i);r&&a&&(Ze.log("Aligning playlist at start of dicontinuity sequence "+i),Dn(r.start-a.start,t))}}(n,s),!n.alignedSliding&&s&&function(t,e){if(t.hasProgramDateTime&&e.hasProgramDateTime){var i,r,a=t.fragments,o=e.fragments;if(a.length&&o.length){var l=Math.min(e.endCC,t.endCC);e.startCC<l&&t.startCC<l&&(i=Or(o,l),r=Or(a,l)),i&&r||(r=Or(a,(i=o[Math.floor(o.length/2)]).cc)||a[Math.floor(a.length/2)]);var h=i.programDateTime,u=r.programDateTime;h&&u&&Dn((u-h)/1e3-(r.start-i.start),t)}}}(n,s),n.alignedSliding||!s||n.skippedSegments||Ga(s,n,!1))}var js=function(s){for(var n="",t=s.length,e=0;e<t;e++)n+="["+s.start(e).toFixed(3)+"-"+s.end(e).toFixed(3)+"]";return n},Ge={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_LEVEL:"WAITING_LEVEL"},Vs=function(s){function n(e,i,r,a,o){var l;return(l=s.call(this,a,e.logger)||this).hls=void 0,l.fragPrevious=null,l.fragCurrent=null,l.fragmentTracker=void 0,l.transmuxer=null,l._state=Ge.STOPPED,l.playlistType=void 0,l.media=null,l.mediaBuffer=null,l.config=void 0,l.bitrateTest=!1,l.lastCurrentTime=0,l.nextLoadPosition=0,l.startPosition=0,l.startTimeOffset=null,l.retryDate=0,l.levels=null,l.fragmentLoader=void 0,l.keyLoader=void 0,l.levelLastLoaded=null,l.startFragRequested=!1,l.decrypter=void 0,l.initPTS=[],l.buffering=!0,l.loadingParts=!1,l.loopSn=void 0,l.onMediaSeeking=function(){var h=l,u=h.config,A=h.fragCurrent,M=h.media,T=h.mediaBuffer,P=h.state,U=M?M.currentTime:0,G=Et.bufferInfo(T||M,U,u.maxBufferHole);if(l.log("media seeking to "+(x(U)?U.toFixed(3):U)+", state: "+P),l.state===Ge.ENDED)l.resetLoadingState();else if(A){var $=u.maxFragLookUpTolerance,te=A.start-$,se=A.start+A.duration+$;if(!G.len||se<G.start||te>G.end){var pe=U>se;(U<te||pe)&&(pe&&A.loader&&(l.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),A.abortRequests(),l.resetLoadingState()),l.fragPrevious=null)}}if(M&&(l.fragmentTracker.removeFragmentsInRange(U,1/0,l.playlistType,!0),U>l.lastCurrentTime&&(l.lastCurrentTime=U),!l.loadingParts)){var ye=Math.max(G.end,U),he=l.shouldLoadParts(l.getLevelDetails(),ye);he&&(l.log("LL-Part loading ON after seeking to "+U.toFixed(2)+" with buffer @"+ye.toFixed(2)),l.loadingParts=he)}l.hls.hasEnoughToStart||G.len||(l.log("setting startPosition to "+U+" because of seek before start"),l.nextLoadPosition=l.startPosition=U),l.tickImmediate()},l.onMediaEnded=function(){l.log("setting startPosition to 0 because media ended"),l.startPosition=l.lastCurrentTime=0},l.playlistType=o,l.hls=e,l.fragmentLoader=new Bs(e.config),l.keyLoader=r,l.fragmentTracker=i,l.config=e.config,l.decrypter=new pa(e.config),l}y(n,s);var t=n.prototype;return t.registerListeners=function(){var e=this.hls;e.on(k.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(k.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(k.MANIFEST_LOADING,this.onManifestLoading,this),e.on(k.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(k.ERROR,this.onError,this)},t.unregisterListeners=function(){var e=this.hls;e.off(k.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(k.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(k.MANIFEST_LOADING,this.onManifestLoading,this),e.off(k.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(k.ERROR,this.onError,this)},t.doTick=function(){this.onTickEnd()},t.onTickEnd=function(){},t.startLoad=function(e){},t.stopLoad=function(){if(this.state!==Ge.STOPPED){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Ge.STOPPED}},t.pauseBuffering=function(){this.buffering=!1},t.resumeBuffering=function(){this.buffering=!0},t._streamEnded=function(e,i){if(i.live||!this.media)return!1;var r=e.end||0,a=this.config.timelineOffset||0;if(r<=a)return!1;var o=e.buffered;this.config.maxBufferHole&&o&&o.length>1&&(e=Et.bufferedInfo(o,e.start,0));var l=e.nextStart;if(l&&l>a&&l<i.edge||this.media.currentTime<e.start)return!1;var h=i.partList;if(h!=null&&h.length){var u=h[h.length-1];return Et.isBuffered(this.media,u.start+u.duration/2)}var A=i.fragments[i.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(A)},t.getLevelDetails=function(){var e;if(this.levels&&this.levelLastLoaded!==null)return(e=this.levelLastLoaded)==null?void 0:e.details},t.onMediaAttached=function(e,i){var r=this.media=this.mediaBuffer=i.media;r.removeEventListener("seeking",this.onMediaSeeking),r.removeEventListener("ended",this.onMediaEnded),r.addEventListener("seeking",this.onMediaSeeking),r.addEventListener("ended",this.onMediaEnded);var a=this.config;this.levels&&a.autoStartLoad&&this.state===Ge.STOPPED&&this.startLoad(a.startPosition)},t.onMediaDetaching=function(e,i){var r=!!i.transferMedia,a=this.media;if(a!==null){if(a.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),a.removeEventListener("seeking",this.onMediaSeeking),a.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}},t.onManifestLoading=function(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1},t.onError=function(e,i){},t.onManifestLoaded=function(e,i){this.startTimeOffset=i.startTimeOffset},t.onHandlerDestroying=function(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),s.prototype.onHandlerDestroying.call(this),this.hls=this.onMediaSeeking=this.onMediaEnded=null},t.onHandlerDestroyed=function(){this.state=Ge.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,s.prototype.onHandlerDestroyed.call(this)},t.loadFragment=function(e,i,r){this.startFragRequested=!0,this._loadFragForPlayback(e,i,r)},t._loadFragForPlayback=function(e,i,r){var a=this;this._doFragLoad(e,i,r,function(o){var l=o.frag;if(a.fragContextChanged(l))return a.warn(l.type+" sn: "+l.sn+(o.part?" part: "+o.part.index:"")+" of "+a.fragInfo(l,!1,o.part)+") was dropped during download."),void a.fragmentTracker.removeFragment(l);l.stats.chunkCount++,a._handleFragmentLoadProgress(o)}).then(function(o){if(o){var l=a.state,h=o.frag;a.fragContextChanged(h)?(l===Ge.FRAG_LOADING||!a.fragCurrent&&l===Ge.PARSING)&&(a.fragmentTracker.removeFragment(h),a.state=Ge.IDLE):("payload"in o&&(a.log("Loaded "+h.type+" sn: "+h.sn+" of "+a.playlistLabel()+" "+h.level),a.hls.trigger(k.FRAG_LOADED,o)),a._handleFragmentLoadComplete(o))}}).catch(function(o){a.state!==Ge.STOPPED&&a.state!==Ge.ERROR&&(a.warn("Frag error: "+((o==null?void 0:o.message)||o)),a.resetFragmentLoading(e))})},t.clearTrackerIfNeeded=function(e){var i,r=this.fragmentTracker;if(r.getState(e)===Sn){var a=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,a),l=Math.max(e.duration,o?o.len:this.config.maxBufferLength),h=this.backtrackFragment;((h?e.sn-h.sn:0)==1||this.reduceMaxBufferLength(l,e.duration))&&r.removeFragment(e)}else((i=this.mediaBuffer)==null?void 0:i.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Ir&&r.removeFragment(e))},t.checkLiveUpdate=function(e){if(e.updated&&!e.live){var i=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:i,part:null,stats:i.stats,id:i.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)},t.waitForLive=function(e){var i=e.details;return(i==null?void 0:i.live)&&i.type!=="EVENT"&&(this.levelLastLoaded!==e||i.expired)},t.flushMainBuffer=function(e,i,r){if(r===void 0&&(r=null),e-i){var a={startOffset:e,endOffset:i,type:r};this.hls.trigger(k.BUFFER_FLUSHING,a)}},t._loadInitSegment=function(e,i){var r=this;this._doFragLoad(e,i).then(function(a){var o=a==null?void 0:a.frag;if(!o||r.fragContextChanged(o)||!r.levels)throw new Error("init load aborted");return a}).then(function(a){var o=r.hls,l=a.frag,h=a.payload,u=l.decryptdata;if(h&&h.byteLength>0&&u!=null&&u.key&&u.iv&&qi(u.method)){var A=self.performance.now();return r.decrypter.decrypt(new Uint8Array(h),u.key.buffer,u.iv.buffer,Rr(u.method)).catch(function(M){throw o.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.FRAG_DECRYPT_ERROR,fatal:!1,error:M,reason:M.message,frag:l}),M}).then(function(M){var T=self.performance.now();return o.trigger(k.FRAG_DECRYPTED,{frag:l,payload:M,stats:{tstart:A,tdecrypt:T}}),a.payload=M,r.completeInitSegmentLoad(a)})}return r.completeInitSegmentLoad(a)}).catch(function(a){r.state!==Ge.STOPPED&&r.state!==Ge.ERROR&&(r.warn(a),r.resetFragmentLoading(e))})},t.completeInitSegmentLoad=function(e){if(!this.levels)throw new Error("init load aborted, missing levels");var i=e.frag.stats;this.state!==Ge.STOPPED&&(this.state=Ge.IDLE),e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()},t.fragContextChanged=function(e){var i=this.fragCurrent;return!e||!i||e.sn!==i.sn||e.level!==i.level},t.fragBufferedComplete=function(e,i){var r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered "+e.type+" sn: "+e.sn+(i?" part: "+i.index:"")+" of "+this.fragInfo(e,!1,i)+" > buffer:"+(r?js(Et.getBuffered(r)):"(detached)")+")"),Ht(e)){var a;if(e.type!==le){var o=e.elementaryStreams;if(!Object.keys(o).some(function(h){return!!o[h]}))return void(this.state=Ge.IDLE)}var l=(a=this.levels)==null?void 0:a[e.level];l!=null&&l.fragmentError&&(this.log("Resetting level fragment error count of "+l.fragmentError+" on frag buffered"),l.fragmentError=0)}this.state=Ge.IDLE},t._handleFragmentLoadComplete=function(e){var i=this.transmuxer;if(i){var r=e.frag,a=e.part,o=e.partsLoaded,l=!o||o.length===0||o.some(function(u){return!u}),h=new kn(r.level,r.sn,r.stats.chunkCount+1,0,a?a.index:-1,!l);i.flush(h)}},t._handleFragmentLoadProgress=function(e){},t._doFragLoad=function(e,i,r,a){var o,l=this;r===void 0&&(r=null),this.fragCurrent=e;var h=i==null?void 0:i.details;if(!this.levels||!h)throw new Error("frag load aborted, missing level"+(h?"":" detail")+"s");var u=null;!e.encrypted||(o=e.decryptdata)!=null&&o.key?e.encrypted||(u=this.keyLoader.loadClear(e,h.encryptedFragments))&&this.log("[eme] blocking frag load until media-keys acquired"):(this.log("Loading key for "+e.sn+" of ["+h.startSN+"-"+h.endSN+"], "+this.playlistLabel()+" "+e.level),this.state=Ge.KEY_LOADING,this.fragCurrent=e,u=this.keyLoader.load(e).then(function(se){if(!l.fragContextChanged(se.frag))return l.hls.trigger(k.KEY_LOADED,se),l.state===Ge.KEY_LOADING&&(l.state=Ge.IDLE),se}),this.hls.trigger(k.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(u=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING"))));var A=this.fragPrevious;if(Ht(e)&&(!A||e.sn!==A.sn)){var M=this.shouldLoadParts(i.details,e.end);M!==this.loadingParts&&(this.log("LL-Part loading "+(M?"ON":"OFF")+" loading sn "+(A==null?void 0:A.sn)+"->"+e.sn),this.loadingParts=M)}if(r=Math.max(e.start,r||0),this.loadingParts&&Ht(e)){var T=h.partList;if(T&&a){r>e.end&&h.fragmentHint&&(e=h.fragmentHint);var P=this.getNextPart(T,e,r);if(P>-1){var U,G=T[P];return e=this.fragCurrent=G.fragment,this.log("Loading "+e.type+" sn: "+e.sn+" part: "+G.index+" ("+P+"/"+(T.length-1)+") of "+this.fragInfo(e,!1,G)+") cc: "+e.cc+" ["+h.startSN+"-"+h.endSN+"], target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=G.start+G.duration,this.state=Ge.FRAG_LOADING,U=u?u.then(function(se){return!se||l.fragContextChanged(se.frag)?null:l.doFragPartsLoad(e,G,i,a)}).catch(function(se){return l.handleFragLoadError(se)}):this.doFragPartsLoad(e,G,i,a).catch(function(se){return l.handleFragLoadError(se)}),this.hls.trigger(k.FRAG_LOADING,{frag:e,part:G,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):U}if(!e.url||this.loadedEndOfParts(T,r))return Promise.resolve(null)}}if(Ht(e)&&this.loadingParts)this.log("LL-Part loading OFF after next part miss @"+r.toFixed(2)),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log("Loading "+e.type+" sn: "+e.sn+" of "+this.fragInfo(e,!1)+") cc: "+e.cc+" "+(h?"["+h.startSN+"-"+h.endSN+"]":"")+", target: "+parseFloat(r.toFixed(3))),x(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Ge.FRAG_LOADING;var $,te=this.config.progressive;return $=te&&u?u.then(function(se){return!se||l.fragContextChanged(se==null?void 0:se.frag)?null:l.fragmentLoader.load(e,a)}).catch(function(se){return l.handleFragLoadError(se)}):Promise.all([this.fragmentLoader.load(e,te?a:void 0),u]).then(function(se){var pe=se[0];return!te&&pe&&a&&a(pe),pe}).catch(function(se){return l.handleFragLoadError(se)}),this.hls.trigger(k.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):$},t.doFragPartsLoad=function(e,i,r,a){var o=this;return new Promise(function(l,h){var u,A=[],M=(u=r.details)==null?void 0:u.partList,T=function(P){o.fragmentLoader.loadPart(e,P,a).then(function(U){A[P.index]=U;var G=U.part;o.hls.trigger(k.FRAG_LOADED,U);var $=Ya(r.details,e.sn,P.index+1)||$a(M,e.sn,P.index+1);if(!$)return l({frag:e,part:G,partsLoaded:A});T($)}).catch(h)};T(i)})},t.handleFragLoadError=function(e){if("data"in e){var i=e.data;e.data&&i.details===K.INTERNAL_ABORTED?this.handleFragLoadAborted(i.frag,i.part):this.hls.trigger(k.ERROR,i)}else this.hls.trigger(k.ERROR,{type:re.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null},t._handleTransmuxerFlush=function(e){var i=this.getCurrentContext(e);if(i&&this.state===Ge.PARSING){var r=i.frag,a=i.part,o=i.level,l=self.performance.now();r.stats.parsing.end=l,a&&(a.stats.parsing.end=l);var h=this.getLevelDetails(),u=h&&r.sn>h.endSN||this.shouldLoadParts(h,r.end);u!==this.loadingParts&&(this.log("LL-Part loading "+(u?"ON":"OFF")+" after parsing segment ending @"+r.end.toFixed(2)),this.loadingParts=u),this.updateLevelTiming(r,a,o,e.partial)}else this.fragCurrent||this.state===Ge.STOPPED||this.state===Ge.ERROR||(this.state=Ge.IDLE)},t.shouldLoadParts=function(e,i){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var r,a,o=e.partList[0];if(i>=o.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0)&&(this.hls.hasEnoughToStart?((a=this.media)==null?void 0:a.currentTime)||this.lastCurrentTime:this.getLoadPosition())>o.start-o.fragment.duration)return!0}}return!1},t.getCurrentContext=function(e){var i=this.levels,r=this.fragCurrent,a=e.level,o=e.sn,l=e.part;if(i==null||!i[a])return this.warn("Levels object was unset while buffering fragment "+o+" of "+this.playlistLabel()+" "+a+". The current chunk will not be buffered."),null;var h=i[a],u=h.details,A=l>-1?Ya(u,o,l):null,M=A?A.fragment:Ha(u,o,r);return M?(r&&r!==M&&(M.stats=r.stats),{frag:M,part:A,level:h}):null},t.bufferFragmentData=function(e,i,r,a,o){var l;if(e&&this.state===Ge.PARSING){var h=e.data1,u=e.data2,A=h;if(h&&u&&(A=mi(h,u)),(l=A)!=null&&l.length){var M={type:e.type,frag:i,part:r,chunkMeta:a,parent:i.type,data:A};if(this.hls.trigger(k.BUFFER_APPENDING,M),e.dropped&&e.independent&&!r){if(o)return;this.flushBufferGap(i)}}}},t.flushBufferGap=function(e){var i=this.media;if(i)if(Et.isBuffered(i,i.currentTime)){var r=i.currentTime,a=Et.bufferInfo(i,r,0),o=e.duration,l=Math.min(2*this.config.maxFragLookUpTolerance,.25*o),h=Math.max(Math.min(e.start-l,a.end-l),r+l);e.start-h>l&&this.flushMainBuffer(h,e.start)}else this.flushMainBuffer(0,e.start)},t.getFwdBufferInfo=function(e,i){var r,a=this.getLoadPosition();if(!x(a))return null;var o=this.lastCurrentTime>a||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,a,i,o)},t.getFwdBufferInfoAtPos=function(e,i,r,a){var o=Et.bufferInfo(e,i,a);if(o.len===0&&o.nextStart!==void 0){var l=this.fragmentTracker.getBufferedFrag(i,r);if(l&&(o.nextStart<=l.end||l.gap)){var h=Math.max(Math.min(o.nextStart,l.end)-i,a);return Et.bufferInfo(e,i,h)}}return o},t.getMaxBufferLength=function(e){var i,r=this.config;return i=e?Math.max(8*r.maxBufferSize/e,r.maxBufferLength):r.maxBufferLength,Math.min(i,r.maxMaxBufferLength)},t.reduceMaxBufferLength=function(e,i){var r=this.config,a=Math.max(Math.min(e-i,r.maxBufferLength),i),o=Math.max(e-3*i,r.maxMaxBufferLength/2,a);return o>=a&&(r.maxMaxBufferLength=o,this.warn("Reduce max buffer length to "+o+"s"),!0)},t.getAppendedFrag=function(e,i){var r;i===void 0&&(i=q);var a=(r=this.fragmentTracker)==null?void 0:r.getAppendedFrag(e,i);return a&&"fragment"in a?a.fragment:a},t.getNextFragment=function(e,i){var r=i.fragments,a=r.length;if(!a)return null;var o=this.config,l=r[0].start,h=o.lowLatencyMode&&!!i.partList,u=null;if(i.live){var A=o.initialLiveManifestSize;if(a<A)return this.warn("Not enough fragments to start playback (have: "+a+", need: "+A+")"),null;if(!i.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<l){var M;h&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),u=this.getInitialLiveFragment(i);var T=this.hls.startPosition,P=this.hls.liveSyncPosition,U=u?(T!==-1&&T>=l?T:P)||u.start:e;this.log("Setting startPosition to "+U+" to match start frag at live edge. mainStart: "+T+" liveSyncPosition: "+P+" frag.start: "+((M=u)==null?void 0:M.start)),this.startPosition=this.nextLoadPosition=U}}else e<=l&&(u=r[0]);if(!u){var G=this.loadingParts?i.partEnd:i.fragmentEnd;u=this.getFragmentAtPosition(e,G,i)}var $=this.filterReplacedPrimary(u,i);if(!$&&u){var te=u.sn-i.startSN;$=this.filterReplacedPrimary(r[te+1]||null,i)}return this.mapToInitFragWhenRequired($)},t.isLoopLoading=function(e,i){var r=this.fragmentTracker.getState(e);return(r===Cr||r===Ir&&!!e.gap)&&this.nextLoadPosition>i},t.getNextFragmentLoopLoading=function(e,i,r,a,o){var l=null;if(e.gap&&(l=this.getNextFragment(this.nextLoadPosition,i))&&!l.gap&&r.nextStart){var h=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,a,0);if(h!==null&&r.len+h.len>=o){var u=l.sn;return this.loopSn!==u&&(this.log('buffer full after gaps in "'+a+'" playlist starting at sn: '+u),this.loopSn=u),null}}return this.loopSn=void 0,l},t.filterReplacedPrimary=function(e,i){return e&&(this.hls.config,e)},t.mapToInitFragWhenRequired=function(e){return e==null||!e.initSegment||e!=null&&e.initSegment.data||this.bitrateTest?e:e.initSegment},t.getNextPart=function(e,i,r){for(var a=-1,o=!1,l=!0,h=0,u=e.length;h<u;h++){var A=e[h];if(l=l&&!A.independent,a>-1&&r<A.start)break;var M=A.loaded;M?a=-1:(o||A.independent||l)&&A.fragment===i&&(a=h),o=M}return a},t.loadedEndOfParts=function(e,i){var r=e[e.length-1];return r&&i>r.start&&r.loaded},t.getInitialLiveFragment=function(e){var i=e.fragments,r=this.fragPrevious,a=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),a=function(u,A,M){if(A===null||!Array.isArray(u)||!u.length||!x(A)||A<(u[0].programDateTime||0)||A>=(u[u.length-1].endProgramDateTime||0))return null;for(var T=0;T<u.length;++T){var P=u[T];if(at(A,M,P))return P}return null}(i,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!a){var o=r.sn+1;if(o>=e.startSN&&o<=e.endSN){var l=i[o-e.startSN];r.cc===l.cc&&(a=l,this.log("Live playlist, switching playlist, load frag with next SN: "+a.sn))}a||(a=function(u,A,M){if(u&&u.startCC<=A&&u.endCC>=A){var T,P=u.fragments,U=u.fragmentHint;return U&&(P=P.concat(U)),rt(P,function(G){return G.cc<A?1:G.cc>A?-1:(T=G,G.end<=M?1:G.start>M?-1:0)}),T||null}return null}(e,r.cc,r.end),a&&this.log("Live playlist, switching playlist, load frag with same CC: "+a.sn))}}else{var h=this.hls.liveSyncPosition;h!==null&&(a=this.getFragmentAtPosition(h,this.bitrateTest?e.fragmentEnd:e.edge,e))}return a},t.getFragmentAtPosition=function(e,i,r){var a,o,l=this.config,h=this.fragPrevious,u=r.fragments,A=r.endSN,M=r.fragmentHint,T=l.maxFragLookUpTolerance,P=r.partList,U=!!(this.loadingParts&&P!=null&&P.length&&M);if(U&&M&&!this.bitrateTest&&P[P.length-1].fragment.sn===M.sn&&(u=u.concat(M),A=M.sn),a=e<i?vt(h,u,e,e<this.lastCurrentTime||e>i-T||(o=this.media)!=null&&o.paused||!this.startFragRequested?0:T):u[u.length-1]){var G=a.sn-r.startSN,$=this.fragmentTracker.getState(a);if(($===Cr||$===Ir&&a.gap)&&(h=a),h&&a.sn===h.sn&&(!U||P[0].fragment.sn>a.sn||!r.live&&!U)&&h&&a.level===h.level){var te=u[G+1];a=a.sn<A&&this.fragmentTracker.getState(te)!==Cr?te:null}}return a},t.alignPlaylists=function(e,i,r){var a=e.fragments.length;if(!a)return this.warn("No fragments in live playlist"),0;var o=e.fragmentStart,l=!i,h=e.alignedSliding&&x(o);if(l||!h&&!o){Us(r,e);var u=e.fragmentStart;return this.log("Live playlist sliding: "+u.toFixed(2)+" start-sn: "+(i?i.startSN:"na")+"->"+e.startSN+" fragments: "+a),u}return o},t.waitForCdnTuneIn=function(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},t.setStartPosition=function(e,i){var r=this.startPosition;r<i&&(r=-1);var a=this.timelineOffset;if(r===-1){var o=this.startTimeOffset!==null,l=o?this.startTimeOffset:e.startTimeOffset;l!==null&&x(l)?(r=i+l,l<0&&(r+=e.edge),r=Math.min(Math.max(i,r),i+e.totalduration),this.log("Setting startPosition to "+r+" for start time offset "+l+" found in "+(o?"multivariant":"media")+" playlist"),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||i,this.log("Setting startPosition to -1 to start at live edge "+r),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+a}this.nextLoadPosition=r+a},t.getLoadPosition=function(){var e,i=this.media,r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&i?r=i.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r},t.handleFragLoadAborted=function(e,i){this.transmuxer&&e.type===this.playlistType&&Ht(e)&&e.stats.aborted&&(this.warn("Fragment "+e.sn+(i?" part "+i.index:"")+" of "+this.playlistLabel()+" "+e.level+" was aborted"),this.resetFragmentLoading(e))},t.resetFragmentLoading=function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Ge.FRAG_LOADING_WAITING_RETRY)||(this.state=Ge.IDLE)},t.onFragmentOrKeyLoadError=function(e,i){if(i.chunkMeta&&!i.frag){var r=this.getCurrentContext(i.chunkMeta);r&&(i.frag=r.frag)}var a=i.frag;if(a&&a.type===e&&this.levels)if(this.fragContextChanged(a)){var o;this.warn("Frag load error must match current frag to retry "+a.url+" > "+((o=this.fragCurrent)==null?void 0:o.url))}else{var l=i.details===K.FRAG_GAP;l&&this.fragmentTracker.fragBuffered(a,!0);var h=i.errorAction,u=h||{},A=u.action,M=u.flags,T=u.retryCount,P=T===void 0?0:T,U=u.retryConfig,G=!!h&&!!U,$=G&&A===Wt,te=G&&!h.resolved&&M===fi;if(!$&&te&&Ht(a)&&!a.endList)this.resetFragmentErrors(e),this.treatAsGap(a),h.resolved=!0;else if(($||te)&&P<U.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);var se=Ut(U,P);this.warn("Fragment "+a.sn+" of "+e+" "+a.level+" errored with "+i.details+", retrying loading "+(P+1)+"/"+U.maxNumRetry+" in "+se+"ms"),h.resolved=!0,this.retryDate=self.performance.now()+se,this.state=Ge.FRAG_LOADING_WAITING_RETRY}else if(U&&h){if(this.resetFragmentErrors(e),!(P<U.maxNumRetry))return void this.warn(i.details+" reached or exceeded max retry ("+P+")");l||A===ei||(h.resolved=!0)}else this.state=A===Ft?Ge.WAITING_LEVEL:Ge.ERROR;this.tickImmediate()}},t.reduceLengthAndFlushBuffer=function(e){if(this.state===Ge.PARSING||this.state===Ge.PARSED){var i=e.frag,r=e.parent,a=this.getFwdBufferInfo(this.mediaBuffer,r),o=a&&a.len>.5;o&&this.reduceMaxBufferLength(a.len,(i==null?void 0:i.duration)||10);var l=!o;return l&&this.warn("Buffer full error while media.currentTime is not buffered, flush "+r+" buffer"),i&&(this.fragmentTracker.removeFragment(i),this.nextLoadPosition=i.start),this.resetLoadingState(),l}return!1},t.resetFragmentErrors=function(e){e===H&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==Ge.STOPPED&&(this.state=Ge.IDLE)},t.afterBufferFlushed=function(e,i,r){if(e){var a=Et.getBuffered(e);this.fragmentTracker.detectEvictedFragments(i,a,r),this.state===Ge.ENDED&&this.resetLoadingState()}},t.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==Ge.STOPPED&&(this.state=Ge.IDLE)},t.resetStartWhenNotLoaded=function(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;var i=e?e.details:null;i!=null&&i.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(i,i.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},t.resetWhenMissingContext=function(e){this.warn("The loading context changed while buffering fragment "+e.sn+" of "+this.playlistLabel()+" "+e.level+". This chunk will not be buffered."),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()},t.removeUnbufferedFrags=function(e){e===void 0&&(e=0),this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)},t.updateLevelTiming=function(e,i,r,a){var o=this,l=r.details;if(l){var h;if(!Object.keys(e.elementaryStreams).reduce(function(A,M){var T=e.elementaryStreams[M];if(T){var P=T.endPTS-T.startPTS;if(P<=0)return o.warn("Could not parse fragment "+e.sn+" "+M+" duration reliably ("+P+")"),A||!1;var U=a?0:ja(l,e,T.startPTS,T.endPTS,T.startDTS,T.endDTS);return o.hls.trigger(k.LEVEL_PTS_UPDATED,{details:l,level:r,drift:U,type:M,frag:e,start:T.startPTS,end:T.endPTS}),!0}return A},!1)&&(r.fragmentError===0&&this.treatAsGap(e,r),((h=this.transmuxer)==null?void 0:h.error)===null)){var u=new Error("Found no media in fragment "+e.sn+" of "+this.playlistLabel()+" "+e.level+" resetting transmuxer to fallback to playlist timing");if(this.warn(u.message),this.hls.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:u,frag:e,reason:"Found no media in msn "+e.sn+" of "+this.playlistLabel()+' "'+r.url+'"'}),!this.hls)return;this.resetTransmuxer()}this.state=Ge.PARSED,this.log("Parsed "+e.type+" sn: "+e.sn+(i?" part: "+i.index:"")+" of "+this.fragInfo(e,!1,i)+")"),this.hls.trigger(k.FRAG_PARSED,{frag:e,part:i})}else this.warn("level.details undefined")},t.playlistLabel=function(){return this.playlistType===q?"level":"track"},t.fragInfo=function(e,i,r){var a,o;return i===void 0&&(i=!0),this.playlistLabel()+" "+e.level+" ("+(r?"part":"frag")+":["+((a=i&&!r?e.startPTS:(r||e).start)!=null?a:NaN).toFixed(3)+"-"+((o=i&&!r?e.endPTS:(r||e).end)!=null?o:NaN).toFixed(3)+"]"+(r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):"")},t.treatAsGap=function(e,i){i&&i.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)},t.resetTransmuxer=function(){var e;(e=this.transmuxer)==null||e.reset()},t.recoverWorkerError=function(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())},g(n,[{key:"startPositionValue",get:function(){var e=this.nextLoadPosition,i=this.startPosition;return i===-1&&e?e:i}},{key:"bufferingEnabled",get:function(){return this.buffering}},{key:"inFlightFrag",get:function(){return{frag:this.fragCurrent,state:this.state}}},{key:"timelineOffset",get:function(){var e,i=this.config.timelineOffset;return i?((e=this.getLevelDetails())==null?void 0:e.appliedTimelineOffset)||i:0}},{key:"primaryPrefetch",get:function(){return this.hls.config,!1}},{key:"state",get:function(){return this._state},set:function(e){var i=this._state;i!==e&&(this._state=e,this.log(i+"->"+e))}}])}(xn);function Pr(s,n,t){yr(s,n,t),s.addEventListener(n,t)}function yr(s,n,t){s.removeEventListener(n,t)}var Gs=function(s){function n(e,i){var r;return(r=s.call(this,"gap-controller",e.logger)||this).hls=null,r.fragmentTracker=null,r.media=null,r.mediaSource=void 0,r.nudgeRetry=0,r.stallReported=!1,r.stalled=null,r.moved=!1,r.seeking=!1,r.buffered={},r.lastCurrentTime=0,r.ended=0,r.waiting=0,r.onMediaPlaying=function(){r.ended=0,r.waiting=0},r.onMediaWaiting=function(){var a;(a=r.media)!=null&&a.seeking||(r.waiting=self.performance.now(),r.tick())},r.onMediaEnded=function(){var a;r.hls&&(r.ended=((a=r.media)==null?void 0:a.currentTime)||1,r.hls.trigger(k.MEDIA_ENDED,{stalled:!1}))},r.hls=e,r.fragmentTracker=i,r.registerListeners(),r}y(n,s);var t=n.prototype;return t.registerListeners=function(){var e=this.hls;e&&(e.on(k.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(k.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(k.BUFFER_APPENDED,this.onBufferAppended,this))},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(k.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(k.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(k.BUFFER_APPENDED,this.onBufferAppended,this))},t.destroy=function(){s.prototype.destroy.call(this),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0},t.onMediaAttached=function(e,i){this.setInterval(100),this.mediaSource=i.mediaSource;var r=this.media=i.media;Pr(r,"playing",this.onMediaPlaying),Pr(r,"waiting",this.onMediaWaiting),Pr(r,"ended",this.onMediaEnded)},t.onMediaDetaching=function(e,i){this.clearInterval();var r=this.media;r&&(yr(r,"playing",this.onMediaPlaying),yr(r,"waiting",this.onMediaWaiting),yr(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0},t.onBufferAppended=function(e,i){this.buffered=i.timeRanges},t.tick=function(){var e;if((e=this.media)!=null&&e.readyState&&this.hasBuffered){var i=this.media.currentTime;this.poll(i,this.lastCurrentTime),this.lastCurrentTime=i}},t.poll=function(e,i){var r,a,o=(r=this.hls)==null?void 0:r.config;if(o){var l=this.media;if(l){var h=l.seeking,u=this.seeking&&!h,A=!this.seeking&&h,M=l.paused&&!h||l.ended||l.playbackRate===0;if(this.seeking=h,e!==i)return i&&(this.ended=0),this.moved=!0,h||(this.nudgeRetry=0,o.nudgeOnVideoHole&&!M&&e>i&&this.nudgeOnVideoHole(e,i)),void(this.waiting===0&&this.stallResolved(e));if(A||u)u&&this.stallResolved(e);else{if(M)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&l.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(k.MEDIA_ENDED,{stalled:!1})));if(Et.getBuffered(l).length){var T=Et.bufferInfo(l,e,0),P=T.nextStart||0,U=this.fragmentTracker;if(h&&U&&this.hls){var G=Mn(this.hls.inFlightFragments,e),$=T.len>2,te=!P||G||P-e>2&&!U.getPartialFragment(e);if($||te)return;this.moved=!1}var se=(a=this.hls)==null?void 0:a.latestLevelDetails;if(!this.moved&&this.stalled!==null&&U){if(!(T.len>0||P))return;var pe=Math.max(P,T.start||0)-e,ye=se!=null&&se.live?2*se.targetduration:2,he=U.getPartialFragment(e);if(pe>0&&(pe<=ye||he))return void(l.paused||this._trySkipBufferHole(he))}var ge=o.detectStallWithCurrentTimeMs,Ae=self.performance.now(),Te=this.waiting,Ee=this.stalled;if(Ee===null){if(!(Te>0&&Ae-Te<ge))return void(this.stalled=Ae);Ee=this.stalled=Te}var xe=Ae-Ee;if(!h&&(xe>=ge||Te)&&this.hls){var Pe;if(((Pe=this.mediaSource)==null?void 0:Pe.readyState)==="ended"&&(se==null||!se.live)&&Math.abs(e-((se==null?void 0:se.edge)||0))<1)return this.ended?void 0:(this.ended=e||1,void this.hls.trigger(k.MEDIA_ENDED,{stalled:!0}));if(this._reportStall(T),!this.media||!this.hls)return}var ze=Et.bufferInfo(l,e,o.maxBufferHole);this._tryFixBufferStall(ze,xe,e)}else this.nudgeRetry=0}}}},t.stallResolved=function(e){var i=this.stalled;if(i&&this.hls&&(this.stalled=null,this.stallReported)){var r=self.performance.now()-i;this.log("playback not stuck anymore @"+e+", after "+Math.round(r)+"ms"),this.stallReported=!1,this.waiting=0,this.hls.trigger(k.STALL_RESOLVED,{})}},t.nudgeOnVideoHole=function(e,i){var r,a=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&a&&a.length>1&&e>a.end(0)){var o=Et.bufferedInfo(Et.timeRangesToArray(this.buffered.audio),e,0);if(o.len>1&&i>=o.start){var l=Et.timeRangesToArray(a),h=Et.bufferedInfo(l,i,0).bufferedIndex;if(h>-1&&h<l.length-1){var u=Et.bufferedInfo(l,e,0).bufferedIndex,A=l[h].end,M=l[h+1].start;if((u===-1||u>h)&&M-A<1&&e-A<2){var T=new Error("nudging playhead to flush pipeline after video hole. currentTime: "+e+" hole: "+A+" -> "+M+" buffered index: "+u);this.warn(T.message),this.media.currentTime+=1e-6;var P=this.fragmentTracker.getPartialFragment(e)||void 0,U=Et.bufferInfo(this.media,e,0);this.hls.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:T,reason:T.message,frag:P,buffer:U.len,bufferInfo:U})}}}}},t._tryFixBufferStall=function(e,i,r){var a,o,l=this.fragmentTracker,h=this.media,u=(a=this.hls)==null?void 0:a.config;if(h&&l&&u){var A=(o=this.hls)==null?void 0:o.latestLevelDetails,M=l.getPartialFragment(r);if((M||A!=null&&A.live&&r<A.fragmentStart)&&(this._trySkipBufferHole(M)||!this.media))return;var T=e.buffered,P=this.adjacentTraversal(e,r);(T&&T.length>1&&e.len>u.maxBufferHole||e.nextStart&&(e.nextStart-r<u.maxBufferHole||P))&&(i>1e3*u.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}},t.adjacentTraversal=function(e,i){var r=this.fragmentTracker,a=e.nextStart;if(r&&a){var o=r.getFragAtPos(i,q),l=r.getFragAtPos(a,q);if(o&&l)return l.sn-o.sn<2}return!1},t._reportStall=function(e){var i=this.hls,r=this.media,a=this.stallReported,o=this.stalled;if(!a&&o!==null&&r&&i){this.stallReported=!0;var l=new Error("Playback stalling at @"+r.currentTime+" due to low buffer ("+$e(e)+")");this.warn(l.message),i.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.BUFFER_STALLED_ERROR,fatal:!1,error:l,buffer:e.len,bufferInfo:e,stalled:{start:o}})}},t._trySkipBufferHole=function(e){var i,r=this.fragmentTracker,a=this.media,o=(i=this.hls)==null?void 0:i.config;if(!a||!r||!o)return 0;var l=a.currentTime,h=Et.bufferInfo(a,l,0),u=l<h.start?h.start:h.nextStart;if(u&&this.hls){var A=h.len<=o.maxBufferHole,M=h.len>0&&h.len<1&&a.readyState<3,T=u-l;if(T>0&&(A||M)){if(T>o.maxBufferHole){var P=!1;if(l===0){var U=r.getAppendedFrag(0,q);U&&u<U.end&&(P=!0)}if(!P){var G=e||r.getAppendedFrag(l,q);if(G){var $;if(($=this.hls.loadLevelObj)==null||!$.details||Mn(this.hls.inFlightFragments,u))return 0;for(var te=!1,se=G.end;se<u;){var pe=r.getPartialFragment(se);if(!pe){te=!0;break}se+=pe.duration}if(te)return 0}}}var ye=Math.max(u+.05,l+.1);if(this.warn("skipping hole, adjusting currentTime from "+l+" to "+ye),this.moved=!0,a.currentTime=ye,e==null||!e.gap){var he=new Error("fragment loaded with buffer holes, seeking from "+l+" to "+ye);this.hls.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:he,reason:he.message,frag:e||void 0,buffer:h.len,bufferInfo:h})}return ye}}return 0},t._tryNudgeBuffer=function(e){var i=this.hls,r=this.media,a=this.nudgeRetry,o=i==null?void 0:i.config;if(!r||!o)return 0;var l=r.currentTime;if(this.nudgeRetry++,a<o.nudgeMaxRetry){var h=l+(a+1)*o.nudgeOffset,u=new Error("Nudging 'currentTime' from "+l+" to "+h);this.warn(u.message),r.currentTime=h,i.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.BUFFER_NUDGE_ON_STALL,error:u,fatal:!1,buffer:e.len,bufferInfo:e})}else{var A=new Error("Playhead still not moving while enough data buffered @"+l+" after "+o.nudgeMaxRetry+" nudges");this.error(A.message),i.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.BUFFER_STALLED_ERROR,error:A,fatal:!0,buffer:e.len,bufferInfo:e})}},g(n,[{key:"hasBuffered",get:function(){return Object.keys(this.buffered).length>0}}])}(xn);function Mn(s,n){var t=In(s.main);if(t&&t.start<=n)return t;var e=In(s.audio);return e&&e.start<=n?e:null}function In(s){if(!s)return null;switch(s.state){case Ge.IDLE:case Ge.STOPPED:case Ge.ENDED:case Ge.ERROR:return null}return s.frag}function zs(s,n){var t;try{t=new Event("addtrack")}catch(e){(t=document.createEvent("Event")).initEvent("addtrack",!1,!1)}t.track=s,n.dispatchEvent(t)}function Hs(s,n,t,e){var i=s.mode;if(i==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0)for(var r=function(o,l,h){var u=[],A=function(U,G){if(G<=U[0].startTime)return 0;var $=U.length-1;if(G>U[$].endTime)return-1;for(var te,se=0,pe=$;se<=pe;)if(G<U[te=Math.floor((pe+se)/2)].startTime)pe=te-1;else{if(!(G>U[te].startTime&&se<$))return te;se=te+1}return U[se].startTime-G<G-U[pe].startTime?se:pe}(o,l);if(A>-1)for(var M=A,T=o.length;M<T;M++){var P=o[M];if(P.startTime>=l&&P.endTime<=h)u.push(P);else if(P.startTime>h)return u}return u}(s.cues,n,t),a=0;a<r.length;a++)e&&!e(r[a])||s.removeCue(r[a]);i==="disabled"&&(s.mode=i)}function Aa(){if(typeof self<"u")return self.VTTCue||self.TextTrackCue}function Cn(s,n,t,e,i){var r=new s(n,t,"");try{r.value=e,i&&(r.type=i)}catch(a){r=new s(n,t,$e(i?E({type:i},e):e))}return r}var ea=function(){var s=Aa();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch(n){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}(),Ys=function(){function s(t){var e=this;this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=function(){e.hls&&e.hls.trigger(k.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}var n=s.prototype;return n.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null},n._registerListeners=function(){var t=this.hls;t.on(k.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(k.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(k.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(k.MANIFEST_LOADING,this.onManifestLoading,this),t.on(k.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(k.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(k.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(k.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)},n._unregisterListeners=function(){var t=this.hls;t.off(k.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(k.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(k.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(k.MANIFEST_LOADING,this.onManifestLoading,this),t.off(k.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(k.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(k.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(k.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)},n.onMediaAttaching=function(t,e){var i;this.media=e.media,((i=e.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)},n.onMediaAttached=function(){var t=this.hls.latestLevelDetails;t&&this.updateDateRangeCues(t)},n.onMediaDetaching=function(t,e){this.media=null,e.transferMedia||(this.id3Track&&(this.removeCues&&function(i,r){var a=i.mode;if(a==="disabled"&&(i.mode="hidden"),i.cues)for(var o=i.cues.length;o--;)r&&i.cues[o].removeEventListener("enter",r),i.removeCue(i.cues[o]);a==="disabled"&&(i.mode=a)}(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})},n.onManifestLoading=function(){this.dateRangeCuesAppended={}},n.createTrack=function(t){var e=this.getID3Track(t.textTracks);return e.mode="hidden",e},n.getID3Track=function(t){if(this.media){for(var e=0;e<t.length;e++){var i=t[e];if(i.kind==="metadata"&&i.label==="id3")return zs(i,this.media),i}return this.media.addTextTrack("metadata","id3")}},n.onFragParsingMetadata=function(t,e){if(this.media){var i=this.hls.config,r=i.enableEmsgMetadataCues,a=i.enableID3MetadataCues;if(r||a){var o=e.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));var l=Aa();if(l)for(var h=0;h<o.length;h++){var u=o[h].type;if((u!==gi.emsg||r)&&a){var A=rn(o[h].data);if(A){var M=o[h].pts,T=M+o[h].duration;T>ea&&(T=ea),T-M<=0&&(T=M+.25);for(var P=0;P<A.length;P++){var U=A[P];if(!an(U)){this.updateId3CueEnds(M,u);var G=Cn(l,M,T,U,u);G&&this.id3Track.addCue(G)}}}}}}}},n.updateId3CueEnds=function(t,e){var i,r=(i=this.id3Track)==null?void 0:i.cues;if(r)for(var a=r.length;a--;){var o=r[a];o.type===e&&o.startTime<t&&o.endTime===ea&&(o.endTime=t)}},n.onBufferFlushing=function(t,e){var i=e.startOffset,r=e.endOffset,a=e.type,o=this.id3Track,l=this.hls;if(l){var h=l.config,u=h.enableEmsgMetadataCues,A=h.enableID3MetadataCues;o&&(u||A)&&Hs(o,i,r,a==="audio"?function(M){return M.type===gi.audioId3&&A}:a==="video"?function(M){return M.type===gi.emsg&&u}:function(M){return M.type===gi.audioId3&&A||M.type===gi.emsg&&u})}},n.onLevelUpdated=function(t,e){var i=e.details;this.updateDateRangeCues(i,!0)},n.onLevelPtsUpdated=function(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)},n.updateDateRangeCues=function(t,e){var i=this;if(this.media&&t.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var r,a=this.id3Track,o=t.dateRanges,l=Object.keys(o),h=this.dateRangeCuesAppended;if(a&&e)if((r=a.cues)!=null&&r.length)for(var u=Object.keys(h).filter(function($){return!l.includes($)}),A=function(){var $=u[M],te=h[$].cues;delete h[$],Object.keys(te).forEach(function(se){try{var pe=te[se];pe.removeEventListener("enter",i.onEventCueEnter),a.removeCue(pe)}catch(ye){}})},M=u.length;M--;)A();else h=this.dateRangeCuesAppended={};var T=t.fragments[t.fragments.length-1];if(l.length!==0&&x(T==null?void 0:T.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var P=Aa(),U=function(){var $=l[G],te=o[$],se=te.startTime,pe=h[$],ye=(pe==null?void 0:pe.cues)||{},he=(pe==null?void 0:pe.durationKnown)||!1,ge=ea,Ae=te.duration;if(te.endDate&&Ae!==null)ge=se+Ae,he=!0;else if(te.endOnNext&&!he){var Te=l.reduce(function(Ye,ot){if(ot!==te.id){var qe=o[ot];if(qe.class===te.class&&qe.startDate>te.startDate&&(!Ye||te.startDate<Ye.startDate))return qe}return Ye},null);Te&&(ge=Te.startTime,he=!0)}for(var Ee,xe,Pe=Object.keys(te.attr),ze=0;ze<Pe.length;ze++){var Fe=Pe[ze];if((xe=Fe)!=="ID"&&xe!=="CLASS"&&xe!=="CUE"&&xe!=="START-DATE"&&xe!=="DURATION"&&xe!=="END-DATE"&&xe!=="END-ON-NEXT"){var Me=ye[Fe];if(Me)he&&!pe.durationKnown?Me.endTime=ge:Math.abs(Me.startTime-se)>.01&&(Me.startTime=se,Me.endTime=ge);else if(P){var De=te.attr[Fe];Hr(Fe)&&(Ee=De,De=Uint8Array.from(Ee.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer);var je=Cn(P,se,ge,{key:Fe,data:De},gi.dateRange);je&&(je.id=$,i.id3Track.addCue(je),ye[Fe]=je)}}}h[$]={cues:ye,dateRange:te,durationKnown:he}},G=0;G<l.length;G++)U()}}},s}(),$s=function(){function s(t){var e=this;this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=function(){var i=e.media,r=e.levelDetails;if(i&&r){e.currentTime=i.currentTime;var a=e.computeLatency();if(a!==null){e._latency=a;var o=e.config,l=o.lowLatencyMode,h=o.maxLiveSyncPlaybackRate;if(l&&h!==1&&r.live){var u=e.targetLatency;if(u!==null){var A=a-u;if(A<Math.min(e.maxLatency,u+r.targetduration)&&A>.05&&e.forwardBufferLength>1){var M=Math.min(2,Math.max(1,h)),T=Math.round(2/(1+Math.exp(-.75*A-e.edgeStalled))*20)/20,P=Math.min(M,Math.max(1,T));e.changeMediaPlaybackRate(i,P)}else i.playbackRate!==1&&i.playbackRate!==0&&e.changeMediaPlaybackRate(i,1)}}}}},this.hls=t,this.config=t.config,this.registerListeners()}var n=s.prototype;return n.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null},n.registerListeners=function(){var t=this.hls;t&&(t.on(k.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(k.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(k.MANIFEST_LOADING,this.onManifestLoading,this),t.on(k.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(k.ERROR,this.onError,this))},n.unregisterListeners=function(){var t=this.hls;t&&(t.off(k.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(k.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(k.MANIFEST_LOADING,this.onManifestLoading,this),t.off(k.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(k.ERROR,this.onError,this))},n.onMediaAttached=function(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)},n.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)},n.onManifestLoading=function(){this._latency=null,this.stallCount=0},n.onLevelUpdated=function(t,e){var i=e.details;i.advanced&&this.onTimeupdate(),!i.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)},n.onError=function(t,e){var i;e.details===K.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))},n.changeMediaPlaybackRate=function(t,e){var i,r;t.playbackRate!==e&&((i=this.hls)==null||i.logger.debug("[latency-controller]: latency="+this.latency.toFixed(3)+", targetLatency="+((r=this.targetLatency)==null?void 0:r.toFixed(3))+", forwardBufferLength="+this.forwardBufferLength.toFixed(3)+": adjusting playback rate from "+t.playbackRate+" to "+e),t.playbackRate=e)},n.estimateLiveEdge=function(){var t=this.levelDetails;return t===null?null:t.edge+t.age},n.computeLatency=function(){var t=this.estimateLiveEdge();return t===null?null:t-this.currentTime},g(s,[{key:"levelDetails",get:function(){var t;return((t=this.hls)==null?void 0:t.latestLevelDetails)||null}},{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var t=this.config;if(t.liveMaxLatencyDuration!==void 0)return t.liveMaxLatencyDuration;var e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}},{key:"targetLatency",get:function(){var t=this.levelDetails;if(t===null||this.hls===null)return null;var e=t.holdBack,i=t.partHoldBack,r=t.targetduration,a=this.config,o=a.liveSyncDuration,l=a.liveSyncDurationCount,h=a.lowLatencyMode,u=this.hls.userConfig,A=h&&i||e;(this._targetLatencyUpdated||u.liveSyncDuration||u.liveSyncDurationCount||A===0)&&(A=o!==void 0?o:l*r);var M=r;return A+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,M)},set:function(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}},{key:"liveSyncPosition",get:function(){var t=this.estimateLiveEdge(),e=this.targetLatency;if(t===null||e===null)return null;var i=this.levelDetails;if(i===null)return null;var r=i.edge,a=t-e-this.edgeStalled,o=r-i.totalduration,l=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(o,a),l)}},{key:"drift",get:function(){var t=this.levelDetails;return t===null?1:t.drift}},{key:"edgeStalled",get:function(){var t=this.levelDetails;if(t===null)return 0;var e=3*(this.config.lowLatencyMode&&t.partTarget||t.targetduration);return Math.max(t.age-e,0)}},{key:"forwardBufferLength",get:function(){var t=this.media,e=this.levelDetails;if(!t||!e)return 0;var i=t.buffered.length;return(i?t.buffered.end(i-1):e.edge)-this.currentTime}}])}(),qs=function(s){function n(e,i){var r;return(r=s.call(this,i,e.logger)||this).hls=void 0,r.canLoad=!1,r.timer=-1,r.hls=e,r}y(n,s);var t=n.prototype;return t.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},t.clearTimer=function(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)},t.startLoad=function(){this.canLoad=!0,this.loadPlaylist()},t.stopLoad=function(){this.canLoad=!1,this.clearTimer()},t.switchParams=function(e,i,r){var a=i==null?void 0:i.renditionReports;if(a){for(var o=-1,l=0;l<a.length;l++){var h=a[l],u=void 0;try{u=new self.URL(h.URI,i.url).href}catch(G){this.warn("Could not construct new URL for Rendition Report: "+G),u=h.URI||""}if(u===e){o=l;break}u===e.substring(0,u.length)&&(o=l)}if(o!==-1){var A=a[o],M=parseInt(A["LAST-MSN"])||(i==null?void 0:i.lastPartSn),T=parseInt(A["LAST-PART"])||(i==null?void 0:i.lastPartIndex);if(this.hls.config.lowLatencyMode){var P=Math.min(i.age-i.partTarget,i.targetduration);T>=0&&P>i.partTarget&&(T+=1)}var U=r&&ke(r);return new we(M,T>=0?T:void 0,U)}}},t.loadPlaylist=function(e){this.clearTimer()},t.loadingPlaylist=function(e,i){this.clearTimer()},t.shouldLoadPlaylist=function(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)},t.getUrlWithDirectives=function(e,i){if(i)try{return i.addDirectives(e)}catch(r){this.warn("Could not construct new URL with HLS Delivery Directives: "+r)}return e},t.playlistLoaded=function(e,i,r){var a=i.details,o=i.stats,l=self.performance.now(),h=o.loading.first?Math.max(0,l-o.loading.first):0;a.advancedDateTime=Date.now()-h;var u=this.hls.config.timelineOffset;if(u!==a.appliedTimelineOffset){var A=Math.max(u||0,0);a.appliedTimelineOffset=A,a.fragments.forEach(function(De){De.start=De.playlistOffset+A})}if(a.live||r!=null&&r.live){var M="levelInfo"in i?i.levelInfo:i.track;if(a.reloaded(r),r&&a.fragments.length>0){Jn(r,a);var T=a.playlistParsingError;if(T){this.warn(T);var P=this.hls;if(!P.config.ignorePlaylistParsingErrors){var U,G=i.networkDetails;return void P.trigger(k.ERROR,{type:re.NETWORK_ERROR,details:K.LEVEL_PARSING_ERROR,fatal:!1,url:a.url,error:T,reason:T.message,level:i.level||void 0,parent:(U=a.fragments[0])==null?void 0:U.type,networkDetails:G,stats:o})}a.playlistParsingError=null}}a.requestScheduled===-1&&(a.requestScheduled=o.loading.start);var $,te=this.hls.mainForwardBufferInfo,se=te?te.end-te.len:0,pe=za(a,1e3*(a.edge-se));if(a.requestScheduled+pe<l?a.requestScheduled=l:a.requestScheduled+=pe,this.log("live playlist "+e+" "+(a.advanced?"REFRESHED "+a.lastPartSn+"-"+a.lastPartIndex:a.updated?"UPDATED":"MISSED")),!this.canLoad||!a.live)return;var ye=void 0,he=void 0;if(a.canBlockReload&&a.endSN&&a.advanced){var ge=this.hls.config.lowLatencyMode,Ae=a.lastPartSn,Te=a.endSN,Ee=a.lastPartIndex,xe=Ae===Te;Ee!==-1?xe?(ye=Te+1,he=ge?0:Ee):(ye=Ae,he=ge?Ee+1:a.maxPartIndex):ye=Te+1;var Pe=a.age,ze=Pe+a.ageHeader,Fe=Math.min(ze-a.partTarget,1.5*a.targetduration);if(Fe>0){if(ze>3*a.targetduration)this.log("Playlist last advanced "+Pe.toFixed(2)+"s ago. Omitting segment and part directives."),ye=void 0,he=void 0;else if(r!=null&&r.tuneInGoal&&ze-a.partTarget>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+Fe+" with playlist age: "+a.age),Fe=0;else{var Me=Math.floor(Fe/a.targetduration);ye+=Me,he!==void 0&&(he+=Math.round(Fe%a.targetduration/a.partTarget)),this.log("CDN Tune-in age: "+a.ageHeader+"s last advanced "+Pe.toFixed(2)+"s goal: "+Fe+" skip sn "+Me+" to part "+he)}a.tuneInGoal=Fe}if($=this.getDeliveryDirectives(a,i.deliveryDirectives,ye,he),ge||!xe)return a.requestScheduled=l,void this.loadingPlaylist(M,$)}else(a.canBlockReload||a.canSkipUntil)&&($=this.getDeliveryDirectives(a,i.deliveryDirectives,ye,he));$&&ye!==void 0&&a.canBlockReload&&(a.requestScheduled=o.loading.first+Math.max(pe-2*h,pe/2)),this.scheduleLoading(M,$,a)}else this.clearTimer()},t.scheduleLoading=function(e,i,r){var a=this,o=r||e.details;if(o){var l=self.performance.now(),h=o.requestScheduled;if(l>=h)this.loadingPlaylist(e,i);else{var u=h-l;this.log("reload live playlist "+(e.name||e.bitrate+"bps")+" in "+Math.round(u)+" ms"),this.clearTimer(),this.timer=self.setTimeout(function(){return a.loadingPlaylist(e,i)},u)}}else this.loadingPlaylist(e,i)},t.getDeliveryDirectives=function(e,i,r,a){var o=ke(e);return i!=null&&i.skip&&e.deltaUpdateFailed&&(r=i.msn,a=i.part,o=ue),new we(r,a,o)},t.checkRetry=function(e){var i=this,r=e.details,a=ut(e),o=e.errorAction,l=o||{},h=l.action,u=l.retryCount,A=u===void 0?0:u,M=l.retryConfig,T=!!o&&!!M&&(h===Wt||!o.resolved&&h===Ft);if(T){var P;if(A>=M.maxNumRetry)return!1;if(a&&(P=e.context)!=null&&P.deliveryDirectives)this.warn("Retrying playlist loading "+(A+1)+"/"+M.maxNumRetry+' after "'+r+'" without delivery-directives'),this.loadPlaylist();else{var U=Ut(M,A);this.clearTimer(),this.timer=self.setTimeout(function(){return i.loadPlaylist()},U),this.warn("Retrying playlist loading "+(A+1)+"/"+M.maxNumRetry+' after "'+r+'" in '+U+"ms")}e.levelRetry=!0,o.resolved=!0}return T},n}(Oe),Ws=function(s){function n(e,i){var r;return(r=s.call(this,e,"level-controller")||this)._levels=[],r._firstLevel=-1,r._maxAutoLevel=-1,r._startLevel=void 0,r.currentLevel=null,r.currentLevelIndex=-1,r.manualLevelIndex=-1,r.steering=void 0,r.onParsedComplete=void 0,r.steering=i,r._registerListeners(),r}y(n,s);var t=n.prototype;return t._registerListeners=function(){var e=this.hls;e.on(k.MANIFEST_LOADING,this.onManifestLoading,this),e.on(k.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(k.LEVEL_LOADED,this.onLevelLoaded,this),e.on(k.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(k.FRAG_BUFFERED,this.onFragBuffered,this),e.on(k.ERROR,this.onError,this)},t._unregisterListeners=function(){var e=this.hls;e.off(k.MANIFEST_LOADING,this.onManifestLoading,this),e.off(k.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(k.LEVEL_LOADED,this.onLevelLoaded,this),e.off(k.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(k.FRAG_BUFFERED,this.onFragBuffered,this),e.off(k.ERROR,this.onError,this)},t.destroy=function(){this._unregisterListeners(),this.steering=null,this.resetLevels(),s.prototype.destroy.call(this)},t.stopLoad=function(){this._levels.forEach(function(e){e.loadError=0,e.fragmentError=0}),s.prototype.stopLoad.call(this)},t.resetLevels=function(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1},t.onManifestLoading=function(e,i){this.resetLevels()},t.onManifestLoaded=function(e,i){var r=this,a=this.hls.config.preferManagedMediaSource,o=[],l={},h={},u=!1,A=!1,M=!1;i.levels.forEach(function(T){var P=T.attrs,U=T.audioCodec,G=T.videoCodec;U&&(T.audioCodec=U=O(U,a)||void 0),G&&(G=T.videoCodec=function(je){for(var Ye=je.split(","),ot=0;ot<Ye.length;ot++){var qe=Ye[ot].split(".");qe.length>2&&qe[0]==="avc1"&&(Ye[ot]="avc1."+parseInt(qe[1]).toString(16)+("000"+parseInt(qe[2]).toString(16)).slice(-4))}return Ye.join(",")}(G));var $=T.width,te=T.height,se=T.unknownCodecs,pe=se?se.length:0;if(se)for(var ye=pe;ye--;){var he=se[ye];r.isAudioSupported(he)?(T.audioCodec=U=U?U+","+he:he,pe--,Fi.audio[U.substring(0,4)]=2):r.isVideoSupported(he)&&(T.videoCodec=G=G?G+","+he:he,pe--,Fi.video[G.substring(0,4)]=2)}if(u||(u=!(!$||!te)),A||(A=!!G),M||(M=!!U),pe||U&&!r.isAudioSupported(U)||G&&!r.isVideoSupported(G))r.log('Some or all CODECS not supported "'+P.CODECS+'"');else{var ge=P.CODECS,Ae=P["FRAME-RATE"],Te=P["HDCP-LEVEL"],Ee=P["PATHWAY-ID"],xe=P.RESOLUTION,Pe=P["VIDEO-RANGE"],ze=(Ee||".")+"-"+T.bitrate+"-"+xe+"-"+Ae+"-"+ge+"-"+Pe+"-"+Te;if(l[ze])if(l[ze].uri===T.url||T.attrs["PATHWAY-ID"])l[ze].addGroupId("audio",P.AUDIO),l[ze].addGroupId("text",P.SUBTITLES);else{var Fe=h[ze]+=1;T.attrs["PATHWAY-ID"]=new Array(Fe+1).join(".");var Me=r.createLevel(T);l[ze]=Me,o.push(Me)}else{var De=r.createLevel(T);l[ze]=De,h[ze]=1,o.push(De)}}}),this.filterAndSortMediaOptions(o,i,u,A,M)},t.createLevel=function(e){var i=new Ve(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){var a=new Error('SUPPLEMENTAL-CODECS not supported "'+r.videoCodec+'"');this.log(a.message),i.supportedResult=xt.getUnsupportedResult(a,[])}return i},t.isAudioSupported=function(e){return Gt(e,"audio",this.hls.config.preferManagedMediaSource)},t.isVideoSupported=function(e){return Gt(e,"video",this.hls.config.preferManagedMediaSource)},t.filterAndSortMediaOptions=function(e,i,r,a,o){var l=this,h=[],u=[],A=e;if((r||a)&&o&&(A=A.filter(function(Ae){var Te,Ee=Ae.videoCodec,xe=Ae.videoRange,Pe=Ae.width,ze=Ae.height;return(!!Ee||!(!Pe||!ze))&&!!(Te=xe)&&ce.indexOf(Te)>-1})),A.length!==0){i.audioTracks&&On(h=i.audioTracks.filter(function(Ae){return!Ae.audioCodec||l.isAudioSupported(Ae.audioCodec)})),i.subtitles&&On(u=i.subtitles);var M=A.slice(0);A.sort(function(Ae,Te){if(Ae.attrs["HDCP-LEVEL"]!==Te.attrs["HDCP-LEVEL"])return(Ae.attrs["HDCP-LEVEL"]||"")>(Te.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&Ae.height!==Te.height)return Ae.height-Te.height;if(Ae.frameRate!==Te.frameRate)return Ae.frameRate-Te.frameRate;if(Ae.videoRange!==Te.videoRange)return ce.indexOf(Ae.videoRange)-ce.indexOf(Te.videoRange);if(Ae.videoCodec!==Te.videoCodec){var Ee=f(Ae.videoCodec),xe=f(Te.videoCodec);if(Ee!==xe)return xe-Ee}if(Ae.uri===Te.uri&&Ae.codecSet!==Te.codecSet){var Pe=c(Ae.codecSet),ze=c(Te.codecSet);if(Pe!==ze)return ze-Pe}return Ae.averageBitrate!==Te.averageBitrate?Ae.averageBitrate-Te.averageBitrate:0});var T=M[0];if(this.steering&&(A=this.steering.filterParsedLevels(A)).length!==M.length){for(var P=0;P<M.length;P++)if(M[P].pathwayId===A[0].pathwayId){T=M[P];break}}this._levels=A;for(var U=0;U<A.length;U++)if(A[U]===T){var G;this._firstLevel=U;var $=T.bitrate,te=this.hls.bandwidthEstimate;if(this.log("manifest loaded, "+A.length+" level(s) found, first bitrate: "+$),((G=this.hls.userConfig)==null?void 0:G.abrEwmaDefaultEstimate)===void 0){var se=Math.min($,this.hls.config.abrEwmaDefaultEstimateMax);se>te&&te===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=se)}break}var pe=o&&!a,ye=this.hls.config,he=!(!ye.audioStreamController||!ye.audioTrackController),ge={levels:A,audioTracks:h,subtitleTracks:u,sessionData:i.sessionData,sessionKeys:i.sessionKeys,firstLevel:this._firstLevel,stats:i.stats,audio:o,video:a,altAudio:he&&!pe&&h.some(function(Ae){return!!Ae.url})};this.hls.trigger(k.MANIFEST_PARSED,ge)}else Promise.resolve().then(function(){if(l.hls){var Ae="no level with compatible codecs found in manifest",Te=Ae;i.levels.length&&(Te="one or more CODECS in variant not supported: "+$e(i.levels.map(function(xe){return xe.attrs.CODECS}).filter(function(xe,Pe,ze){return ze.indexOf(xe)===Pe})),l.warn(Te),Ae+=" ("+Te+")");var Ee=new Error(Ae);l.hls.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:i.url,error:Ee,reason:Te})}})},t.onError=function(e,i){!i.fatal&&i.context&&i.context.type===ie&&i.context.level===this.level&&this.checkRetry(i)},t.onFragBuffered=function(e,i){var r=i.frag;if(r!==void 0&&r.type===q){var a=r.elementaryStreams;if(!Object.keys(a).some(function(l){return!!a[l]}))return;var o=this._levels[r.level];o!=null&&o.loadError&&(this.log("Resetting level error count of "+o.loadError+" on frag buffered"),o.loadError=0)}},t.onLevelLoaded=function(e,i){var r,a,o=i.level,l=i.details,h=i.levelInfo;if(!h)return this.warn("Invalid level index "+o),void((a=i.deliveryDirectives)!=null&&a.skip&&(l.deltaUpdateFailed=!0));if(h===this.currentLevel||i.withoutMultiVariant){h.fragmentError===0&&(h.loadError=0);var u=h.details;u===i.details&&u.advanced&&(u=void 0),this.playlistLoaded(o,i,u)}else(r=i.deliveryDirectives)!=null&&r.skip&&(l.deltaUpdateFailed=!0)},t.loadPlaylist=function(e){s.prototype.loadPlaylist.call(this),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)},t.loadingPlaylist=function(e,i){s.prototype.loadingPlaylist.call(this,e,i);var r=this.getUrlWithDirectives(e.uri,i),a=this.currentLevelIndex,o=e.attrs["PATHWAY-ID"],l=e.details,h=l==null?void 0:l.age;this.log("Loading level index "+a+((i==null?void 0:i.msn)!==void 0?" at sn "+i.msn+" part "+i.part:"")+(o?" Pathway "+o:"")+(h&&l.live?" age "+h.toFixed(1)+(l.type&&" "+l.type||""):"")+" "+r),this.hls.trigger(k.LEVEL_LOADING,{url:r,level:a,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:i||null})},t.removeLevel=function(e){var i,r=this;if(this._levels.length!==1){var a=this._levels.filter(function(l,h){return h!==e||(r.steering&&r.steering.removeLevel(l),l===r.currentLevel&&(r.currentLevel=null,r.currentLevelIndex=-1,l.details&&l.details.fragments.forEach(function(u){return u.level=-1})),!1)});qa(a),this._levels=a,this.currentLevelIndex>-1&&(i=this.currentLevel)!=null&&i.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);var o=a.length-1;this._firstLevel=Math.min(this._firstLevel,o),this._startLevel&&(this._startLevel=Math.min(this._startLevel,o)),this.hls.trigger(k.LEVELS_UPDATED,{levels:a})}},t.onLevelsUpdated=function(e,i){var r=i.levels;this._levels=r},t.checkMaxAutoUpdated=function(){var e=this.hls,i=e.autoLevelCapping,r=e.maxAutoLevel,a=e.maxHdcpLevel;this._maxAutoLevel!==r&&(this._maxAutoLevel=r,this.hls.trigger(k.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:i,levels:this.levels,maxAutoLevel:r,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:a}))},g(n,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"loadLevelObj",get:function(){return this.currentLevel}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var i=this._levels;if(i.length!==0){if(e<0||e>=i.length){var r=new Error("invalid level idx"),a=e<0;if(this.hls.trigger(k.ERROR,{type:re.OTHER_ERROR,details:K.LEVEL_SWITCH_ERROR,level:e,fatal:a,error:r,reason:r.message}),a)return;e=Math.min(e,i.length-1)}var o=this.currentLevelIndex,l=this.currentLevel,h=l?l.attrs["PATHWAY-ID"]:void 0,u=i[e],A=u.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=u,o!==e||!l||h!==A){this.log("Switching to level "+e+" ("+(u.height?u.height+"p ":"")+(u.videoRange?u.videoRange+" ":"")+(u.codecSet?u.codecSet+" ":"")+"@"+u.bitrate+")"+(A?" with Pathway "+A:"")+" from level "+o+(h?" with Pathway "+h:""));var M={level:e,attrs:u.attrs,details:u.details,bitrate:u.bitrate,averageBitrate:u.averageBitrate,maxBitrate:u.maxBitrate,realBitrate:u.realBitrate,width:u.width,height:u.height,codecSet:u.codecSet,audioCodec:u.audioCodec,videoCodec:u.videoCodec,audioGroups:u.audioGroups,subtitleGroups:u.subtitleGroups,loaded:u.loaded,loadError:u.loadError,fragmentError:u.fragmentError,name:u.name,id:u.id,uri:u.uri,url:u.url,urlId:0,audioGroupIds:u.audioGroupIds,textGroupIds:u.textGroupIds};this.hls.trigger(k.LEVEL_SWITCHING,M);var T=u.details;if(!T||T.live){var P=this.switchParams(u.uri,l==null?void 0:l.details,T);this.loadPlaylist(P)}}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"pathways",get:function(){return this.steering?this.steering.pathways():[]}},{key:"pathwayPriority",get:function(){return this.steering?this.steering.pathwayPriority:null},set:function(e){if(this.steering){var i=this.steering.pathways(),r=e.filter(function(a){return i.indexOf(a)!==-1});if(e.length<1)return void this.warn("pathwayPriority "+e+" should contain at least one pathway from list: "+i);this.steering.pathwayPriority=r}}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}}])}(qs);function On(s){var n={};s.forEach(function(t){var e=t.groupId||"";t.id=n[e]=n[e]||0,n[e]++})}var Ta=[];function La(s,n,t){if(!((e=n.remuxResult).audio||e.video||e.text||e.id3||e.initSegment))return!1;var e,i=[],r=n.remuxResult,a=r.audio,o=r.video;return a&&Pn(i,a),o&&Pn(i,o),s.postMessage({event:"transmuxComplete",data:n,instanceNo:t},i),!0}function Pn(s,n){n.data1&&s.push(n.data1.buffer),n.data2&&s.push(n.data2.buffer)}function Nn(s,n,t,e){n.reduce(function(i,r){return La(s,r,e)||i},!1)||s.postMessage({event:"transmuxComplete",data:n[0],instanceNo:e}),s.postMessage({event:"flush",data:t,instanceNo:e})}function br(s,n,t){self.postMessage({event:s,data:n,instanceNo:t})}J!==void 0&&J&&self.addEventListener("message",function(s){var n=s.data,t=n.instanceNo;if(t!==void 0){var e=Ta[t];if(n.cmd==="reset"&&(delete Ta[n.resetNo],e&&e.destroy(),n.cmd="init"),n.cmd==="init"){var i=JSON.parse(n.config),r=new fe;r.on(k.FRAG_DECRYPTED,br),r.on(k.ERROR,br);var a=Ue(i.debug,n.id);return function(u,A){var M=function(P){var U=function(G){br("workerLog",{logType:P,message:G},A)};u[P]=U};for(var T in u)M(T)}(a,t),Ta[t]=new ba(r,n.typeSupported,i,"",n.id,a),void br("init",null,t)}if(e)switch(n.cmd){case"configure":e.configure(n.config);break;case"demux":var o=e.push(n.data,n.decryptdata,n.chunkMeta,n.state);ir(o)?o.then(function(u){La(self,u,t)}).catch(function(u){br(k.ERROR,{instanceNo:t,type:re.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,chunkMeta:n.chunkMeta,fatal:!1,error:u,err:u,reason:"transmuxer-worker push error"},t)}):La(self,o,t);break;case"flush":var l=n.chunkMeta,h=e.flush(l);ir(h)?h.then(function(u){Nn(self,u,l,t)}).catch(function(u){br(k.ERROR,{type:re.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,chunkMeta:n.chunkMeta,fatal:!1,error:u,err:u,reason:"transmuxer-worker flush error"},t)}):Nn(self,h,l,t)}}});var Nr="1.6.5",Er={},Fn=0,Ks=function(){function s(t,e,i,r){var a=this;this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Fn++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=function(M){var T=M.data,P=a.hls;if(P&&T!=null&&T.event&&T.instanceNo===a.instanceNo)switch(T.event){case"init":var U,G=(U=a.workerContext)==null?void 0:U.objectURL;G&&self.URL.revokeObjectURL(G);break;case"transmuxComplete":a.handleTransmuxComplete(T.data);break;case"flush":a.onFlush(T.data);break;case"workerLog":P.logger[T.data.logType]&&P.logger[T.data.logType](T.data.message);break;default:T.data=T.data||{},T.data.frag=a.frag,T.data.part=a.part,T.data.id=a.id,P.trigger(T.event,T.data)}},this.onWorkerError=function(M){if(a.hls){var T=new Error(M.message+"  ("+M.filename+":"+M.lineno+")");a.hls.config.enableWorker=!1,a.hls.logger.warn('Error in "'+a.id+'" Web Worker, fallback to inline'),a.hls.trigger(k.ERROR,{type:re.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:T})}};var o=t.config;this.hls=t,this.id=e,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;var l=function(M,T){(T=T||{}).frag=a.frag||void 0,M===k.ERROR&&(T.parent=a.id,T.part=a.part,a.error=T.error),a.hls.trigger(M,T)};this.observer=new fe,this.observer.on(k.FRAG_DECRYPTED,l),this.observer.on(k.ERROR,l);var h=X(o.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){var u=this.hls.logger;o.workerPath;try{o.workerPath?(u.log("loading Web Worker "+o.workerPath+' for "'+e+'"'),this.workerContext=function(M){var T=Er[M];if(T)return T.clientCount++,T;var P=new self.URL(M,self.location.href).href,U={worker:new self.Worker(P),scriptURL:P,clientCount:1};return Er[M]=U,U}(o.workerPath)):(u.log('injecting Web Worker for "'+e+'"'),this.workerContext=function(){var M=Er[Nr];if(M)return M.clientCount++,M;var T=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;("+R.toString()+")(true);"],{type:"text/javascript"}),P=self.URL.createObjectURL(T),U={worker:new self.Worker(P),objectURL:P,clientCount:1};return Er[Nr]=U,U}());var A=this.workerContext.worker;A.addEventListener("message",this.onWorkerMessage),A.addEventListener("error",this.onWorkerError),A.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:h,id:e,config:$e(o)})}catch(M){u.warn('Error setting up "'+e+'" Web Worker, fallback to inline',M),this.terminateWorker(),this.error=null,this.transmuxer=new ba(this.observer,h,o,"",e,t.logger)}}else this.transmuxer=new ba(this.observer,h,o,"",e,t.logger)}var n=s.prototype;return n.reset=function(){if(this.frag=null,this.part=null,this.workerContext){var t=this.instanceNo;this.instanceNo=Fn++;var e=this.hls.config,i=X(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:i,id:this.id,config:$e(e)})}},n.terminateWorker=function(){if(this.workerContext){var t=this.workerContext.worker;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),function(e){var i=Er[e||Nr];if(i&&i.clientCount--==1){var r=i.worker,a=i.objectURL;delete Er[e||Nr],a&&self.URL.revokeObjectURL(a),r.terminate()}}(this.hls.config.workerPath)}},n.destroy=function(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{var t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}var e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null},n.push=function(t,e,i,r,a,o,l,h,u,A){var M,T,P=this;u.transmuxing.start=self.performance.now();var U=this.instanceNo,G=this.transmuxer,$=o?o.start:a.start,te=a.decryptdata,se=this.frag,pe=!(se&&a.cc===se.cc),ye=!(se&&u.level===se.level),he=se?u.sn-se.sn:-1,ge=this.part?u.part-this.part.index:-1,Ae=he===0&&u.id>1&&u.id===(se==null?void 0:se.stats.chunkCount),Te=!ye&&(he===1||he===0&&(ge===1||Ae&&ge<=0)),Ee=self.performance.now();(ye||he||a.stats.parsing.start===0)&&(a.stats.parsing.start=Ee),!o||!ge&&Te||(o.stats.parsing.start=Ee);var xe=!(se&&((M=a.initSegment)==null?void 0:M.url)===((T=se.initSegment)==null?void 0:T.url)),Pe=new Ds(pe,Te,h,ye,$,xe);if(!Te||pe||xe){this.hls.logger.log("[transmuxer-interface]: Starting new transmux session for "+a.type+" sn: "+u.sn+(u.part>-1?" part: "+u.part:"")+" "+(this.id===q?"level":"track")+": "+u.level+" id: "+u.id+"\n        discontinuity: "+pe+"\n        trackSwitch: "+ye+"\n        contiguous: "+Te+"\n        accurateTimeOffset: "+h+"\n        timeOffset: "+$+"\n        initSegmentChange: "+xe);var ze=new Rs(i,r,e,l,A);this.configureTransmuxer(ze)}if(this.frag=a,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:U,cmd:"demux",data:t,decryptdata:te,chunkMeta:u,state:Pe},t instanceof ArrayBuffer?[t]:[]);else if(G){var Fe=G.push(t,te,u,Pe);ir(Fe)?Fe.then(function(Me){P.handleTransmuxComplete(Me)}).catch(function(Me){P.transmuxerError(Me,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(Fe)}},n.flush=function(t){var e=this;t.transmuxing.start=self.performance.now();var i=this.instanceNo,r=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:i,cmd:"flush",chunkMeta:t});else if(r){var a=r.flush(t);ir(a)?a.then(function(o){e.handleFlushResult(o,t)}).catch(function(o){e.transmuxerError(o,t,"transmuxer-interface flush error")}):this.handleFlushResult(a,t)}},n.transmuxerError=function(t,e,i){this.hls&&(this.error=t,this.hls.trigger(k.ERROR,{type:re.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:i}))},n.handleFlushResult=function(t,e){var i=this;t.forEach(function(r){i.handleTransmuxComplete(r)}),this.onFlush(e)},n.configureTransmuxer=function(t){var e=this.instanceNo,i=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):i&&i.configure(t)},n.handleTransmuxComplete=function(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)},s}();function Bn(){return self.SourceBuffer||self.WebKitSourceBuffer}function Un(){if(!Ti())return!1;var s=Bn();return!s||s.prototype&&typeof s.prototype.appendBuffer=="function"&&typeof s.prototype.remove=="function"}var Qs=function(s){function n(e,i,r){var a;return(a=s.call(this,e,i,r,"stream-controller",q)||this).audioCodecSwap=!1,a.level=-1,a._forceStartLoad=!1,a._hasEnoughToStart=!1,a.altAudio=0,a.audioOnly=!1,a.fragPlaying=null,a.fragLastKbps=0,a.couldBacktrack=!1,a.backtrackFragment=null,a.audioCodecSwitch=!1,a.videoBuffer=null,a.onMediaPlaying=function(){a.tick()},a.onMediaSeeked=function(){var o=a.media,l=o?o.currentTime:null;if(l!==null&&x(l)&&(a.log("Media seeked to "+l.toFixed(3)),a.getBufferedFrag(l))){var h=a.getFwdBufferInfoAtPos(o,l,q,0);h!==null&&h.len!==0?a.tick():a.warn("Main forward buffer length at "+l+' on "seeked" event '+(h?h.len:"empty")+")")}},a.registerListeners(),a}y(n,s);var t=n.prototype;return t.registerListeners=function(){s.prototype.registerListeners.call(this);var e=this.hls;e.on(k.MANIFEST_PARSED,this.onManifestParsed,this),e.on(k.LEVEL_LOADING,this.onLevelLoading,this),e.on(k.LEVEL_LOADED,this.onLevelLoaded,this),e.on(k.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(k.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(k.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(k.BUFFER_CREATED,this.onBufferCreated,this),e.on(k.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(k.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(k.FRAG_BUFFERED,this.onFragBuffered,this)},t.unregisterListeners=function(){s.prototype.unregisterListeners.call(this);var e=this.hls;e.off(k.MANIFEST_PARSED,this.onManifestParsed,this),e.off(k.LEVEL_LOADED,this.onLevelLoaded,this),e.off(k.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(k.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(k.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(k.BUFFER_CREATED,this.onBufferCreated,this),e.off(k.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(k.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(k.FRAG_BUFFERED,this.onFragBuffered,this)},t.onHandlerDestroying=function(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),s.prototype.onHandlerDestroying.call(this)},t.startLoad=function(e,i){if(this.levels){var r=this.lastCurrentTime,a=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){var o=a.startLevel;o===-1&&(a.config.testBandwidth&&this.levels.length>1?(o=0,this.bitrateTest=!0):o=a.firstAutoLevel),a.nextLoadLevel=o,this.level=a.loadLevel,this._hasEnoughToStart=!!i}r>0&&e===-1&&!i&&(this.log("Override startPosition with lastCurrentTime @"+r.toFixed(3)),e=r),this.state=Ge.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=i?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=Ge.STOPPED},t.stopLoad=function(){this._forceStartLoad=!1,s.prototype.stopLoad.call(this)},t.doTick=function(){switch(this.state){case Ge.WAITING_LEVEL:var e=this.levels,i=this.level,r=e==null?void 0:e[i],a=r==null?void 0:r.details;if(a&&(!a.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(a))break;this.state=Ge.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=Ge.IDLE;break}break;case Ge.FRAG_LOADING_WAITING_RETRY:var o,l=self.performance.now(),h=this.retryDate;if(!h||l>=h||(o=this.media)!=null&&o.seeking){var u=this.levels,A=this.level,M=u==null?void 0:u[A];this.resetStartWhenNotLoaded(M||null),this.state=Ge.IDLE}}this.state===Ge.IDLE&&this.doTickIdle(),this.onTickEnd()},t.onTickEnd=function(){var e;s.prototype.onTickEnd.call(this),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()},t.doTickIdle=function(){var e=this.hls,i=this.levelLastLoaded,r=this.levels,a=this.media;if(i!==null&&(a||this.primaryPrefetch||!this.startFragRequested&&e.config.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)){var o=this.buffering?e.nextLoadLevel:e.loadLevel;if(r!=null&&r[o]){var l=r[o],h=this.getMainFwdBufferInfo();if(h!==null){var u=this.getLevelDetails();if(u&&this._streamEnded(h,u)){var A={};return this.altAudio===2&&(A.type="video"),this.hls.trigger(k.BUFFER_EOS,A),void(this.state=Ge.ENDED)}if(this.buffering){e.loadLevel!==o&&e.manualLevel===-1&&this.log("Adapting to level "+o+" from level "+this.level),this.level=e.nextLoadLevel=o;var M=l.details;if(!M||this.state===Ge.WAITING_LEVEL||this.waitForLive(l))return this.level=o,this.state=Ge.WAITING_LEVEL,void(this.startFragRequested=!1);var T=h.len,P=this.getMaxBufferLength(l.maxBitrate);if(!(T>=P)){this.backtrackFragment&&this.backtrackFragment.start>h.end&&(this.backtrackFragment=null);var U=this.backtrackFragment?this.backtrackFragment.start:h.end,G=this.getNextFragment(U,M);if(this.couldBacktrack&&!this.fragPrevious&&G&&Ht(G)&&this.fragmentTracker.getState(G)!==Cr){var $,te=(($=this.backtrackFragment)!=null?$:G).sn-M.startSN,se=M.fragments[te-1];se&&G.cc===se.cc&&(G=se,this.fragmentTracker.removeFragment(se))}else this.backtrackFragment&&h.len&&(this.backtrackFragment=null);if(G&&this.isLoopLoading(G,U)){if(!G.gap){var pe=this.audioOnly&&!this.altAudio?Jt:Bt,ye=(pe===Bt?this.videoBuffer:this.mediaBuffer)||this.media;ye&&this.afterBufferFlushed(ye,pe,q)}G=this.getNextFragmentLoopLoading(G,M,h,q,P)}G&&(!G.initSegment||G.initSegment.data||this.bitrateTest||(G=G.initSegment),this.loadFragment(G,l,U))}}}}}},t.loadFragment=function(e,i,r){var a=this.fragmentTracker.getState(e);a===En||a===Ir?Ht(e)?this.bitrateTest?(this.log("Fragment "+e.sn+" of level "+e.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(e,i)):s.prototype.loadFragment.call(this,e,i,r):this._loadInitSegment(e,i):this.clearTrackerIfNeeded(e)},t.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,q)},t.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},t.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},t.nextLevelSwitch=function(){var e=this.levels,i=this.media;if(i!=null&&i.readyState){var r,a=this.getAppendedFrag(i.currentTime);a&&a.start>1&&this.flushMainBuffer(0,a.start-1);var o=this.getLevelDetails();if(o!=null&&o.live){var l=this.getMainFwdBufferInfo();if(!l||l.len<2*o.targetduration)return}if(!i.paused&&e){var h=e[this.hls.nextLoadLevel],u=this.fragLastKbps;r=u&&this.fragCurrent?this.fragCurrent.duration*h.maxBitrate/(1e3*u)+1:0}else r=0;var A=this.getBufferedFrag(i.currentTime+r);if(A){var M=this.followingBufferedFrag(A);if(M){this.abortCurrentFrag();var T=M.maxStartPTS?M.maxStartPTS:M.start,P=M.duration,U=Math.max(A.end,T+Math.min(Math.max(P-this.config.maxFragLookUpTolerance,P*(this.couldBacktrack?.5:.125)),P*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(U,Number.POSITIVE_INFINITY)}}}},t.abortCurrentFrag=function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Ge.KEY_LOADING:case Ge.FRAG_LOADING:case Ge.FRAG_LOADING_WAITING_RETRY:case Ge.PARSING:case Ge.PARSED:this.state=Ge.IDLE}this.nextLoadPosition=this.getLoadPosition()},t.flushMainBuffer=function(e,i){s.prototype.flushMainBuffer.call(this,e,i,this.altAudio===2?"video":null)},t.onMediaAttached=function(e,i){s.prototype.onMediaAttached.call(this,e,i);var r=i.media;Pr(r,"playing",this.onMediaPlaying),Pr(r,"seeked",this.onMediaSeeked)},t.onMediaDetaching=function(e,i){var r=this.media;r&&(yr(r,"playing",this.onMediaPlaying),yr(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,s.prototype.onMediaDetaching.call(this,e,i),i.transferMedia||(this._hasEnoughToStart=!1)},t.onManifestLoading=function(){s.prototype.onManifestLoading.call(this),this.log("Trigger BUFFER_RESET"),this.hls.trigger(k.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1},t.onManifestParsed=function(e,i){var r,a,o=!1,l=!1;i.levels.forEach(function(h){var u=h.audioCodec;u&&(o=o||u.indexOf("mp4a.40.2")!==-1,l=l||u.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=o&&l&&typeof((a=Bn())==null||(r=a.prototype)==null?void 0:r.changeType)!="function",this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=i.levels,this.startFragRequested=!1},t.onLevelLoading=function(e,i){if(this.levels&&this.state===Ge.IDLE){var r=i.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=Ge.WAITING_LEVEL)}},t.onLevelLoaded=function(e,i){var r,a=this.levels,o=this.startFragRequested,l=i.level,h=i.details,u=h.totalduration;if(a){this.log("Level "+l+" loaded ["+h.startSN+","+h.endSN+"]"+(h.lastPartSn?"[part-"+h.lastPartSn+"-"+h.lastPartIndex+"]":"")+", cc ["+h.startCC+", "+h.endCC+"] duration:"+u);var A=i.levelInfo,M=this.fragCurrent;!M||this.state!==Ge.FRAG_LOADING&&this.state!==Ge.FRAG_LOADING_WAITING_RETRY||M.level!==i.level&&M.loader&&this.abortCurrentFrag();var T=0;if(h.live||(r=A.details)!=null&&r.live){var P;if(this.checkLiveUpdate(h),h.deltaUpdateFailed)return;T=this.alignPlaylists(h,A.details,(P=this.levelLastLoaded)==null?void 0:P.details)}if(A.details=h,this.levelLastLoaded=A,o||this.setStartPosition(h,T),this.hls.trigger(k.LEVEL_UPDATED,{details:h,level:l}),this.state===Ge.WAITING_LEVEL){if(this.waitForCdnTuneIn(h))return;this.state=Ge.IDLE}o&&h.live&&this.synchronizeToLiveEdge(h),this.tick()}else this.warn("Levels were reset while loading level "+l)},t.synchronizeToLiveEdge=function(e){var i=this.config,r=this.media;if(r){var a=this.hls.liveSyncPosition,o=this.getLoadPosition(),l=e.fragmentStart,h=e.edge,u=o>=l-i.maxFragLookUpTolerance&&o<=h;if(a!==null&&r.duration>a&&(o<a||!u)){var A=i.liveMaxLatencyDuration!==void 0?i.liveMaxLatencyDuration:i.liveMaxLatencyDurationCount*e.targetduration;if((!u&&r.readyState<4||o<h-A)&&(this._hasEnoughToStart||(this.nextLoadPosition=a),r.readyState))if(this.warn("Playback: "+o.toFixed(3)+" is located too far from the end of live sliding playlist: "+h+", reset currentTime to : "+a.toFixed(3)),this.config.liveSyncMode==="buffered"){var M,T=Et.bufferInfo(r,a,0);if(T==null||(M=T.buffered)==null||!M.length||T.start<=o)return void(r.currentTime=a);var P=Et.bufferedInfo(T.buffered,o,0).nextStart;P&&(r.currentTime=P)}else r.currentTime=a}}},t._handleFragmentLoadProgress=function(e){var i,r=e.frag,a=e.part,o=e.payload,l=this.levels;if(l){var h=l[r.level];if(h){var u=h.details;if(!u)return this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset"),void this.fragmentTracker.removeFragment(r);var A=h.videoCodec,M=u.PTSKnown||!u.live,T=(i=r.initSegment)==null?void 0:i.data,P=this._getAudioCodec(h),U=this.transmuxer=this.transmuxer||new Ks(this.hls,q,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),G=a?a.index:-1,$=G!==-1,te=new kn(r.level,r.sn,r.stats.chunkCount,o.byteLength,G,$),se=this.initPTS[r.cc];U.push(o,T,P,A,r,a,u.totalduration,M,te,se)}else this.warn("Level "+r.level+" not found on progress")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},t.onAudioTrackSwitching=function(e,i){var r=this,a=this.hls,o=this.altAudio===2;if(Qe(i.url,a))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var l=this.fragCurrent;l&&(this.log("Switching to main audio track, cancel main fragment load"),l.abortRequests(),this.fragmentTracker.removeFragment(l)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(o)return this.fragmentTracker.removeAllFragments(),a.once(k.BUFFER_FLUSHED,function(){var h;(h=r.hls)==null||h.trigger(k.AUDIO_TRACK_SWITCHED,i)}),void a.trigger(k.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});a.trigger(k.AUDIO_TRACK_SWITCHED,i)}},t.onAudioTrackSwitched=function(e,i){var r=Qe(i.url,this.hls);if(r){var a=this.videoBuffer;a&&this.mediaBuffer!==a&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=a)}this.altAudio=r?2:0,this.tick()},t.onBufferCreated=function(e,i){var r,a,o=i.tracks,l=!1;for(var h in o){var u=o[h];if(u.id==="main"){if(a=h,r=u,h==="video"){var A=o[h];A&&(this.videoBuffer=A.buffer)}}else l=!0}l&&r?(this.log("Alternate track found, use "+a+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},t.onFragBuffered=function(e,i){var r=i.frag,a=i.part,o=r.type===q;if(o){if(this.fragContextChanged(r))return this.warn("Fragment "+r.sn+(a?" p: "+a.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===Ge.PARSED&&(this.state=Ge.IDLE));var l=a?a.stats:r.stats;this.fragLastKbps=Math.round(8*l.total/(l.buffering.end-l.loading.first)),Ht(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,a)}var h=this.media;h&&(!this._hasEnoughToStart&&Et.getBuffered(h).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),o&&this.tick())},t.onError=function(e,i){var r;if(i.fatal)this.state=Ge.ERROR;else switch(i.details){case K.FRAG_GAP:case K.FRAG_PARSING_ERROR:case K.FRAG_DECRYPT_ERROR:case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(q,i);break;case K.LEVEL_LOAD_ERROR:case K.LEVEL_LOAD_TIMEOUT:case K.LEVEL_PARSING_ERROR:i.levelRetry||this.state!==Ge.WAITING_LEVEL||((r=i.context)==null?void 0:r.type)!==ie||(this.state=Ge.IDLE);break;case K.BUFFER_ADD_CODEC_ERROR:case K.BUFFER_APPEND_ERROR:if(i.parent!=="main")return;this.resetLoadingState();break;case K.BUFFER_FULL_ERROR:if(i.parent!=="main")return;this.reduceLengthAndFlushBuffer(i)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case K.INTERNAL_EXCEPTION:this.recoverWorkerError(i)}},t.onFragLoadEmergencyAborted=function(){this.state=Ge.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()},t.onBufferFlushed=function(e,i){var r=i.type;if(r!==Jt||!this.altAudio){var a=(r===Bt?this.videoBuffer:this.mediaBuffer)||this.media;a&&(this.afterBufferFlushed(a,r,q),this.tick())}},t.onLevelsUpdated=function(e,i){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=i.levels},t.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},t.seekToStartPos=function(){var e=this.media;if(e){var i=e.currentTime,r=this.startPosition;if(r>=0&&i<r){if(e.seeking)return void this.log("could not seek to "+r+", already seeking at "+i);var a=this.timelineOffset;a&&r&&(r+=a);var o=this.getLevelDetails(),l=Et.getBuffered(e),h=l.length?l.start(0):0,u=h-r,A=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||u>0&&(u<A||this.loadingParts&&u<2*((o==null?void 0:o.partTarget)||0)))&&(this.log("adjusting start position by "+u+" to match buffer start"),r+=u,this.startPosition=r),i<r&&(this.log("seek to target start position "+r+" from current time "+i+" buffer start "+h),e.currentTime=r)}}},t._getAudioCodec=function(e){var i=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&i&&(this.log("Swapping audio codec"),i=i.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),i},t._loadBitrateTestFrag=function(e,i){var r=this;e.bitrateTest=!0,this._doFragLoad(e,i).then(function(a){var o=r.hls,l=a==null?void 0:a.frag;if(l&&!r.fragContextChanged(l)){i.fragmentError=0,r.state=Ge.IDLE,r.startFragRequested=!1,r.bitrateTest=!1;var h=l.stats;h.parsing.start=h.parsing.end=h.buffering.start=h.buffering.end=self.performance.now(),o.trigger(k.FRAG_LOADED,a),l.bitrateTest=!1}})},t._handleTransmuxComplete=function(e){var i,r=this.playlistType,a=this.hls,o=e.remuxResult,l=e.chunkMeta,h=this.getCurrentContext(l);if(h){var u=h.frag,A=h.part,M=h.level,T=o.video,P=o.text,U=o.id3,G=o.initSegment,$=M.details,te=this.altAudio?void 0:o.audio;if(this.fragContextChanged(u))this.fragmentTracker.removeFragment(u);else{if(this.state=Ge.PARSING,G){if(G!=null&&G.tracks){var se=u.initSegment||u;this._bufferInitSegment(M,G.tracks,se,l),a.trigger(k.FRAG_PARSING_INIT_SEGMENT,{frag:se,id:r,tracks:G.tracks})}var pe=G.initPTS,ye=G.timescale;x(pe)&&(this.initPTS[u.cc]={baseTime:pe,timescale:ye},a.trigger(k.INIT_PTS_FOUND,{frag:u,id:r,initPTS:pe,timescale:ye}))}if(T&&$){te&&T.type==="audiovideo"&&this.logMuxedErr(u);var he=$.fragments[u.sn-1-$.startSN],ge=u.sn===$.startSN,Ae=!he||u.cc>he.cc;if(o.independent!==!1){var Te=T.startPTS,Ee=T.endPTS,xe=T.startDTS,Pe=T.endDTS;if(A)A.elementaryStreams[T.type]={startPTS:Te,endPTS:Ee,startDTS:xe,endDTS:Pe};else if(T.firstKeyFrame&&T.independent&&l.id===1&&!Ae&&(this.couldBacktrack=!0),T.dropped&&T.independent){var ze=this.getMainFwdBufferInfo(),Fe=(ze?ze.end:this.getLoadPosition())+this.config.maxBufferHole,Me=T.firstKeyFramePTS?T.firstKeyFramePTS:Te;if(!ge&&Fe<Me-this.config.maxBufferHole&&!Ae)return void this.backtrack(u);Ae&&(u.gap=!0),u.setElementaryStreamInfo(T.type,u.start,Ee,u.start,Pe,!0)}else ge&&Te-($.appliedTimelineOffset||0)>2&&(u.gap=!0);u.setElementaryStreamInfo(T.type,Te,Ee,xe,Pe),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(T,u,A,l,ge||Ae)}else{if(!ge&&!Ae)return void this.backtrack(u);u.gap=!0}}if(te){var De=te.startPTS,je=te.endPTS,Ye=te.startDTS,ot=te.endDTS;A&&(A.elementaryStreams[Jt]={startPTS:De,endPTS:je,startDTS:Ye,endDTS:ot}),u.setElementaryStreamInfo(Jt,De,je,Ye,ot),this.bufferFragmentData(te,u,A,l)}if($&&U!=null&&(i=U.samples)!=null&&i.length){var qe={id:r,frag:u,details:$,samples:U.samples};a.trigger(k.FRAG_PARSING_METADATA,qe)}if($&&P){var Lt={id:r,frag:u,details:$,samples:P.samples};a.trigger(k.FRAG_PARSING_USERDATA,Lt)}}}else this.resetWhenMissingContext(l)},t.logMuxedErr=function(e){this.warn((Ht(e)?"Media":"Init")+" segment with muxed audiovideo where only video expected: "+e.url)},t._bufferInitSegment=function(e,i,r,a){var o=this;if(this.state===Ge.PARSING){this.audioOnly=!!i.audio&&!i.video,this.altAudio&&!this.audioOnly&&(delete i.audio,i.audiovideo&&this.logMuxedErr(r));var l=i.audio,h=i.video,u=i.audiovideo;if(l){var A=C(l.codec,e.audioCodec);A==="mp4a"&&(A="mp4a.40.5");var M=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){A&&(A=A.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5");var T=l.metadata;T&&"channelCount"in T&&(T.channelCount||1)!==1&&M.indexOf("firefox")===-1&&(A="mp4a.40.5")}A&&A.indexOf("mp4a.40.5")!==-1&&M.indexOf("android")!==-1&&l.container!=="audio/mpeg"&&(A="mp4a.40.2",this.log("Android: force audio codec to "+A)),e.audioCodec&&e.audioCodec!==A&&this.log('Swapping manifest audio codec "'+e.audioCodec+'" for "'+A+'"'),l.levelCodec=A,l.id=q,this.log("Init audio buffer, container:"+l.container+", codecs[selected/level/parsed]=["+(A||"")+"/"+(e.audioCodec||"")+"/"+l.codec+"]"),delete i.audiovideo}if(h){h.levelCodec=e.videoCodec,h.id=q;var P=h.codec;if((P==null?void 0:P.length)===4)switch(P){case"hvc1":case"hev1":h.codec="hvc1.1.6.L120.90";break;case"av01":h.codec="av01.0.04M.08";break;case"avc1":h.codec="avc1.42e01e"}this.log("Init video buffer, container:"+h.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+P+"]"+(h.codec!==P?" parsed-corrected="+h.codec:"")+(h.supplemental?" supplemental="+h.supplemental:"")),delete i.audiovideo}u&&(this.log("Init audiovideo buffer, container:"+u.container+", codecs[level/parsed]=["+e.codecs+"/"+u.codec+"]"),delete i.video,delete i.audio);var U=Object.keys(i);if(U.length){if(this.hls.trigger(k.BUFFER_CODECS,i),!this.hls)return;U.forEach(function(G){var $=i[G].initSegment;$!=null&&$.byteLength&&o.hls.trigger(k.BUFFER_APPENDING,{type:G,data:$,frag:r,part:null,chunkMeta:a,parent:r.type})})}this.tickImmediate()}},t.getMainFwdBufferInfo=function(){var e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,q)},t.backtrack=function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Ge.IDLE},t.checkFragmentChanged=function(){var e=this.media,i=null;if(e&&e.readyState>1&&e.seeking===!1){var r=e.currentTime;if(Et.isBuffered(e,r)?i=this.getAppendedFrag(r):Et.isBuffered(e,r+.1)&&(i=this.getAppendedFrag(r+.1)),i){this.backtrackFragment=null;var a=this.fragPlaying,o=i.level;a&&i.sn===a.sn&&a.level===o||(this.fragPlaying=i,this.hls.trigger(k.FRAG_CHANGED,{frag:i}),a&&a.level===o||this.hls.trigger(k.LEVEL_SWITCHED,{level:o}))}}},g(n,[{key:"hasEnoughToStart",get:function(){return this._hasEnoughToStart}},{key:"maxBufferLength",get:function(){var e=this.levels,i=this.level,r=e==null?void 0:e[i];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e;if(this.fragPlaying)return this.fragPlaying;var i=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return x(i)?this.getAppendedFrag(i):null}},{key:"currentProgramDateTime",get:function(){var e,i=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(x(i)){var r=this.getLevelDetails(),a=this.currentFrag||(r?vt(null,r.fragments,i):null);if(a){var o=a.programDateTime;if(o!==null){var l=o+1e3*(i-a.start);return new Date(l)}}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])}(Vs),Zs=function(){function s(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}var n=s.prototype;return n.abort=function(t){for(var e in this.keyUriToKeyInfo){var i=this.keyUriToKeyInfo[e].loader;if(i){var r;if(t&&t!==((r=i.context)==null?void 0:r.frag.type))return;i.abort()}}},n.detach=function(){for(var t in this.keyUriToKeyInfo){var e=this.keyUriToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}},n.destroy=function(){for(var t in this.detach(),this.keyUriToKeyInfo){var e=this.keyUriToKeyInfo[t].loader;e&&e.destroy()}this.keyUriToKeyInfo={}},n.createKeyLoadError=function(t,e,i,r,a){return e===void 0&&(e=K.KEY_LOAD_ERROR),new Vi({type:re.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:a,error:i,networkDetails:r})},n.loadClear=function(t,e){var i=this;if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(e.length){for(var r,a=t.sn,o=t.cc,l=function(){var A=e[h];if(o<=A.cc&&(a==="initSegment"||A.sn==="initSegment"||a<A.sn))return{v:i.emeController.selectKeySystemFormat(A).then(function(M){if(A.setKeyFormat(M),i.emeController&&i.config.requireKeySystemAccessOnStart){var T=xt.keySystemFormatToKeySystemDomain(M);if(T)return i.emeController.getKeySystemAccess([T])}})}},h=0;h<e.length;h++)if(r=l())return r.v}else if(this.config.requireKeySystemAccessOnStart){var u=xt.getKeySystemsForConfig(this.config);if(u.length)return this.emeController.getKeySystemAccess(u)}}return null},n.load=function(t){var e=this;return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then(function(i){return e.loadInternal(t,i)}):this.loadInternal(t)},n.loadInternal=function(t,e){var i,r;e&&t.setKeyFormat(e);var a=t.decryptdata;if(!a){var o=new Error(e?"Expected frag.decryptdata to be defined after setting format "+e:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,K.KEY_LOAD_ERROR,o))}var l=a.uri;if(!l)return Promise.reject(this.createKeyLoadError(t,K.KEY_LOAD_ERROR,new Error('Invalid key URI: "'+l+'"')));var h,u=this.keyUriToKeyInfo[l];if((i=u)!=null&&i.decryptdata.key)return a.key=u.decryptdata.key,Promise.resolve({frag:t,keyInfo:u});if((r=u)!=null&&r.keyLoadPromise)switch((h=u.mediaKeySessionContext)==null?void 0:h.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return u.keyLoadPromise.then(function(A){return a.key=A.keyInfo.decryptdata.key,{frag:t,keyInfo:u}})}switch(u=this.keyUriToKeyInfo[l]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(u,t):this.loadKeyEME(u,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(u,t);default:return Promise.reject(this.createKeyLoadError(t,K.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'+a.method+'"')))}},n.loadKeyEME=function(t,e){var i={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){var r=this.emeController.loadKey(i);if(r)return(t.keyLoadPromise=r.then(function(a){return t.mediaKeySessionContext=a,i})).catch(function(a){throw t.keyLoadPromise=null,a})}return Promise.resolve(i)},n.loadKeyHTTP=function(t,e){var i=this,r=this.config,a=new r.loader(r);return e.keyLoader=t.loader=a,t.keyLoadPromise=new Promise(function(o,l){var h={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},u=r.keyLoadPolicy.default,A={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},M={onSuccess:function(T,P,U,G){var $=U.frag,te=U.keyInfo,se=U.url;if(!$.decryptdata||te!==i.keyUriToKeyInfo[se])return l(i.createKeyLoadError($,K.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),G));te.decryptdata.key=$.decryptdata.key=new Uint8Array(T.data),$.keyLoader=null,te.loader=null,o({frag:$,keyInfo:te})},onError:function(T,P,U,G){i.resetLoader(P),l(i.createKeyLoadError(e,K.KEY_LOAD_ERROR,new Error("HTTP Error "+T.code+" loading key "+T.text),U,E({url:h.url,data:void 0},T)))},onTimeout:function(T,P,U){i.resetLoader(P),l(i.createKeyLoadError(e,K.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),U))},onAbort:function(T,P,U){i.resetLoader(P),l(i.createKeyLoadError(e,K.INTERNAL_ABORTED,new Error("key loading aborted"),U))}};a.load(h,A,M)})},n.resetLoader=function(t){var e=t.frag,i=t.keyInfo,r=t.url,a=i.loader;e.keyLoader===a&&(e.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[r],a&&a.destroy()},s}();function jn(s){switch(s.type){case ve:return H;case _e:return le;default:return q}}function wa(s,n){var t=s.url;return t!==void 0&&t.indexOf("data:")!==0||(t=n.url),t}var Xs=function(){function s(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}var n=s.prototype;return n.startLoad=function(t){},n.stopLoad=function(){this.destroyInternalLoaders()},n.registerListeners=function(){var t=this.hls;t.on(k.MANIFEST_LOADING,this.onManifestLoading,this),t.on(k.LEVEL_LOADING,this.onLevelLoading,this),t.on(k.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(k.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(k.LEVELS_UPDATED,this.onLevelsUpdated,this)},n.unregisterListeners=function(){var t=this.hls;t.off(k.MANIFEST_LOADING,this.onManifestLoading,this),t.off(k.LEVEL_LOADING,this.onLevelLoading,this),t.off(k.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(k.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(k.LEVELS_UPDATED,this.onLevelsUpdated,this)},n.createInternalLoader=function(t){var e=this.hls.config,i=e.pLoader,r=e.loader,a=new(i||r)(e);return this.loaders[t.type]=a,a},n.getInternalLoader=function(t){return this.loaders[t.type]},n.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},n.destroyInternalLoaders=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}},n.destroy=function(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()},n.onManifestLoading=function(t,e){var i=e.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:de,url:i,deliveryDirectives:null,levelOrTrack:null})},n.onLevelLoading=function(t,e){var i=e.id,r=e.level,a=e.pathwayId,o=e.url,l=e.deliveryDirectives,h=e.levelInfo;this.load({id:i,level:r,pathwayId:a,responseType:"text",type:ie,url:o,deliveryDirectives:l,levelOrTrack:h})},n.onAudioTrackLoading=function(t,e){var i=e.id,r=e.groupId,a=e.url,o=e.deliveryDirectives,l=e.track;this.load({id:i,groupId:r,level:null,responseType:"text",type:ve,url:a,deliveryDirectives:o,levelOrTrack:l})},n.onSubtitleTrackLoading=function(t,e){var i=e.id,r=e.groupId,a=e.url,o=e.deliveryDirectives,l=e.track;this.load({id:i,groupId:r,level:null,responseType:"text",type:_e,url:a,deliveryDirectives:o,levelOrTrack:l})},n.onLevelsUpdated=function(t,e){var i=this.loaders[ie];if(i){var r=i.context;r&&!e.levels.some(function(a){return a===r.levelOrTrack})&&(i.abort(),delete this.loaders[ie])}},n.load=function(t){var e,i,r,a=this,o=this.hls.config,l=this.getInternalLoader(t);if(l){var h=this.hls.logger,u=l.context;if(u&&u.levelOrTrack===t.levelOrTrack&&(u.url===t.url||u.deliveryDirectives&&!t.deliveryDirectives))return void(u.url===t.url?h.log("[playlist-loader]: ignore "+t.url+" ongoing request"):h.log("[playlist-loader]: ignore "+t.url+" in favor of "+u.url));h.log("[playlist-loader]: aborting previous loader for type: "+t.type),l.abort()}if(i=t.type===de?o.manifestLoadPolicy.default:D({},o.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),l=this.createInternalLoader(t),x((e=t.deliveryDirectives)==null?void 0:e.part)&&(t.type===ie&&t.level!==null?r=this.hls.levels[t.level].details:t.type===ve&&t.id!==null?r=this.hls.audioTracks[t.id].details:t.type===_e&&t.id!==null&&(r=this.hls.subtitleTracks[t.id].details),r)){var A=r.partTarget,M=r.targetduration;if(A&&M){var T=1e3*Math.max(3*A,.8*M);i=D({},i,{maxTimeToFirstByteMs:Math.min(T,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(T,i.maxTimeToFirstByteMs)})}}var P=i.errorRetry||i.timeoutRetry||{},U={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:P.maxNumRetry||0,retryDelay:P.retryDelayMs||0,maxRetryDelay:P.maxRetryDelayMs||0},G={onSuccess:function($,te,se,pe){var ye=a.getInternalLoader(se);a.resetInternalLoader(se.type);var he=$.data;he.indexOf("#EXTM3U")===0?(te.parsing.start=performance.now(),Dr.isMediaPlaylist(he)||se.type!==de?a.handleTrackOrLevelPlaylist($,te,se,pe||null,ye):a.handleMasterPlaylist($,te,se,pe)):a.handleManifestParsingError($,se,new Error("no EXTM3U delimiter"),pe||null,te)},onError:function($,te,se,pe){a.handleNetworkError(te,se,!1,$,pe)},onTimeout:function($,te,se){a.handleNetworkError(te,se,!0,void 0,$)}};l.load(t,U,G)},n.checkAutostartLoad=function(){if(this.hls){var t=this.hls,e=t.config,i=e.autoStartLoad,r=e.startPosition,a=t.forceStartLoad;(i||a)&&(this.hls.logger.log((i?"auto":"force")+" startLoad with configured startPosition "+r),this.hls.startLoad(r))}},n.handleMasterPlaylist=function(t,e,i,r){var a=this.hls,o=t.data,l=wa(t,i),h=Dr.parseMasterPlaylist(o,l);if(h.playlistParsingError)this.handleManifestParsingError(t,i,h.playlistParsingError,r,e);else{var u=h.contentSteering,A=h.levels,M=h.sessionData,T=h.sessionKeys,P=h.startTimeOffset,U=h.variableList;this.variableList=U;var G=Dr.parseMasterPlaylistMedia(o,l,h),$=G.AUDIO,te=$===void 0?[]:$,se=G.SUBTITLES,pe=G["CLOSED-CAPTIONS"];te.length&&(te.some(function(ye){return!ye.url})||!A[0].audioCodec||A[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),te.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new $t({}),bitrate:0,url:""}))),a.trigger(k.MANIFEST_LOADED,{levels:A,audioTracks:te,subtitles:se,captions:pe,contentSteering:u,url:l,stats:e,networkDetails:r,sessionData:M,sessionKeys:T,startTimeOffset:P,variableList:U})}},n.handleTrackOrLevelPlaylist=function(t,e,i,r,a){var o=this.hls,l=i.id,h=i.level,u=i.type,A=wa(t,i),M=x(h)?h:x(l)?l:0,T=jn(i),P=Dr.parseLevelPlaylist(t.data,A,M,T,0,this.variableList);if(u===de){var U={attrs:new $t({}),bitrate:0,details:P,name:"",url:A};P.requestScheduled=e.loading.start+za(P,0),o.trigger(k.MANIFEST_LOADED,{levels:[U],audioTracks:[],url:A,stats:e,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),i.levelDetails=P,this.handlePlaylistLoaded(P,t,e,i,r,a)},n.handleManifestParsingError=function(t,e,i,r,a){this.hls.trigger(k.ERROR,{type:re.NETWORK_ERROR,details:K.MANIFEST_PARSING_ERROR,fatal:e.type===de,url:t.url,err:i,error:i,reason:i.message,response:t,context:e,networkDetails:r,stats:a})},n.handleNetworkError=function(t,e,i,r,a){i===void 0&&(i=!1);var o="A network "+(i?"timeout":"error"+(r?" (status "+r.code+")":""))+" occurred while loading "+t.type;t.type===ie?o+=": "+t.level+" id: "+t.id:t.type!==ve&&t.type!==_e||(o+=" id: "+t.id+' group-id: "'+t.groupId+'"');var l=new Error(o);this.hls.logger.warn("[playlist-loader]: "+o);var h=K.UNKNOWN,u=!1,A=this.getInternalLoader(t);switch(t.type){case de:h=i?K.MANIFEST_LOAD_TIMEOUT:K.MANIFEST_LOAD_ERROR,u=!0;break;case ie:h=i?K.LEVEL_LOAD_TIMEOUT:K.LEVEL_LOAD_ERROR,u=!1;break;case ve:h=i?K.AUDIO_TRACK_LOAD_TIMEOUT:K.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case _e:h=i?K.SUBTITLE_TRACK_LOAD_TIMEOUT:K.SUBTITLE_LOAD_ERROR,u=!1}A&&this.resetInternalLoader(t.type);var M={type:re.NETWORK_ERROR,details:h,fatal:u,url:t.url,loader:A,context:t,error:l,networkDetails:e,stats:a};if(r){var T=(e==null?void 0:e.url)||t.url;M.response=E({url:T,data:void 0},r)}this.hls.trigger(k.ERROR,M)},n.handlePlaylistLoaded=function(t,e,i,r,a,o){var l=this.hls,h=r.type,u=r.level,A=r.id,M=r.groupId,T=r.deliveryDirectives,P=wa(e,r),U=jn(r),G=typeof r.level=="number"&&U===q?u:void 0;if(t.fragments.length){t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));var $=t.playlistParsingError;if($){if(this.hls.logger.warn($),!l.config.ignorePlaylistParsingErrors)return void l.trigger(k.ERROR,{type:re.NETWORK_ERROR,details:K.LEVEL_PARSING_ERROR,fatal:!1,url:P,error:$,reason:$.message,response:e,context:r,level:G,parent:U,networkDetails:a,stats:i});t.playlistParsingError=null}switch(t.live&&o&&(o.getCacheAge&&(t.ageHeader=o.getCacheAge()||0),o.getCacheAge&&!isNaN(t.ageHeader)||(t.ageHeader=0)),h){case de:case ie:l.trigger(k.LEVEL_LOADED,{details:t,levelInfo:r.levelOrTrack||l.levels[0],level:G||0,id:A||0,stats:i,networkDetails:a,deliveryDirectives:T,withoutMultiVariant:h===de});break;case ve:l.trigger(k.AUDIO_TRACK_LOADED,{details:t,track:r.levelOrTrack,id:A||0,groupId:M||"",stats:i,networkDetails:a,deliveryDirectives:T});break;case _e:l.trigger(k.SUBTITLE_TRACK_LOADED,{details:t,track:r.levelOrTrack,id:A||0,groupId:M||"",stats:i,networkDetails:a,deliveryDirectives:T})}}else{var te=t.playlistParsingError=new Error("No Segments found in Playlist");l.trigger(k.ERROR,{type:re.NETWORK_ERROR,details:K.LEVEL_EMPTY_ERROR,fatal:!1,url:P,error:te,reason:te.message,response:e,context:r,level:G,parent:U,networkDetails:a,stats:i})}},s}(),Js={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},Vn={};function eo(s,n,t){var e=s.videoCodec,i=s.audioCodec;if(!e&&!i||!t)return Promise.resolve(Js);var r=[];if(e){var a={width:s.width,height:s.height,bitrate:Math.ceil(Math.max(.9*s.bitrate,s.averageBitrate)),framerate:s.frameRate||30},o=s.videoRange;o!=="SDR"&&(a.transferFunction=o.toLowerCase());var l=e.split(","),h=navigator.userAgent;if(l.some(function(u){return cr(u)})&&bi())return Promise.resolve(function(u,A){return{supported:!1,configurations:A,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:u}}(new Error("Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: ("+h+")"),r));r.push.apply(r,l.map(function(u){return{type:"media-source",video:E(E({},a),{},{contentType:v(V(u),"video")})}}))}return i&&s.audioGroups&&s.audioGroups.forEach(function(u){var A;u&&((A=n.groups[u])==null||A.tracks.forEach(function(M){if(M.groupId===u){var T=M.channels||"",P=parseFloat(T);x(P)&&P>2&&r.push.apply(r,i.split(",").map(function(U){return{type:"media-source",audio:{contentType:v(U,"audio"),channels:""+P}}}))}}))}),Promise.all(r.map(function(u){var A=function(M){var T=M.audio,P=M.video,U=P||T;if(U){var G=Z(U.contentType);if(P)return"r"+P.height+"x"+P.width+"f"+Math.ceil(P.framerate)+(P.transferFunction||"sd")+"_"+G+"_"+Math.ceil(P.bitrate/1e5);if(T)return"c"+T.channels+(T.spatialRendering?"s":"n")+"_"+G}return""}(u);return Vn[A]||(Vn[A]=t.decodingInfo(u))})).then(function(u){return{supported:!u.some(function(A){return!A.supported}),configurations:r,decodingInfoResults:u}}).catch(function(u){return{supported:!1,configurations:r,decodingInfoResults:[],error:u}})}var Gn=function(){function s(t){t===void 0&&(t={}),this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new fe,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;var e=this.logger=Ue(t.debug||!1,"Hls instance",t.assetPlayerId),i=this.config=function(Me,De,je){if((De.liveSyncDurationCount||De.liveMaxLatencyDurationCount)&&(De.liveSyncDuration||De.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(De.liveMaxLatencyDurationCount!==void 0&&(De.liveSyncDurationCount===void 0||De.liveMaxLatencyDurationCount<=De.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(De.liveMaxLatencyDuration!==void 0&&(De.liveSyncDuration===void 0||De.liveMaxLatencyDuration<=De.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var Ye=Sa(Me),ot=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(function(qe){var Lt=(qe==="level"?"playlist":qe)+"LoadPolicy",It=De[Lt]===void 0,mt=[];ot.forEach(function(At){var Ct=qe+"Loading"+At,bt=De[Ct];if(bt!==void 0&&It){mt.push(Ct);var yt=Ye[Lt].default;switch(De[Lt]={default:yt},At){case"TimeOut":yt.maxLoadTimeMs=bt,yt.maxTimeToFirstByteMs=bt;break;case"MaxRetry":yt.errorRetry.maxNumRetry=bt,yt.timeoutRetry.maxNumRetry=bt;break;case"RetryDelay":yt.errorRetry.retryDelayMs=bt,yt.timeoutRetry.retryDelayMs=bt;break;case"MaxRetryTimeout":yt.errorRetry.maxRetryDelayMs=bt,yt.timeoutRetry.maxRetryDelayMs=bt}}}),mt.length&&je.warn('hls.js config: "'+mt.join('", "')+'" setting(s) are deprecated, use "'+Lt+'": '+$e(De[Lt]))}),E(E({},Ye),De)}(s.DefaultConfig,t,e);this.userConfig=t,i.progressive&&Ns(i,e);var r=i.abrController,a=i.bufferController,o=i.capLevelController,l=i.errorController,h=i.fpsController,u=new l(this),A=this.abrController=new r(this),M=new Fs(this),T=i.interstitialsController,P=T?this.interstitialsController=new T(this,s):null,U=this.bufferController=new a(this,M),G=this.capLevelController=new o(this),$=new h(this),te=new Xs(this),se=i.contentSteeringController,pe=se?new se(this):null,ye=this.levelController=new Ws(this,pe),he=new Ys(this),ge=new Zs(this.config),Ae=this.streamController=new Qs(this,M,ge),Te=this.gapController=new Gs(this,M);G.setStreamController(Ae),$.setStreamController(Ae);var Ee=[te,ye,Ae];P&&Ee.splice(1,0,P),pe&&Ee.splice(1,0,pe),this.networkControllers=Ee;var xe=[A,U,Te,G,$,he,M];this.audioTrackController=this.createController(i.audioTrackController,Ee);var Pe=i.audioStreamController;Pe&&Ee.push(this.audioStreamController=new Pe(this,M,ge)),this.subtitleTrackController=this.createController(i.subtitleTrackController,Ee);var ze=i.subtitleStreamController;ze&&Ee.push(this.subtititleStreamController=new ze(this,M,ge)),this.createController(i.timelineController,xe),ge.emeController=this.emeController=this.createController(i.emeController,xe),this.cmcdController=this.createController(i.cmcdController,xe),this.latencyController=this.createController($s,xe),this.coreComponents=xe,Ee.push(u);var Fe=u.onErrorOut;typeof Fe=="function"&&this.on(k.ERROR,Fe,u),this.on(k.MANIFEST_LOADED,te.onManifestLoaded,te)}s.isMSESupported=function(){return Un()},s.isSupported=function(){return function(){if(!Un())return!1;var t=Ti();return typeof(t==null?void 0:t.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(function(e){return t.isTypeSupported(v(e,"video"))})||["mp4a.40.2","fLaC"].some(function(e){return t.isTypeSupported(v(e,"audio"))}))}()},s.getMediaSource=function(){return Ti()};var n=s.prototype;return n.createController=function(t,e){if(t){var i=new t(this);return e&&e.push(i),i}return null},n.on=function(t,e,i){i===void 0&&(i=this),this._emitter.on(t,e,i)},n.once=function(t,e,i){i===void 0&&(i=this),this._emitter.once(t,e,i)},n.removeAllListeners=function(t){this._emitter.removeAllListeners(t)},n.off=function(t,e,i,r){i===void 0&&(i=this),this._emitter.off(t,e,i,r)},n.listeners=function(t){return this._emitter.listeners(t)},n.emit=function(t,e,i){return this._emitter.emit(t,e,i)},n.trigger=function(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(r){if(this.logger.error("An internal error happened while handling event "+t+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;var i=t===k.ERROR;this.trigger(k.ERROR,{type:re.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,fatal:i,event:t,error:r}),this.triggeringException=!1}}return!1},n.listenerCount=function(t){return this._emitter.listenerCount(t)},n.destroy=function(){this.logger.log("destroy"),this.trigger(k.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(function(e){return e.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(e){return e.destroy()}),this.coreComponents.length=0;var t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null},n.attachMedia=function(t){if(!t||"media"in t&&!t.media){var e=new Error("attachMedia failed: invalid argument ("+t+")");this.trigger(k.ERROR,{type:re.OTHER_ERROR,details:K.ATTACH_MEDIA_ERROR,fatal:!0,error:e})}else{this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());var i="media"in t,r=i?t.media:t,a=i?t:{media:r};this._media=r,this.trigger(k.MEDIA_ATTACHING,a)}},n.detachMedia=function(){this.logger.log("detachMedia"),this.trigger(k.MEDIA_DETACHING,{}),this._media=null},n.transferMedia=function(){this._media=null;var t=this.bufferController.transferMedia();return this.trigger(k.MEDIA_DETACHING,{transferMedia:t}),t},n.loadSource=function(t){this.stopLoad();var e=this.media,i=this._url,r=this._url=B.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log("loadSource:"+r),e&&i&&(i!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(k.MANIFEST_LOADING,{url:t})},n.startLoad=function(t,e){t===void 0&&(t=-1),this.logger.log("startLoad("+t+(e?", <skip seek to start>":"")+")"),this.started=!0,this.resumeBuffering();for(var i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(t,e),this.started&&this.networkControllers);i++);},n.stopLoad=function(){this.logger.log("stopLoad"),this.started=!1;for(var t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!this.started&&this.networkControllers);t++);},n.resumeBuffering=function(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(function(t){t.resumeBuffering&&t.resumeBuffering()}))},n.pauseBuffering=function(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(function(t){t.pauseBuffering&&t.pauseBuffering()}))},n.swapAudioCodec=function(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},n.recoverMediaError=function(){this.logger.log("recoverMediaError");var t=this._media,e=t==null?void 0:t.currentTime;this.detachMedia(),t&&(this.attachMedia(t),e&&this.startLoad(e))},n.removeLevel=function(t){this.levelController.removeLevel(t)},n.setAudioOption=function(t){var e;return((e=this.audioTrackController)==null?void 0:e.setAudioOption(t))||null},n.setSubtitleOption=function(t){var e;return((e=this.subtitleTrackController)==null?void 0:e.setSubtitleOption(t))||null},n.getMediaDecodingInfo=function(t,e){return e===void 0&&(e=this.allAudioTracks),eo(t,Be(e),navigator.mediaCapabilities)},g(s,[{key:"url",get:function(){return this._url}},{key:"hasEnoughToStart",get:function(){return this.streamController.hasEnoughToStart}},{key:"startPosition",get:function(){return this.streamController.startPositionValue}},{key:"loadingEnabled",get:function(){return this.started}},{key:"bufferingEnabled",get:function(){return this.streamController.bufferingEnabled}},{key:"inFlightFragments",get:function(){var t,e=((t={})[q]=this.streamController.inFlightFrag,t);return this.audioStreamController&&(e[H]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[le]=this.subtititleStreamController.inFlightFrag),e}},{key:"sessionId",get:function(){var t=this._sessionId;return t||(t=this._sessionId=function(){try{return crypto.randomUUID()}catch(a){try{var e=URL.createObjectURL(new Blob),i=e.toString();return URL.revokeObjectURL(e),i.slice(i.lastIndexOf("/")+1)}catch(o){var r=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){var h=(r+16*Math.random())%16|0;return r=Math.floor(r/16),(l=="x"?h:3&h|8).toString(16)})}}}()),t}},{key:"levels",get:function(){var t=this.levelController.levels;return t||[]}},{key:"latestLevelDetails",get:function(){return this.streamController.getLevelDetails()||null}},{key:"loadLevelObj",get:function(){return this.levelController.loadLevelObj}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){this.logger.log("set currentLevel:"+t),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){this.logger.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){this.logger.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){this.logger.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){var t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t},set:function(t){this.logger.log("set startLevel:"+t),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(t){var e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){this._autoLevelCapping!==t&&(this.logger.log("set autoLevelCapping:"+t),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}},{key:"bandwidthEstimate",get:function(){var t=this.abrController.bwEstimator;return t?t.getEstimate():NaN},set:function(t){this.abrController.resetEstimator(t)}},{key:"abrEwmaDefaultEstimate",get:function(){var t=this.abrController.bwEstimator;return t?t.defaultEstimate:NaN}},{key:"ttfbEstimate",get:function(){var t=this.abrController.bwEstimator;return t?t.getEstimateTTFB():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(t){(function(e){return ne.indexOf(e)>-1})(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var t=this.levels,e=this.config.minAutoBitrate;if(!t)return 0;for(var i=t.length,r=0;r<i;r++)if(t[r].maxBitrate>=e)return r;return 0}},{key:"maxAutoLevel",get:function(){var t,e=this.levels,i=this.autoLevelCapping,r=this.maxHdcpLevel;if(t=i===-1&&e!=null&&e.length?e.length-1:i,r)for(var a=t;a--;){var o=e[a].attrs["HDCP-LEVEL"];if(o&&o<=r)return a}return t}},{key:"firstAutoLevel",get:function(){return this.abrController.firstAutoLevel}},{key:"nextAutoLevel",get:function(){return this.abrController.nextAutoLevel},set:function(t){this.abrController.nextAutoLevel=t}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"maxBufferLength",get:function(){return this.streamController.maxBufferLength}},{key:"allAudioTracks",get:function(){var t=this.audioTrackController;return t?t.allAudioTracks:[]}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"allSubtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(t){this.config.lowLatencyMode=t}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency},set:function(t){this.latencyController.targetLatency=t}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}},{key:"pathways",get:function(){return this.levelController.pathways}},{key:"pathwayPriority",get:function(){return this.levelController.pathwayPriority},set:function(t){this.levelController.pathwayPriority=t}},{key:"bufferedToEnd",get:function(){var t;return!((t=this.bufferController)==null||!t.bufferedToEnd)}},{key:"interstitialsManager",get:function(){var t;return((t=this.interstitialsController)==null?void 0:t.interstitialsManager)||null}}],[{key:"version",get:function(){return Nr}},{key:"Events",get:function(){return k}},{key:"MetadataSchema",get:function(){return gi}},{key:"ErrorTypes",get:function(){return re}},{key:"ErrorDetails",get:function(){return K}},{key:"DefaultConfig",get:function(){return s.defaultConfig?s.defaultConfig:Ps},set:function(t){s.defaultConfig=t}}])}();return Gn.defaultConfig=void 0,Gn},vi.exports=w()})(!1)})(Wn);var Lo=Wn.exports;const $n=na(Lo);var ra={exports:{}};ra.exports;(function(vi,ii){/*!
 * artplayer.js v5.2.3
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2025 Harvey Zack
 * Released under the MIT License.
 */(function(R,J,w,Q,g,p,D,m){var y=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof ta<"u"?ta:{},_=typeof y[Q]=="function"&&y[Q],b=_.i||{},E=_.cache||{},L=typeof ia=="function"&&ia.bind(vi);function I(W,oe){if(!E[W]){if(!R[W]){if(g[W])return g[W];var F=typeof y[Q]=="function"&&y[Q];if(!oe&&F)return F(W,!0);if(_)return _(W,!0);if(L&&typeof W=="string")return L(W);var ee=Error("Cannot find module '"+W+"'");throw ee.code="MODULE_NOT_FOUND",ee}ae.resolve=function(B){var x=R[W][1][B];return x!=null?x:B},ae.cache={};var fe=E[W]=new I.Module(W);R[W][0].call(fe.exports,ae,fe,fe.exports,y)}return E[W].exports;function ae(B){var x=ae.resolve(B);return x===!1?{}:I(x)}}I.isParcelRequire=!0,I.Module=function(W){this.id=W,this.bundle=I,this.require=L,this.exports={}},I.modules=R,I.cache=E,I.parent=_,I.distDir=void 0,I.publicUrl=void 0,I.devServer=void 0,I.i=b,I.register=function(W,oe){R[W]=[function(F,ee){ee.exports=oe},{}]},Object.defineProperty(I,"root",{get:function(){return y[Q]}}),y[Q]=I;for(var z=0;z<J.length;z++)I(J[z]);if(w){var j=I(w);vi.exports=j}})({"5lTcX":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("bundle-text:./style/index.less"),D=g.interopDefault(p),m=R("option-validator"),y=g.interopDefault(m),_=R("./utils/emitter"),b=g.interopDefault(_),E=R("./utils"),L=R("./scheme"),I=g.interopDefault(L),z=R("./config"),j=g.interopDefault(z),W=R("./template"),oe=g.interopDefault(W),F=R("./i18n"),ee=g.interopDefault(F),fe=R("./player"),ae=g.interopDefault(fe),B=R("./control"),x=g.interopDefault(B),N=R("./contextmenu"),Y=g.interopDefault(N),re=R("./info"),K=g.interopDefault(re),k=R("./subtitle"),de=g.interopDefault(k),ie=R("./events"),ve=g.interopDefault(ie),_e=R("./hotkey"),q=g.interopDefault(_e),H=R("./layer"),le=g.interopDefault(H),be=R("./loading"),Ie=g.interopDefault(be),Oe=R("./notice"),We=g.interopDefault(Oe),et=R("./mask"),Le=g.interopDefault(et),Re=R("./icons"),He=g.interopDefault(Re),Ue=R("./setting"),Ke=g.interopDefault(Ue),st=R("./storage"),Ze=g.interopDefault(st),xt=R("./plugins"),Xt=g.interopDefault(xt);let ct=0,ri=[];class Xe extends b.default{constructor(Bt,_i){super(),this.id=++ct;let Si=E.mergeDeep(Xe.option,Bt);if(Si.container=Bt.container,this.option=(0,y.default)(Si,I.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isRotate=!1,this.isDestroy=!1,this.template=new oe.default(this),this.events=new ve.default(this),this.storage=new Ze.default(this),this.icons=new He.default(this),this.i18n=new ee.default(this),this.notice=new We.default(this),this.player=new ae.default(this),this.layers=new le.default(this),this.controls=new x.default(this),this.contextmenu=new Y.default(this),this.subtitle=new de.default(this),this.info=new K.default(this),this.loading=new Ie.default(this),this.hotkey=new q.default(this),this.mask=new Le.default(this),this.setting=new Ke.default(this),this.plugins=new Xt.default(this),typeof _i=="function"&&this.on("ready",()=>_i.call(this,this)),Xe.DEBUG){let Ht=ui=>console.log("[ART.".concat(this.id,"] -> ").concat(ui));Ht("Version@"+Xe.version),Ht("Env@"+Xe.env),Ht("Build@"+Xe.build);for(let ui=0;ui<j.default.events.length;ui++)this.on("video:"+j.default.events[ui],Oi=>Ht("Event@"+Oi.type))}ri.push(this)}static get instances(){return ri}static get version(){return"5.2.3"}static get env(){return"production"}static get build(){return"2025-04-20 10:10:54"}static get config(){return j.default}static get utils(){return E}static get scheme(){return I.default}static get Emitter(){return b.default}static get validator(){return y.default}static get kindOf(){return y.default.kindOf}static get html(){return oe.default.html}static get option(){return{id:"",container:"#artplayer",url:"",poster:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,gesture:!0,fastForward:!1,autoPlayback:!1,autoOrientation:!1,airplay:!1,proxy:void 0,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],thumbnails:{url:"",number:60,column:10,width:0,height:0,scale:1},subtitle:{url:"",type:"",style:{},name:"",escape:!0,encoding:"utf-8",onVttLoad:Bt=>Bt},moreVideoAttr:{controls:!1,preload:E.isSafari?"auto":"metadata"},i18n:{},icons:{},cssVar:{},customType:{},lang:navigator==null?void 0:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}get video(){return this.template.$video}destroy(Bt=!0){this.events.destroy(),this.template.destroy(Bt),ri.splice(ri.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}w.default=Xe,Xe.STYLE=D.default,Xe.DEBUG=!1,Xe.CONTEXTMENU=!0,Xe.NOTICE_TIME=2e3,Xe.SETTING_WIDTH=250,Xe.SETTING_ITEM_WIDTH=200,Xe.SETTING_ITEM_HEIGHT=35,Xe.RESIZE_TIME=200,Xe.SCROLL_TIME=200,Xe.SCROLL_GAP=50,Xe.AUTO_PLAYBACK_MAX=10,Xe.AUTO_PLAYBACK_MIN=5,Xe.AUTO_PLAYBACK_TIMEOUT=3e3,Xe.RECONNECT_TIME_MAX=5,Xe.RECONNECT_SLEEP_TIME=1e3,Xe.CONTROL_HIDE_TIME=3e3,Xe.DBCLICK_TIME=300,Xe.DBCLICK_FULLSCREEN=!0,Xe.MOBILE_DBCLICK_PLAY=!0,Xe.MOBILE_CLICK_PLAY=!1,Xe.AUTO_ORIENTATION_TIME=200,Xe.INFO_LOOP_TIME=1e3,Xe.FAST_FORWARD_VALUE=3,Xe.FAST_FORWARD_TIME=1e3,Xe.TOUCH_MOVE_RATIO=.5,Xe.VOLUME_STEP=.1,Xe.SEEK_STEP=5,Xe.PLAYBACK_RATE=[.5,.75,1,1.25,1.5,2],Xe.ASPECT_RATIO=["default","4:3","16:9"],Xe.FLIP=["normal","horizontal","vertical"],Xe.FULLSCREEN_WEB_IN_BODY=!1,Xe.LOG_VERSION=!0,Xe.USE_RAF=!1,E.isBrowser&&(window.Artplayer=Xe,E.setStyleText("artplayer-style",D.default),setTimeout(()=>{Xe.LOG_VERSION&&console.log("%c ArtPlayer %c ".concat(Xe.version," %c https://artplayer.org"),"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},100))},{"bundle-text:./style/index.less":"0016T","option-validator":"bAWi2","./utils/emitter":"66mFZ","./utils":"71aH7","./scheme":"AKEiO","./config":"lyjeQ","./template":"X13Zf","./i18n":"3jKkj","./player":"a90nx","./control":"8Z0Uf","./contextmenu":"2KYsr","./info":"02ajl","./subtitle":"eSWto","./events":"jo4S1","./hotkey":"6NoFy","./layer":"6G6hZ","./loading":"3dsEe","./notice":"dWGTw","./mask":"5POkG","./icons":"6OeNg","./setting":"3eYNH","./storage":"2aaJe","./plugins":"8MTUM","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"0016T":[function(R,J,w,Q){J.exports='.art-video-player{--art-theme:red;--art-font-color:#fff;--art-background-color:#000;--art-text-shadow-color:#00000080;--art-transition-duration:.2s;--art-padding:10px;--art-border-radius:3px;--art-progress-height:6px;--art-progress-color:#ffffff40;--art-hover-color:#ffffff40;--art-loaded-color:#ffffff40;--art-state-size:80px;--art-state-opacity:.8;--art-bottom-height:100px;--art-bottom-offset:20px;--art-bottom-gap:5px;--art-highlight-width:8px;--art-highlight-color:#ffffff80;--art-control-height:46px;--art-control-opacity:.75;--art-control-icon-size:36px;--art-control-icon-scale:1.1;--art-volume-height:120px;--art-volume-handle-size:14px;--art-lock-size:36px;--art-indicator-scale:0;--art-indicator-size:16px;--art-fullscreen-web-index:9999;--art-settings-icon-size:24px;--art-settings-max-height:300px;--art-selector-max-height:300px;--art-contextmenus-min-width:250px;--art-subtitle-font-size:20px;--art-subtitle-gap:5px;--art-subtitle-bottom:15px;--art-subtitle-border:#000;--art-widget-background:#000000d9;--art-tip-background:#000000b3;--art-scrollbar-size:4px;--art-scrollbar-background:#ffffff40;--art-scrollbar-background-hover:#ffffff80;--art-mini-progress-height:2px}.art-bg-cover{background-position:50%;background-repeat:no-repeat;background-size:cover}.art-bottom-gradient{background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x}.art-backdrop-filter{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.art-video-player{zoom:1;text-align:left;user-select:none;box-sizing:border-box;width:100%;height:100%;color:var(--art-font-color);background-color:var(--art-background-color);text-shadow:0 0 2px var(--art-text-shadow-color);-webkit-tap-highlight-color:#0000;-ms-touch-action:manipulation;touch-action:manipulation;-ms-high-contrast-adjust:none;direction:ltr;outline:0;margin:0 auto;padding:0;font-family:PingFang SC,Helvetica Neue,Microsoft YaHei,Roboto,Arial,sans-serif;font-size:14px;line-height:1.3;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box}.art-video-player ::-webkit-scrollbar{width:var(--art-scrollbar-size);height:var(--art-scrollbar-size)}.art-video-player ::-webkit-scrollbar-thumb{background-color:var(--art-scrollbar-background)}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:var(--art-scrollbar-background-hover)}.art-video-player img{vertical-align:top;max-width:100%}.art-video-player svg{fill:var(--art-font-color)}.art-video-player a{color:var(--art-font-color);text-decoration:none}.art-icon{justify-content:center;align-items:center;line-height:1;display:flex}.art-video-player.art-backdrop .art-contextmenus,.art-video-player.art-backdrop .art-info,.art-video-player.art-backdrop .art-settings,.art-video-player.art-backdrop .art-layer-auto-playback,.art-video-player.art-backdrop .art-selector-list,.art-video-player.art-backdrop .art-volume-inner{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-video{z-index:10;cursor:pointer;width:100%;height:100%;position:absolute;inset:0}.art-poster{z-index:11;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;width:100%;height:100%;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;text-align:center;pointer-events:none;justify-content:center;align-items:center;gap:var(--art-subtitle-gap);width:100%;bottom:var(--art-subtitle-bottom);font-size:var(--art-subtitle-font-size);transition:bottom var(--art-transition-duration)ease;text-shadow:var(--art-subtitle-border)1px 0 1px,var(--art-subtitle-border)0 1px 1px,var(--art-subtitle-border)-1px 0 1px,var(--art-subtitle-border)0 -1px 1px,var(--art-subtitle-border)1px 1px 1px,var(--art-subtitle-border)-1px -1px 1px,var(--art-subtitle-border)1px -1px 1px,var(--art-subtitle-border)-1px 1px 1px;flex-direction:column;padding:0 5%;display:none;position:absolute}.art-video-player.art-subtitle-show .art-subtitle{display:flex}.art-video-player.art-control-show .art-subtitle{bottom:calc(var(--art-control-height) + var(--art-subtitle-bottom))}.art-danmuku{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;pointer-events:none;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:flex}.art-video-player .art-mask{z-index:50;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;inset:0}.art-video-player .art-mask .art-state{opacity:0;width:var(--art-state-size);height:var(--art-state-size);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;display:flex;transform:scale(2)}.art-video-player.art-mask-show .art-state{cursor:pointer;pointer-events:auto;opacity:var(--art-state-opacity);transform:scale(1)}.art-video-player.art-loading-show .art-state{display:none}.art-video-player .art-loading{z-index:70;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;opacity:0;pointer-events:none;width:100%;height:100%;padding:0 var(--art-padding);transition:all var(--art-transition-duration)ease;background-size:100% var(--art-bottom-height);background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:flex-end;display:flex;position:absolute;inset:0;overflow:hidden}.art-video-player .art-bottom .art-controls,.art-video-player .art-bottom .art-progress{transform:translateY(var(--art-bottom-offset));transition:transform var(--art-transition-duration)ease}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1}.art-video-player.art-control-show .art-bottom .art-controls,.art-video-player.art-hover .art-bottom .art-controls,.art-video-player.art-control-show .art-bottom .art-progress,.art-video-player.art-hover .art-bottom .art-progress{transform:translateY(0)}.art-bottom .art-progress{z-index:0;pointer-events:auto;padding-bottom:var(--art-bottom-gap);position:relative}.art-bottom .art-progress .art-control-progress{cursor:pointer;height:var(--art-progress-height);justify-content:center;align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner{width:100%;height:50%;transition:height var(--art-transition-duration)ease;background-color:var(--art-progress-color);align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-hover{z-index:0;background-color:var(--art-hover-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;background-color:var(--art-loaded-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;background-color:var(--art-theme);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{z-index:0;pointer-events:auto;width:100%;height:100%;transform:translateX(calc(var(--art-highlight-width)/-2));background-color:var(--art-highlight-color);position:absolute;inset:0 auto 0 0;width:var(--art-highlight-width)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{z-index:40;width:var(--art-indicator-size);height:var(--art-indicator-size);transform:scale(var(--art-indicator-scale));margin-left:calc(var(--art-indicator-size)/-2);transition:transform var(--art-transition-duration)ease;border-radius:50%;justify-content:center;align-items:center;display:flex;position:absolute;left:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{pointer-events:none;width:100%;height:100%}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:hover{transform:scale(1.2)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:active{transform:scale(1)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;border-radius:var(--art-border-radius);white-space:nowrap;background-color:var(--art-tip-background);padding:3px 5px;font-size:12px;line-height:1;display:none;position:absolute;top:-25px;left:0}.art-bottom .art-progress .art-control-progress:hover .art-control-progress-inner{height:100%}.art-bottom .art-progress .art-control-thumbnails{bottom:calc(var(--art-bottom-gap) + 10px);border-radius:var(--art-border-radius);pointer-events:none;background-color:var(--art-widget-background);display:none;position:absolute;left:0;box-shadow:0 1px 3px #0003,0 1px 2px -1px #0003}.art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{transform:scale(1)}.art-controls{z-index:10;pointer-events:auto;height:var(--art-control-height);justify-content:space-between;align-items:center;display:flex;position:relative}.art-controls .art-controls-left,.art-controls .art-controls-right{height:100%;display:flex}.art-controls .art-controls-center{flex:1;justify-content:center;align-items:center;height:100%;padding:0 10px;display:none}.art-controls .art-controls-right{justify-content:flex-end}.art-controls .art-control{cursor:pointer;white-space:nowrap;opacity:var(--art-control-opacity);min-height:var(--art-control-height);min-width:var(--art-control-height);transition:opacity var(--art-transition-duration)ease;flex-shrink:0;justify-content:center;align-items:center;display:flex}.art-controls .art-control .art-icon{height:var(--art-control-icon-size);width:var(--art-control-icon-size);transform:scale(var(--art-control-icon-scale));transition:transform var(--art-transition-duration)ease}.art-controls .art-control .art-icon:active{transform:scale(calc(var(--art-control-icon-scale)*.8))}.art-controls .art-control:hover{opacity:1}.art-control-volume{position:relative}.art-control-volume .art-volume-panel{text-align:center;cursor:default;opacity:0;pointer-events:none;left:0;right:0;bottom:var(--art-control-height);width:var(--art-control-height);height:var(--art-volume-height);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;padding:0 5px;font-size:12px;display:flex;position:absolute;transform:translateY(10px)}.art-control-volume .art-volume-panel .art-volume-inner{border-radius:var(--art-border-radius);background-color:var(--art-widget-background);flex-direction:column;align-items:center;gap:10px;width:100%;height:100%;padding:10px 0 12px;display:flex}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider{cursor:pointer;flex:1;justify-content:center;width:100%;display:flex;position:relative}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle{border-radius:var(--art-border-radius);background-color:#ffffff40;justify-content:center;width:2px;display:flex;position:relative;overflow:hidden}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle .art-volume-loaded{z-index:0;background-color:var(--art-theme);width:100%;height:100%;position:absolute;inset:0}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-indicator{width:var(--art-volume-handle-size);height:var(--art-volume-handle-size);margin-top:calc(var(--art-volume-handle-size)/-2);background-color:var(--art-theme);transition:transform var(--art-transition-duration)ease;border-radius:100%;flex-shrink:0;position:absolute;transform:scale(1)}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider:active .art-volume-indicator{transform:scale(.9)}.art-control-volume:hover .art-volume-panel{opacity:1;pointer-events:auto;transform:translateY(0)}.art-video-player .art-notice{z-index:80;width:100%;height:auto;padding:var(--art-padding);pointer-events:none;display:none;position:absolute;inset:0 0 auto}.art-video-player .art-notice .art-notice-inner{border-radius:var(--art-border-radius);background-color:var(--art-tip-background);padding:5px;line-height:1;display:inline-flex}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);min-width:var(--art-contextmenus-min-width);flex-direction:column;padding:5px 0;font-size:12px;display:none;position:absolute}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;border-bottom:1px solid #ffffff1a;padding:10px 15px;display:flex}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 8px}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:var(--art-theme)}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;border-radius:var(--art-border-radius);max-height:var(--art-settings-max-height);left:auto;right:var(--art-padding);bottom:var(--art-control-height);transition:all var(--art-transition-duration)ease;background-color:var(--art-widget-background);flex-direction:column;display:none;position:absolute;overflow:hidden auto}.art-video-player .art-settings .art-setting-panel{flex-direction:column;display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item{cursor:pointer;transition:background-color var(--art-transition-duration)ease;justify-content:space-between;align-items:center;padding:0 5px;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover{background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:var(--art-theme)}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{flex-shrink:0;justify-content:center;align-items:center;gap:5px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:var(--art-settings-icon-size);width:var(--art-settings-icon-size);justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{justify-content:center;align-items:center;gap:5px;font-size:12px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{justify-content:center;align-items:center;min-width:32px;height:24px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{appearance:none;background-color:#fff3;outline:none;width:80px;height:3px}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:flex}.art-video-player .art-info{left:var(--art-padding);top:var(--art-padding);z-index:100;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);padding:10px;font-size:12px;display:none;position:absolute}.art-video-player .art-info .art-info-panel{flex-direction:column;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item{align-items:center;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item .art-info-title{text-align:right;width:100px}.art-video-player .art-info .art-info-panel .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;user-select:all;width:250px;overflow:hidden}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio]{overflow:hidden}.art-video-player[data-aspect-ratio] .art-video{object-fit:fill;box-sizing:content-box}.art-fullscreen{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3}.art-fullscreen-web{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3;z-index:var(--art-fullscreen-web-index);width:100%;height:100%;position:fixed;inset:0}.art-mini-popup{z-index:9999;border-radius:var(--art-border-radius);cursor:move;user-select:none;background:#000;width:320px;height:180px;transition:opacity .2s;position:fixed;overflow:hidden;box-shadow:0 0 5px #00000080}.art-mini-popup svg{fill:#fff}.art-mini-popup .art-video{pointer-events:none}.art-mini-popup .art-mini-close{z-index:20;cursor:pointer;opacity:0;transition:opacity .2s;position:absolute;top:10px;right:10px}.art-mini-popup .art-mini-state{z-index:30;pointer-events:none;opacity:0;background-color:#00000040;justify-content:center;align-items:center;width:100%;height:100%;transition:opacity .2s;display:flex;position:absolute;inset:0}.art-mini-popup .art-mini-state .art-icon{opacity:.75;cursor:pointer;pointer-events:auto;transition:transform .2s;transform:scale(3)}.art-mini-popup .art-mini-state .art-icon:active{transform:scale(2.5)}.art-mini-popup.art-mini-droging{opacity:.9}.art-mini-popup:hover .art-mini-close,.art-mini-popup:hover .art-mini-state{opacity:1}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-lock{height:var(--art-lock-size);width:var(--art-lock-size);top:50%;left:var(--art-padding);background-color:var(--art-tip-background);border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;transform:translateY(-50%)}.art-video-player .art-layer-auto-playback{border-radius:var(--art-border-radius);left:var(--art-padding);bottom:calc(var(--art-control-height) + var(--art-bottom-gap) + 10px);background-color:var(--art-widget-background);align-items:center;gap:10px;padding:10px;line-height:1;display:none;position:absolute}.art-video-player .art-layer-auto-playback .art-auto-playback-close{cursor:pointer;justify-content:center;align-items:center;display:flex}.art-video-player .art-layer-auto-playback .art-auto-playback-close svg{width:15px;height:15px;fill:var(--art-theme)}.art-video-player .art-layer-auto-playback .art-auto-playback-jump{color:var(--art-theme);cursor:pointer}.art-video-player.art-lock .art-subtitle{bottom:var(--art-subtitle-bottom)!important}.art-video-player.art-mini-progress-bar .art-bottom,.art-video-player.art-lock .art-bottom{opacity:1;background-image:none;padding:0}.art-video-player.art-mini-progress-bar .art-bottom .art-controls,.art-video-player.art-lock .art-bottom .art-controls,.art-video-player.art-mini-progress-bar .art-bottom .art-progress,.art-video-player.art-lock .art-bottom .art-progress{transform:translateY(calc(var(--art-control-height) + var(--art-bottom-gap) + var(--art-progress-height)/4))}.art-video-player.art-mini-progress-bar .art-bottom .art-progress-indicator,.art-video-player.art-lock .art-bottom .art-progress-indicator{display:none!important}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-control-selector{justify-content:center;display:flex;position:relative}.art-control-selector .art-selector-list{text-align:center;border-radius:var(--art-border-radius);opacity:0;pointer-events:none;bottom:var(--art-control-height);max-height:var(--art-selector-max-height);background-color:var(--art-widget-background);transition:all var(--art-transition-duration)ease;flex-direction:column;align-items:center;display:flex;position:absolute;overflow:hidden auto;transform:translateY(10px)}.art-control-selector .art-selector-list .art-selector-item{flex-shrink:0;justify-content:center;align-items:center;width:100%;padding:10px 15px;line-height:1;display:flex}.art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-control-selector .art-selector-list .art-selector-item:hover,.art-control-selector .art-selector-list .art-selector-item.art-current{color:var(--art-theme)}.art-control-selector:hover .art-selector-list{opacity:1;pointer-events:auto;transform:translateY(0)}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}.art-video-player.art-mobile{--art-bottom-gap:10px;--art-control-height:38px;--art-control-icon-scale:1;--art-state-size:60px;--art-settings-max-height:180px;--art-selector-max-height:180px;--art-indicator-scale:1;--art-control-opacity:1}.art-video-player.art-mobile .art-controls-left{margin-left:calc(var(--art-padding)/-1)}.art-video-player.art-mobile .art-controls-right{margin-right:calc(var(--art-padding)/-1)}'},{}],bAWi2:[function(R,J,w,Q){J.exports=function(){function g(E){return(g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L})(E)}var p=Object.prototype.toString,D=function(E){if(E===void 0)return"undefined";if(E===null)return"null";var L=g(E);if(L==="boolean")return"boolean";if(L==="string")return"string";if(L==="number")return"number";if(L==="symbol")return"symbol";if(L==="function")return m(E)==="GeneratorFunction"?"generatorfunction":"function";if(Array.isArray?Array.isArray(E):E instanceof Array)return"array";if(E.constructor&&typeof E.constructor.isBuffer=="function"&&E.constructor.isBuffer(E))return"buffer";if(function(I){try{if(typeof I.length=="number"&&typeof I.callee=="function")return!0}catch(z){if(z.message.indexOf("callee")!==-1)return!0}return!1}(E))return"arguments";if(E instanceof Date||typeof E.toDateString=="function"&&typeof E.getDate=="function"&&typeof E.setDate=="function")return"date";if(E instanceof Error||typeof E.message=="string"&&E.constructor&&typeof E.constructor.stackTraceLimit=="number")return"error";if(E instanceof RegExp||typeof E.flags=="string"&&typeof E.ignoreCase=="boolean"&&typeof E.multiline=="boolean"&&typeof E.global=="boolean")return"regexp";switch(m(E)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(typeof E.throw=="function"&&typeof E.return=="function"&&typeof E.next=="function")return"generator";switch(L=p.call(E)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return L.slice(8,-1).toLowerCase().replace(/\s/g,"")};function m(E){return E.constructor?E.constructor.name:null}function y(E,L){var I=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return _(E,L,I),b(E,L,I),function(z,j,W){var oe=D(j),F=D(z);if(oe==="object"){if(F!=="object")throw Error("[Type Error]: '".concat(W.join("."),"' require 'object' type, but got '").concat(F,"'"));Object.keys(j).forEach(function(ee){var fe=z[ee],ae=j[ee],B=W.slice();B.push(ee),_(fe,ae,B),b(fe,ae,B),y(fe,ae,B)})}if(oe==="array"){if(F!=="array")throw Error("[Type Error]: '".concat(W.join("."),"' require 'array' type, but got '").concat(F,"'"));z.forEach(function(ee,fe){var ae=z[fe],B=j[fe]||j[0],x=W.slice();x.push(fe),_(ae,B,x),b(ae,B,x),y(ae,B,x)})}}(E,L,I),E}function _(E,L,I){if(D(L)==="string"){var z=D(E);if(L[0]==="?"&&(L=L.slice(1)+"|undefined"),!(-1<L.indexOf("|")?L.split("|").map(function(j){return j.toLowerCase().trim()}).filter(Boolean).some(function(j){return z===j}):L.toLowerCase().trim()===z))throw Error("[Type Error]: '".concat(I.join("."),"' require '").concat(L,"' type, but got '").concat(z,"'"))}}function b(E,L,I){if(D(L)==="function"){var z=L(E,D(E),I);if(z!==!0){var j=D(z);throw j==="string"?Error(z):j==="error"?z:Error("[Validator Error]: The scheme for '".concat(I.join("."),"' validator require return true, but got '").concat(z,"'"))}}}return y.kindOf=D,y}()},{}],"66mFZ":[function(R,J,w,Q){R("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(w),w.default=class{on(g,p,D){let m=this.e||(this.e={});return(m[g]||(m[g]=[])).push({fn:p,ctx:D}),this}once(g,p,D){let m=this;function y(..._){m.off(g,y),p.apply(D,_)}return y._=p,this.on(g,y,D)}emit(g,...p){let D=((this.e||(this.e={}))[g]||[]).slice();for(let m=0;m<D.length;m+=1)D[m].fn.apply(D[m].ctx,p);return this}off(g,p){let D=this.e||(this.e={}),m=D[g],y=[];if(m&&p)for(let _=0,b=m.length;_<b;_+=1)m[_].fn!==p&&m[_].fn._!==p&&y.push(m[_]);return y.length?D[g]=y:delete D[g],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"9pCYc":[function(R,J,w,Q){w.interopDefault=function(g){return g&&g.__esModule?g:{default:g}},w.defineInteropFlag=function(g){Object.defineProperty(g,"__esModule",{value:!0})},w.exportAll=function(g,p){return Object.keys(g).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(p,D)||Object.defineProperty(p,D,{enumerable:!0,get:function(){return g[D]}})}),p},w.export=function(g,p,D){Object.defineProperty(g,p,{enumerable:!0,get:D})}},{}],"71aH7":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./dom");g.exportAll(p,w);var D=R("./error");g.exportAll(D,w);var m=R("./subtitle");g.exportAll(m,w);var y=R("./file");g.exportAll(y,w);var _=R("./property");g.exportAll(_,w);var b=R("./time");g.exportAll(b,w);var E=R("./format");g.exportAll(E,w);var L=R("./compatibility");g.exportAll(L,w)},{"./dom":"bSNiV","./error":"hwmZz","./subtitle":"inzwq","./file":"6b7Ip","./property":"5NSdr","./time":"epmNy","./format":"gapRl","./compatibility":"6ZTr6","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],bSNiV:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"query",()=>D),g.export(w,"queryAll",()=>m),g.export(w,"addClass",()=>y),g.export(w,"removeClass",()=>_),g.export(w,"hasClass",()=>b),g.export(w,"append",()=>E),g.export(w,"remove",()=>L),g.export(w,"setStyle",()=>I),g.export(w,"setStyles",()=>z),g.export(w,"getStyle",()=>j),g.export(w,"sublings",()=>W),g.export(w,"inverseClass",()=>oe),g.export(w,"tooltip",()=>F),g.export(w,"isInViewport",()=>ee),g.export(w,"includeFromEvent",()=>fe),g.export(w,"replaceElement",()=>ae),g.export(w,"createElement",()=>B),g.export(w,"getIcon",()=>x),g.export(w,"setStyleText",()=>N),g.export(w,"supportsFlex",()=>Y),g.export(w,"getRect",()=>re),g.export(w,"loadImg",()=>K);var p=R("./compatibility");function D(k,de=document){return de.querySelector(k)}function m(k,de=document){return Array.from(de.querySelectorAll(k))}function y(k,de){return k.classList.add(de)}function _(k,de){return k.classList.remove(de)}function b(k,de){return k.classList.contains(de)}function E(k,de){return de instanceof Element?k.appendChild(de):k.insertAdjacentHTML("beforeend",String(de)),k.lastElementChild||k.lastChild}function L(k){return k.parentNode.removeChild(k)}function I(k,de,ie){return k.style[de]=ie,k}function z(k,de){for(let ie in de)I(k,ie,de[ie]);return k}function j(k,de,ie=!0){let ve=window.getComputedStyle(k,null).getPropertyValue(de);return ie?parseFloat(ve):ve}function W(k){return Array.from(k.parentElement.children).filter(de=>de!==k)}function oe(k,de){W(k).forEach(ie=>_(ie,de)),y(k,de)}function F(k,de,ie="top"){p.isMobile||(k.setAttribute("aria-label",de),y(k,"hint--rounded"),y(k,"hint--".concat(ie)))}function ee(k,de=0){let ie=k.getBoundingClientRect(),ve=window.innerHeight||document.documentElement.clientHeight,_e=window.innerWidth||document.documentElement.clientWidth,q=ie.top-de<=ve&&ie.top+ie.height+de>=0,H=ie.left-de<=_e+de&&ie.left+ie.width+de>=0;return q&&H}function fe(k,de){return k.composedPath&&k.composedPath().indexOf(de)>-1}function ae(k,de){return de.parentNode.replaceChild(k,de),k}function B(k){return document.createElement(k)}function x(k="",de=""){let ie=B("i");return y(ie,"art-icon"),y(ie,"art-icon-".concat(k)),E(ie,de),ie}function N(k,de){let ie=document.getElementById(k);ie||((ie=document.createElement("style")).id=k,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{document.head.appendChild(ie)}):(document.head||document.documentElement).appendChild(ie)),ie.textContent=de}function Y(){let k=document.createElement("div");return k.style.display="flex",k.style.display==="flex"}function re(k){return k.getBoundingClientRect()}function K(k,de){return new Promise((ie,ve)=>{let _e=new Image;_e.onload=function(){if(de&&de!==1){let q=document.createElement("canvas"),H=q.getContext("2d");q.width=_e.width*de,q.height=_e.height*de,H.drawImage(_e,0,0,q.width,q.height),q.toBlob(le=>{let be=URL.createObjectURL(le),Ie=new Image;Ie.onload=function(){ie(Ie)},Ie.onerror=function(){URL.revokeObjectURL(be),ve(Error("Image load failed: ".concat(k)))},Ie.src=be})}else ie(_e)},_e.onerror=function(){ve(Error("Image load failed: ".concat(k)))},_e.src=k})}},{"./compatibility":"6ZTr6","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"6ZTr6":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"userAgent",()=>p),g.export(w,"isSafari",()=>D),g.export(w,"isWechat",()=>m),g.export(w,"isIE",()=>y),g.export(w,"isAndroid",()=>_),g.export(w,"isIOS",()=>b),g.export(w,"isIOS13",()=>E),g.export(w,"isMobile",()=>L),g.export(w,"isBrowser",()=>I);let p=typeof navigator<"u"?navigator.userAgent:"",D=/^((?!chrome|android).)*safari/i.test(p),m=/MicroMessenger/i.test(p),y=/MSIE|Trident/i.test(p),_=/android/i.test(p),b=/iPad|iPhone|iPod/i.test(p)&&!window.MSStream,E=b||p.includes("Macintosh")&&navigator.maxTouchPoints>=1,L=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(p)||E,I=typeof window<"u"},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],hwmZz:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"ArtPlayerError",()=>p),g.export(w,"errorHandle",()=>D);class p extends Error{constructor(y,_){super(y),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,_||this.constructor),this.name="ArtPlayerError"}}function D(m,y){if(!m)throw new p(y);return m}},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],inzwq:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(y){return"WEBVTT \r\n\r\n".concat(y.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(_,b,E)=>{let L=E.slice(0,3);return E.length===1&&(L=E+"00"),E.length===2&&(L=E+"0"),"".concat(b,",").concat(L)}).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat("\r\n\r\n"))}function D(y){return URL.createObjectURL(new Blob([y],{type:"text/vtt"}))}function m(y){let _=RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function b(E=""){return E.split(/[:.]/).map((L,I,z)=>{if(I===z.length-1){if(L.length===1)return".".concat(L,"00");if(L.length===2)return".".concat(L,"0")}else if(L.length===1)return(I===0?"0":":0")+L;return I===0?L:I===z.length-1?".".concat(L):":".concat(L)}).join("")}return"WEBVTT\n\n"+y.split(/\r?\n/).map(E=>{let L=E.match(_);return L?{start:b(L[1].trim()),end:b(L[2].trim()),text:L[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,"\n").trim().split(/\r?\n/).map(I=>I.trim()).join("\n")}:null}).filter(E=>E).map((E,L)=>E?L+1+"\n"+"".concat(E.start," --> ").concat(E.end)+"\n"+"".concat(E.text):"").filter(E=>E.trim()).join("\n\n")}g.defineInteropFlag(w),g.export(w,"srtToVtt",()=>p),g.export(w,"vttToBlob",()=>D),g.export(w,"assToVtt",()=>m)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"6b7Ip":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D,m){let y=document.createElement("a");y.style.display="none",y.href=D,y.download=m,document.body.appendChild(y),y.click(),document.body.removeChild(y)}g.defineInteropFlag(w),g.export(w,"getExt",()=>function D(m){return m.includes("?")?D(m.split("?")[0]):m.includes("#")?D(m.split("#")[0]):m.trim().toLowerCase().split(".").pop()}),g.export(w,"download",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"5NSdr":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"def",()=>p),g.export(w,"has",()=>m),g.export(w,"get",()=>y),g.export(w,"mergeDeep",()=>function _(...b){let E=L=>L&&typeof L=="object"&&!Array.isArray(L);return b.reduce((L,I)=>(Object.keys(I).forEach(z=>{let j=L[z],W=I[z];Array.isArray(j)&&Array.isArray(W)?L[z]=j.concat(...W):E(j)&&E(W)?L[z]=_(j,W):L[z]=W}),L),{})});let p=Object.defineProperty,{hasOwnProperty:D}=Object.prototype;function m(_,b){return D.call(_,b)}function y(_,b){return Object.getOwnPropertyDescriptor(_,b)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],epmNy:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(y=0){return new Promise(_=>setTimeout(_,y))}function D(y,_){let b;return function(...E){clearTimeout(b),b=setTimeout(()=>(b=null,y.apply(this,E)),_)}}function m(y,_){let b=!1;return function(...E){b||(y.apply(this,E),b=!0,setTimeout(function(){b=!1},_))}}g.defineInteropFlag(w),g.export(w,"sleep",()=>p),g.export(w,"debounce",()=>D),g.export(w,"throttle",()=>m)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],gapRl:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(b,E,L){return Math.max(Math.min(b,Math.max(E,L)),Math.min(E,L))}function D(b){return b.charAt(0).toUpperCase()+b.slice(1)}function m(b){if(!b)return"00:00";let E=Math.floor(b/3600),L=Math.floor((b-3600*E)/60),I=Math.floor(b-3600*E-60*L);return(E>0?[E,L,I]:[L,I]).map(z=>z<10?"0".concat(z):String(z)).join(":")}function y(b){return b.replace(/[&<>'"]/g,E=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[E]||E)}function _(b){let E={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&quot;":'"'},L=RegExp("(".concat(Object.keys(E).join("|"),")"),"g");return b.replace(L,I=>E[I]||I)}g.defineInteropFlag(w),g.export(w,"clamp",()=>p),g.export(w,"capitalize",()=>D),g.export(w,"secondToTime",()=>m),g.export(w,"escape",()=>y),g.export(w,"unescape",()=>_)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],AKEiO:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"ComponentOption",()=>I);var p=R("../utils");let D="array",m="boolean",y="string",_="number",b="object",E="function";function L(z,j,W){return(0,p.errorHandle)(j===y||j===_||z instanceof Element,"".concat(W.join(".")," require '").concat(y,"' or 'Element' type"))}let I={html:L,disable:"?".concat(m),name:"?".concat(y),index:"?".concat(_),style:"?".concat(b),click:"?".concat(E),mounted:"?".concat(E),tooltip:"?".concat(y,"|").concat(_),width:"?".concat(_),selector:"?".concat(D),onSelect:"?".concat(E),switch:"?".concat(m),onSwitch:"?".concat(E),range:"?".concat(D),onRange:"?".concat(E),onChange:"?".concat(E)};w.default={id:y,container:L,url:y,poster:y,type:y,theme:y,lang:y,volume:_,isLive:m,muted:m,autoplay:m,autoSize:m,autoMini:m,loop:m,flip:m,playbackRate:m,aspectRatio:m,screenshot:m,setting:m,hotkey:m,pip:m,mutex:m,backdrop:m,fullscreen:m,fullscreenWeb:m,subtitleOffset:m,miniProgressBar:m,useSSR:m,playsInline:m,lock:m,gesture:m,fastForward:m,autoPlayback:m,autoOrientation:m,airplay:m,proxy:"?".concat(E),plugins:[E],layers:[I],contextmenu:[I],settings:[I],controls:[{...I,position:(z,j,W)=>{let oe=["top","left","right"];return(0,p.errorHandle)(oe.includes(z),"".concat(W.join(".")," only accept ").concat(oe.toString()," as parameters"))}}],quality:[{default:"?".concat(m),html:y,url:y}],highlight:[{time:_,text:y}],thumbnails:{url:y,number:_,column:_,width:_,height:_,scale:_},subtitle:{url:y,name:y,type:y,style:b,escape:m,encoding:y,onVttLoad:E},moreVideoAttr:b,i18n:b,icons:b,cssVar:b,customType:b}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],lyjeQ:[function(R,J,w,Q){R("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(w),w.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],X13Zf:[function(R,J,w,Q){R("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(w);var g=R("./utils");class p{constructor(m){this.art=m;let{option:y,constructor:_}=m;y.container instanceof Element?this.$container=y.container:(this.$container=(0,g.query)(y.container),(0,g.errorHandle)(this.$container,"No container element found by ".concat(y.container))),(0,g.errorHandle)((0,g.supportsFlex)(),"The current browser does not support flex layout");let b=this.$container.tagName.toLowerCase();(0,g.errorHandle)(b==="div","Unsupported container element type, only support 'div' but got '".concat(b,"'")),(0,g.errorHandle)(_.instances.every(E=>E.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=m.id,this.init()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"><track default kind="metadata" src=""></track></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">5.2.3</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span>x<span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-contextmenus"></div></div>'}query(m){return(0,g.query)(m,this.$container)}init(){let{option:m}=this.art;if(m.useSSR||(this.$container.innerHTML=p.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$track=this.query("track"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$contextmenu=this.query(".art-contextmenus"),m.proxy){let y=m.proxy.call(this.art,this.art);(0,g.errorHandle)(y instanceof HTMLVideoElement||y instanceof HTMLCanvasElement,"Function 'option.proxy' needs to return 'HTMLVideoElement' or 'HTMLCanvasElement'"),(0,g.replaceElement)(y,this.$video),y.className="art-video",this.$video=y}m.backdrop&&(0,g.addClass)(this.$player,"art-backdrop"),g.isMobile&&(0,g.addClass)(this.$player,"art-mobile")}destroy(m){this.$video.src="",m?this.$container.innerHTML="":(0,g.addClass)(this.$player,"art-destroy")}}w.default=p},{"./utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"3jKkj":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("../utils"),D=R("./zh-cn"),m=g.interopDefault(D);w.default=class{constructor(y){this.art=y,this.languages={"zh-cn":m.default},this.language={},this.update(y.option.i18n)}init(){let y=this.art.option.lang.toLowerCase();this.language=this.languages[y]||{}}get(y){return this.language[y]||y}update(y){this.languages=(0,p.mergeDeep)(this.languages,y),this.init()}}},{"../utils":"71aH7","./zh-cn":"5Y91w","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"5Y91w":[function(R,J,w,Q){R("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(w);let g={"Video Info":"统计信息",Close:"关闭","Video Load Failed":"加载失败",Volume:"音量",Play:"播放",Pause:"暂停",Rate:"速度",Mute:"静音","Video Flip":"画面翻转",Horizontal:"水平",Vertical:"垂直",Reconnect:"重新连接","Show Setting":"显示设置","Hide Setting":"隐藏设置",Screenshot:"截图","Play Speed":"播放速度","Aspect Ratio":"画面比例",Default:"默认",Normal:"正常",Open:"打开","Switch Video":"切换","Switch Subtitle":"切换字幕",Fullscreen:"全屏","Exit Fullscreen":"退出全屏","Web Fullscreen":"网页全屏","Exit Web Fullscreen":"退出网页全屏","Mini Player":"迷你播放器","PIP Mode":"开启画中画","Exit PIP Mode":"退出画中画","PIP Not Supported":"不支持画中画","Fullscreen Not Supported":"不支持全屏","Subtitle Offset":"字幕偏移","Last Seen":"上次看到","Jump Play":"跳转播放",AirPlay:"隔空播放","AirPlay Not Available":"隔空播放不可用"};w.default=g,typeof window<"u"&&(window["artplayer-i18n-zh-cn"]=g)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],a90nx:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./urlMix"),D=g.interopDefault(p),m=R("./attrMix"),y=g.interopDefault(m),_=R("./playMix"),b=g.interopDefault(_),E=R("./pauseMix"),L=g.interopDefault(E),I=R("./toggleMix"),z=g.interopDefault(I),j=R("./seekMix"),W=g.interopDefault(j),oe=R("./volumeMix"),F=g.interopDefault(oe),ee=R("./currentTimeMix"),fe=g.interopDefault(ee),ae=R("./durationMix"),B=g.interopDefault(ae),x=R("./switchMix"),N=g.interopDefault(x),Y=R("./playbackRateMix"),re=g.interopDefault(Y),K=R("./aspectRatioMix"),k=g.interopDefault(K),de=R("./screenshotMix"),ie=g.interopDefault(de),ve=R("./fullscreenMix"),_e=g.interopDefault(ve),q=R("./fullscreenWebMix"),H=g.interopDefault(q),le=R("./pipMix"),be=g.interopDefault(le),Ie=R("./loadedMix"),Oe=g.interopDefault(Ie),We=R("./playedMix"),et=g.interopDefault(We),Le=R("./playingMix"),Re=g.interopDefault(Le),He=R("./autoSizeMix"),Ue=g.interopDefault(He),Ke=R("./rectMix"),st=g.interopDefault(Ke),Ze=R("./flipMix"),xt=g.interopDefault(Ze),Xt=R("./miniMix"),ct=g.interopDefault(Xt),ri=R("./posterMix"),Xe=g.interopDefault(ri),Jt=R("./autoHeightMix"),Bt=g.interopDefault(Jt),_i=R("./cssVarMix"),Si=g.interopDefault(_i),Ht=R("./themeMix"),ui=g.interopDefault(Ht),Oi=R("./typeMix"),zi=g.interopDefault(Oi),Ai=R("./stateMix"),Pi=g.interopDefault(Ai),nr=R("./subtitleOffsetMix"),Yt=g.interopDefault(nr),sr=R("./airplayMix"),it=g.interopDefault(sr),or=R("./qualityMix"),lr=g.interopDefault(or),Xi=R("./thumbnailsMix"),lt=g.interopDefault(Xi),Ar=R("./optionInit"),dr=g.interopDefault(Ar),Tr=R("./eventInit"),Hi=g.interopDefault(Tr);w.default=class{constructor(ht){(0,D.default)(ht),(0,y.default)(ht),(0,b.default)(ht),(0,L.default)(ht),(0,z.default)(ht),(0,W.default)(ht),(0,F.default)(ht),(0,fe.default)(ht),(0,B.default)(ht),(0,N.default)(ht),(0,re.default)(ht),(0,k.default)(ht),(0,ie.default)(ht),(0,_e.default)(ht),(0,H.default)(ht),(0,be.default)(ht),(0,Oe.default)(ht),(0,et.default)(ht),(0,Re.default)(ht),(0,Ue.default)(ht),(0,st.default)(ht),(0,xt.default)(ht),(0,ct.default)(ht),(0,Xe.default)(ht),(0,Bt.default)(ht),(0,Si.default)(ht),(0,ui.default)(ht),(0,zi.default)(ht),(0,Pi.default)(ht),(0,Yt.default)(ht),(0,it.default)(ht),(0,lr.default)(ht),(0,lt.default)(ht),(0,Hi.default)(ht),(0,dr.default)(ht)}}},{"./urlMix":"kQoac","./attrMix":"deCma","./playMix":"fOJuP","./pauseMix":"fzHAy","./toggleMix":"cBHxQ","./seekMix":"koAPr","./volumeMix":"6eyuR","./currentTimeMix":"faaWv","./durationMix":"5y91K","./switchMix":"iceD8","./playbackRateMix":"keKwh","./aspectRatioMix":"jihET","./screenshotMix":"36kPY","./fullscreenMix":"2GYOJ","./fullscreenWebMix":"5aYAP","./pipMix":"7EnIB","./loadedMix":"3N9mP","./playedMix":"et96R","./playingMix":"9DzzM","./autoSizeMix":"i1LDY","./rectMix":"IqARI","./flipMix":"7E7Vs","./miniMix":"gpugx","./posterMix":"1SuFS","./autoHeightMix":"8x4te","./cssVarMix":"1CaTA","./themeMix":"2FqhO","./typeMix":"1fQQs","./stateMix":"iBOQW","./subtitleOffsetMix":"6vlBV","./airplayMix":"eftqT","./qualityMix":"5SdyX","./thumbnailsMix":"4HcqV","./optionInit":"fCWZK","./eventInit":"f8Lv3","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],kQoac:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{option:y,template:{$video:_}}=m;(0,p.def)(m,"url",{get:()=>_.src,async set(b){if(b){let E=m.url,L=y.type||(0,p.getExt)(b),I=y.customType[L];L&&I?(await(0,p.sleep)(),m.loading.show=!0,I.call(m,_,b,m)):(URL.revokeObjectURL(E),_.src=b),E!==m.url&&(m.option.url=b,m.isReady&&E&&m.once("video:canplay",()=>{m.emit("restart",b)}))}else await(0,p.sleep)(),m.loading.show=!0}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],deCma:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{template:{$video:y}}=m;(0,p.def)(m,"attr",{value(_,b){if(b===void 0)return y[_];y[_]=b}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],fOJuP:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{i18n:y,notice:_,option:b,constructor:{instances:E},template:{$video:L}}=m;(0,p.def)(m,"play",{value:async function(){let I=await L.play();if(_.show=y.get("Play"),m.emit("play"),b.mutex)for(let z=0;z<E.length;z++){let j=E[z];j!==m&&j.pause()}return I}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],fzHAy:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{template:{$video:y},i18n:_,notice:b}=m;(0,p.def)(m,"pause",{value(){let E=y.pause();return b.show=_.get("Pause"),m.emit("pause"),E}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],cBHxQ:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){(0,p.def)(m,"toggle",{value:()=>m.playing?m.pause():m.play()})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],koAPr:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{notice:y}=m;(0,p.def)(m,"seek",{set(_){m.currentTime=_,m.duration&&(y.show="".concat((0,p.secondToTime)(m.currentTime)," / ").concat((0,p.secondToTime)(m.duration))),m.emit("seek",m.currentTime)}}),(0,p.def)(m,"forward",{set(_){m.seek=m.currentTime+_}}),(0,p.def)(m,"backward",{set(_){m.seek=m.currentTime-_}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"6eyuR":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{template:{$video:y},i18n:_,notice:b,storage:E}=m;(0,p.def)(m,"volume",{get:()=>y.volume||0,set:L=>{y.volume=(0,p.clamp)(L,0,1),b.show="".concat(_.get("Volume"),": ").concat(parseInt(100*y.volume,10)),y.volume!==0&&E.set("volume",y.volume)}}),(0,p.def)(m,"muted",{get:()=>y.muted,set:L=>{y.muted=L,m.emit("muted",L)}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],faaWv:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{$video:y}=m.template;(0,p.def)(m,"currentTime",{get:()=>y.currentTime||0,set:_=>{Number.isNaN(_=parseFloat(_))||(y.currentTime=(0,p.clamp)(_,0,m.duration))}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"5y91K":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){(0,p.def)(m,"duration",{get:()=>{let{duration:y}=m.template.$video;return y===1/0?0:y||0}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],iceD8:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){function y(_,b){return new Promise((E,L)=>{if(_===m.url)return;let{playing:I,aspectRatio:z,playbackRate:j}=m;m.pause(),m.url=_,m.notice.show="",m.once("video:error",L),m.once("video:loadedmetadata",()=>{m.currentTime=b}),m.once("video:canplay",async()=>{m.playbackRate=j,m.aspectRatio=z,I&&await m.play(),m.notice.show="",E()})})}(0,p.def)(m,"switchQuality",{value:_=>y(_,m.currentTime)}),(0,p.def)(m,"switchUrl",{value:_=>y(_,0)}),(0,p.def)(m,"switch",{set:m.switchUrl})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],keKwh:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{template:{$video:y},i18n:_,notice:b}=m;(0,p.def)(m,"playbackRate",{get:()=>y.playbackRate,set(E){E?E!==y.playbackRate&&(y.playbackRate=E,b.show="".concat(_.get("Rate"),": ").concat(E===1?_.get("Normal"):"".concat(E,"x"))):m.playbackRate=1}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],jihET:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{i18n:y,notice:_,template:{$video:b,$player:E}}=m;(0,p.def)(m,"aspectRatio",{get:()=>E.dataset.aspectRatio||"default",set(L){if(L||(L="default"),L==="default")(0,p.setStyle)(b,"width",null),(0,p.setStyle)(b,"height",null),(0,p.setStyle)(b,"margin",null),delete E.dataset.aspectRatio;else{let I=L.split(":").map(Number),{clientWidth:z,clientHeight:j}=E,W=I[0]/I[1];z/j>W?((0,p.setStyle)(b,"width","".concat(W*j,"px")),(0,p.setStyle)(b,"height","100%"),(0,p.setStyle)(b,"margin","0 auto")):((0,p.setStyle)(b,"width","100%"),(0,p.setStyle)(b,"height","".concat(z/W,"px")),(0,p.setStyle)(b,"margin","auto 0")),E.dataset.aspectRatio=L}_.show="".concat(y.get("Aspect Ratio"),": ").concat(L==="default"?y.get("Default"):L),m.emit("aspectRatio",L)}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"36kPY":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{notice:y,template:{$video:_}}=m,b=(0,p.createElement)("canvas");(0,p.def)(m,"getDataURL",{value:()=>new Promise((E,L)=>{try{b.width=_.videoWidth,b.height=_.videoHeight,b.getContext("2d").drawImage(_,0,0),E(b.toDataURL("image/png"))}catch(I){y.show=I,L(I)}})}),(0,p.def)(m,"getBlobUrl",{value:()=>new Promise((E,L)=>{try{b.width=_.videoWidth,b.height=_.videoHeight,b.getContext("2d").drawImage(_,0,0),b.toBlob(I=>{E(URL.createObjectURL(I))})}catch(I){y.show=I,L(I)}})}),(0,p.def)(m,"screenshot",{value:async E=>{let L=await m.getDataURL(),I=E||"artplayer_".concat((0,p.secondToTime)(_.currentTime));return(0,p.download)(L,"".concat(I,".png")),m.emit("screenshot",L),L}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"2GYOJ":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>y);var p=R("../libs/screenfull"),D=g.interopDefault(p),m=R("../utils");function y(_){let{i18n:b,notice:E,template:{$video:L,$player:I}}=_,z=W=>{D.default.on("change",()=>{W.emit("fullscreen",D.default.isFullscreen),D.default.isFullscreen?(W.state="fullscreen",(0,m.addClass)(I,"art-fullscreen")):(0,m.removeClass)(I,"art-fullscreen"),W.emit("resize")}),D.default.on("error",oe=>{W.emit("fullscreenError",oe)}),(0,m.def)(W,"fullscreen",{get:()=>D.default.isFullscreen,async set(oe){oe?await D.default.request(I):await D.default.exit()}})},j=W=>{W.proxy(document,"webkitfullscreenchange",()=>{W.emit("fullscreen",W.fullscreen),W.emit("resize")}),(0,m.def)(W,"fullscreen",{get:()=>document.fullscreenElement===L,set(oe){oe?(W.state="fullscreen",L.webkitEnterFullscreen()):L.webkitExitFullscreen()}})};_.once("video:loadedmetadata",()=>{D.default.isEnabled?z(_):L.webkitSupportsFullscreen?j(_):(0,m.def)(_,"fullscreen",{get:()=>!1,set(){E.show=b.get("Fullscreen Not Supported")}}),(0,m.def)(_,"fullscreen",(0,m.get)(_,"fullscreen"))})}},{"../libs/screenfull":"8v40z","../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"8v40z":[function(R,J,w,Q){R("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(w);let g=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],p=(()=>{if(typeof document>"u")return!1;let y=g[0],_={};for(let b of g)if(b[1]in document){for(let[E,L]of b.entries())_[y[E]]=L;return _}return!1})(),D={change:p.fullscreenchange,error:p.fullscreenerror},m={request:(y=document.documentElement,_)=>new Promise((b,E)=>{let L=()=>{m.off("change",L),b()};m.on("change",L);let I=y[p.requestFullscreen](_);I instanceof Promise&&I.then(L).catch(E)}),exit:()=>new Promise((y,_)=>{if(!m.isFullscreen)return void y();let b=()=>{m.off("change",b),y()};m.on("change",b);let E=document[p.exitFullscreen]();E instanceof Promise&&E.then(b).catch(_)}),toggle:(y,_)=>m.isFullscreen?m.exit():m.request(y,_),onchange(y){m.on("change",y)},onerror(y){m.on("error",y)},on(y,_){let b=D[y];b&&document.addEventListener(b,_,!1)},off(y,_){let b=D[y];b&&document.removeEventListener(b,_,!1)},raw:p};Object.defineProperties(m,{isFullscreen:{get:()=>!!document[p.fullscreenElement]},element:{enumerable:!0,get:()=>document[p.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>!!document[p.fullscreenEnabled]}}),p||(m={isEnabled:!1}),w.default=m},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"5aYAP":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{constructor:y,template:{$container:_,$player:b}}=m,E="";(0,p.def)(m,"fullscreenWeb",{get:()=>(0,p.hasClass)(b,"art-fullscreen-web"),set(L){L?(E=b.style.cssText,y.FULLSCREEN_WEB_IN_BODY&&(0,p.append)(document.body,b),m.state="fullscreenWeb",(0,p.setStyle)(b,"width","100%"),(0,p.setStyle)(b,"height","100%"),(0,p.addClass)(b,"art-fullscreen-web"),m.emit("fullscreenWeb",!0)):(y.FULLSCREEN_WEB_IN_BODY&&(0,p.append)(_,b),E&&(b.style.cssText=E,E=""),(0,p.removeClass)(b,"art-fullscreen-web"),m.emit("fullscreenWeb",!1)),m.emit("resize")}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"7EnIB":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{i18n:y,notice:_,template:{$video:b}}=m;if(document.pictureInPictureEnabled){let{template:{$video:E},proxy:L,notice:I}=m;E.disablePictureInPicture=!1,(0,p.def)(m,"pip",{get:()=>document.pictureInPictureElement,set(z){z?(m.state="pip",E.requestPictureInPicture().catch(j=>{throw I.show=j,j})):document.exitPictureInPicture().catch(j=>{throw I.show=j,j})}}),L(E,"enterpictureinpicture",()=>{m.emit("pip",!0)}),L(E,"leavepictureinpicture",()=>{m.emit("pip",!1)})}else if(b.webkitSupportsPresentationMode){let{$video:E}=m.template;E.webkitSetPresentationMode("inline"),(0,p.def)(m,"pip",{get:()=>E.webkitPresentationMode==="picture-in-picture",set(L){L?(m.state="pip",E.webkitSetPresentationMode("picture-in-picture"),m.emit("pip",!0)):(E.webkitSetPresentationMode("inline"),m.emit("pip",!1))}})}else(0,p.def)(m,"pip",{get:()=>!1,set(){_.show=y.get("PIP Not Supported")}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"3N9mP":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{$video:y}=m.template;(0,p.def)(m,"loaded",{get:()=>m.loadedTime/y.duration}),(0,p.def)(m,"loadedTime",{get:()=>y.buffered.length?y.buffered.end(y.buffered.length-1):0})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],et96R:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){(0,p.def)(m,"played",{get:()=>m.currentTime/m.duration})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"9DzzM":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{$video:y}=m.template;(0,p.def)(m,"playing",{get:()=>typeof y.playing=="boolean"?y.playing:y.currentTime>0&&!y.paused&&!y.ended&&y.readyState>2})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],i1LDY:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{$container:y,$player:_,$video:b}=m.template;(0,p.def)(m,"autoSize",{value(){let{videoWidth:E,videoHeight:L}=b,{width:I,height:z}=(0,p.getRect)(y),j=E/L;I/z>j?((0,p.setStyle)(_,"width","".concat(z*j/I*100,"%")),(0,p.setStyle)(_,"height","100%")):((0,p.setStyle)(_,"width","100%"),(0,p.setStyle)(_,"height","".concat(I/j/z*100,"%"))),m.emit("autoSize",{width:m.width,height:m.height})}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],IqARI:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){(0,p.def)(m,"rect",{get:()=>(0,p.getRect)(m.template.$player)});let y=["bottom","height","left","right","top","width"];for(let _=0;_<y.length;_++){let b=y[_];(0,p.def)(m,b,{get:()=>m.rect[b]})}(0,p.def)(m,"x",{get:()=>m.left+window.pageXOffset}),(0,p.def)(m,"y",{get:()=>m.top+window.pageYOffset})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"7E7Vs":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{template:{$player:y},i18n:_,notice:b}=m;(0,p.def)(m,"flip",{get:()=>y.dataset.flip||"normal",set(E){E||(E="normal"),E==="normal"?delete y.dataset.flip:y.dataset.flip=E,b.show="".concat(_.get("Video Flip"),": ").concat(_.get((0,p.capitalize)(E))),m.emit("flip",E)}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],gpugx:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{icons:y,proxy:_,storage:b,template:{$player:E,$video:L}}=m,I=!1,z=0,j=0;function W(){let{$mini:ee}=m.template;ee&&((0,p.removeClass)(E,"art-mini"),(0,p.setStyle)(ee,"display","none"),E.prepend(L),m.emit("mini",!1))}function oe(ee,fe){m.playing?((0,p.setStyle)(ee,"display","none"),(0,p.setStyle)(fe,"display","flex")):((0,p.setStyle)(ee,"display","flex"),(0,p.setStyle)(fe,"display","none"))}function F(){let{$mini:ee}=m.template,fe=(0,p.getRect)(ee),ae=window.innerHeight-fe.height-50,B=window.innerWidth-fe.width-50;b.set("top",ae),b.set("left",B),(0,p.setStyle)(ee,"top","".concat(ae,"px")),(0,p.setStyle)(ee,"left","".concat(B,"px"))}(0,p.def)(m,"mini",{get:()=>(0,p.hasClass)(E,"art-mini"),set(ee){if(ee){m.state="mini",(0,p.addClass)(E,"art-mini");let fe=function(){let{$mini:x}=m.template;if(x)return(0,p.append)(x,L),(0,p.setStyle)(x,"display","flex");{let N=(0,p.createElement)("div");(0,p.addClass)(N,"art-mini-popup"),(0,p.append)(document.body,N),m.template.$mini=N,(0,p.append)(N,L);let Y=(0,p.append)(N,'<div class="art-mini-close"></div>');(0,p.append)(Y,y.close),_(Y,"click",W);let re=(0,p.append)(N,'<div class="art-mini-state"></div>'),K=(0,p.append)(re,y.play),k=(0,p.append)(re,y.pause);return _(K,"click",()=>m.play()),_(k,"click",()=>m.pause()),oe(K,k),m.on("video:playing",()=>oe(K,k)),m.on("video:pause",()=>oe(K,k)),m.on("video:timeupdate",()=>oe(K,k)),_(N,"mousedown",de=>{I=de.button===0,z=de.pageX,j=de.pageY}),m.on("document:mousemove",de=>{if(I){(0,p.addClass)(N,"art-mini-droging");let ie=de.pageX-z,ve=de.pageY-j;(0,p.setStyle)(N,"transform","translate(".concat(ie,"px, ").concat(ve,"px)"))}}),m.on("document:mouseup",()=>{if(I){I=!1,(0,p.removeClass)(N,"art-mini-droging");let de=(0,p.getRect)(N);b.set("left",de.left),b.set("top",de.top),(0,p.setStyle)(N,"left","".concat(de.left,"px")),(0,p.setStyle)(N,"top","".concat(de.top,"px")),(0,p.setStyle)(N,"transform",null)}}),N}}(),ae=b.get("top"),B=b.get("left");ae&&B?((0,p.setStyle)(fe,"top","".concat(ae,"px")),(0,p.setStyle)(fe,"left","".concat(B,"px")),(0,p.isInViewport)(fe)||F()):F(),m.emit("mini",!0)}else W()}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"1SuFS":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{template:{$poster:y}}=m;(0,p.def)(m,"poster",{get:()=>{try{return y.style.backgroundImage.match(/"(.*)"/)[1]}catch(_){return""}},set(_){(0,p.setStyle)(y,"backgroundImage","url(".concat(_,")"))}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"8x4te":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{template:{$container:y,$video:_}}=m;(0,p.def)(m,"autoHeight",{value(){let{clientWidth:b}=y,{videoHeight:E,videoWidth:L}=_,I=b/L*E;(0,p.setStyle)(y,"height",I+"px"),m.emit("autoHeight",I)}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"1CaTA":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{$player:y}=m.template;(0,p.def)(m,"cssVar",{value:(_,b)=>b?y.style.setProperty(_,b):getComputedStyle(y).getPropertyValue(_)})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"2FqhO":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){(0,p.def)(m,"theme",{get:()=>m.cssVar("--art-theme"),set(y){m.cssVar("--art-theme",y)}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"1fQQs":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){(0,p.def)(m,"type",{get:()=>m.option.type,set(y){m.option.type=y}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],iBOQW:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let y=["mini","pip","fullscreen","fullscreenWeb"];(0,p.def)(m,"state",{get:()=>y.find(_=>m[_])||"standard",set(_){for(let b=0;b<y.length;b++){let E=y[b];E!==_&&m[E]&&(m[E]=!1)}}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"6vlBV":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{notice:y,i18n:_,template:b}=m;(0,p.def)(m,"subtitleOffset",{get:()=>{var E;return((E=b.$track)==null?void 0:E.offset)||0},set(E){var z,j;let{cues:L}=m.subtitle;if(!b.$track||L.length===0)return;let I=(0,p.clamp)(E,-10,10);b.$track.offset=I;for(let W=0;W<L.length;W++){let oe=L[W];oe.originalStartTime=(z=oe.originalStartTime)!=null?z:oe.startTime,oe.originalEndTime=(j=oe.originalEndTime)!=null?j:oe.endTime,oe.startTime=(0,p.clamp)(oe.originalStartTime+I,0,m.duration),oe.endTime=(0,p.clamp)(oe.originalEndTime+I,0,m.duration)}m.subtitle.update(),y.show="".concat(_.get("Subtitle Offset"),": ").concat(E,"s"),m.emit("subtitleOffset",E)}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],eftqT:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{i18n:y,notice:_,proxy:b,template:{$video:E}}=m,L=!0;window.WebKitPlaybackTargetAvailabilityEvent&&E.webkitShowPlaybackTargetPicker?b(E,"webkitplaybacktargetavailabilitychanged",I=>{switch(I.availability){case"available":L=!0;break;case"not-available":L=!1}}):L=!1,(0,p.def)(m,"airplay",{value(){L?(E.webkitShowPlaybackTargetPicker(),m.emit("airplay")):_.show=y.get("AirPlay Not Available")}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"5SdyX":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){(0,p.def)(m,"quality",{set(y){let{controls:_,notice:b,i18n:E}=m,L=y.find(I=>I.default)||y[0];_.update({name:"quality",position:"right",index:10,style:{marginRight:"10px"},html:(L==null?void 0:L.html)||"",selector:y,onSelect:async I=>(await m.switchQuality(I.url),b.show="".concat(E.get("Switch Video"),": ").concat(I.html),I.html)})}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"4HcqV":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{events:y,option:_,template:{$progress:b,$video:E}}=m,L=null,I=null,z=!1,j=!1,W=!1;y.hover(b,()=>{W=!0},()=>{W=!1}),m.on("setBar",async(oe,F,ee)=>{var N;let fe=(N=m.controls)==null?void 0:N.thumbnails,{url:ae,scale:B}=_.thumbnails;if(!fe||!ae)return;let x=oe==="played"&&ee&&p.isMobile;if(oe==="hover"||x){if(z||(z=!0,I=await(0,p.loadImg)(ae,B),j=!0),!j||!W)return;let Y=b.clientWidth*F;(0,p.setStyle)(fe,"display","flex"),Y>0&&Y<b.clientWidth?function(re){var Ie;let K=(Ie=m.controls)==null?void 0:Ie.thumbnails;if(!K)return;let{number:k,column:de,width:ie,height:ve,scale:_e}=_.thumbnails,q=ie*_e||I.naturalWidth/de,H=ve*_e||q/(E.videoWidth/E.videoHeight),le=Math.floor(re/(b.clientWidth/k)),be=Math.ceil(le/de)-1;(0,p.setStyle)(K,"backgroundImage","url(".concat(I.src,")")),(0,p.setStyle)(K,"height","".concat(H,"px")),(0,p.setStyle)(K,"width","".concat(q,"px")),(0,p.setStyle)(K,"backgroundPosition","-".concat((le%de||de-1)*q,"px -").concat(be*H,"px")),re<=q/2?(0,p.setStyle)(K,"left",0):re>b.clientWidth-q/2?(0,p.setStyle)(K,"left","".concat(b.clientWidth-q,"px")):(0,p.setStyle)(K,"left","".concat(re-q/2,"px"))}(Y):p.isMobile||(0,p.setStyle)(fe,"display","none"),x&&(clearTimeout(L),L=setTimeout(()=>{(0,p.setStyle)(fe,"display","none")},500))}}),(0,p.def)(m,"thumbnails",{get:()=>m.option.thumbnails,set(oe){oe.url&&!m.option.isLive&&(m.option.thumbnails=oe,clearTimeout(L),L=null,I=null,z=!1,j=!1)}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],fCWZK:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{option:y,storage:_,template:{$video:b,$poster:E}}=m;for(let I in y.moreVideoAttr)m.attr(I,y.moreVideoAttr[I]);y.muted&&(m.muted=y.muted),y.volume&&(b.volume=(0,p.clamp)(y.volume,0,1));let L=_.get("volume");for(let I in typeof L=="number"&&(b.volume=(0,p.clamp)(L,0,1)),y.poster&&(0,p.setStyle)(E,"backgroundImage","url(".concat(y.poster,")")),y.autoplay&&(b.autoplay=y.autoplay),y.playsInline&&(b.playsInline=!0,b["webkit-playsinline"]=!0),y.theme&&(y.cssVar["--art-theme"]=y.theme),y.cssVar)m.cssVar(I,y.cssVar[I]);m.url=y.url}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],f8Lv3:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>y);var p=R("../config"),D=g.interopDefault(p),m=R("../utils");function y(_){let{i18n:b,notice:E,option:L,constructor:I,proxy:z,template:{$player:j,$video:W,$poster:oe}}=_,F=0;for(let ee=0;ee<D.default.events.length;ee++)z(W,D.default.events[ee],fe=>{_.emit("video:".concat(fe.type),fe)});_.on("video:canplay",()=>{F=0,_.loading.show=!1}),_.once("video:canplay",()=>{_.loading.show=!1,_.controls.show=!0,_.mask.show=!0,_.isReady=!0,_.emit("ready")}),_.on("video:ended",()=>{L.loop?(_.seek=0,_.play(),_.controls.show=!1,_.mask.show=!1):(_.controls.show=!0,_.mask.show=!0)}),_.on("video:error",async ee=>{F<I.RECONNECT_TIME_MAX?(await(0,m.sleep)(I.RECONNECT_SLEEP_TIME),F+=1,_.url=L.url,E.show="".concat(b.get("Reconnect"),": ").concat(F),_.emit("error",ee,F)):(_.mask.show=!0,_.loading.show=!1,_.controls.show=!0,(0,m.addClass)(j,"art-error"),await(0,m.sleep)(I.RECONNECT_SLEEP_TIME),E.show=b.get("Video Load Failed"))}),_.on("video:loadedmetadata",()=>{_.emit("resize"),m.isMobile&&(_.loading.show=!1,_.controls.show=!0,_.mask.show=!0)}),_.on("video:loadstart",()=>{_.loading.show=!0,_.mask.show=!1,_.controls.show=!0}),_.on("video:pause",()=>{_.controls.show=!0,_.mask.show=!0}),_.on("video:play",()=>{_.mask.show=!1,(0,m.setStyle)(oe,"display","none")}),_.on("video:playing",()=>{_.mask.show=!1}),_.on("video:progress",()=>{_.playing&&(_.loading.show=!1)}),_.on("video:seeked",()=>{_.loading.show=!1,_.mask.show=!0}),_.on("video:seeking",()=>{_.loading.show=!0,_.mask.show=!1}),_.on("video:timeupdate",()=>{_.mask.show=!1}),_.on("video:waiting",()=>{_.loading.show=!0,_.mask.show=!1})}},{"../config":"lyjeQ","../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"8Z0Uf":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("../utils/component"),D=g.interopDefault(p),m=R("./fullscreen"),y=g.interopDefault(m),_=R("./fullscreenWeb"),b=g.interopDefault(_),E=R("./pip"),L=g.interopDefault(E),I=R("./playAndPause"),z=g.interopDefault(I),j=R("./progress"),W=g.interopDefault(j),oe=R("./time"),F=g.interopDefault(oe),ee=R("./volume"),fe=g.interopDefault(ee),ae=R("./setting"),B=g.interopDefault(ae),x=R("./screenshot"),N=g.interopDefault(x),Y=R("./airplay"),re=g.interopDefault(Y),K=R("../utils");class k extends D.default{constructor(ie){super(ie),this.isHover=!1,this.name="control",this.timer=Date.now();let{constructor:ve}=ie,{$player:_e,$bottom:q}=this.art.template;ie.on("mousemove",()=>{K.isMobile||(this.show=!0)}),ie.on("click",()=>{K.isMobile?this.toggle():this.show=!0}),ie.on("document:mousemove",H=>{this.isHover=(0,K.includeFromEvent)(H,q)}),ie.on("video:timeupdate",()=>{!ie.setting.show&&!this.isHover&&!ie.isInput&&ie.playing&&this.show&&Date.now()-this.timer>=ve.CONTROL_HIDE_TIME&&(this.show=!1)}),ie.on("control",H=>{H?((0,K.removeClass)(_e,"art-hide-cursor"),(0,K.addClass)(_e,"art-hover"),this.timer=Date.now()):((0,K.addClass)(_e,"art-hide-cursor"),(0,K.removeClass)(_e,"art-hover"))}),this.init()}init(){let{option:ie}=this.art;ie.isLive||this.add((0,W.default)({name:"progress",position:"top",index:10})),this.add({name:"thumbnails",position:"top",index:20}),this.add((0,z.default)({name:"playAndPause",position:"left",index:10})),this.add((0,fe.default)({name:"volume",position:"left",index:20})),ie.isLive||this.add((0,F.default)({name:"time",position:"left",index:30})),ie.quality.length&&(0,K.sleep)().then(()=>{this.art.quality=ie.quality}),ie.screenshot&&!K.isMobile&&this.add((0,N.default)({name:"screenshot",position:"right",index:20})),ie.setting&&this.add((0,B.default)({name:"setting",position:"right",index:30})),ie.pip&&this.add((0,L.default)({name:"pip",position:"right",index:40})),ie.airplay&&window.WebKitPlaybackTargetAvailabilityEvent&&this.add((0,re.default)({name:"airplay",position:"right",index:50})),ie.fullscreenWeb&&this.add((0,b.default)({name:"fullscreenWeb",position:"right",index:60})),ie.fullscreen&&this.add((0,y.default)({name:"fullscreen",position:"right",index:70}));for(let ve=0;ve<ie.controls.length;ve++)this.add(ie.controls[ve])}add(ie){let ve=typeof ie=="function"?ie(this.art):ie,{$progress:_e,$controlsLeft:q,$controlsRight:H}=this.art.template;switch(ve.position){case"top":this.$parent=_e;break;case"left":this.$parent=q;break;case"right":this.$parent=H;break;default:(0,K.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(ve)}check(ie){ie.$control_value.innerHTML=ie.html;for(let ve=0;ve<ie.$control_option.length;ve++){let _e=ie.$control_option[ve];_e.default=_e===ie,_e.default&&(0,K.inverseClass)(_e.$control_item,"art-current")}}selector(ie,ve,_e){let{proxy:q}=this.art.events;(0,K.addClass)(ve,"art-control-selector");let H=(0,K.createElement)("div");(0,K.addClass)(H,"art-selector-value"),(0,K.append)(H,ie.html),ve.innerText="",(0,K.append)(ve,H);let le=(0,K.createElement)("div");(0,K.addClass)(le,"art-selector-list"),(0,K.append)(ve,le);for(let Ie=0;Ie<ie.selector.length;Ie++){let Oe=ie.selector[Ie],We=(0,K.createElement)("div");(0,K.addClass)(We,"art-selector-item"),Oe.default&&(0,K.addClass)(We,"art-current"),We.dataset.index=Ie,We.dataset.value=Oe.value,We.innerHTML=Oe.html,(0,K.append)(le,We),(0,K.def)(Oe,"$control_option",{get:()=>ie.selector}),(0,K.def)(Oe,"$control_item",{get:()=>We}),(0,K.def)(Oe,"$control_value",{get:()=>H})}let be=q(le,"click",async Ie=>{let Oe=Ie.composedPath()||[],We=ie.selector.find(et=>et.$control_item===Oe.find(Le=>et.$control_item===Le));this.check(We),ie.onSelect&&(H.innerHTML=await ie.onSelect.call(this.art,We,We.$control_item,Ie))});_e.push(be)}}w.default=k},{"../utils/component":"18nVI","./fullscreen":"c61Lj","./fullscreenWeb":"03jeB","./pip":"u8l8e","./playAndPause":"ebXtb","./progress":"bgoVP","./time":"ikc2j","./volume":"b8NFx","./setting":"03o9l","./screenshot":"4KCF5","./airplay":"4IS2d","../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"18nVI":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./dom"),D=R("./error"),m=R("option-validator"),y=g.interopDefault(m),_=R("../scheme");w.default=class{constructor(b){this.id=0,this.art=b,this.cache=new Map,this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.update=this.update.bind(this)}get show(){return(0,p.hasClass)(this.art.template.$player,"art-".concat(this.name,"-show"))}set show(b){let{$player:E}=this.art.template,L="art-".concat(this.name,"-show");b?(0,p.addClass)(E,L):(0,p.removeClass)(E,L),this.art.emit(this.name,b)}toggle(){this.show=!this.show}add(b){let E=typeof b=="function"?b(this.art):b;if(E.html=E.html||"",(0,y.default)(E,_.ComponentOption),!this.$parent||!this.name||E.disable)return;let L=E.name||"".concat(this.name).concat(this.id),I=this.cache.get(L);(0,D.errorHandle)(!I,"Can't add an existing [".concat(L,"] to the [").concat(this.name,"]")),this.id+=1;let z=(0,p.createElement)("div");(0,p.addClass)(z,"art-".concat(this.name)),(0,p.addClass)(z,"art-".concat(this.name,"-").concat(L));let j=Array.from(this.$parent.children);z.dataset.index=E.index||this.id;let W=j.find(F=>Number(F.dataset.index)>=Number(z.dataset.index));W?W.insertAdjacentElement("beforebegin",z):(0,p.append)(this.$parent,z),E.html&&(0,p.append)(z,E.html),E.style&&(0,p.setStyles)(z,E.style),E.tooltip&&(0,p.tooltip)(z,E.tooltip);let oe=[];if(E.click){let F=this.art.events.proxy(z,"click",ee=>{ee.preventDefault(),E.click.call(this.art,this,ee)});oe.push(F)}return E.selector&&["left","right"].includes(E.position)&&this.selector(E,z,oe),this[L]=z,this.cache.set(L,{$ref:z,events:oe,option:E}),E.mounted&&E.mounted.call(this.art,z),z}remove(b){let E=this.cache.get(b);(0,D.errorHandle)(E,"Can't find [".concat(b,"] from the [").concat(this.name,"]")),E.option.beforeUnmount&&E.option.beforeUnmount.call(this.art,E.$ref);for(let L=0;L<E.events.length;L++)this.art.events.remove(E.events[L]);this.cache.delete(b),delete this[b],(0,p.remove)(E.$ref)}update(b){let E=this.cache.get(b.name);return E&&(b=Object.assign(E.option,b),this.remove(b.name)),this.add(b)}}},{"./dom":"bSNiV","./error":"hwmZz","option-validator":"bAWi2","../scheme":"AKEiO","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],c61Lj:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,tooltip:y.i18n.get("Fullscreen"),mounted:_=>{let{proxy:b,icons:E,i18n:L}=y,I=(0,p.append)(_,E.fullscreenOn),z=(0,p.append)(_,E.fullscreenOff);(0,p.setStyle)(z,"display","none"),b(_,"click",()=>{y.fullscreen=!y.fullscreen}),y.on("fullscreen",j=>{j?((0,p.tooltip)(_,L.get("Exit Fullscreen")),(0,p.setStyle)(I,"display","none"),(0,p.setStyle)(z,"display","inline-flex")):((0,p.tooltip)(_,L.get("Fullscreen")),(0,p.setStyle)(I,"display","inline-flex"),(0,p.setStyle)(z,"display","none"))})}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"03jeB":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,tooltip:y.i18n.get("Web Fullscreen"),mounted:_=>{let{proxy:b,icons:E,i18n:L}=y,I=(0,p.append)(_,E.fullscreenWebOn),z=(0,p.append)(_,E.fullscreenWebOff);(0,p.setStyle)(z,"display","none"),b(_,"click",()=>{y.fullscreenWeb=!y.fullscreenWeb}),y.on("fullscreenWeb",j=>{j?((0,p.tooltip)(_,L.get("Exit Web Fullscreen")),(0,p.setStyle)(I,"display","none"),(0,p.setStyle)(z,"display","inline-flex")):((0,p.tooltip)(_,L.get("Web Fullscreen")),(0,p.setStyle)(I,"display","inline-flex"),(0,p.setStyle)(z,"display","none"))})}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],u8l8e:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,tooltip:y.i18n.get("PIP Mode"),mounted:_=>{let{proxy:b,icons:E,i18n:L}=y;(0,p.append)(_,E.pip),b(_,"click",()=>{y.pip=!y.pip}),y.on("pip",I=>{(0,p.tooltip)(_,L.get(I?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],ebXtb:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,mounted:_=>{let{proxy:b,icons:E,i18n:L}=y,I=(0,p.append)(_,E.play),z=(0,p.append)(_,E.pause);function j(){(0,p.setStyle)(I,"display","flex"),(0,p.setStyle)(z,"display","none")}function W(){(0,p.setStyle)(I,"display","none"),(0,p.setStyle)(z,"display","flex")}(0,p.tooltip)(I,L.get("Play")),(0,p.tooltip)(z,L.get("Pause")),b(I,"click",()=>{y.play()}),b(z,"click",()=>{y.pause()}),y.playing?W():j(),y.on("video:playing",()=>{W()}),y.on("video:pause",()=>{j()})}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],bgoVP:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"getPosFromEvent",()=>D),g.export(w,"setCurrentTime",()=>m),g.export(w,"default",()=>y);var p=R("../utils");function D(_,b){let{$progress:E}=_.template,{left:L}=(0,p.getRect)(E),I=p.isMobile?b.touches[0].clientX:b.clientX,z=(0,p.clamp)(I-L,0,E.clientWidth),j=z/E.clientWidth*_.duration,W=(0,p.secondToTime)(j),oe=(0,p.clamp)(z/E.clientWidth,0,1);return{second:j,time:W,width:z,percentage:oe}}function m(_,b){if(_.isRotate){let E=b.touches[0].clientY/_.height,L=E*_.duration;_.emit("setBar","played",E,b),_.seek=L}else{let{second:E,percentage:L}=D(_,b);_.emit("setBar","played",L,b),_.seek=E}}function y(_){return b=>{let{icons:E,option:L,proxy:I}=b;return{..._,html:'<div class="art-control-progress-inner"><div class="art-progress-hover"></div><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:z=>{let j=null,W=!1,oe=(0,p.query)(".art-progress-hover",z),F=(0,p.query)(".art-progress-loaded",z),ee=(0,p.query)(".art-progress-played",z),fe=(0,p.query)(".art-progress-highlight",z),ae=(0,p.query)(".art-progress-indicator",z),B=(0,p.query)(".art-progress-tip",z);function x(N,Y){let{width:re,time:K}=Y||D(b,N);B.innerText=K;let k=B.clientWidth;re<=k/2?(0,p.setStyle)(B,"left",0):re>z.clientWidth-k/2?(0,p.setStyle)(B,"left","".concat(z.clientWidth-k,"px")):(0,p.setStyle)(B,"left","".concat(re-k/2,"px"))}E.indicator?(0,p.append)(ae,E.indicator):(0,p.setStyle)(ae,"backgroundColor","var(--art-theme)"),b.on("setBar",function(N,Y,re){let K=N==="played"&&re&&p.isMobile;N==="loaded"&&(0,p.setStyle)(F,"width","".concat(100*Y,"%")),N==="hover"&&(0,p.setStyle)(oe,"width","".concat(100*Y,"%")),N==="played"&&((0,p.setStyle)(ee,"width","".concat(100*Y,"%")),(0,p.setStyle)(ae,"left","".concat(100*Y,"%"))),K&&((0,p.setStyle)(B,"display","flex"),x(re,{width:z.clientWidth*Y,time:(0,p.secondToTime)(Y*b.duration)}),clearTimeout(j),j=setTimeout(()=>{(0,p.setStyle)(B,"display","none")},500))}),b.on("video:loadedmetadata",function(){fe.innerText="";for(let N=0;N<L.highlight.length;N++){let Y=L.highlight[N],re=(0,p.clamp)(Y.time,0,b.duration)/b.duration*100,K='<span data-text="'.concat(Y.text,'" data-time="').concat(Y.time,'" style="left: ').concat(re,'%"></span>');(0,p.append)(fe,K)}}),b.on("video:progress",()=>{b.emit("setBar","loaded",b.loaded)}),b.constructor.USE_RAF?b.on("raf",()=>{b.emit("setBar","played",b.played)}):b.on("video:timeupdate",()=>{b.emit("setBar","played",b.played)}),b.on("video:ended",()=>{b.emit("setBar","played",1)}),b.emit("setBar","loaded",b.loaded||0),p.isMobile||(I(z,"click",N=>{N.target!==ae&&m(b,N)}),I(z,"mousemove",N=>{let{percentage:Y}=D(b,N);if(b.emit("setBar","hover",Y,N),(0,p.setStyle)(B,"display","flex"),(0,p.includeFromEvent)(N,fe)){let{width:re}=D(b,N),{text:K}=N.target.dataset;B.innerText=K;let k=B.clientWidth;re<=k/2?(0,p.setStyle)(B,"left",0):re>z.clientWidth-k/2?(0,p.setStyle)(B,"left","".concat(z.clientWidth-k,"px")):(0,p.setStyle)(B,"left","".concat(re-k/2,"px"))}else x(N)}),I(z,"mouseleave",N=>{(0,p.setStyle)(B,"display","none"),b.emit("setBar","hover",0,N)}),I(z,"mousedown",N=>{W=N.button===0}),b.on("document:mousemove",N=>{if(W){let{second:Y,percentage:re}=D(b,N);b.emit("setBar","played",re,N),b.seek=Y}}),b.on("document:mouseup",()=>{W&&(W=!1)}))}}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],ikc2j:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,style:p.isMobile?{fontSize:"12px",padding:"0 5px"}:{cursor:"auto",padding:"0 10px"},mounted:_=>{function b(){let L="".concat((0,p.secondToTime)(y.currentTime)," / ").concat((0,p.secondToTime)(y.duration));L!==_.innerText&&(_.innerText=L)}b();let E=["video:loadedmetadata","video:timeupdate","video:progress"];for(let L=0;L<E.length;L++)y.on(E[L],b)}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],b8NFx:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,mounted:_=>{let{proxy:b,icons:E}=y,L=(0,p.append)(_,E.volume),I=(0,p.append)(_,E.volumeClose),z=(0,p.append)(_,'<div class="art-volume-panel"></div>'),j=(0,p.append)(z,'<div class="art-volume-inner"></div>'),W=(0,p.append)(j,'<div class="art-volume-val"></div>'),oe=(0,p.append)(j,'<div class="art-volume-slider"></div>'),F=(0,p.append)(oe,'<div class="art-volume-handle"></div>'),ee=(0,p.append)(F,'<div class="art-volume-loaded"></div>'),fe=(0,p.append)(oe,'<div class="art-volume-indicator"></div>');function ae(x){let{top:N,height:Y}=(0,p.getRect)(oe);return 1-(x.clientY-N)/Y}function B(){if(y.muted||y.volume===0)(0,p.setStyle)(L,"display","none"),(0,p.setStyle)(I,"display","flex"),(0,p.setStyle)(fe,"top","100%"),(0,p.setStyle)(ee,"top","100%"),W.innerText=0;else{let x=100*y.volume;(0,p.setStyle)(L,"display","flex"),(0,p.setStyle)(I,"display","none"),(0,p.setStyle)(fe,"top","".concat(100-x,"%")),(0,p.setStyle)(ee,"top","".concat(100-x,"%")),W.innerText=Math.floor(x)}}if(B(),y.on("video:volumechange",B),b(L,"click",()=>{y.muted=!0}),b(I,"click",()=>{y.muted=!1}),p.isMobile)(0,p.setStyle)(z,"display","none");else{let x=!1;b(oe,"mousedown",N=>{x=N.button===0,y.volume=ae(N)}),y.on("document:mousemove",N=>{x&&(y.muted=!1,y.volume=ae(N))}),y.on("document:mouseup",()=>{x&&(x=!1)})}}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"03o9l":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,tooltip:y.i18n.get("Show Setting"),mounted:_=>{let{proxy:b,icons:E,i18n:L}=y;(0,p.append)(_,E.setting),b(_,"click",()=>{y.setting.toggle(),y.setting.resize()}),y.on("setting",I=>{(0,p.tooltip)(_,L.get(I?"Hide Setting":"Show Setting"))})}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"4KCF5":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,tooltip:y.i18n.get("Screenshot"),mounted:_=>{let{proxy:b,icons:E}=y;(0,p.append)(_,E.screenshot),b(_,"click",()=>{y.screenshot()})}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"4IS2d":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>({...m,tooltip:y.i18n.get("AirPlay"),mounted:_=>{let{proxy:b,icons:E}=y;(0,p.append)(_,E.airplay),b(_,"click",()=>y.airplay())}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"2KYsr":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("../utils"),D=R("../utils/component"),m=g.interopDefault(D),y=R("./playbackRate"),_=g.interopDefault(y),b=R("./aspectRatio"),E=g.interopDefault(b),L=R("./flip"),I=g.interopDefault(L),z=R("./info"),j=g.interopDefault(z),W=R("./version"),oe=g.interopDefault(W),F=R("./close"),ee=g.interopDefault(F);class fe extends m.default{constructor(B){super(B),this.name="contextmenu",this.$parent=B.template.$contextmenu,p.isMobile||this.init()}init(){let{option:B,proxy:x,template:{$player:N,$contextmenu:Y}}=this.art;B.playbackRate&&this.add((0,_.default)({name:"playbackRate",index:10})),B.aspectRatio&&this.add((0,E.default)({name:"aspectRatio",index:20})),B.flip&&this.add((0,I.default)({name:"flip",index:30})),this.add((0,j.default)({name:"info",index:40})),this.add((0,oe.default)({name:"version",index:50})),this.add((0,ee.default)({name:"close",index:60}));for(let re=0;re<B.contextmenu.length;re++)this.add(B.contextmenu[re]);x(N,"contextmenu",re=>{if(!this.art.constructor.CONTEXTMENU)return;re.preventDefault(),this.show=!0;let K=re.clientX,k=re.clientY,{height:de,width:ie,left:ve,top:_e}=(0,p.getRect)(N),{height:q,width:H}=(0,p.getRect)(Y),le=K-ve,be=k-_e;K+H>ve+ie&&(le=ie-H),k+q>_e+de&&(be=de-q),(0,p.setStyles)(Y,{top:"".concat(be,"px"),left:"".concat(le,"px")})}),x(N,"click",re=>{(0,p.includeFromEvent)(re,Y)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}w.default=fe},{"../utils":"71aH7","../utils/component":"18nVI","./playbackRate":"69eLi","./aspectRatio":"lUefg","./flip":"kysiM","./info":"gqIgJ","./version":"kRU7C","./close":"jQ8Pm","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"69eLi":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>{let{i18n:_,constructor:{PLAYBACK_RATE:b}}=y,E=b.map(L=>'<span data-value="'.concat(L,'">').concat(L===1?_.get("Normal"):L.toFixed(1),"</span>")).join("");return{...m,html:"".concat(_.get("Play Speed"),": ").concat(E),click:(L,I)=>{let{value:z}=I.target.dataset;z&&(y.playbackRate=Number(z),L.show=!1)},mounted:L=>{let I=(0,p.query)('[data-value="1"]',L);I&&(0,p.inverseClass)(I,"art-current"),y.on("video:ratechange",()=>{let z=(0,p.queryAll)("span",L).find(j=>Number(j.dataset.value)===y.playbackRate);z&&(0,p.inverseClass)(z,"art-current")})}}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],lUefg:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>{let{i18n:_,constructor:{ASPECT_RATIO:b}}=y,E=b.map(L=>'<span data-value="'.concat(L,'">').concat(L==="default"?_.get("Default"):L,"</span>")).join("");return{...m,html:"".concat(_.get("Aspect Ratio"),": ").concat(E),click:(L,I)=>{let{value:z}=I.target.dataset;z&&(y.aspectRatio=z,L.show=!1)},mounted:L=>{let I=(0,p.query)('[data-value="default"]',L);I&&(0,p.inverseClass)(I,"art-current"),y.on("aspectRatio",z=>{let j=(0,p.queryAll)("span",L).find(W=>W.dataset.value===z);j&&(0,p.inverseClass)(j,"art-current")})}}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],kysiM:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return y=>{let{i18n:_,constructor:{FLIP:b}}=y,E=b.map(L=>'<span data-value="'.concat(L,'">').concat(_.get((0,p.capitalize)(L)),"</span>")).join("");return{...m,html:"".concat(_.get("Video Flip"),": ").concat(E),click:(L,I)=>{let{value:z}=I.target.dataset;z&&(y.flip=z.toLowerCase(),L.show=!1)},mounted:L=>{let I=(0,p.query)('[data-value="normal"]',L);I&&(0,p.inverseClass)(I,"art-current"),y.on("flip",z=>{let j=(0,p.queryAll)("span",L).find(W=>W.dataset.value===z);j&&(0,p.inverseClass)(j,"art-current")})}}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],gqIgJ:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D){return m=>({...D,html:m.i18n.get("Video Info"),click:y=>{m.info.show=!0,y.show=!1}})}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],kRU7C:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D){return{...D,html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 5.2.3</a>'}}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],jQ8Pm:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D){return m=>({...D,html:m.i18n.get("Close"),click:y=>{y.show=!1}})}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"02ajl":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./utils"),D=R("./utils/component"),m=g.interopDefault(D);class y extends m.default{constructor(b){super(b),this.name="info",p.isMobile||this.init()}init(){let{proxy:b,constructor:E,template:{$infoPanel:L,$infoClose:I,$video:z}}=this.art;b(I,"click",()=>{this.show=!1});let j=null,W=(0,p.queryAll)("[data-video]",L)||[];this.art.on("destroy",()=>clearTimeout(j)),function oe(){for(let F=0;F<W.length;F++){let ee=W[F],fe=z[ee.dataset.video],ae=typeof fe=="number"?fe.toFixed(2):fe;ee.innerText!==ae&&(ee.innerText=ae)}j=setTimeout(oe,E.INFO_LOOP_TIME)}()}}w.default=y},{"./utils":"71aH7","./utils/component":"18nVI","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],eSWto:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./utils"),D=R("./utils/component"),m=g.interopDefault(D),y=R("option-validator"),_=g.interopDefault(y),b=R("./scheme"),E=g.interopDefault(b);class L extends m.default{constructor(z){super(z),this.name="subtitle",this.option=null,this.destroyEvent=()=>null,this.init(z.option.subtitle);let j=!1;z.on("video:timeupdate",()=>{if(!this.url)return;let W=this.art.template.$video.webkitDisplayingFullscreen;typeof W=="boolean"&&W!==j&&(j=W,this.createTrack(W?"subtitles":"metadata",this.url))})}get url(){return this.art.template.$track.src}set url(z){this.switch(z)}get textTrack(){var z,j;return(j=(z=this.art.template.$video)==null?void 0:z.textTracks)==null?void 0:j[0]}get activeCues(){return this.textTrack?Array.from(this.textTrack.activeCues):[]}get cues(){return this.textTrack?Array.from(this.textTrack.cues):[]}style(z,j){let{$subtitle:W}=this.art.template;return typeof z=="object"?(0,p.setStyles)(W,z):(0,p.setStyle)(W,z,j)}update(){let{option:{subtitle:z},template:{$subtitle:j}}=this.art;j.innerHTML="",this.activeCues.length&&(this.art.emit("subtitleBeforeUpdate",this.activeCues),j.innerHTML=this.activeCues.map((W,oe)=>W.text.split(/\r?\n/).filter(F=>F.trim()).map(F=>'<div class="art-subtitle-line" data-group="'.concat(oe,'">').concat(z.escape?(0,p.escape)(F):F,"</div>")).join("")).join(""),this.art.emit("subtitleAfterUpdate",this.activeCues))}async switch(z,j={}){let{i18n:W,notice:oe,option:F}=this.art,ee={...F.subtitle,...j,url:z},fe=await this.init(ee);return j.name&&(oe.show="".concat(W.get("Switch Subtitle"),": ").concat(j.name)),fe}createTrack(z,j){let{template:W,proxy:oe,option:F}=this.art,{$video:ee,$track:fe}=W,ae=(0,p.createElement)("track");ae.default=!0,ae.kind=z,ae.src=j,ae.label=F.subtitle.name||"Artplayer",ae.track.mode="hidden",ae.onload=()=>{this.art.emit("subtitleLoad",this.cues,this.option)},this.art.events.remove(this.destroyEvent),fe.onload=null,(0,p.remove)(fe),(0,p.append)(ee,ae),W.$track=ae,this.destroyEvent=oe(this.textTrack,"cuechange",()=>this.update())}async init(z){let{notice:j,template:{$subtitle:W}}=this.art;return this.textTrack?((0,_.default)(z,E.default.subtitle),z.url?(this.option=z,this.style(z.style),fetch(z.url).then(oe=>oe.arrayBuffer()).then(oe=>{let F=new TextDecoder(z.encoding).decode(oe);switch(z.type||(0,p.getExt)(z.url)){case"srt":{let ee=(0,p.srtToVtt)(F),fe=z.onVttLoad(ee);return(0,p.vttToBlob)(fe)}case"ass":{let ee=(0,p.assToVtt)(F),fe=z.onVttLoad(ee);return(0,p.vttToBlob)(fe)}case"vtt":{let ee=z.onVttLoad(F);return(0,p.vttToBlob)(ee)}default:return z.url}}).then(oe=>(W.innerHTML="",this.url===oe||(URL.revokeObjectURL(this.url),this.createTrack("metadata",oe)),oe)).catch(oe=>{throw W.innerHTML="",j.show=oe,oe})):void 0):null}}w.default=L},{"./utils":"71aH7","./utils/component":"18nVI","option-validator":"bAWi2","./scheme":"AKEiO","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],jo4S1:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./clickInit"),D=g.interopDefault(p),m=R("./hoverInit"),y=g.interopDefault(m),_=R("./moveInit"),b=g.interopDefault(_),E=R("./resizeInit"),L=g.interopDefault(E),I=R("./gestureInit"),z=g.interopDefault(I),j=R("./viewInit"),W=g.interopDefault(j),oe=R("./documentInit"),F=g.interopDefault(oe),ee=R("./updateInit"),fe=g.interopDefault(ee),ae=R("./restoreInit"),B=g.interopDefault(ae);w.default=class{constructor(x){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),(0,D.default)(x,this),(0,y.default)(x,this),(0,b.default)(x,this),(0,L.default)(x,this),(0,z.default)(x,this),(0,W.default)(x,this),(0,F.default)(x,this),(0,fe.default)(x,this),(0,B.default)(x,this)}proxy(x,N,Y,re={}){if(Array.isArray(N))return N.map(k=>this.proxy(x,k,Y,re));x.addEventListener(N,Y,re);let K=()=>x.removeEventListener(N,Y,re);return this.destroyEvents.push(K),K}hover(x,N,Y){N&&this.proxy(x,"mouseenter",N),Y&&this.proxy(x,"mouseleave",Y)}remove(x){let N=this.destroyEvents.indexOf(x);N>-1&&(x(),this.destroyEvents.splice(N,1))}destroy(){for(let x=0;x<this.destroyEvents.length;x++)this.destroyEvents[x]()}}},{"./clickInit":"6UrCm","./hoverInit":"4jWHi","./moveInit":"eqaUm","./resizeInit":"eDXPO","./gestureInit":"95GtS","./viewInit":"InUBx","./documentInit":"hoLfM","./updateInit":"cl8m3","./restoreInit":"bK8As","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"6UrCm":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m,y){let{constructor:_,template:{$player:b,$video:E}}=m;y.proxy(document,["click","contextmenu"],I=>{(0,p.includeFromEvent)(I,b)?(m.isInput=I.target.tagName==="INPUT",m.isFocus=!0,m.emit("focus",I)):(m.isInput=!1,m.isFocus=!1,m.emit("blur",I))});let L=[];y.proxy(E,"click",I=>{let z=Date.now();L.push(z);let{MOBILE_CLICK_PLAY:j,DBCLICK_TIME:W,MOBILE_DBCLICK_PLAY:oe,DBCLICK_FULLSCREEN:F}=_,ee=L.filter(fe=>z-fe<=W);switch(ee.length){case 1:m.emit("click",I),p.isMobile?!m.isLock&&j&&m.toggle():m.toggle(),L=ee;break;case 2:m.emit("dblclick",I),p.isMobile?!m.isLock&&oe&&m.toggle():F&&(m.fullscreen=!m.fullscreen),L=[];break;default:L=[]}})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"4jWHi":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m,y){let{$player:_}=m.template;y.hover(_,b=>{(0,p.addClass)(_,"art-hover"),m.emit("hover",!0,b)},b=>{(0,p.removeClass)(_,"art-hover"),m.emit("hover",!1,b)})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],eqaUm:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D,m){let{$player:y}=D.template;m.proxy(y,"mousemove",_=>{D.emit("mousemove",_)})}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],eDXPO:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m,y){let{option:_,constructor:b}=m;m.on("resize",()=>{let{aspectRatio:L,notice:I}=m;m.state==="standard"&&_.autoSize&&m.autoSize(),m.aspectRatio=L,I.show=""});let E=(0,p.debounce)(()=>m.emit("resize"),b.RESIZE_TIME);y.proxy(window,["orientationchange","resize"],()=>E()),screen&&screen.orientation&&screen.orientation.onchange&&y.proxy(screen.orientation,"change",()=>E())}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"95GtS":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>m);var p=R("../utils"),D=R("../control/progress");function m(y,_){if(p.isMobile&&!y.option.isLive){let{$video:b,$progress:E}=y.template,L=null,I=!1,z=0,j=0,W=0,oe=ee=>{if(ee.touches.length===1&&!y.isLock){L===E&&(0,D.setCurrentTime)(y,ee),I=!0;let{pageX:fe,pageY:ae}=ee.touches[0];z=fe,j=ae,W=y.currentTime}},F=ee=>{if(ee.touches.length===1&&I&&y.duration){let{pageX:fe,pageY:ae}=ee.touches[0],B=function(Y,re,K,k){var de=re-k,ie=K-Y,ve=0;if(2>Math.abs(ie)&&2>Math.abs(de))return ve;var _e=180*Math.atan2(de,ie)/Math.PI;return _e>=-45&&_e<45?ve=4:_e>=45&&_e<135?ve=1:_e>=-135&&_e<-45?ve=2:(_e>=135&&_e<=180||_e>=-180&&_e<-135)&&(ve=3),ve}(z,j,fe,ae),x=[3,4].includes(B),N=[1,2].includes(B);if(x&&!y.isRotate||N&&y.isRotate){let Y=(0,p.clamp)((fe-z)/y.width,-1,1),re=(0,p.clamp)((ae-j)/y.height,-1,1),K=y.isRotate?re:Y,k=L===b?y.constructor.TOUCH_MOVE_RATIO:1,de=(0,p.clamp)(W+y.duration*K*k,0,y.duration);y.seek=de,y.emit("setBar","played",(0,p.clamp)(de/y.duration,0,1),ee),y.notice.show="".concat((0,p.secondToTime)(de)," / ").concat((0,p.secondToTime)(y.duration))}}};y.option.gesture&&(_.proxy(b,"touchstart",ee=>{L=b,oe(ee)}),_.proxy(b,"touchmove",F)),_.proxy(E,"touchstart",ee=>{L=E,oe(ee)}),_.proxy(E,"touchmove",F),_.proxy(document,"touchend",()=>{I&&(z=0,j=0,W=0,I=!1,L=null)})}}},{"../utils":"71aH7","../control/progress":"bgoVP","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],InUBx:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m,y){let{option:_,constructor:b,template:{$container:E}}=m,L=(0,p.throttle)(()=>{m.emit("view",(0,p.isInViewport)(E,b.SCROLL_GAP))},b.SCROLL_TIME);y.proxy(window,"scroll",()=>L()),m.on("view",I=>{_.autoMini&&(m.mini=!I)})}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],hoLfM:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D,m){m.proxy(document,"mousemove",y=>{D.emit("document:mousemove",y)}),m.proxy(document,"mouseup",y=>{D.emit("document:mouseup",y)})}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],cl8m3:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D){if(D.constructor.USE_RAF){let m=null;(function y(){D.playing&&D.emit("raf"),D.isDestroy||(m=requestAnimationFrame(y))})(),D.on("destroy",()=>{cancelAnimationFrame(m)})}}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],bK8As:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D,m){}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"6NoFy":[function(R,J,w,Q){R("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(w);var g=R("./utils");w.default=class{constructor(p){this.art=p,this.keys={},p.option.hotkey&&!g.isMobile&&this.init()}init(){let{proxy:p,constructor:D}=this.art;this.add("Escape",()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add("Space",()=>{this.art.toggle()}),this.add("ArrowLeft",()=>{this.art.backward=D.SEEK_STEP}),this.add("ArrowUp",()=>{this.art.volume+=D.VOLUME_STEP}),this.add("ArrowRight",()=>{this.art.forward=D.SEEK_STEP}),this.add("ArrowDown",()=>{this.art.volume-=D.VOLUME_STEP}),p(document,"keydown",m=>{if(this.art.isFocus){let y=document.activeElement.tagName.toUpperCase(),_=document.activeElement.getAttribute("contenteditable");if(y!=="INPUT"&&y!=="TEXTAREA"&&_!==""&&_!=="true"&&!m.altKey&&!m.ctrlKey&&!m.metaKey&&!m.shiftKey){let b=this.keys[m.code];if(b){m.preventDefault();for(let E=0;E<b.length;E++)b[E].call(this.art,m);this.art.emit("hotkey",m)}}}this.art.emit("keydown",m)})}add(p,D){return this.keys[p]?this.keys[p].push(D):this.keys[p]=[D],this}remove(p,D){if(this.keys[p]){let m=this.keys[p].indexOf(D);m!==-1&&this.keys[p].splice(m,1)}return this}}},{"./utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"6G6hZ":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./utils/component"),D=g.interopDefault(p);class m extends D.default{constructor(_){super(_);let{option:b,template:{$layer:E}}=_;this.name="layer",this.$parent=E;for(let L=0;L<b.layers.length;L++)this.add(b.layers[L])}}w.default=m},{"./utils/component":"18nVI","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"3dsEe":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./utils"),D=R("./utils/component"),m=g.interopDefault(D);class y extends m.default{constructor(b){super(b),this.name="loading",(0,p.append)(b.template.$loading,b.icons.loading)}}w.default=y},{"./utils":"71aH7","./utils/component":"18nVI","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],dWGTw:[function(R,J,w,Q){R("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(w);var g=R("./utils");w.default=class{constructor(p){this.art=p,this.timer=null}set show(p){let{constructor:D,template:{$player:m,$noticeInner:y}}=this.art;p?(y.innerText=p instanceof Error?p.message.trim():p,(0,g.addClass)(m,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{y.innerText="",(0,g.removeClass)(m,"art-notice-show")},D.NOTICE_TIME)):(0,g.removeClass)(m,"art-notice-show")}}},{"./utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"5POkG":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./utils"),D=R("./utils/component"),m=g.interopDefault(D);class y extends m.default{constructor(b){super(b),this.name="mask";let{template:E,icons:L,events:I}=b,z=(0,p.append)(E.$state,L.state),j=(0,p.append)(E.$state,L.error);(0,p.setStyle)(j,"display","none"),b.on("destroy",()=>{(0,p.setStyle)(z,"display","none"),(0,p.setStyle)(j,"display",null)}),I.proxy(E.$state,"click",()=>b.play())}}w.default=y},{"./utils":"71aH7","./utils/component":"18nVI","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"6OeNg":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("../utils"),D=R("bundle-text:./loading.svg"),m=g.interopDefault(D),y=R("bundle-text:./state.svg"),_=g.interopDefault(y),b=R("bundle-text:./check.svg"),E=g.interopDefault(b),L=R("bundle-text:./play.svg"),I=g.interopDefault(L),z=R("bundle-text:./pause.svg"),j=g.interopDefault(z),W=R("bundle-text:./volume.svg"),oe=g.interopDefault(W),F=R("bundle-text:./volume-close.svg"),ee=g.interopDefault(F),fe=R("bundle-text:./screenshot.svg"),ae=g.interopDefault(fe),B=R("bundle-text:./setting.svg"),x=g.interopDefault(B),N=R("bundle-text:./arrow-left.svg"),Y=g.interopDefault(N),re=R("bundle-text:./arrow-right.svg"),K=g.interopDefault(re),k=R("bundle-text:./playback-rate.svg"),de=g.interopDefault(k),ie=R("bundle-text:./aspect-ratio.svg"),ve=g.interopDefault(ie),_e=R("bundle-text:./config.svg"),q=g.interopDefault(_e),H=R("bundle-text:./pip.svg"),le=g.interopDefault(H),be=R("bundle-text:./lock.svg"),Ie=g.interopDefault(be),Oe=R("bundle-text:./unlock.svg"),We=g.interopDefault(Oe),et=R("bundle-text:./fullscreen-off.svg"),Le=g.interopDefault(et),Re=R("bundle-text:./fullscreen-on.svg"),He=g.interopDefault(Re),Ue=R("bundle-text:./fullscreen-web-off.svg"),Ke=g.interopDefault(Ue),st=R("bundle-text:./fullscreen-web-on.svg"),Ze=g.interopDefault(st),xt=R("bundle-text:./switch-on.svg"),Xt=g.interopDefault(xt),ct=R("bundle-text:./switch-off.svg"),ri=g.interopDefault(ct),Xe=R("bundle-text:./flip.svg"),Jt=g.interopDefault(Xe),Bt=R("bundle-text:./error.svg"),_i=g.interopDefault(Bt),Si=R("bundle-text:./close.svg"),Ht=g.interopDefault(Si),ui=R("bundle-text:./airplay.svg"),Oi=g.interopDefault(ui);w.default=class{constructor(zi){let Ai={loading:m.default,state:_.default,play:I.default,pause:j.default,check:E.default,volume:oe.default,volumeClose:ee.default,screenshot:ae.default,setting:x.default,pip:le.default,arrowLeft:Y.default,arrowRight:K.default,playbackRate:de.default,aspectRatio:ve.default,config:q.default,lock:Ie.default,flip:Jt.default,unlock:We.default,fullscreenOff:Le.default,fullscreenOn:He.default,fullscreenWebOff:Ke.default,fullscreenWebOn:Ze.default,switchOn:Xt.default,switchOff:ri.default,error:_i.default,close:Ht.default,airplay:Oi.default,...zi.option.icons};for(let Pi in Ai)(0,p.def)(this,Pi,{get:()=>(0,p.getIcon)(Pi,Ai[Pi])})}}},{"../utils":"71aH7","bundle-text:./loading.svg":"7tDub","bundle-text:./state.svg":"1ElZc","bundle-text:./check.svg":"lmgoP","bundle-text:./play.svg":"lVWoQ","bundle-text:./pause.svg":"5Mnax","bundle-text:./volume.svg":"w3eIa","bundle-text:./volume-close.svg":"rHjo1","bundle-text:./screenshot.svg":"2KcqM","bundle-text:./setting.svg":"8rQMV","bundle-text:./arrow-left.svg":"kqGBE","bundle-text:./arrow-right.svg":"aFjpC","bundle-text:./playback-rate.svg":"lx7ZM","bundle-text:./aspect-ratio.svg":"2sEjf","bundle-text:./config.svg":"fQTgE","bundle-text:./pip.svg":"2CaxO","bundle-text:./lock.svg":"aCGnW","bundle-text:./unlock.svg":"bTrAV","bundle-text:./fullscreen-off.svg":"bA3p0","bundle-text:./fullscreen-on.svg":"fTuY8","bundle-text:./fullscreen-web-off.svg":"tvKf4","bundle-text:./fullscreen-web-on.svg":"1F1oB","bundle-text:./switch-on.svg":"7qNHs","bundle-text:./switch-off.svg":"28aV8","bundle-text:./flip.svg":"1uXI6","bundle-text:./error.svg":"9f4dh","bundle-text:./close.svg":"4nTtS","bundle-text:./airplay.svg":"cDPXC","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"7tDub":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" class="uil-default" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><path fill="none" d="M0 0h100v100H0z" class="bk"/><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="translate(0 -30)"><animate attributeName="opacity" begin="-1s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(30 105.98 65)"><animate attributeName="opacity" begin="-0.9166666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(60 75.98 65)"><animate attributeName="opacity" begin="-0.8333333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(90 65 65)"><animate attributeName="opacity" begin="-0.75s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(120 58.66 65)"><animate attributeName="opacity" begin="-0.6666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(150 54.02 65)"><animate attributeName="opacity" begin="-0.5833333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(180 50 65)"><animate attributeName="opacity" begin="-0.5s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" begin="-0.4166666666666667s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" begin="-0.3333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(-90 35 65)"><animate attributeName="opacity" begin="-0.25s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" begin="-0.16666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" fill="#fff" rx="5" ry="5" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" begin="-0.08333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect></svg>'},{}],"1ElZc":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24"><path fill="#fff" d="M9.5 9.325v5.35q0 .575.525.875t1.025-.05l4.15-2.65q.475-.3.475-.85t-.475-.85L11.05 8.5q-.5-.35-1.025-.05t-.525.875M12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12t.788-3.9 2.137-3.175q1.35-1.35 3.175-2.137T12 2t3.9.788 3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22"/></svg>'},{}],lmgoP:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%" viewBox="0 0 24 24"><path fill="#fff" d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"/></svg>'},{}],lVWoQ:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45"/></svg>'},{}],"5Mnax":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2m8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2"/></svg>'},{}],w3eIa:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39m4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8 8 0 0 0 19 11a8 8 0 0 0-4.554-7.222"/><path d="M15 11a4 4 0 0 0-2-3.465v6.93A4 4 0 0 0 15 11"/></svg>'},{}],rHjo1:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M15 11a4 4 0 0 0-2-3.465v2.636l1.865 1.865A4 4 0 0 0 15 11"/><path d="M13.583 5.583A6 6 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8 8 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805m5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806q.322-.154.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416M11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172z"/></svg>'},{}],"2KcqM":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10m0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8"/></svg>'},{}],"8rQMV":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a7 7 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1 1 0 0 0-1.272.23l-1.008 1.225a7 7 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A7 7 0 0 0 4.4 8.6l-1.564.261A1 1 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.1 7.1 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a1 1 0 0 0 .835-.986V9.847a1 1 0 0 0-.836-.986M11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8"/></svg>'},{}],kqGBE:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="#fff" d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z"/></svg>'},{}],aFjpC:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="#fff" d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z"/></svg>'},{}],lx7ZM:[function(R,J,w,Q){J.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path fill="#fff" d="M10 8v8l6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2M5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8m0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"2sEjf":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;transform:translate(0,0)" viewBox="0 0 88 88"><defs><clipPath id="a"><path d="M0 0h88v88H0z"/></clipPath></defs><g clip-path="url(\'#a\')" style="display:block"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0m-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>'},{}],fQTgE:[function(R,J,w,Q){J.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path fill="#fff" d="M15 17h6v1h-6zm-4 0H3v1h8v2h1v-5h-1zm3-9h1V3h-1v2H3v1h11zm4-3v1h3V5zM6 14h1V9H6v2H3v1h3zm4-2h11v-1H10z" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"2CaxO":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 36 36"><path d="M25 17h-8v6h8zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2m-2 .02H9V10.97h18z"/></svg>'},{}],aCGnW:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path fill="#fff" d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128"/></svg>'},{}],bTrAV:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path fill="#fff" d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816"/></svg>'},{}],bA3p0:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768zM341.333 384h-256v-85.333H256V128h85.333zM768 725.333V896h-85.333V640h256v85.333zM341.333 640v256H256V725.333H85.333V640z"/></svg>'},{}],fTuY8:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256zM256 398.222V256h142.222V142.222h-256v256zm512 227.556V768H625.778v113.778h256v-256zM398.222 768H256V625.778H142.222v256h256z"/></svg>'},{}],tvKf4:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448z"/></svg>'},{}],"1F1oB":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384z"/></svg>'},{}],"7qNHs":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1664 1024"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024m0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448"/></svg>'},{}],"28aV8":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1740 1024"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898m-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.87 463.87 0 0 1 511.334 48.435z"/></svg>'},{}],"1uXI6":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon" viewBox="0 0 1024 1024"><path fill="#fff" d="M554.667 810.667V896h-85.334v-85.333zm-384-632.662a42.67 42.67 0 0 1 34.986 18.219l203.904 291.328a42.67 42.67 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667m682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.67 42.67 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.67 42.67 0 0 1 34.944-18.219M554.667 640v85.333h-85.334V640zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334zm0-170.667V384h-85.334v-85.333zm0-170.667v85.333h-85.334V128z"/></svg>'},{}],"9f4dh":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 1024"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.1 93.1 0 0 1 34.448 33.341M512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88m0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2"/></svg>'},{}],"4nTtS":[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733-17.066-17.067-42.666-17.067-59.733 0L512 452.267l-268.8-268.8c-17.067-17.067-42.667-17.067-59.733 0-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733z"/></svg>'},{}],cDPXC:[function(R,J,w,Q){J.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="#fff"><path d="M16 1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h3v-2H3V3h12v8h-2v2h3a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"/><path d="M4 17h10l-5-6z"/></g></svg>'},{}],"3eYNH":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("./flip"),D=g.interopDefault(p),m=R("./aspectRatio"),y=g.interopDefault(m),_=R("./playbackRate"),b=g.interopDefault(_),E=R("./subtitleOffset"),L=g.interopDefault(E),I=R("../utils/component"),z=g.interopDefault(I),j=R("../utils");class W extends z.default{constructor(F){super(F);let{option:ee,controls:fe,template:{$setting:ae}}=F;this.name="setting",this.$parent=ae,this.id=0,this.active=null,this.cache=new Map,this.option=[...this.builtin,...ee.settings],ee.setting&&(this.format(),this.render(),F.on("blur",()=>{this.show&&(this.show=!1,this.render())}),F.on("focus",B=>{let x=(0,j.includeFromEvent)(B,fe.setting),N=(0,j.includeFromEvent)(B,this.$parent);!this.show||x||N||(this.show=!1,this.render())}),F.on("resize",()=>this.resize()))}get builtin(){let F=[],{option:ee}=this.art;return ee.playbackRate&&F.push((0,b.default)(this.art)),ee.aspectRatio&&F.push((0,y.default)(this.art)),ee.flip&&F.push((0,D.default)(this.art)),ee.subtitleOffset&&F.push((0,L.default)(this.art)),F}traverse(F,ee=this.option){var fe;for(let ae=0;ae<ee.length;ae++){let B=ee[ae];F(B),(fe=B.selector)!=null&&fe.length&&this.traverse.call(this,F,B.selector)}}check(F){F.$parent.tooltip=F.html,this.traverse(ee=>{ee.default=ee===F,ee.default&&ee.$item&&(0,j.inverseClass)(ee.$item,"art-current")},F.$option),this.render(F.$parents)}format(F=this.option,ee,fe,ae=[]){for(let B=0;B<F.length;B++){let x=F[B];if(x!=null&&x.name?((0,j.errorHandle)(!ae.includes(x.name),"The [".concat(x.name,"] is already exist in [setting]")),ae.push(x.name)):x.name="setting-".concat(this.id++),!x.$formatted){(0,j.def)(x,"$parent",{get:()=>ee}),(0,j.def)(x,"$parents",{get:()=>fe}),(0,j.def)(x,"$option",{get:()=>F});let N=[];(0,j.def)(x,"$events",{get:()=>N}),(0,j.def)(x,"$formatted",{get:()=>!0})}this.format(x.selector||[],x,F,ae)}this.option=F}find(F=""){let ee=null;return this.traverse(fe=>{fe.name===F&&(ee=fe)}),ee}resize(){var x,N;let{controls:F,constructor:{SETTING_WIDTH:ee,SETTING_ITEM_HEIGHT:fe},template:{$player:ae,$setting:B}}=this.art;if(F.setting&&this.show){let Y=((N=(x=this.active[0])==null?void 0:x.$parent)==null?void 0:N.width)||ee,{left:re,width:K}=(0,j.getRect)(F.setting),{left:k,width:de}=(0,j.getRect)(ae),ie=re-k+K/2-Y/2,ve=this.active===this.option?this.active.length*fe:(this.active.length+1)*fe;if((0,j.setStyle)(B,"height","".concat(ve,"px")),(0,j.setStyle)(B,"width","".concat(Y,"px")),this.art.isRotate||j.isMobile)return;ie+Y>de?((0,j.setStyle)(B,"left",null),(0,j.setStyle)(B,"right",null)):((0,j.setStyle)(B,"left","".concat(ie,"px")),(0,j.setStyle)(B,"right","auto"))}}inactivate(F){for(let ee=0;ee<F.$events.length;ee++)this.art.events.remove(F.$events[ee]);F.$events.length=0}remove(F){let ee=this.find(F);(0,j.errorHandle)(ee,"Can't find [".concat(F,"] in the [setting]"));let fe=ee.$option.indexOf(ee);ee.$option.splice(fe,1),this.inactivate(ee),ee.$item&&(0,j.remove)(ee.$item),this.render()}update(F){let ee=this.find(F.name);return ee?(this.inactivate(ee),Object.assign(ee,F),this.format(),this.creatItem(ee,!0),this.render(),ee):this.add(F)}add(F,ee=this.option){return ee.push(F),this.format(),this.creatItem(F),this.render(),F}creatHeader(F){if(!this.cache.has(F.$option))return;let ee=this.cache.get(F.$option),{proxy:fe,icons:{arrowLeft:ae},constructor:{SETTING_ITEM_HEIGHT:B}}=this.art,x=(0,j.createElement)("div");(0,j.setStyle)(x,"height","".concat(B,"px")),(0,j.addClass)(x,"art-setting-item"),(0,j.addClass)(x,"art-setting-item-back");let N=(0,j.append)(x,'<div class="art-setting-item-left"></div>'),Y=(0,j.createElement)("div");(0,j.addClass)(Y,"art-setting-item-left-icon"),(0,j.append)(Y,ae),(0,j.append)(N,Y),(0,j.append)(N,F.$parent.html);let re=fe(x,"click",()=>this.render(F.$parents));F.$parent.$events.push(re),(0,j.append)(ee,x)}creatItem(F,ee=!1){var _e,q;if(!this.cache.has(F.$option))return;let fe=this.cache.get(F.$option),ae=F.$item,B="selector";(0,j.has)(F,"switch")&&(B="switch"),(0,j.has)(F,"range")&&(B="range"),(0,j.has)(F,"onClick")&&(B="button");let{icons:x,proxy:N,constructor:Y}=this.art,re=(0,j.createElement)("div");(0,j.addClass)(re,"art-setting-item"),(0,j.setStyle)(re,"height","".concat(Y.SETTING_ITEM_HEIGHT,"px")),re.dataset.name=F.name||"",re.dataset.value=F.value||"";let K=(0,j.append)(re,'<div class="art-setting-item-left"></div>'),k=(0,j.append)(re,'<div class="art-setting-item-right"></div>'),de=(0,j.createElement)("div");switch((0,j.addClass)(de,"art-setting-item-left-icon"),B){case"button":case"switch":case"range":(0,j.append)(de,F.icon||x.config);break;case"selector":(_e=F.selector)!=null&&_e.length?(0,j.append)(de,F.icon||x.config):(0,j.append)(de,x.check)}(0,j.append)(K,de),(0,j.def)(F,"$icon",{configurable:!0,get:()=>de}),(0,j.def)(F,"icon",{configurable:!0,get:()=>de.innerHTML,set(H){de.innerHTML="",(0,j.append)(de,H)}});let ie=(0,j.createElement)("div");(0,j.addClass)(ie,"art-setting-item-left-text"),(0,j.append)(ie,F.html||""),(0,j.append)(K,ie),(0,j.def)(F,"$html",{configurable:!0,get:()=>ie}),(0,j.def)(F,"html",{configurable:!0,get:()=>ie.innerHTML,set(H){ie.innerHTML="",(0,j.append)(ie,H)}});let ve=(0,j.createElement)("div");switch((0,j.addClass)(ve,"art-setting-item-right-tooltip"),(0,j.append)(ve,F.tooltip||""),(0,j.append)(k,ve),(0,j.def)(F,"$tooltip",{configurable:!0,get:()=>ve}),(0,j.def)(F,"tooltip",{configurable:!0,get:()=>ve.innerHTML,set(H){ve.innerHTML="",(0,j.append)(ve,H)}}),B){case"switch":{let H=(0,j.createElement)("div");(0,j.addClass)(H,"art-setting-item-right-icon");let le=(0,j.append)(H,x.switchOn),be=(0,j.append)(H,x.switchOff);(0,j.setStyle)(F.switch?be:le,"display","none"),(0,j.append)(k,H),(0,j.def)(F,"$switch",{configurable:!0,get:()=>H});let Ie=F.switch;(0,j.def)(F,"switch",{configurable:!0,get:()=>Ie,set(Oe){Ie=Oe,Oe?((0,j.setStyle)(be,"display","none"),(0,j.setStyle)(le,"display",null)):((0,j.setStyle)(be,"display",null),(0,j.setStyle)(le,"display","none"))}});break}case"range":{let H=(0,j.createElement)("div");(0,j.addClass)(H,"art-setting-item-right-icon");let le=(0,j.append)(H,'<input type="range">');le.value=F.range[0],le.min=F.range[1],le.max=F.range[2],le.step=F.range[3],(0,j.addClass)(le,"art-setting-range"),(0,j.append)(k,H),(0,j.def)(F,"$range",{configurable:!0,get:()=>le});let be=[...F.range];(0,j.def)(F,"range",{configurable:!0,get:()=>be,set(Ie){be=[...Ie],le.value=Ie[0],le.min=Ie[1],le.max=Ie[2],le.step=Ie[3]}})}break;case"selector":if((q=F.selector)!=null&&q.length){let H=(0,j.createElement)("div");(0,j.addClass)(H,"art-setting-item-right-icon"),(0,j.append)(H,x.arrowRight),(0,j.append)(k,H)}}switch(B){case"switch":if(F.onSwitch){let H=N(re,"click",async le=>{F.switch=await F.onSwitch.call(this.art,F,re,le)});F.$events.push(H)}break;case"range":if(F.$range){if(F.onRange){let H=N(F.$range,"change",async le=>{F.range[0]=F.$range.valueAsNumber,F.tooltip=await F.onRange.call(this.art,F,re,le)});F.$events.push(H)}if(F.onChange){let H=N(F.$range,"input",async le=>{F.range[0]=F.$range.valueAsNumber,F.tooltip=await F.onChange.call(this.art,F,re,le)});F.$events.push(H)}}break;case"selector":{let H=N(re,"click",async le=>{var be;(be=F.selector)!=null&&be.length?this.render(F.selector):(this.check(F),F.$parent.onSelect&&(F.$parent.tooltip=await F.$parent.onSelect.call(this.art,F,re,le)))});F.$events.push(H),F.default&&(0,j.addClass)(re,"art-current")}break;case"button":if(F.onClick){let H=N(re,"click",async le=>{F.tooltip=await F.onClick.call(this.art,F,re,le)});F.$events.push(H)}}(0,j.def)(F,"$item",{configurable:!0,get:()=>re}),ee?(0,j.replaceElement)(re,ae):(0,j.append)(fe,re),F.mounted&&setTimeout(()=>F.mounted.call(this.art,F.$item,F),0)}render(F=this.option){var ee;if(this.active=F,this.cache.has(F)){let fe=this.cache.get(F);(0,j.inverseClass)(fe,"art-current")}else{let fe=(0,j.createElement)("div");this.cache.set(F,fe),(0,j.addClass)(fe,"art-setting-panel"),(0,j.append)(this.$parent,fe),(0,j.inverseClass)(fe,"art-current"),(ee=F[0])!=null&&ee.$parent&&this.creatHeader(F[0]);for(let ae=0;ae<F.length;ae++)this.creatItem(F[ae])}this.resize()}}w.default=W},{"./flip":"kONUB","./aspectRatio":"84NBV","./playbackRate":"aetWt","./subtitleOffset":"fIBkO","../utils/component":"18nVI","../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],kONUB:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{i18n:y,icons:_,constructor:{SETTING_ITEM_WIDTH:b,FLIP:E}}=m;function L(z){return y.get((0,p.capitalize)(z))}function I(){let z=m.setting.find("flip-".concat(m.flip));m.setting.check(z)}return{width:b,name:"flip",html:y.get("Video Flip"),tooltip:L(m.flip),icon:_.flip,selector:E.map(z=>({value:z,name:"flip-".concat(z),default:z===m.flip,html:L(z)})),onSelect:z=>(m.flip=z.value,z.html),mounted:()=>{I(),m.on("flip",()=>I())}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"84NBV":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D){let{i18n:m,icons:y,constructor:{SETTING_ITEM_WIDTH:_,ASPECT_RATIO:b}}=D;function E(I){return I==="default"?m.get("Default"):I}function L(){let I=D.setting.find("aspect-ratio-".concat(D.aspectRatio));D.setting.check(I)}return{width:_,name:"aspect-ratio",html:m.get("Aspect Ratio"),icon:y.aspectRatio,tooltip:E(D.aspectRatio),selector:b.map(I=>({value:I,name:"aspect-ratio-".concat(I),default:I===D.aspectRatio,html:E(I)})),onSelect:I=>(D.aspectRatio=I.value,I.html),mounted:()=>{L(),D.on("aspectRatio",()=>L())}}}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],aetWt:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D){let{i18n:m,icons:y,constructor:{SETTING_ITEM_WIDTH:_,PLAYBACK_RATE:b}}=D;function E(I){return I===1?m.get("Normal"):I.toFixed(1)}function L(){let I=D.setting.find("playback-rate-".concat(D.playbackRate));D.setting.check(I)}return{width:_,name:"playback-rate",html:m.get("Play Speed"),tooltip:E(D.playbackRate),icon:y.playbackRate,selector:b.map(I=>({value:I,name:"playback-rate-".concat(I),default:I===D.playbackRate,html:E(I)})),onSelect:I=>(D.playbackRate=I.value,I.html),mounted:()=>{L(),D.on("video:ratechange",()=>L())}}}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],fIBkO:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");function p(D){let{i18n:m,icons:y,constructor:_}=D;return{width:_.SETTING_ITEM_WIDTH,name:"subtitle-offset",html:m.get("Subtitle Offset"),icon:y.subtitle,tooltip:"0s",range:[0,-10,10,.1],onChange:b=>(D.subtitleOffset=b.range[0],b.range[0]+"s"),mounted:(b,E)=>{D.on("subtitleOffset",L=>{E.$range.value=L,E.tooltip=L+"s"})}}}g.defineInteropFlag(w),g.export(w,"default",()=>p)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"2aaJe":[function(R,J,w,Q){R("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(w),w.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(g){try{let p=JSON.parse(window.localStorage.getItem(this.name))||{};return g?p[g]:p}catch(p){return g?this.settings[g]:this.settings}}set(g,p){try{let D=Object.assign({},this.get(),{[g]:p});window.localStorage.setItem(this.name,JSON.stringify(D))}catch(D){this.settings[g]=p}}del(g){try{let p=this.get();delete p[g],window.localStorage.setItem(this.name,JSON.stringify(p))}catch(p){delete this.settings[g]}}clear(){try{window.localStorage.removeItem(this.name)}catch(g){this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"8MTUM":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w);var p=R("../utils"),D=R("./miniProgressBar"),m=g.interopDefault(D),y=R("./autoOrientation"),_=g.interopDefault(y),b=R("./autoPlayback"),E=g.interopDefault(b),L=R("./fastForward"),I=g.interopDefault(L),z=R("./lock"),j=g.interopDefault(z);w.default=class{constructor(W){this.art=W,this.id=0;let{option:oe}=W;oe.miniProgressBar&&!oe.isLive&&this.add(m.default),oe.lock&&p.isMobile&&this.add(j.default),oe.autoPlayback&&!oe.isLive&&this.add(E.default),oe.autoOrientation&&p.isMobile&&this.add(_.default),oe.fastForward&&p.isMobile&&!oe.isLive&&this.add(I.default);for(let F=0;F<oe.plugins.length;F++)this.add(oe.plugins[F])}add(W){this.id+=1;let oe=W.call(this.art,this.art);return oe instanceof Promise?oe.then(F=>this.next(W,F)):this.next(W,oe)}next(W,oe){let F=oe&&oe.name||W.name||"plugin".concat(this.id);return(0,p.errorHandle)(!(0,p.has)(this,F),"Cannot add a plugin that already has the same name: ".concat(F)),(0,p.def)(this,F,{value:oe}),this}}},{"../utils":"71aH7","./miniProgressBar":"87pSL","./autoOrientation":"ePEg5","./autoPlayback":"cVO99","./fastForward":"hFDwt","./lock":"1hsTH","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"87pSL":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){return m.on("control",y=>{y?(0,p.removeClass)(m.template.$player,"art-mini-progress-bar"):(0,p.addClass)(m.template.$player,"art-mini-progress-bar")}),{name:"mini-progress-bar"}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],ePEg5:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{constructor:y,template:{$player:_,$video:b}}=m;return m.on("fullscreenWeb",E=>{if(E){let{videoWidth:L,videoHeight:I}=b,{clientWidth:z,clientHeight:j}=document.documentElement;(L>I&&z<j||L<I&&z>j)&&setTimeout(()=>{(0,p.setStyle)(_,"width","".concat(j,"px")),(0,p.setStyle)(_,"height","".concat(z,"px")),(0,p.setStyle)(_,"transform-origin","0 0"),(0,p.setStyle)(_,"transform","rotate(90deg) translate(0, -".concat(z,"px)")),(0,p.addClass)(_,"art-auto-orientation"),m.isRotate=!0,m.emit("resize")},y.AUTO_ORIENTATION_TIME)}else(0,p.hasClass)(_,"art-auto-orientation")&&((0,p.removeClass)(_,"art-auto-orientation"),m.isRotate=!1,m.emit("resize"))}),m.on("fullscreen",async E=>{var I;if(!((I=screen==null?void 0:screen.orientation)!=null&&I.lock))return;let L=screen.orientation.type;if(E){let{videoWidth:z,videoHeight:j}=b,{clientWidth:W,clientHeight:oe}=document.documentElement;if(z>j&&W<oe||z<j&&W>oe){let F=L.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(F),(0,p.addClass)(_,"art-auto-orientation-fullscreen")}}else(0,p.hasClass)(_,"art-auto-orientation-fullscreen")&&(await screen.orientation.lock(L),(0,p.removeClass)(_,"art-auto-orientation-fullscreen"))}),{name:"autoOrientation",get state(){return(0,p.hasClass)(_,"art-auto-orientation")}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],cVO99:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{i18n:y,icons:_,storage:b,constructor:E,proxy:L,template:{$poster:I}}=m,z=m.layers.add({name:"auto-playback",html:'<div class="art-auto-playback-close"></div><div class="art-auto-playback-last"></div><div class="art-auto-playback-jump"></div>'}),j=(0,p.query)(".art-auto-playback-last",z),W=(0,p.query)(".art-auto-playback-jump",z),oe=(0,p.query)(".art-auto-playback-close",z);(0,p.append)(oe,_.close);let F=null;function ee(){let fe=(b.get("times")||{})[m.option.id||m.option.url];clearTimeout(F),(0,p.setStyle)(z,"display","none"),fe&&fe>=E.AUTO_PLAYBACK_MIN&&((0,p.setStyle)(z,"display","flex"),j.innerText="".concat(y.get("Last Seen")," ").concat((0,p.secondToTime)(fe)),W.innerText=y.get("Jump Play"),L(oe,"click",()=>{(0,p.setStyle)(z,"display","none")}),L(W,"click",()=>{m.seek=fe,m.play(),(0,p.setStyle)(I,"display","none"),(0,p.setStyle)(z,"display","none")}),m.once("video:timeupdate",()=>{F=setTimeout(()=>{(0,p.setStyle)(z,"display","none")},E.AUTO_PLAYBACK_TIMEOUT)}))}return m.on("video:timeupdate",()=>{if(m.playing){let fe=b.get("times")||{},ae=Object.keys(fe);ae.length>E.AUTO_PLAYBACK_MAX&&delete fe[ae[0]],fe[m.option.id||m.option.url]=m.currentTime,b.set("times",fe)}}),m.on("ready",ee),m.on("restart",ee),{name:"auto-playback",get times(){return b.get("times")||{}},clear:()=>b.del("times"),delete(fe){let ae=b.get("times")||{};return delete ae[fe],b.set("times",ae),ae}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],hFDwt:[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{constructor:y,proxy:_,template:{$player:b,$video:E}}=m,L=null,I=!1,z=1,j=()=>{clearTimeout(L),I&&(I=!1,m.playbackRate=z,(0,p.removeClass)(b,"art-fast-forward"))};return _(E,"touchstart",W=>{W.touches.length===1&&m.playing&&!m.isLock&&(L=setTimeout(()=>{I=!0,z=m.playbackRate,m.playbackRate=y.FAST_FORWARD_VALUE,(0,p.addClass)(b,"art-fast-forward")},y.FAST_FORWARD_TIME))}),_(document,"touchmove",j),_(document,"touchend",j),{name:"fastForward",get state(){return(0,p.hasClass)(b,"art-fast-forward")}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"1hsTH":[function(R,J,w,Q){var g=R("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(w),g.export(w,"default",()=>D);var p=R("../utils");function D(m){let{layers:y,icons:_,template:{$player:b}}=m;function E(){return(0,p.hasClass)(b,"art-lock")}function L(){(0,p.addClass)(b,"art-lock"),m.isLock=!0,m.emit("lock",!0)}function I(){(0,p.removeClass)(b,"art-lock"),m.isLock=!1,m.emit("lock",!1)}return y.add({name:"lock",mounted(z){let j=(0,p.append)(z,_.lock),W=(0,p.append)(z,_.unlock);(0,p.setStyle)(j,"display","none"),m.on("lock",oe=>{oe?((0,p.setStyle)(j,"display","inline-flex"),(0,p.setStyle)(W,"display","none")):((0,p.setStyle)(j,"display","none"),(0,p.setStyle)(W,"display","inline-flex"))})},click(){E()?I():L()}}),{name:"lock",get state(){return E()},set state(z){z?L():I()}}}},{"../utils":"71aH7","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}]},["5lTcX"],"5lTcX","parcelRequire4dc0",{})})(ra,ra.exports);var wo=ra.exports;const xo=na(wo);var aa={exports:{}};aa.exports;(function(vi,ii){/*!
 * artplayer-plugin-danmuku.js v5.1.5
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2025 Harvey Zack
 * Released under the MIT License.
 */(function(R,J,w,Q,g){var p=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof ta<"u"?ta:{},D=typeof p[Q]=="function"&&p[Q],m=D.cache||{},y=typeof ia=="function"&&ia.bind(vi);function _(L,I){if(!m[L]){if(!R[L]){var z=typeof p[Q]=="function"&&p[Q];if(!I&&z)return z(L,!0);if(D)return D(L,!0);if(y&&typeof L=="string")return y(L);var j=Error("Cannot find module '"+L+"'");throw j.code="MODULE_NOT_FOUND",j}oe.resolve=function(F){var ee=R[L][1][F];return ee!=null?ee:F},oe.cache={};var W=m[L]=new _.Module(L);R[L][0].call(W.exports,oe,W,W.exports,this)}return m[L].exports;function oe(F){var ee=oe.resolve(F);return ee===!1?{}:_(ee)}}_.isParcelRequire=!0,_.Module=function(L){this.id=L,this.bundle=_,this.exports={}},_.modules=R,_.cache=m,_.parent=D,_.register=function(L,I){R[L]=[function(z,j){j.exports=I},{}]},Object.defineProperty(_,"root",{get:function(){return p[Q]}}),p[Q]=_;for(var b=0;b<J.length;b++)_(J[b]);if(w){var E=_(w);vi.exports=E}})({bgm6t:[function(R,J,w){var Q=R("@parcel/transformer-js/src/esmodule-helpers.js");Q.defineInteropFlag(w),Q.export(w,"default",()=>b);var g=R("./danmuku"),p=Q.interopDefault(g),D=R("./setting"),m=Q.interopDefault(D),y=R("./heatmap"),_=Q.interopDefault(y);function b(E){return L=>{let I=new p.default(L,E),z=new m.default(L,I);return I.option.heatmap&&(0,_.default)(L,I,I.option.heatmap),{name:"artplayerPluginDanmuku",emit:I.emit.bind(I),load:I.load.bind(I),config:I.config.bind(I),hide:I.hide.bind(I),show:I.show.bind(I),reset:I.reset.bind(I),mount:z.mount.bind(z),get option(){return I.option},get isHide(){return I.isHide},get isStop(){return I.isStop}}}}b.icons=m.default.icons,typeof window<"u"&&(window.artplayerPluginDanmuku=b)},{"./danmuku":"4ns48","./setting":"lO8OT","./heatmap":"8AxLD","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"4ns48":[function(R,J,w){var Q=R("@parcel/transformer-js/src/esmodule-helpers.js");Q.defineInteropFlag(w);var g=R("./bilibili"),p=R("bundle-text:./worker"),D=Q.interopDefault(p);class m{constructor(_,b){let{constructor:E,template:L}=_;this.utils=E.utils,this.validator=E.validator,this.$danmuku=L.$danmuku,this.$player=L.$player,this.art=_,this.queue=[],this.$refs=[],this.isStop=!1,this.isHide=!1,this.timer=null,this.index=0,this.option=m.option,this.states={wait:[],ready:[],emit:[],stop:[]},this.config(b);let I=new Blob([D.default],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(I)),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.reset=this.reset.bind(this),this.resize=this.resize.bind(this),this.destroy=this.destroy.bind(this),_.on("video:play",this.start),_.on("video:playing",this.start),_.on("video:pause",this.stop),_.on("video:waiting",this.stop),_.on("destroy",this.destroy),_.on("resize",this.resize),this.load()}static get option(){return{danmuku:[],speed:5,margin:[10,"25%"],opacity:1,color:"#FFFFFF",mode:0,modes:[0,1,2],fontSize:25,antiOverlap:!0,synchronousPlayback:!1,mount:void 0,heatmap:!1,width:512,points:[],filter:()=>!0,beforeEmit:()=>!0,beforeVisible:()=>!0,visible:!0,emitter:!0,maxLength:200,lockTime:5,theme:"dark",OPACITY:{},FONT_SIZE:{},MARGIN:{},SPEED:{},COLOR:[]}}static get scheme(){return{danmuku:"array|function|string",speed:"number",margin:"array",opacity:"number",color:"string",mode:"number",modes:"array",fontSize:"number|string",antiOverlap:"boolean",synchronousPlayback:"boolean",mount:"?htmldivelement|string",heatmap:"object|boolean",width:"number",points:"array",filter:"function",beforeEmit:"function",beforeVisible:"function",visible:"boolean",emitter:"boolean",maxLength:"number",lockTime:"number",theme:"string",OPACITY:"object",FONT_SIZE:"object",MARGIN:"object",SPEED:"object",COLOR:"array"}}static get cssText(){return' user-select: none; position: absolute; white-space: pre; pointer-events: none; perspective: 500px; display: inline-block; will-change: transform; font-weight: normal; line-height: 1.125; visibility: hidden; font-family: SimHei, "Microsoft JhengHei", Arial, Helvetica, sans-serif; text-shadow: rgb(0, 0, 0) 1px 0px 1px, rgb(0, 0, 0) 0px 1px 1px, rgb(0, 0, 0) 0px -1px 1px, rgb(0, 0, 0) -1px 0px 1px; '}get isRotate(){var _,b;return(b=(_=this.art.plugins)==null?void 0:_.autoOrientation)==null?void 0:b.state}get marginTop(){let{clamp:_}=this.utils,b=this.option.margin[0],{clientHeight:E}=this.$player;return typeof b=="number"?_(b,0,E):typeof b=="string"&&b.endsWith("%")?_(E*(parseFloat(b)/100),0,E):m.option.margin[0]}get marginBottom(){let{clamp:_}=this.utils,b=this.option.margin[1],{clientHeight:E}=this.$player;return typeof b=="number"?_(b,0,E):typeof b=="string"&&b.endsWith("%")?_(E*(parseFloat(b)/100),0,E):m.option.margin[1]}get fontSize(){let{clamp:_}=this.utils,{clientHeight:b}=this.$player,E=this.option.fontSize;return typeof E=="number"?Math.round(_(E,12,b)):typeof E=="string"&&E.endsWith("%")?Math.round(_(b*(parseFloat(E)/100),12,b)):m.option.fontSize}get $ref(){let _=this.$refs.pop()||document.createElement("div");return _.style.cssText=m.cssText,_.dataset.mode="",_.className="",_}get readys(){let{currentTime:_}=this.art,b=[];return this.filter("ready",E=>b.push(E)),this.filter("wait",E=>{_+.1>=E.time&&E.time>=_-.1&&b.push(E)}),b}get visibles(){let _=[],{clientWidth:b}=this.$player,E=this.getLeft(this.$player);return this.filter("emit",L=>{let I=L.$ref.offsetTop,z=this.getLeft(L.$ref)-E,j=L.$ref.clientHeight,W=L.$ref.clientWidth,oe=z+W,F=oe/L.$restTime,ee={};ee.top=I,ee.left=z,ee.height=j,ee.width=W,ee.right=b-oe,ee.speed=F,ee.distance=oe,ee.time=L.$restTime,ee.mode=L.mode,_.push(ee)}),_}get speed(){return this.option.synchronousPlayback&&this.art.playbackRate?this.option.speed/Number(this.art.playbackRate):this.option.speed}async load(_){let{errorHandle:b}=this.utils,E=[],L=_||this.option.danmuku;try{typeof L=="function"?E=await L():L instanceof Promise?E=await L:typeof L=="string"?E=await(0,g.bilibiliDanmuParseFromUrl)(L):Array.isArray(L)&&(E=L),b(Array.isArray(E),"Danmuku need return an array as result"),_===void 0&&(this.reset(),this.queue=[],this.states={wait:[],ready:[],emit:[],stop:[]},this.$refs=[],this.$danmuku.innerText="");for(let I=0;I<E.length;I++){let z=E[I];await this.emit(z)}this.art.emit("artplayerPluginDanmuku:loaded",this.queue)}catch(I){throw this.art.emit("artplayerPluginDanmuku:error",I),I}return this}async emit(_){let{clamp:b}=this.utils;if(this.validator(_,{text:"string",mode:"?number",color:"?string",time:"?number",border:"?boolean",style:"?object"}),!_.text.trim()||(_.time?_.time=b(_.time,0,1/0):_.time=this.art.currentTime+.5,_.mode===void 0&&(_.mode=this.option.mode),_.style===void 0&&(_.style={}),_.color===void 0&&(_.color=this.option.color),![0,1,2].includes(_.mode)||!this.option.filter(_)))return this;let E={..._,$state:"wait",$id:this.index++,$ref:null,$restTime:0,$lastStartTime:0};return this.setState(E,"wait"),this.queue.push(E),this}config(_){let{clamp:b}=this.utils,{$controlsCenter:E}=this.art.template;return Object.keys(_).some(L=>JSON.stringify(this.option[L])!==JSON.stringify(_[L]))&&(this.option=Object.assign({},m.option,this.option,_),this.validator(this.option,m.scheme),this.option.mode=b(this.option.mode,0,2),this.option.speed=b(this.option.speed,1,10),this.option.opacity=b(this.option.opacity,0,1),this.option.lockTime=b(this.option.lockTime,1,60),this.option.maxLength=b(this.option.maxLength,1,1e3),this.option.mount=this.option.mount||E,_.fontSize&&this.reset(),this.option.visible?this.show():this.hide(),this.art.emit("artplayerPluginDanmuku:config",this.option)),this}getLeft(_){let b=_.getBoundingClientRect();return this.isRotate?b.top:b.left}postMessage(_={}){return new Promise(b=>{_.id=Date.now(),this.worker.postMessage(_),this.worker.onmessage=E=>{let{data:L}=E;L.id===_.id&&b(L)}})}filter(_,b){let E=this.states[_]||[];for(let L=0;L<E.length;L++)b(E[L]);return E}setState(_,b){this.states[_.$state]=this.states[_.$state].filter(E=>E!==_),_.$state=b,_.$ref&&(_.$ref.dataset.state=b),this.states[b].push(_)}makeWait(_){this.setState(_,"wait"),_.$ref&&(_.$ref.style.cssText=m.cssText,_.$ref.style.visibility="hidden",_.$ref.style.marginLeft="0px",_.$ref.style.transform="translateX(0px)",_.$ref.style.transition="transform 0s linear 0s",this.$refs.push(_.$ref),_.$ref=null)}update(){let{setStyles:_}=this.utils;return this.timer=window.requestAnimationFrame(async()=>{if(this.art.playing&&!this.isHide){this.filter("emit",E=>{let L=(Date.now()-E.$lastStartTime)/1e3;E.$restTime-=L,E.$lastStartTime=Date.now(),E.$restTime<=0&&this.makeWait(E)});let b=this.readys;for(let E=0;E<b.length;E++){let L=b[E];if(await this.option.beforeVisible(L)){let{clientWidth:I,clientHeight:z}=this.$player;L.$ref=this.$ref,L.$ref.innerText=L.text,this.$danmuku.appendChild(L.$ref),L.$ref.style.opacity=this.option.opacity,L.$ref.style.fontSize="".concat(this.fontSize,"px"),L.$ref.style.color=L.color,L.$ref.style.border=L.border?"1px solid ".concat(L.color):null,L.$ref.style.backgroundColor=L.border?"rgb(0 0 0 / 50%)":null,_(L.$ref,L.style),L.$lastStartTime=Date.now(),L.$restTime=this.speed;let j=I+L.$ref.clientWidth,{result:W}=await this.postMessage({type:"getDanmuTop",target:{mode:L.mode,height:L.$ref.clientHeight,speed:j/L.$restTime},visibles:this.visibles,antiOverlap:this.option.antiOverlap,clientWidth:I,clientHeight:z,marginBottom:this.marginBottom,marginTop:this.marginTop});if(L.$ref)if(this.isStop||W===void 0)this.setState(L,"ready"),this.$refs.push(L.$ref),L.$ref=null;else{switch(this.setState(L,"emit"),L.$ref.style.top="".concat(W,"px"),L.$ref.style.visibility="visible",L.$ref.dataset.mode=L.mode,L.mode){case 0:L.$ref.style.left="".concat(I,"px"),L.$ref.style.marginLeft="0px",L.$ref.style.transform="translateX(".concat(-j,"px)"),L.$ref.style.transition="transform ".concat(L.$restTime,"s linear 0s");break;case 1:case 2:L.$ref.style.left="50%",L.$ref.style.marginLeft="-".concat(L.$ref.clientWidth/2,"px")}this.art.emit("artplayerPluginDanmuku:visible",L)}}}}this.isStop||this.update()}),this}resize(){let{clientWidth:_}=this.$player;this.filter("stop",b=>{b.mode===0&&(b.$ref.style.left="".concat(_,"px"))}),this.filter("emit",b=>{if(b.$lastStartTime=Date.now(),b.mode===0){let E=_+b.$ref.clientWidth;b.$ref.style.left="".concat(_,"px"),b.$ref.style.transform="translateX(".concat(-E,"px)"),b.$ref.style.transition="transform ".concat(b.$restTime,"s linear 0s")}})}continue(){let{clientWidth:_}=this.$player;return this.filter("stop",b=>{if(this.setState(b,"emit"),b.$lastStartTime=Date.now(),b.mode===0){let E=_+b.$ref.clientWidth;b.$ref.style.transform="translateX(".concat(-E,"px)"),b.$ref.style.transition="transform ".concat(b.$restTime,"s linear 0s")}}),this}suspend(){let{clientWidth:_}=this.$player;return this.filter("emit",b=>{if(this.setState(b,"stop"),b.mode===0){let E=_-(this.getLeft(b.$ref)-this.getLeft(this.$player));b.$ref.style.transform="translateX(".concat(-E,"px)"),b.$ref.style.transition="transform 0s linear 0s"}}),this}stop(){return this.isStop=!0,this.suspend(),window.cancelAnimationFrame(this.timer),this.art.emit("artplayerPluginDanmuku:stop"),this}start(){return this.isStop=!1,this.continue(),this.update(),this.art.emit("artplayerPluginDanmuku:start"),this}reset(){return this.queue.forEach(_=>this.makeWait(_)),this.art.emit("artplayerPluginDanmuku:reset"),this}show(){return this.isHide=!1,this.$danmuku.style.opacity=1,this.option.visible=!0,this.art.emit("artplayerPluginDanmuku:show"),this}hide(){return this.isHide=!0,this.$danmuku.style.opacity=0,this.option.visible=!1,this.art.emit("artplayerPluginDanmuku:hide"),this}destroy(){this.stop(),this.worker.terminate(),this.art.off("video:play",this.start),this.art.off("video:playing",this.start),this.art.off("video:pause",this.stop),this.art.off("video:waiting",this.stop),this.art.off("resize",this.reset),this.art.off("destroy",this.destroy),this.art.emit("artplayerPluginDanmuku:destroy")}}w.default=m},{"./bilibili":"f83sx","bundle-text:./worker":"lfIAi","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],f83sx:[function(R,J,w){var Q=R("@parcel/transformer-js/src/esmodule-helpers.js");function g(y){switch(y){case 1:case 2:case 3:default:return 0;case 4:return 2;case 5:return 1}}function p(y){if(typeof y!="string")return[];let _=new RegExp(new RegExp('<d (?:.*? )??p="(?<p>.+?)"(?: .*?)?>(?<text>.+?)<\\/d>',"gs"));return Array.from(y.matchAll(_)).map(b=>{let E=b.groups.p.split(",");return E.length>=8?{text:b.groups.text.trim().replaceAll("&quot;",'"').replaceAll("&apos;","'").replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&amp;","&"),time:Number(E[0]),mode:g(Number(E[1])),fontSize:Number(E[2]),color:"#".concat(Number(E[3]).toString(16)),timestamp:Number(E[4]),pool:Number(E[5]),userID:E[6],rowID:Number(E[7])}:null}).filter(Boolean)}function D({data:y}){let{xml:_,id:b}=y;if(!b||!_)return;let E=p(_);self.postMessage({danmus:E,id:b})}function m(y){return new Promise(async _=>{let b=await fetch(y),E=await b.text();try{let L=function(){let I=new Blob([" ".concat(g.toString()," ").concat(p.toString()," onmessage = ").concat(D.toString()," ")],{type:"application/javascript"});return new Worker(URL.createObjectURL(I))}();L.onmessage=I=>{let{danmus:z,id:j}=I.data;j&&z&&(_(z),L.terminate())},L.postMessage({xml:E,id:Date.now()})}catch(L){_(p(E))}})}Q.defineInteropFlag(w),Q.export(w,"bilibiliDanmuParseFromUrl",()=>m)},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],"9pCYc":[function(R,J,w){w.interopDefault=function(Q){return Q&&Q.__esModule?Q:{default:Q}},w.defineInteropFlag=function(Q){Object.defineProperty(Q,"__esModule",{value:!0})},w.exportAll=function(Q,g){return Object.keys(Q).forEach(function(p){p==="default"||p==="__esModule"||Object.prototype.hasOwnProperty.call(g,p)||Object.defineProperty(g,p,{enumerable:!0,get:function(){return Q[p]}})}),g},w.export=function(Q,g,p){Object.defineProperty(Q,g,{enumerable:!0,get:p})}},{}],lfIAi:[function(R,J,w){J.exports='!function(e,t,n,o,i){var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},f="function"==typeof r[o]&&r[o],l=f.cache||{},d="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(t,n){if(!l[t]){if(!e[t]){var i="function"==typeof r[o]&&r[o];if(!n&&i)return i(t,!0);if(f)return f(t,!0);if(d&&"string"==typeof t)return d(t);var h=Error("Cannot find module \'"+t+"\'");throw h.code="MODULE_NOT_FOUND",h}s.resolve=function(n){var o=e[t][1][n];return null!=o?o:n},s.cache={};var p=l[t]=new u.Module(t);e[t][0].call(p.exports,s,p,p.exports,this)}return l[t].exports;function s(e){var t=s.resolve(e);return!1===t?{}:u(t)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=l,u.parent=f,u.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(u,"root",{get:function(){return r[o]}}),r[o]=u;for(var h=0;h<t.length;h++)u(t[h]);if(n){var p=u(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=p:"function"==typeof define&&define.amd&&define(function(){return p})}}({"59OZS":[function(e,t,n){function o({target:e,visibles:t,clientWidth:n,clientHeight:o,marginBottom:i,marginTop:r,antiOverlap:f}){let l=o-i,d=t.filter(t=>t.mode===e.mode&&t.top<=l).sort((e,t)=>e.top-t.top);if(0===d.length)return 2===e.mode?l-e.height:r;if(d.unshift({type:"top",top:0,left:0,right:0,height:r,width:n,speed:0,distance:n}),d.push({type:"bottom",top:l,left:0,right:0,height:i,width:n,speed:0,distance:n}),2===e.mode)for(let t=d.length-2;t>=0;t-=1){let n=d[t],o=d[t+1],i=n.top+n.height;if(o.top-i>=e.height)return o.top-e.height}else for(let t=1;t<d.length;t+=1){let n=d[t],o=d[t-1],i=o.top+o.height;if(n.top-i>=e.height)return i}let u=[];for(let e=1;e<d.length-1;e+=1){let t=d[e];if(u.length){let e=u[u.length-1];e[0].top===t.top?e.push(t):u.push([t])}else u.push([t])}if(f)switch(e.mode){case 0:{let t=u.find(t=>t.every(t=>!(n<t.distance)&&(e.speed<t.speed||t.right/(e.speed-t.speed)>t.time)));return t&&t[0]?t[0].top:void 0}case 1:case 2:return}else{switch(e.mode){case 0:u.sort((e,t)=>{let n=Math.min(...t.map(e=>e.right)),o=Math.min(...e.map(e=>e.right));return n*t.length-o*e.length});break;case 1:case 2:u.sort((e,t)=>{let n=Math.max(...t.map(e=>e.width));return Math.max(...e.map(e=>e.width))*e.length-n*t.length})}return u[0][0].top}}onmessage=e=>{let{data:t}=e;if(!t.id||!t.type)return;let n=(0,({getDanmuTop:o})[t.type])(t);self.postMessage({result:n,id:t.id})}},{}]},["59OZS"],"59OZS","parcelRequire4dc0");'},{}],lO8OT:[function(R,J,w){var Q=R("@parcel/transformer-js/src/esmodule-helpers.js");Q.defineInteropFlag(w);var g=R("bundle-text:./style.less"),p=Q.interopDefault(g),D=R("bundle-text:./img/on.svg"),m=Q.interopDefault(D),y=R("bundle-text:./img/off.svg"),_=Q.interopDefault(y),b=R("bundle-text:./img/config.svg"),E=Q.interopDefault(b),L=R("bundle-text:./img/style.svg"),I=Q.interopDefault(L),z=R("bundle-text:./img/mode_0_off.svg"),j=Q.interopDefault(z),W=R("bundle-text:./img/mode_0_on.svg"),oe=Q.interopDefault(W),F=R("bundle-text:./img/mode_1_off.svg"),ee=Q.interopDefault(F),fe=R("bundle-text:./img/mode_1_on.svg"),ae=Q.interopDefault(fe),B=R("bundle-text:./img/mode_2_off.svg"),x=Q.interopDefault(B),N=R("bundle-text:./img/mode_2_on.svg"),Y=Q.interopDefault(N),re=R("bundle-text:./img/check_on.svg"),K=Q.interopDefault(re),k=R("bundle-text:./img/check_off.svg"),de=Q.interopDefault(k);if(w.default=class{constructor(ie,ve){this.art=ie,this.danmuku=ve,this.utils=ie.constructor.utils;let{setStyle:_e}=this.utils,{$controlsCenter:q}=ie.template;_e(q,"display","flex"),this.template={$controlsCenter:q,$mount:q,$danmuku:null,$toggle:null,$config:null,$configPanel:null,$configModes:null,$style:null,$stylePanel:null,$styleModes:null,$colors:null,$opacitySlider:null,$opacityValue:null,$marginSlider:null,$marginValue:null,$fontSizeSlider:null,$fontSizeValue:null,$speedSlider:null,$speedValue:null,$input:null,$send:null},this.slider={opacity:null,margin:null,fontSize:null,speed:null},this.emitting=!1,this.isLock=!1,this.timer=null,this.createTemplate(),this.createSliders(),this.createEvents(),this.mount(this.option.mount),ie.on("resize",()=>this.resize()),ie.on("fullscreen",H=>this.onFullscreen(H)),ie.on("fullscreenWeb",H=>this.onFullscreen(H)),ie.proxy(this.template.$config,"mouseenter",()=>{this.onMouseEnter({$control:this.template.$config,$panel:this.template.$configPanel})}),ie.proxy(this.template.$style,"mouseenter",()=>{this.onMouseEnter({$control:this.template.$style,$panel:this.template.$stylePanel})})}static get icons(){return{$on:m.default,$off:_.default,$config:E.default,$style:I.default,$mode_0_off:j.default,$mode_0_on:oe.default,$mode_1_off:ee.default,$mode_1_on:ae.default,$mode_2_off:x.default,$mode_2_on:Y.default,$check_on:K.default,$check_off:de.default}}get option(){return this.danmuku.option}get outside(){return this.template.$mount!==this.template.$controlsCenter}get TEMPLATE(){let{option:ie}=this;return'<div class="apd-toggle">'.concat(m.default).concat(_.default,'</div><div class="apd-config">').concat(E.default,'<div class="apd-config-panel"><div class="apd-config-panel-inner"><div class="apd-config-mode">按类型屏蔽<div class="apd-modes"><div data-mode="0" class="apd-mode">').concat(j.default).concat(oe.default,'<div>滚动</div></div><div data-mode="1" class="apd-mode">').concat(ee.default).concat(ae.default,'<div>顶部</div></div><div data-mode="2" class="apd-mode">').concat(x.default).concat(Y.default,'<div>底部</div></div></div></div><div class="apd-config-other"><div class="apd-other apd-anti-overlap">').concat(K.default).concat(de.default,' 防止弹幕重叠</div><div class="apd-other apd-sync-video">').concat(K.default).concat(de.default,' 同步视频速度</div></div><div class="apd-config-slider apd-config-opacity">不透明度<div class="apd-slider"></div><div class="apd-value">未知</div></div><div class="apd-config-slider apd-config-margin">显示区域<div class="apd-slider"></div><div class="apd-value">未知</div></div><div class="apd-config-slider apd-config-fontSize">弹幕字号<div class="apd-slider"></div><div class="apd-value">未知</div></div><div class="apd-config-slider apd-config-speed">弹幕速度<div class="apd-slider"></div><div class="apd-value">未知</div></div></div></div></div><div class="apd-emitter"><div class="apd-style">').concat(I.default,'<div class="apd-style-panel"><div class="apd-style-panel-inner"><div class="apd-style-mode">模式<div class="apd-modes"><div data-mode="0" class="apd-mode">').concat(oe.default,'<div>滚动</div></div><div data-mode="1" class="apd-mode">').concat(ae.default,'<div>顶部</div></div><div data-mode="2" class="apd-mode">').concat(Y.default,'<div>底部</div></div></div></div><div class="apd-style-color">颜色<div class="apd-colors">').concat(this.COLOR.map(ve=>'<div data-color="'.concat(ve,'" class="apd-color" style="background-color: ').concat(ve,'"></div>')).join(""),'</div></div></div></div></div><input class="apd-input" placeholder="发个友善的弹幕见证当下" autocomplete="off" maxLength="').concat(ie.maxLength,'" /><div class="apd-send">发送</div></div>')}get OPACITY(){return{min:0,max:100,steps:[],...this.option.OPACITY}}get FONT_SIZE(){return{min:12,max:120,steps:[],...this.option.FONT_SIZE}}get MARGIN(){return{min:0,max:3,steps:[{name:"1/4",value:[10,"75%"]},{name:"半屏",value:[10,"50%"]},{name:"3/4",value:[10,"25%"]},{name:"满屏",value:[10,10]}],...this.option.MARGIN}}get SPEED(){return{min:0,max:4,steps:[{name:"极慢",value:10},{name:"较慢",value:7.5,hide:!0},{name:"适中",value:5},{name:"较快",value:2.5,hide:!0},{name:"极快",value:1}],...this.option.SPEED}}get COLOR(){return this.option.COLOR.length?this.option.COLOR:["#FE0302","#FF7204","#FFAA02","#FFD302","#FFFF00","#A0EE00","#00CD00","#019899","#4266BE","#89D5FF","#CC0273","#222222","#9B9B9B","#FFFFFF"]}query(ie){let{query:ve}=this.utils,{$danmuku:_e}=this.template;return ve(ie,_e)}append(ie,ve){let{append:_e}=this.utils;[...ie.children].some(q=>q===ve)||_e(ie,ve)}setData(ie,ve){let{$player:_e}=this.art.template,{$mount:q}=this.template;_e.dataset[ie]=ve,this.outside&&(q.dataset[ie]=ve)}createTemplate(){let{createElement:ie,tooltip:ve}=this.utils,_e=ie("div");_e.className="artplayer-plugin-danmuku",_e.innerHTML=this.TEMPLATE,this.template.$danmuku=_e,this.template.$toggle=this.query(".apd-toggle"),this.template.$config=this.query(".apd-config"),this.template.$configPanel=this.query(".apd-config-panel"),this.template.$configModes=this.query(".apd-config-mode .apd-modes"),this.template.$style=this.query(".apd-style"),this.template.$stylePanel=this.query(".apd-style-panel"),this.template.$styleModes=this.query(".apd-style-mode .apd-modes"),this.template.$colors=this.query(".apd-colors"),this.template.$antiOverlap=this.query(".apd-anti-overlap"),this.template.$syncVideo=this.query(".apd-sync-video"),this.template.$opacitySlider=this.query(".apd-config-opacity .apd-slider"),this.template.$opacityValue=this.query(".apd-config-opacity .apd-value"),this.template.$marginSlider=this.query(".apd-config-margin .apd-slider"),this.template.$marginValue=this.query(".apd-config-margin .apd-value"),this.template.$fontSizeSlider=this.query(".apd-config-fontSize .apd-slider"),this.template.$fontSizeValue=this.query(".apd-config-fontSize .apd-value"),this.template.$speedSlider=this.query(".apd-config-speed .apd-slider"),this.template.$speedValue=this.query(".apd-config-speed .apd-value"),this.template.$input=this.query(".apd-input"),this.template.$send=this.query(".apd-send");let{$toggle:q}=this.template;this.art.on("artplayerPluginDanmuku:show",()=>{ve(q,"关闭弹幕")}),this.art.on("artplayerPluginDanmuku:hide",()=>{ve(q,"打开弹幕")})}createEvents(){let{$toggle:ie,$configModes:ve,$styleModes:_e,$colors:q,$antiOverlap:H,$syncVideo:le,$send:be,$input:Ie}=this.template;this.art.proxy(ie,"click",()=>{this.danmuku.config({visible:!this.option.visible}),this.reset()}),this.art.proxy(ve,"click",Oe=>{let We=Oe.target.closest(".apd-mode");if(!We)return;let et=Number(We.dataset.mode);this.option.modes.includes(et)?this.danmuku.config({modes:this.option.modes.filter(Le=>Le!==et)}):this.danmuku.config({modes:[...this.option.modes,et]}),this.reset()}),this.art.proxy(H,"click",()=>{this.danmuku.config({antiOverlap:!this.option.antiOverlap}),this.reset()}),this.art.proxy(le,"click",()=>{this.danmuku.config({synchronousPlayback:!this.option.synchronousPlayback}),this.reset()}),this.art.proxy(_e,"click",Oe=>{let We=Oe.target.closest(".apd-mode");if(!We)return;let et=Number(We.dataset.mode);this.danmuku.config({mode:et}),this.reset()}),this.art.proxy(q,"click",Oe=>{let We=Oe.target.closest(".apd-color");We&&(this.danmuku.config({color:We.dataset.color}),this.reset())}),this.art.proxy(be,"click",()=>this.emit()),this.art.proxy(Ie,"keypress",Oe=>{Oe.key==="Enter"&&(Oe.preventDefault(),this.emit())})}createSliders(){this.slider.opacity=this.createSlider({...this.OPACITY,container:this.template.$opacitySlider,findIndex:()=>Math.round(100*this.option.opacity),onChange:ie=>{let{$opacityValue:ve}=this.template;ve.textContent="".concat(ie,"%"),this.danmuku.config({opacity:ie/100})}}),this.slider.margin=this.createSlider({...this.MARGIN,container:this.template.$marginSlider,findIndex:()=>this.MARGIN.steps.findIndex(ie=>ie.value[0]===this.option.margin[0]&&ie.value[1]===this.option.margin[1]),onChange:ie=>{let ve=this.MARGIN.steps[ie];if(!ve)return;let{$marginValue:_e}=this.template;_e.textContent=ve.name,this.danmuku.config({margin:ve.value})}}),this.slider.fontSize=this.createSlider({...this.FONT_SIZE,container:this.template.$fontSizeSlider,findIndex:()=>this.danmuku.fontSize,onChange:ie=>{let{$fontSizeValue:ve}=this.template;ve.textContent="".concat(ie,"px"),ie!==this.danmuku.fontSize&&this.danmuku.config({fontSize:ie})}}),this.slider.speed=this.createSlider({...this.SPEED,container:this.template.$speedSlider,findIndex:()=>this.SPEED.steps.findIndex(ie=>ie.value===this.option.speed),onChange:ie=>{let ve=this.SPEED.steps[ie];if(!ve)return;let{$speedValue:_e}=this.template;_e.textContent=ve.name,this.danmuku.config({speed:ve.value})}})}createSlider({min:ie,max:ve,container:_e,findIndex:q,onChange:H,steps:le=[]}){let{query:be,clamp:Ie,setStyle:Oe}=this.utils;Oe(_e,"touch-action","none"),_e.innerHTML='<div class="apd-slider-line"><div class="apd-slider-points">'.concat(le.map(()=>'<div class="apd-slider-point"></div>').join(""),'</div><div class="apd-slider-progress"></div></div><div class="apd-slider-dot"></div><div class="apd-slider-steps">').concat(le.map(Ue=>Ue.hide?"":'<div class="apd-slider-step">'.concat(Ue.name,"</div>")).join(""),"</div>");let We=be(".apd-slider-dot",_e),et=be(".apd-slider-progress",_e),Le=!1;function Re(Ue=q()){if(Ue<ie||Ue>ve)return;let Ke=(Ue-ie)/(ve-ie);We.style.left="".concat(100*Ke,"%"),le.length===0&&(et.style.width=We.style.left),H(Ue)}function He(Ue){let{top:Ke,height:st,left:Ze,width:xt}=_e.getBoundingClientRect();this.art.isRotate?Re(Math.round(Ie(Ue.clientY-Ke,0,st)/st*(ve-ie)+ie)):Re(Math.round(Ie(Ue.clientX-Ze,0,xt)/xt*(ve-ie)+ie))}return this.art.proxy(_e,"click",Ue=>{He.call(this,Ue)}),this.art.proxy(_e,"pointerdown",Ue=>{Le=Ue.button===0}),this.art.proxy(document,"pointermove",Ue=>{Le&&He.call(this,Ue)}),this.art.proxy(document,"pointerup",Ue=>{Le&&(Le=!1,He.call(this,Ue))}),{reset:Re}}onFullscreen(ie){let{$danmuku:ve,$controlsCenter:_e,$mount:q}=this.template;this.outside?ie?this.append(_e,ve):this.append(q,ve):this.append(_e,ve)}onMouseEnter({$control:ie,$panel:ve}){let{$player:_e}=this.art.template,q=ie.getBoundingClientRect(),H=ve.getBoundingClientRect(),le=_e.getBoundingClientRect(),be=H.width/2-q.width/2,Ie=le.left-(q.left-be),Oe=q.right+be-le.right;Ie>0?ve.style.left="".concat(-be+Ie,"px"):Oe>0?ve.style.left="".concat(-be-Oe,"px"):ve.style.left="".concat(-be,"px")}async emit(){let{$input:ie}=this.template,ve=ie.value.trim();if(!ve.length||this.isLock||this.emitting)return;let _e={text:ve,mode:this.option.mode,color:this.option.color,time:this.art.currentTime};try{this.emitting=!0;let q=await this.option.beforeEmit(_e);if(this.emitting=!1,q!==!0)return;_e.border=!0,delete _e.time,this.danmuku.emit(_e),ie.value="",this.lock()}catch(q){this.emitting=!1}}lock(){let{addClass:ie}=this.utils,{$send:ve}=this.template;this.isLock=!0;let _e=this.option.lockTime;ve.innerText=_e,ie(ve,"apd-lock");let q=()=>{this.timer=setTimeout(()=>{_e===0?this.unlock():(_e-=1,ve.innerText=_e,q())},1e3)};q()}unlock(){let{removeClass:ie}=this.utils,{$send:ve}=this.template;clearTimeout(this.timer),this.isLock=!1,ve.innerText="发送",ie(ve,"apd-lock")}resize(){if(this.outside||this.art.fullscreen||this.art.fullscreenWeb)return;let{$player:ie,$controlsCenter:ve}=this.art.template,{$danmuku:_e}=this.template;this.art.width<this.option.width?this.append(ie,_e):this.append(ve,_e)}reset(){let{inverseClass:ie,tooltip:ve}=this.utils,{$toggle:_e,$colors:q}=this.template;this.slider.opacity.reset(),this.slider.margin.reset(),this.slider.fontSize.reset(),this.slider.speed.reset(),this.setData("danmukuVisible",this.option.visible),this.setData("danmukuMode",this.option.mode),this.setData("danmukuColor",this.option.color),this.setData("danmukuMode0",this.option.modes.includes(0)),this.setData("danmukuMode1",this.option.modes.includes(1)),this.setData("danmukuMode2",this.option.modes.includes(2)),this.setData("danmukuAntiOverlap",this.option.antiOverlap),this.setData("danmukuSyncVideo",this.option.synchronousPlayback),this.setData("danmukuTheme",this.option.theme),this.setData("danmukuEmitter",this.option.emitter);let H=Array.from(q.children).find(le=>le.dataset.color===this.option.color.toUpperCase());H&&ie(H,"apd-active"),ve(_e,this.option.visible?"关闭弹幕":"打开弹幕"),this.resize()}mount(ie){let{errorHandle:ve}=this.utils,_e=typeof ie=="string"?document.querySelector(ie):ie;ve(_e,"Can not find the mount point: ".concat(ie)),this.append(_e,this.template.$danmuku),this.template.$mount=_e,this.reset()}},typeof document<"u"){let ie="artplayer-plugin-danmuku",ve=document.getElementById(ie);if(ve)ve.textContent=p.default;else{let _e=document.createElement("style");_e.id=ie,_e.textContent=p.default,document.head.appendChild(_e)}}},{"bundle-text:./style.less":"hViDo","bundle-text:./img/on.svg":"9pjcf","bundle-text:./img/off.svg":"b2dkP","bundle-text:./img/config.svg":"l8tyy","bundle-text:./img/style.svg":"5iZC3","bundle-text:./img/mode_0_off.svg":"i0Vut","bundle-text:./img/mode_0_on.svg":"hOSvZ","bundle-text:./img/mode_1_off.svg":"bOXC3","bundle-text:./img/mode_1_on.svg":"lKuh0","bundle-text:./img/mode_2_off.svg":"eB8W6","bundle-text:./img/mode_2_on.svg":"bpe2E","bundle-text:./img/check_on.svg":"kL9zy","bundle-text:./img/check_off.svg":"22xpM","@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}],hViDo:[function(R,J,w){J.exports='.artplayer-plugin-danmuku{z-index:99;color:#fff;flex-shrink:0;justify-content:center;align-items:center;gap:10px;width:100%;height:32px;font-size:12px;font-weight:300;display:flex;position:relative}.artplayer-plugin-danmuku .apd-icon{cursor:pointer;opacity:.75;fill:#fff;transition:all .2s}.artplayer-plugin-danmuku .apd-icon:hover{opacity:1}.artplayer-plugin-danmuku .apd-config{display:flex;position:relative}.artplayer-plugin-danmuku .apd-config .apd-config-panel{opacity:0;pointer-events:none;width:320px;padding:10px;position:absolute;bottom:24px;left:0}.artplayer-plugin-danmuku .apd-config .apd-config-panel .apd-config-panel-inner{background-color:#000000d9;border-radius:3px;width:100%;padding:10px}.artplayer-plugin-danmuku .apd-config:hover .apd-config-panel{opacity:100;pointer-events:all}.artplayer-plugin-danmuku .apd-config-mode,.artplayer-plugin-danmuku .apd-config-slider,.artplayer-plugin-danmuku .apd-config-other,.artplayer-plugin-danmuku .apd-style-mode{margin-bottom:15px}.artplayer-plugin-danmuku .apd-modes{align-items:center;gap:20px;margin-top:5px;display:flex}.artplayer-plugin-danmuku .apd-modes .apd-mode{cursor:pointer;text-align:center}.artplayer-plugin-danmuku .apd-modes .apd-mode:hover{color:#00a1d6}.artplayer-plugin-danmuku .apd-config-slider{align-items:center;gap:12px;display:flex}.artplayer-plugin-danmuku .apd-config-slider .apd-value{text-align:right;width:32px}.artplayer-plugin-danmuku .apd-slider{cursor:pointer;flex:1;justify-content:center;align-items:center;height:20px;display:flex;position:relative}.artplayer-plugin-danmuku .apd-slider .apd-slider-line{background-color:#ffffff40;border-radius:3px;width:100%;height:2px;position:relative;overflow:hidden}.artplayer-plugin-danmuku .apd-slider .apd-slider-points{justify-content:space-between;align-items:center;display:flex;position:absolute;inset:0}.artplayer-plugin-danmuku .apd-slider .apd-slider-points .apd-slider-point{background-color:#ffffff80;border-radius:50%;width:2px;height:2px}.artplayer-plugin-danmuku .apd-slider .apd-slider-progress{background-color:#00a1d6;width:0%;height:100%}.artplayer-plugin-danmuku .apd-slider .apd-slider-dot{background-color:#00a1d6;border-radius:50%;width:12px;height:12px;position:absolute;left:0%;transform:translate(-6px)}.artplayer-plugin-danmuku .apd-slider .apd-slider-steps{color:#777;justify-content:space-between;align-items:center;width:calc(100% + 32px);display:flex;position:absolute;bottom:-12px}.artplayer-plugin-danmuku .apd-slider .apd-slider-steps .apd-slider-step{text-align:center;flex-shrink:0;width:36px;scale:.95}.artplayer-plugin-danmuku .apd-config-other{align-items:center;gap:20px;display:flex}.artplayer-plugin-danmuku .apd-config-other .apd-check-off,.artplayer-plugin-danmuku .apd-config-other .apd-check-on{width:16px;height:16px}.artplayer-plugin-danmuku .apd-config-other .apd-other{cursor:pointer;align-items:center;gap:2px;display:flex}.artplayer-plugin-danmuku .apd-config-other .apd-other:hover{color:#00a1d6}.artplayer-plugin-danmuku .apd-emitter{background-color:#ffffff40;border-radius:5px;flex:1;align-items:center;height:100%;display:flex}.artplayer-plugin-danmuku .apd-style{justify-content:center;align-items:center;display:flex;position:relative}.artplayer-plugin-danmuku .apd-style .apd-style-panel{opacity:0;pointer-events:none;width:200px;padding:10px;position:absolute;bottom:24px;left:0}.artplayer-plugin-danmuku .apd-style .apd-style-panel .apd-style-panel-inner{background-color:#000000d9;border-radius:3px;width:100%;padding:10px}.artplayer-plugin-danmuku .apd-style:hover .apd-style-panel{opacity:100;pointer-events:all}.artplayer-plugin-danmuku .apd-colors{flex-wrap:wrap;gap:8px;margin-top:5px;display:flex}.artplayer-plugin-danmuku .apd-colors .apd-color{cursor:pointer;border-radius:2px;width:16px;height:16px}.artplayer-plugin-danmuku .apd-colors .apd-color.apd-active{border:1px solid #000;box-shadow:0 0 0 1px #fff}.artplayer-plugin-danmuku .apd-input{color:#fff;background-color:#0000;border:none;outline:none;flex:1;width:auto;min-width:0;height:100%;line-height:1}.artplayer-plugin-danmuku .apd-input::placeholder{color:#ffffff80}.artplayer-plugin-danmuku .apd-send{cursor:pointer;text-shadow:none;background-color:#00a1d6;border-top-right-radius:5px;border-bottom-right-radius:5px;flex-shrink:0;justify-content:center;align-items:center;width:60px;height:100%;display:flex}.artplayer-plugin-danmuku .apd-send.apd-lock{cursor:not-allowed;color:#666;background-color:#e7e7e7}.art-controls-center .apd-emitter{flex:none;width:260px}.art-fullscreen .artplayer-plugin-danmuku,.art-fullscreen-web .artplayer-plugin-danmuku{gap:16px;height:38px}.art-fullscreen .artplayer-plugin-danmuku .apd-config-icon,.art-fullscreen-web .artplayer-plugin-danmuku .apd-config-icon,.art-fullscreen .artplayer-plugin-danmuku .apd-toggle-off,.art-fullscreen-web .artplayer-plugin-danmuku .apd-toggle-off,.art-fullscreen .artplayer-plugin-danmuku .apd-toggle-on,.art-fullscreen-web .artplayer-plugin-danmuku .apd-toggle-on{width:28px;height:28px}.art-fullscreen .artplayer-plugin-danmuku .apd-emitter,.art-fullscreen-web .artplayer-plugin-danmuku .apd-emitter{flex:none;width:400px}.art-video-player>.artplayer-plugin-danmuku{padding:0 10px;position:absolute;bottom:-40px;left:0;right:0}.art-video-player:has(>.artplayer-plugin-danmuku){margin-bottom:40px}[data-danmuku-emitter=false] .apd-emitter{display:none!important}[data-danmuku-emitter=false] .art-controls-center .artplayer-plugin-danmuku{justify-content:flex-end;gap:18px}[data-danmuku-emitter=false].art-fullscreen .art-controls-center .artplayer-plugin-danmuku,[data-danmuku-emitter=false].art-fullscreen-web .art-controls-center .artplayer-plugin-danmuku{gap:24px}[data-danmuku-theme=light]>.artplayer-plugin-danmuku .apd-icon{fill:#333}[data-danmuku-theme=light]>.artplayer-plugin-danmuku .apd-emitter{background-color:#f1f2f3}[data-danmuku-theme=light]>.artplayer-plugin-danmuku .apd-input{color:#000}[data-danmuku-theme=light]>.artplayer-plugin-danmuku .apd-input::placeholder{color:#0000004d}[data-danmuku-visible=false] .apd-toggle-off{display:block}[data-danmuku-visible=false] .apd-toggle-on,[data-danmuku-visible=true] .apd-toggle-off{display:none}[data-danmuku-visible=true] .apd-toggle-on{display:block}[data-danmuku-anti-overlap=false] .apd-anti-overlap .apd-check-on{display:none}[data-danmuku-anti-overlap=false] .apd-anti-overlap .apd-check-off,[data-danmuku-anti-overlap=true] .apd-anti-overlap .apd-check-on{display:block}[data-danmuku-anti-overlap=true] .apd-anti-overlap .apd-check-off,[data-danmuku-sync-video=false] .apd-sync-video .apd-check-on{display:none}[data-danmuku-sync-video=false] .apd-sync-video .apd-check-off,[data-danmuku-sync-video=true] .apd-sync-video .apd-check-on{display:block}[data-danmuku-sync-video=true] .apd-sync-video .apd-check-off{display:none}[data-danmuku-mode0=false] .apd-config-mode .apd-mode-0-off{display:block}[data-danmuku-mode0=false] .apd-config-mode .apd-mode-0-on{display:none}[data-danmuku-mode0=false] .art-danmuku [data-mode="0"]{opacity:0!important}[data-danmuku-mode0=true] .apd-config-mode .apd-mode-0-off{display:none}[data-danmuku-mode0=true] .apd-config-mode .apd-mode-0-on{display:block}[data-danmuku-mode="0"] .apd-style-mode [data-mode="0"]{color:#00a1d6}[data-danmuku-mode="0"] .apd-style-mode [data-mode="0"] path{fill:#00a1d6}[data-danmuku-mode1=false] .apd-config-mode .apd-mode-1-off{display:block}[data-danmuku-mode1=false] .apd-config-mode .apd-mode-1-on{display:none}[data-danmuku-mode1=false] .art-danmuku [data-mode="1"]{opacity:0!important}[data-danmuku-mode1=true] .apd-config-mode .apd-mode-1-off{display:none}[data-danmuku-mode1=true] .apd-config-mode .apd-mode-1-on{display:block}[data-danmuku-mode="1"] .apd-style-mode [data-mode="1"]{color:#00a1d6}[data-danmuku-mode="1"] .apd-style-mode [data-mode="1"] path{fill:#00a1d6}[data-danmuku-mode2=false] .apd-config-mode .apd-mode-2-off{display:block}[data-danmuku-mode2=false] .apd-config-mode .apd-mode-2-on{display:none}[data-danmuku-mode2=false] .art-danmuku [data-mode="2"]{opacity:0!important}[data-danmuku-mode2=true] .apd-config-mode .apd-mode-2-off{display:none}[data-danmuku-mode2=true] .apd-config-mode .apd-mode-2-on{display:block}[data-danmuku-mode="2"] .apd-style-mode [data-mode="2"]{color:#00a1d6}[data-danmuku-mode="2"] .apd-style-mode [data-mode="2"] path{fill:#00a1d6}'},{}],"9pjcf":[function(R,J,w){J.exports='<svg class="apd-icon apd-toggle-on" xmlns="http://www.w3.org/2000/svg" data-pointer="none" viewBox="0 0 24 24" width="24" height="24"><path fill-rule="evenodd" d="M11.989 4.828c-.47 0-.975.004-1.515.012l-1.71-2.566a1.008 1.008 0 0 0-1.678 1.118l.999 1.5c-.681.018-1.403.04-2.164.068a4.013 4.013 0 0 0-3.83 3.44c-.165 1.15-.245 2.545-.245 4.185 0 1.965.115 3.67.35 5.116a4.012 4.012 0 0 0 3.763 3.363l.906.046c1.205.063 1.808.095 3.607.095a.988.988 0 0 0 0-1.975c-1.758 0-2.339-.03-3.501-.092l-.915-.047a2.037 2.037 0 0 1-1.91-1.708c-.216-1.324-.325-2.924-.325-4.798 0-1.563.076-2.864.225-3.904.14-.977.96-1.713 1.945-1.747 2.444-.087 4.465-.13 6.063-.131 1.598 0 3.62.044 6.064.13.96.034 1.71.81 1.855 1.814.075.524.113 1.962.141 3.065v.002c.01.342.017.65.025.88a.987.987 0 1 0 1.974-.068c-.008-.226-.016-.523-.025-.856v-.027c-.03-1.118-.073-2.663-.16-3.276-.273-1.906-1.783-3.438-3.74-3.507-.9-.032-1.743-.058-2.531-.078l1.05-1.46a1.008 1.008 0 0 0-1.638-1.177l-1.862 2.59c-.38-.004-.744-.007-1.088-.007h-.13Zm.521 4.775h-1.32v4.631h2.222v.847h-2.618v1.078h2.618l.003.678c.36.026.714.163 1.01.407h.11v-1.085h2.694v-1.078h-2.695v-.847H16.8v-4.63h-1.276a8.59 8.59 0 0 0 .748-1.42L15.183 7.8a14.232 14.232 0 0 1-.814 1.804h-1.518l.693-.308a8.862 8.862 0 0 0-.814-1.408l-1.045.352c.297.396.572.847.825 1.364Zm-4.18 3.564.154-1.485h1.98V8.294h-3.2v.98H9.33v1.43H7.472l-.308 3.453h2.277c0 1.166-.044 1.925-.12 2.277-.078.352-.386.528-.936.528-.308 0-.616-.022-.902-.055l.297 1.067.062.005c.285.02.551.04.818.04 1.001-.067 1.562-.419 1.694-1.057.11-.638.176-1.903.176-3.795h-2.2Zm7.458.11v-.858h-1.254v.858h1.254Zm-2.376-.858v.858h-1.199v-.858h1.2Zm-1.199-.946h1.2v-.902h-1.2v.902Zm2.321 0v-.902h1.254v.902h-1.254Z" clip-rule="evenodd"/><path fill="#00AEEC" fill-rule="evenodd" d="M22.846 14.627a1 1 0 0 0-1.412.075l-5.091 5.703-2.216-2.275-.097-.086-.008-.005a1 1 0 0 0-1.322 1.493l2.963 3.041.093.083.007.005a1 1 0 0 0 1.354-.124l5.81-6.505.08-.102.005-.008a1 1 0 0 0-.166-1.295Z" clip-rule="evenodd"/></svg>'},{}],b2dkP:[function(R,J,w){J.exports='<svg class="apd-icon apd-toggle-off" xmlns="http://www.w3.org/2000/svg" data-pointer="none" viewBox="0 0 24 24" width="24" height="24"><path fill-rule="evenodd" d="m8.085 4.891-.999-1.499a1.008 1.008 0 0 1 1.679-1.118l1.709 2.566c.54-.008 1.045-.012 1.515-.012h.13c.345 0 .707.003 1.088.007l1.862-2.59a1.008 1.008 0 0 1 1.637 1.177l-1.049 1.46c.788.02 1.631.046 2.53.078 1.958.069 3.468 1.6 3.74 3.507.088.613.13 2.158.16 3.276l.001.027c.01.333.017.63.025.856a.987.987 0 0 1-1.974.069c-.008-.23-.016-.539-.025-.881v-.002c-.028-1.103-.066-2.541-.142-3.065-.143-1.004-.895-1.78-1.854-1.813a179.14 179.14 0 0 0-6.064-.131c-1.598 0-3.619.044-6.063.13a2.037 2.037 0 0 0-1.945 1.748c-.15 1.04-.225 2.341-.225 3.904 0 1.874.11 3.474.325 4.798.154.949.95 1.66 1.91 1.708a97.58 97.58 0 0 0 5.416.139.988.988 0 0 1 0 1.975 99.78 99.78 0 0 1-5.513-.141A4.012 4.012 0 0 1 2.197 17.7c-.236-1.446-.351-3.151-.351-5.116 0-1.64.08-3.035.245-4.184A4.013 4.013 0 0 1 5.92 4.96c.761-.027 1.483-.05 2.164-.069Zm4.436 4.707h-1.32v4.63h2.222v.848h-2.618v1.078h2.431a5.01 5.01 0 0 1 3.575-3.115V9.598h-1.276a8.59 8.59 0 0 0 .748-1.42l-1.089-.384a14.232 14.232 0 0 1-.814 1.804h-1.518l.693-.308a8.862 8.862 0 0 0-.814-1.408l-1.045.352c.297.396.572.847.825 1.364Zm-4.18 3.564.154-1.485h1.98V8.289h-3.2v.979h2.067v1.43H7.483l-.308 3.454h2.277c0 1.166-.044 1.925-.12 2.277-.078.352-.386.528-.936.528-.308 0-.616-.022-.902-.055l.297 1.067.062.004c.285.02.551.04.818.04 1.001-.066 1.562-.418 1.694-1.056.11-.638.176-1.903.176-3.795h-2.2Zm7.458.11v-.858h-1.254v.858H15.8Zm-2.376-.858v.858h-1.199v-.858h1.2Zm-1.199-.946h1.2v-.902h-1.2v.902Zm2.321 0v-.902H15.8v.902h-1.254Zm3.517 10.594a4 4 0 1 0 0-8 4 4 0 0 0 0 8Zm-.002-1.502a2.5 2.5 0 0 1-2.217-3.657l3.326 3.398a2.49 2.49 0 0 1-1.109.259Zm2.5-2.5c0 .42-.103.815-.286 1.162l-3.328-3.401a2.5 2.5 0 0 1 3.614 2.239Z" clip-rule="evenodd"/></svg>'},{}],l8tyy:[function(R,J,w){J.exports='<svg class="apd-icon apd-config-icon" xmlns="http://www.w3.org/2000/svg" data-pointer="none" viewBox="0 0 24 24" width="24" height="24"><path fill-rule="evenodd" d="m15.645 4.881 1.06-1.473a.998.998 0 1 0-1.622-1.166L13.22 4.835a110.67 110.67 0 0 0-1.1-.007h-.131c-.47 0-.975.004-1.515.012L8.783 2.3A.998.998 0 0 0 7.12 3.408l.988 1.484c-.688.019-1.418.042-2.188.069a4.013 4.013 0 0 0-3.83 3.44c-.165 1.15-.245 2.545-.245 4.185 0 1.965.115 3.67.35 5.116a4.012 4.012 0 0 0 3.763 3.363 99.78 99.78 0 0 0 5.513.141.988.988 0 0 0 0-1.975 97.58 97.58 0 0 1-5.416-.139 2.037 2.037 0 0 1-1.91-1.708c-.216-1.324-.325-2.924-.325-4.798 0-1.563.076-2.864.225-3.904.14-.977.96-1.713 1.945-1.747 2.444-.087 4.465-.13 6.063-.131 1.598 0 3.62.044 6.064.13.96.034 1.71.81 1.855 1.814.075.524.113 1.962.141 3.065v.002c.005.183.01.07.014-.038.004-.096.008-.189.011-.081a.987.987 0 1 0 1.974-.069c-.004-.105-.007-.009-.011.09a2.175 2.175 0 0 1-.007.135l-.002.01a.574.574 0 0 1-.005-.091v-.027c-.03-1.118-.073-2.663-.16-3.276-.273-1.906-1.783-3.438-3.74-3.507-.905-.032-1.752-.058-2.543-.079Zm-3.113 4.703h-1.307v4.643h2.2v.04l.651-1.234c.113-.215.281-.389.482-.509v-.11h.235c.137-.049.283-.074.433-.074h1.553V9.584h-1.264a8.5 8.5 0 0 0 .741-1.405l-1.078-.381c-.24.631-.501 1.23-.806 1.786h-1.503l.686-.305a8.613 8.613 0 0 0-.806-1.394l-1.034.348c.294.392.566.839.817 1.35Zm-1.7 5.502h2.16l-.564 1.068h-1.595v-1.068Zm-2.498-1.863.152-1.561h1.96V8.289H7.277v.969h2.048v1.435h-1.84l-.306 3.51h2.254c0 1.155-.043 1.906-.12 2.255-.076.348-.38.523-.925.523-.305 0-.61-.022-.893-.055l.294 1.056.061.005c.282.02.546.039.81.039.991-.065 1.547-.414 1.677-1.046.11-.631.175-1.883.175-3.757H8.334Zm5.09-.8v.85h-1.188v-.85h1.187Zm-1.188-.955h1.187v-.893h-1.187v.893Zm2.322.007v-.893h1.241v.893h-1.241Zm.528 2.757a1.26 1.26 0 0 1 1.087-.627l4.003-.009a1.26 1.26 0 0 1 1.094.63l1.721 2.982c.226.39.225.872-.001 1.263l-1.743 3a1.26 1.26 0 0 1-1.086.628l-4.003.009a1.26 1.26 0 0 1-1.094-.63l-1.722-2.982a1.26 1.26 0 0 1 .002-1.263l1.742-3Zm1.967.858a1.26 1.26 0 0 0-1.08.614l-.903 1.513a1.26 1.26 0 0 0-.002 1.289l.885 1.492c.227.384.64.62 1.086.618l2.192-.005a1.26 1.26 0 0 0 1.08-.615l.904-1.518a1.26 1.26 0 0 0 .001-1.288l-.884-1.489a1.26 1.26 0 0 0-1.086-.616l-2.193.005Zm2.517 2.76a1.4 1.4 0 1 1-2.8 0 1.4 1.4 0 0 1 2.8 0Z" clip-rule="evenodd"/></svg>'},{}],"5iZC3":[function(R,J,w){J.exports='<svg class="apd-icon apd-style-icon" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" data-pointer="none" style="enable-background:new 0 0 22 22" viewBox="0 0 22 22" width="36" height="24"><path d="M17 16H5c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1zM6.96 15c.39 0 .74-.24.89-.6l.65-1.6h5l.66 1.6c.15.36.5.6.89.6.69 0 1.15-.71.88-1.34l-3.88-8.97C11.87 4.27 11.46 4 11 4s-.87.27-1.05.69l-3.88 8.97c-.27.63.2 1.34.89 1.34zM11 5.98 12.87 11H9.13L11 5.98z"/></svg>'},{}],i0Vut:[function(R,J,w){J.exports='<svg class="apd-icon apd-mode-0-off" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" data-pointer="none" style="enable-background:new 0 0 28 28" viewBox="0 0 28 28" width="28" height="28"><path d="M23 15c1.487 0 2.866.464 4 1.255V7a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h11.674A7 7 0 0 1 23 15zM11 9h6a1 1 0 0 1 0 2h-6a1 1 0 0 1 0-2zm-3 2H6V9h2v2zm4 4h-2v-2h2v2zm2-1a1 1 0 0 1 1-1h1a1 1 0 0 1 0 2h-1a1 1 0 0 1-1-1z" fill="#00AEEC"/><path d="M26.536 18.464a5 5 0 0 0-7.071 0 5 5 0 0 0 0 7.071 5 5 0 1 0 7.071-7.071zm-5.657 5.657a3 3 0 0 1-.586-3.415l4.001 4.001a3 3 0 0 1-3.415-.586zm4.829-.827-4.001-4.001a3.002 3.002 0 0 1 4.001 4.001z" fill="#00AEEC"/></svg>'},{}],hOSvZ:[function(R,J,w){J.exports='<svg class="apd-icon apd-mode-0-on" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" data-pointer="none" style="enable-background:new 0 0 28 28" viewBox="0 0 28 28" width="28" height="28"><path d="M23 3H5a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h18a4 4 0 0 0 4-4V7a4 4 0 0 0-4-4zM11 9h6a1 1 0 0 1 0 2h-6a1 1 0 0 1 0-2zm-3 2H6V9h2v2zm4 4h-2v-2h2v2zm9 0h-6a1 1 0 0 1 0-2h6a1 1 0 0 1 0 2z" fill="#FFF"/></svg>'},{}],bOXC3:[function(R,J,w){J.exports='<svg class="apd-icon apd-mode-1-off" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" data-pointer="none" style="enable-background:new 0 0 28 28" viewBox="0 0 28 28" width="28" height="28"><path d="M23 15c1.487 0 2.866.464 4 1.255V7a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h11.674A7 7 0 0 1 23 15zm-4-8h2v2h-2V7zM9 9H7V7h2v2zm4 0h-2V7h2v2zm2-2h2v2h-2V7z" fill="#00AEEC"/><path d="M26.536 18.464a5 5 0 0 0-7.071 0 5 5 0 0 0 0 7.071 5 5 0 1 0 7.071-7.071zm-5.657 5.657a3 3 0 0 1-.586-3.415l4.001 4.001a3 3 0 0 1-3.415-.586zm4.829-.827-4.001-4.001a3.002 3.002 0 0 1 4.001 4.001z" fill="#00AEEC"/></svg>'},{}],lKuh0:[function(R,J,w){J.exports='<svg class="apd-icon apd-mode-1-on" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" data-pointer="none" style="enable-background:new 0 0 28 28" viewBox="0 0 28 28" width="28" height="28"><path d="M23 3H5a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h18a4 4 0 0 0 4-4V7a4 4 0 0 0-4-4zM9 9H7V7h2v2zm4 0h-2V7h2v2zm4 0h-2V7h2v2zm4 0h-2V7h2v2z" fill="#FFF"/></svg>'},{}],eB8W6:[function(R,J,w){J.exports='<svg class="apd-icon apd-mode-2-off" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" data-pointer="none" style="enable-background:new 0 0 28 28" viewBox="0 0 28 28" width="28" height="28"><path d="M23 15c1.487 0 2.866.464 4 1.255V7a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h11.674A7 7 0 0 1 23 15zM9 21H7v-2h2v2zm4 0h-2v-2h2v2z" fill="#00AEEC"/><path d="M26.536 18.464a5 5 0 0 0-7.071 0 5 5 0 0 0 0 7.071 5 5 0 1 0 7.071-7.071zm-5.657 5.657a3 3 0 0 1-.586-3.415l4.001 4.001a3 3 0 0 1-3.415-.586zm4.829-.827-4.001-4.001a3.002 3.002 0 0 1 4.001 4.001z" fill="#00AEEC"/></svg>'},{}],bpe2E:[function(R,J,w){J.exports='<svg class="apd-icon apd-mode-2-on" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" data-pointer="none" style="enable-background:new 0 0 28 28" viewBox="0 0 28 28" width="28" height="28"><path d="M23 3H5a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h18a4 4 0 0 0 4-4V7a4 4 0 0 0-4-4zM9 21H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2z" fill="#FFF"/></svg>'},{}],kL9zy:[function(R,J,w){J.exports='<svg class="apd-icon apd-check-on" xmlns="http://www.w3.org/2000/svg" data-pointer="none" viewBox="0 0 32 32" width="32" height="32"><path d="m13 18.25-1.8-1.8c-.6-.6-1.65-.6-2.25 0s-.6 1.5 0 2.25l2.85 2.85c.318.318.762.468 1.2.448.438.02.882-.13 1.2-.448l8.85-8.85c.6-.6.6-1.65 0-2.25s-1.65-.6-2.25 0l-7.8 7.8zM8 4h16c2.21 0 4 1.79 4 4v16c0 2.21-1.79 4-4 4H8c-2.21 0-4-1.79-4-4V8c0-2.21 1.79-4 4-4z" fill="#00AEEC"/></svg>'},{}],"22xpM":[function(R,J,w){J.exports='<svg class="apd-icon apd-check-off" xmlns="http://www.w3.org/2000/svg" data-pointer="none" viewBox="0 0 32 32" width="32" height="32"><path d="M8 6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2H8zm0-2h16c2.21 0 4 1.79 4 4v16c0 2.21-1.79 4-4 4H8c-2.21 0-4-1.79-4-4V8c0-2.21 1.79-4 4-4z" fill="#FFF"/></svg>'},{}],"8AxLD":[function(R,J,w){var Q=R("@parcel/transformer-js/src/esmodule-helpers.js");Q.defineInteropFlag(w),Q.export(w,"default",()=>D);let g={map:(m,y,_,b,E)=>(m-y)*(E-b)/(_-y)+b,range(m,y,_){let b=Math.round(m/_)*_;return Array.from({length:Math.floor((y-m)/_)},(E,L)=>L*_+b)}},p=(m,y)=>{let _=y[0]-m[0],b=y[1]-m[1];return{length:Math.sqrt(Math.pow(_,2)+Math.pow(b,2)),angle:Math.atan2(b,_)}};function D(m,y,_){let{query:b}=m.constructor.utils;m.controls.add({name:"heatmap",position:"top",html:"",style:{position:"absolute",top:"-100px",left:"0px",right:"0px",height:"100px",width:"100%",pointerEvents:"none"},mounted(E){let L=null,I=null;function z(j=[]){if(L=null,I=null,E.innerHTML="",!m.duration||m.option.isLive)return;let W={w:E.offsetWidth,h:E.offsetHeight},oe={xMin:0,xMax:W.w,yMin:0,yMax:128,scale:.25,opacity:.2,minHeight:Math.floor(.05*W.h),sampling:Math.floor(W.w/100),smoothing:.2,flattening:.2};typeof _=="object"&&Object.assign(oe,_);let F=[];if(Array.isArray(j)&&j.length)F=[...j];else{let K=m.duration/W.w;for(let k=0;k<=W.w;k+=oe.sampling){let de=y.queue.filter(({time:ie})=>ie>k*K&&ie<=(k+oe.sampling)*K).length;F.push([k,de])}}if(F.length===0)return;let ee=F[F.length-1],fe=ee[0],ae=ee[1];fe!==W.w&&F.push([W.w,ae]);let B=F.map(K=>K[1]),x=(Math.min(...B)+Math.max(...B))/2;for(let K=0;K<F.length;K++){let k=F[K],de=k[1];k[1]=de*(de>x?1+oe.scale:1-oe.scale)+oe.minHeight}let N=(K,k,de,ie)=>{let ve=p(k||K,de||K),_e=g.map(Math.cos(ve.angle)*oe.flattening,0,1,1,0),q=ve.angle*_e+(ie?Math.PI:0),H=ve.length*oe.smoothing;return[K[0]+Math.cos(q)*H,K[1]+Math.sin(q)*H]},Y=(K,k,de)=>{let ie=N(de[k-1],de[k-2],K),ve=N(K,de[k-1],de[k+1],!0),_e=k===de.length-1?" z":"";return"C ".concat(ie[0],",").concat(ie[1]," ").concat(ve[0],",").concat(ve[1]," ").concat(K[0],",").concat(K[1]).concat(_e)},re=F.map(K=>[g.map(K[0],oe.xMin,oe.xMax,0,W.w),g.map(K[1],oe.yMin,oe.yMax,W.h,0)]).reduce((K,k,de,ie)=>de===0?"M ".concat(ie[ie.length-1][0],",").concat(W.h," L ").concat(k[0],",").concat(W.h," L ").concat(k[0],",").concat(k[1]):"".concat(K," ").concat(Y(k,de,ie)),"");E.innerHTML='<svg viewBox="0 0 '.concat(W.w," ").concat(W.h,'"><defs><linearGradient id="heatmap-solids" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:var(--art-theme);stop-opacity:').concat(oe.opacity,'" /><stop offset="0%" style="stop-color:var(--art-theme);stop-opacity:').concat(oe.opacity,'" id="heatmap-start" /><stop offset="0%" style="stop-color:var(--art-progress-color);stop-opacity:1" id="heatmap-stop" /><stop offset="100%" style="stop-color:var(--art-progress-color);stop-opacity:1" /></linearGradient></defs><path fill="url(#heatmap-solids)" d="').concat(re,'"></path></svg>'),L=b("#heatmap-start",E),I=b("#heatmap-stop",E),L.setAttribute("offset","".concat(100*m.played,"%")),I.setAttribute("offset","".concat(100*m.played,"%"))}m.on("video:timeupdate",()=>{L&&I&&(L.setAttribute("offset","".concat(100*m.played,"%")),I.setAttribute("offset","".concat(100*m.played,"%")))}),m.on("setBar",(j,W)=>{L&&I&&j==="played"&&(L.setAttribute("offset","".concat(100*W,"%")),I.setAttribute("offset","".concat(100*W,"%")))}),m.on("ready",()=>z()),m.on("resize",()=>z()),m.on("artplayerPluginDanmuku:loaded",()=>z()),m.on("artplayerPluginDanmuku:points",j=>z(j))}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"9pCYc"}]},["bgm6t"],"bgm6t","parcelRequire4dc0")})(aa,aa.exports);var ko=aa.exports;const Ro=na(ko),Do={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Mo(vi,ii){return Fr(),Br("svg",Do,ii[0]||(ii[0]=[zt("path",{fill:"currentColor",d:"M5.5 18V6h2v12zm13 0l-9-6l9-6z"},null,-1)]))}const Io={name:"material-symbols-skip-previous",render:Mo},Co={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Oo(vi,ii){return Fr(),Br("svg",Co,ii[0]||(ii[0]=[zt("path",{fill:"currentColor",d:"M16.5 18V6h2v12zm-11 0V6l9 6z"},null,-1)]))}const Po={name:"material-symbols-skip-next",render:Oo};const No={key:0,class:"zfile-video-switch-tools"},Fo={__name:"VideoPlayer",setup(vi){io();let ii=uo(),R=co();ro();let J='<i class="art-icon art-icon-hidden"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path d="m16.1 13.3l-1.45-1.45q.225-1.175-.675-2.2t-2.325-.8L10.2 7.4q.425-.2.863-.3T12 7q1.875 0 3.188 1.313T16.5 11.5q0 .5-.1.938t-.3.862Zm3.2 3.15l-1.45-1.4q.95-.725 1.688-1.587T20.8 11.5q-1.25-2.525-3.588-4.013T12 6q-.725 0-1.425.1T9.2 6.4L7.65 4.85q1.025-.425 2.1-.638T12 4q3.775 0 6.725 2.087T23 11.5q-.575 1.475-1.513 2.738T19.3 16.45Zm.5 6.15l-4.2-4.15q-.875.275-1.762.413T12 19q-3.775 0-6.725-2.087T1 11.5q.525-1.325 1.325-2.463T4.15 7L1.4 4.2l1.4-1.4l18.4 18.4l-1.4 1.4ZM5.55 8.4q-.725.65-1.325 1.425T3.2 11.5q1.25 2.525 3.588 4.013T12 17q.5 0 .975-.063t.975-.137l-.9-.95q-.275.075-.525.113T12 16q-1.875 0-3.188-1.312T7.5 11.5q0-.275.038-.525t.112-.525L5.55 8.4Zm7.975 2.325ZM9.75 12.6Z"/></svg></i>',w='<i class="art-icon art-icon-not-hidden"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path d="M12 16q1.875 0 3.188-1.313T16.5 11.5q0-1.875-1.313-3.188T12 7q-1.875 0-3.188 1.313T7.5 11.5q0 1.875 1.313 3.188T12 16Zm0-1.8q-1.125 0-1.913-.788T9.3 11.5q0-1.125.788-1.913T12 8.8q1.125 0 1.913.788T14.7 11.5q0 1.125-.787 1.913T12 14.2Zm0 4.8q-3.65 0-6.65-2.038T1 11.5q1.35-3.425 4.35-5.463T12 4q3.65 0 6.65 2.038T23 11.5q-1.35 3.425-4.35 5.463T12 19Zm0-7.5Zm0 5.5q2.825 0 5.188-1.488T20.8 11.5q-1.25-2.525-3.613-4.013T12 6Q9.175 6 6.812 7.488T3.2 11.5q1.25 2.525 3.613 4.013T12 17Z"/></svg></i>',Q='<i class="art-icon art-icon-video-list"><svg t="1650551038453" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12028" width="20" height="20"><path d="M111.395066 179.64038l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12029"></path><path d="M111.395066 468.067418l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12030"></path><path d="M111.395066 756.493433l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12031"></path></svg></i>',g='<i class="art-icon art-icon-subtitle"><svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 48 48">\n    <path d="M0 0h48v48H0z" fill="none"></path>\n    <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>\n</svg></i>',p='<i class="art-icon art-icon-prev-video"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg></i>',D='<i class="art-icon art-icon-next-video"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg></i>';const m=ka("zfile-video-auto-player-next",!1),y=ka("zfile-video-auto-player",!1),_=ka("zfile-video-hiddle-tools",!1);let b=null,E=null,L=ao(null);const I=async(B,x)=>{L.value={name:B,url:x},document.querySelector(".zfile-video-player-dialog .z-dialog-title").innerHTML=B,b&&b.destroy();let N="mp4";B.toLowerCase().endsWith("flv")?N="flv":B.toLowerCase().endsWith("m3u8")&&(N="m3u8");let Y={container:".artplayer-app",title:B,url:L.value.url,type:N,setting:!0,playbackRate:!0,flip:!0,fullscreen:!0,fastForward:!0,autoOrientation:!0,aspectRatio:!0,fullscreenWeb:!0,theme:"#23ade5",lock:!0,subtitleOffset:!0,miniProgressBar:!0,autoplay:y.value,whitelist:["*"],airplay:!0,moreVideoAttr:{"x5-video-player-type":"h5","x5-video-player-fullscreen":!1,"x5-video-orientation":"portraint",preload:"metadata",crossOrigin:"anonymous"},customType:{flv:function(k,de){if(Yn.isSupported()){const ie=Yn.createPlayer({type:"flv",url:de});ie.attachMediaElement(k),ie.load()}else b.notice.show="不支持播放格式：flv"},m3u8:function(k,de){if($n.isSupported())E=new $n({xhrSetup:(ie,ve)=>{let _e=ho(ve);if(ve!==de){let q=ii.getFileUrlByName(_e);q?ie.open("GET",q,!0):ie.open("GET",ve,!0)}}}),E.loadSource(de),E.attachMedia(k);else{const ie=k.canPlayType("application/vnd.apple.mpegurl");ie==="probably"||ie=="maybe"?k.src=de:b.notice.show="不支持播放格式：m3u8"}}},contextmenu:R.folderConfig.permission.download?[{html:"下载",click:function(){window.open(x)}}]:[],settings:[{html:"自动播放",tooltip:y.value?"开启":"关闭",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:y.value,onSwitch:function(k,de,ie){const ve=!k.switch;return y.value=ve,b.autoplay=ve,k.tooltip=ve?"开启":"关闭",ve}},{html:"自动播放下一个视频",tooltip:m.value?"开启":"关闭",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:m.value,onSwitch:function(k,de,ie){const ve=!k.switch;return m.value=ve,k.tooltip=ve?"开启":"关闭",ve}}],controls:[{name:"video-list",position:"right",html:Q,selector:z(B),onSelect:function(k,de){return I(k.html,k.url),Q}}],plugins:[]},re=F(B);re&&Y.plugins.push(Ro({danmuku:re})),Ra.value===!1&&Y.controls.push({position:"right",html:_.value?J:w,click:function(k,de){_.value=!_.value,de.target.parentNode.parentNode.innerHTML=_.value?J:w}});let K=oe(B);K.length>0&&K.length>1&&Y.controls.push({name:"video-subtitle",position:"right",html:g,selector:K,onSelect:k=>(k.html==="关闭字幕"?b.subtitle.show=!1:(b.subtitle.show=!0,b.subtitle.url=k.url),g)}),b=new xo(Y),b.on("destory",()=>{}),Ra.value===!1&&b.on("ready",()=>{let k=ee(b.option.title);k!=null&&k.prev&&b.controls.add({name:"prev-video",position:"left",index:5,tooltip:"播放上一个",html:D,click:()=>{ae()}}),k!=null&&k.next&&b.controls.add({name:"next-video",position:"left",index:15,tooltip:"播放下一个",html:p,click:()=>{fe()}})}),b.on("video:ended",()=>{m.value&&fe()}),K.length>0&&(b.subtitle.url=K[0].url)},z=B=>{let x=[];return ii.filterFileByType("video").forEach(N=>{x.push({default:N.name===B,html:N.name,url:N.url})}),x},j=B=>{switch(B){case"download":window.location=L.value.url;break;case"thunder":window.location="thunder://".concat(btoa("AA"+L.value.url+"ZZ"));break;case"motrix":window.location="motrix://new-task?uri=".concat(encodeURIComponent(L.value.url),"&out=").concat(encodeURIComponent(L.value.name));break;case"potplayer":window.location="potplayer://".concat(L.value.url);break;case"iina":window.location="iina://weblink?url=".concat(encodeURIComponent(L.value.url));break;case"vlc":window.location="vlc://".concat(L.value.url);break;case"nplayer":window.location="nplayer-".concat(L.value.url);break;case"mxplayer":window.location="intent:"+L.value.url+"#Intent;package=com.mxtech.videoplayer.ad;S.title="+L.value.name+";end";break;case"mxplayer-pro":window.location="intent:"+L.value.url+"#Intent;package=com.mxtech.videoplayer.pro;S.title="+L.value.name+";end";break}},W=()=>{let B=JSON.parse(localStorage.getItem("_h5_player_play_progress_"));if(B){for(let x of Object.keys(B))x.endsWith(B[x].progress)&&delete B[x];localStorage.setItem("_h5_player_play_progress_",JSON.stringify(B))}},oe=B=>{let x=[];return ii.fileList.find(N=>{let Y=B.split(".")[0],re=N.name;(re===B+".vtt"||re===B+".srt"||re===B+".ass"||re===Y+".vtt"||re===Y+".srt"||re===Y+".ass")&&x.push({default:x.length===0,url:N.url,html:re})}),x.length>0&&x.push({url:"",html:"关闭字幕"}),x},F=B=>{let x=ii.fileList.find(N=>{let Y=B.split(".")[0],re=N.name;if(re===B+".xml"||re===Y+".xml")return!0});if(x)return x.url},ee=B=>{let x=ii.filterFileByType("video");W();for(let N=0;N<x.length;N++)if(x[N].name===B)return{prev:x[N-1]||null,next:x[N+1]||null}},fe=()=>{var x;const B=(x=ee(b.option.title))==null?void 0:x.next;B&&I(B.name,B.url)},ae=()=>{var x;const B=(x=ee(b.option.title))==null?void 0:x.prev;B&&I(B.name,B.url)};return no(()=>{I(ii.currentClickRow.name,ii.currentClickRow.url)}),so(()=>{b&&b.destroy(!0),E&&E.destroy()}),(B,x)=>{var re,K;const N=lo,Y=po;return Fr(),Br("div",null,[x[29]||(x[29]=zt("div",{class:"artplayer-app"},null,-1)),Gi(L)&&Gi(Ra)?(Fr(),Br("div",No,[ki(N,{disabled:!((re=ee(Gi(L).name))!=null&&re.prev),icon:Gi(Io),onClick:ae},{default:Qt(()=>x[9]||(x[9]=[Ri("上一个视频")])),_:1,__:[9]},8,["disabled","icon"]),ki(N,{disabled:!((K=ee(Gi(L).name))!=null&&K.next),icon:Gi(Po),onClick:fe},{default:Qt(()=>x[10]||(x[10]=[Ri("下一个视频")])),_:1,__:[10]},8,["disabled","icon"])])):zn("",!0),zt("div",{class:Hn(["zfile-video-tools",Gi(_)?"hidden-important":""])},[Gi(R).folderConfig.permission.download?(Fr(),Br(oo,{key:0},[zt("div",{class:"zfile-video-tools-item",onClick:x[0]||(x[0]=k=>j("download"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[11]||(x[11]=[Ri(" 直接下载 ")])),default:Qt(()=>[x[12]||(x[12]=zt("img",{src:mo,alt:"下载"},null,-1))]),_:1,__:[12]})]),zt("div",{class:"zfile-video-tools-item",onClick:x[1]||(x[1]=k=>j("thunder"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[13]||(x[13]=[Ri(" 使用迅雷下载 ")])),default:Qt(()=>[x[14]||(x[14]=zt("img",{src:go,alt:"迅雷"},null,-1))]),_:1,__:[14]})]),zt("div",{class:"zfile-video-tools-item",onClick:x[2]||(x[2]=k=>j("motrix"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[15]||(x[15]=[Ri(" 使用 motrix 下载 ")])),default:Qt(()=>[x[16]||(x[16]=zt("img",{src:vo,alt:"motrix"},null,-1))]),_:1,__:[16]})])],64)):zn("",!0),zt("div",{class:"zfile-video-tools-item",onClick:x[3]||(x[3]=k=>j("potplayer"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[17]||(x[17]=[Ri(" 使用 PotPlayer 播放 ")])),default:Qt(()=>[x[18]||(x[18]=zt("img",{src:_o,alt:"PotPlayer"},null,-1))]),_:1,__:[18]})]),zt("div",{class:"zfile-video-tools-item",onClick:x[4]||(x[4]=k=>j("iina"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[19]||(x[19]=[Ri(" 使用 IINA 播放 ")])),default:Qt(()=>[x[20]||(x[20]=zt("img",{src:yo,alt:"IINA"},null,-1))]),_:1,__:[20]})]),zt("div",{class:"zfile-video-tools-item",onClick:x[5]||(x[5]=k=>j("vlc"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[21]||(x[21]=[Ri(" 使用 VLC 播放 ")])),default:Qt(()=>[x[22]||(x[22]=zt("img",{src:bo,alt:"VLC"},null,-1))]),_:1,__:[22]})]),zt("div",{class:"zfile-video-tools-item",onClick:x[6]||(x[6]=k=>j("nplayer"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[23]||(x[23]=[Ri(" 使用 nPlayer 播放 ")])),default:Qt(()=>[x[24]||(x[24]=zt("img",{src:Eo,alt:"nPlayer"},null,-1))]),_:1,__:[24]})]),zt("div",{class:"zfile-video-tools-item",onClick:x[7]||(x[7]=k=>j("mxplayer"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[25]||(x[25]=[Ri(" 使用 MXPlayer(Free) 播放 ")])),default:Qt(()=>[x[26]||(x[26]=zt("img",{src:So,alt:"MXPlayer(Free)"},null,-1))]),_:1,__:[26]})]),zt("div",{class:"zfile-video-tools-item",onClick:x[8]||(x[8]=k=>j("mxplayer-pro"))},[ki(Y,{placement:"top"},{content:Qt(()=>x[27]||(x[27]=[Ri(" 使用 MXPlayer(Pro) 播放 ")])),default:Qt(()=>[x[28]||(x[28]=zt("img",{src:Ao,alt:"MXPlayer(Pro)"},null,-1))]),_:1,__:[28]})])],2),zt("div",{class:Hn(["zfile-video-tools-tips",Gi(_)?"hidden-important":""])}," tips: 可点击上方的软件图标进行下载播放, 本地播放器解码效果更佳. ",2)])}}},Fl=fo(Fo,[["__scopeId","data-v-d8adf65d"]]);export{Fl as default};
