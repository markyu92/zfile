import{r as y,a3 as q,Y as T,_ as G,o as A,b as w,g as L,k as e,w as s,x as a,a0 as i,f as o,$ as O,e as S,aj as W,l as Y}from"./index-008199ed.js";/* empty css                */import{_ as H,a as J}from"./el-table-column-plus-be255135.js";import{E as K}from"./button-30635c71.js";/* empty css            */import{E as P,a as Q}from"./select-275ec4c7.js";/* empty css                  *//* empty css               */import"./input-73d413ba.js";import{_ as X}from"./Cancel-b93a9a48.js";import{E as Z}from"./alert-f7baa744.js";import{k as ee,m as te,j as oe}from"./admin-storage-185041e5.js";import{i as ae}from"./base-00eb0fe9.js";import{E as le,b as se}from"./request-7014ab81.js";import{E as ie}from"./index-c0734d0a.js";import{b as B}from"./route-block-83d24a4e.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";import{r as x,a as ne,b as de}from"./FolderIcon-e4e9f716.js";import{r as me}from"./TrashIcon-6780b292.js";import{r as pe}from"./PlusIcon-76caf486.js";import{r as ce}from"./CheckBadgeIcon-af1628c6.js";import{v as ue}from"./directive-20abcd4b.js";import"./index-91840f01.js";import"./index-0da14aee.js";import"./index-4ea0a277.js";import"./index-60380bfa.js";import"./_initCloneObject-ffec0ace.js";import"./index-293710b7.js";import"./debounce-3f0c1a7c.js";import"./index-680901bf.js";import"./index-dc7d0be4.js";import"./strings-535b4609.js";import"./scroll-374ad3fb.js";import"./vnode-5e2fd68e.js";import"./admin-form-header-819a5389.js";import"./arrow-left-6c74187b.js";import"./index-8286893b.js";import"./validator-38288ad7.js";let r=y([]),h=y(!1);function _e(I,f){let n=f.params.storageId;const g=()=>{ee(n).then(d=>{r.value=d.data,r.value.length===0&&u()})},b=()=>{r.value.find(p=>{if(ae(p.expression))return le.warning("请检查数据填写是否完整"),!0})||(h.value=!0,te(n,r.value).then(()=>{ie.confirm("保存成功, 是否返回存储源列表？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success",callback:p=>{p==="confirm"&&I.push("/admin/storage-list")}})}).finally(()=>{h.value=!1}))},u=()=>{r.value.push({mode:"hidden",expression:"",storageId:n,description:"表达式 - "+r.value.length})};return{loading:h,loadData:g,list:r,addItem:u,deleteItem:d=>{r.value.splice(d,1)},saveData:b}}const fe={class:"zfile-admin-filter-body"},ge={class:"rules-tips-link"},be={target:"_blank",class:"link",href:"http://www.ruanyifeng.com/blog/2018/09/bash-wildcards.html"},ve={target:"_blank",class:"link",href:"http://www.ruanyifeng.com/blog/2018/09/bash-wildcards.html"},ke={target:"_blank",class:"link",href:"https://github.com/whinc/blog/issues/18"},we={class:"save-btn"},j={__name:"[storageId]",props:{storageId:{type:Number,required:!1}},setup(I){const f=q();let n=T(),g=G();const{loading:b,loadData:u,list:V,addItem:d,deleteItem:p,saveData:z}=_e(g,n);A(()=>{u(),D()});const E=y(),D=()=>{oe(n.params.storageId).then(_=>{_.data.type=_.data.type.key,E.value=_.data})};return(_,t)=>{var C;const U=Z,F=X,c=H,$=se,v=P,M=Q,k=K,N=J,R=ue;return w(),L("div",fe,[e(F,{to:"/admin/storage-list",title:"过滤文件（"+((C=o(E))==null?void 0:C.name)+"）"},{default:s(()=>[e(U,{closable:!1,type:"info"},{default:s(()=>[t[3]||(t[3]=a("div",{class:"rules-tips"},"Glob 表达式规则：",-1)),t[4]||(t[4]=a("div",{class:"rules-tips"},[a("b",null,"*"),i("：单级路径通配符，如表达式 "),a("span",{class:"select-all code"},"/*.jpg"),i(" 可以匹配根路径下所有的 jpg 后缀的文件")],-1)),t[5]||(t[5]=a("div",{class:"rules-tips"},[a("b",null,"**"),i("：多级路径通配符，如表达式 "),a("span",{class:"select-all code"},"/**.jpg"),i(" 可以匹配所有路径下的 jpg 后缀的文件")],-1)),a("div",ge,[a("a",be,[e(o(x),{class:"inline mr-1"}),t[0]||(t[0]=a("span",null,"参考文章 (Wikipedia)",-1))]),a("a",ve,[e(o(x),{class:"inline mr-1"}),t[1]||(t[1]=i("参考文章 (阮一峰)"))]),a("a",ke,[e(o(x),{class:"inline mr-1"}),t[2]||(t[2]=i("参考文章 (Github)"))])])]),_:1,__:[3,4,5]})]),_:1},8,["title"]),O((w(),S(N,{size:o(f).adminTable.size,"row-key":"id",data:o(V)},{default:s(()=>[o(W)?(w(),S(c,{key:0,label:"ID",prop:"id"})):Y("",!0),e(c,{label:"描述",prop:"description"},{default:s(l=>[e($,{"prefix-icon":o(ne),placeholder:"请输入表达式描述",modelValue:l.row.description,"onUpdate:modelValue":m=>l.row.description=m},null,8,["prefix-icon","modelValue","onUpdate:modelValue"])]),_:1}),e(c,{label:"表达式",prop:"expression"},{default:s(l=>[e($,{"prefix-icon":o(de),placeholder:"请输入表达式",modelValue:l.row.expression,"onUpdate:modelValue":m=>l.row.expression=m,modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue","onUpdate:modelValue"])]),_:1}),e(c,{label:"模式",width:"200",prop:"mode"},{default:s(l=>[e(M,{modelValue:l.row.mode,"onUpdate:modelValue":m=>l.row.mode=m},{default:s(()=>[e(v,{label:"仅隐藏",value:"hidden"}),e(v,{label:"隐藏并不可访问(针对目录)",value:"inaccessible"}),e(v,{label:"隐藏并不可访问不可下载(针对文件)",value:"disable_download"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(c,{align:"center",label:"操作",width:"60px"},{default:s(l=>[e(k,{type:"danger",onClick:m=>o(p)(l.$index),icon:o(me)},null,8,["onClick","icon"])]),_:1})]),_:1},8,["size","data"])),[[R,o(b)]]),e(k,{class:"add-more-btn",size:"default",icon:o(pe),onClick:o(d)},{default:s(()=>t[6]||(t[6]=[i("添加更多")])),_:1,__:[6]},8,["icon","onClick"]),a("div",we,[e(k,{type:"primary",size:"default",icon:o(ce),onClick:o(z)},{default:s(()=>t[7]||(t[7]=[i("保存设置")])),_:1,__:[7]},8,["icon","onClick"])])])}}};typeof B=="function"&&B(j);const st=re(j,[["__scopeId","data-v-4f0c8c9e"]]);export{st as default};
