import{cd as Ge,a3 as Ie,c as ie,r as qe,a4 as we,b as N,g as B,F as de,G as Se,n as Oe,f as b,x as se,h as Le,$ as xe,a1 as Ae,y as ve,l as ge,k as Fe,w as Me,a0 as Ue}from"./index-008199ed.js";import{E as je}from"./empty-4124581b.js";import{E as Je}from"./button-30635c71.js";import{u as Ke,f as Qe,B as Xe}from"./useSetting-78313f06.js";import{_ as Ye}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-4ea0a277.js";import"./request-7014ab81.js";import"./path-229a1735.js";import"./base-00eb0fe9.js";import"./dialog-9877e468.js";import"./index-8286893b.js";import"./vnode-5e2fd68e.js";import"./scroll-374ad3fb.js";import"./overlay-64b24548.js";import"./refs-9142934b.js";/* empty css                     *//* empty css               *//* empty css                  */import"./dropdown-item-28606bba.js";import"./index-60380bfa.js";import"./index-0da14aee.js";import"./dropdown-40114633.js";import"./input-73d413ba.js";import"./_initCloneObject-ffec0ace.js";import"./index-c0734d0a.js";import"./validator-38288ad7.js";import"./index-9e699d2b.js";import"./directive-20abcd4b.js";var Ze={exports:{}};(function(ne){(function(y,h){var u=h(y,y.document,Date);y.lazySizes=u,ne.exports&&(ne.exports=u)})(typeof window<"u"?window:{},function(h,u,$){var A,r;if(function(){var a,t={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",fastLoadedClass:"ls-is-cached",iframeLoadMode:0,srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};r=h.lazySizesConfig||h.lazysizesConfig||{};for(a in t)a in r||(r[a]=t[a])}(),!u||!u.getElementsByClassName)return{init:function(){},cfg:r,noSupport:!0};var V=u.documentElement,le=h.HTMLPictureElement,F="addEventListener",C="getAttribute",g=h[F].bind(h),c=h.setTimeout,O=h.requestAnimationFrame||c,T=h.requestIdleCallback,G=/^picture$/i,D=["load","error","lazyincluded","_lazyloaded"],p={},ee=Array.prototype.forEach,I=function(a,t){return p[t]||(p[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")),p[t].test(a[C]("class")||"")&&p[t]},J=function(a,t){I(a,t)||a.setAttribute("class",(a[C]("class")||"").trim()+" "+t)},oe=function(a,t){var s;(s=I(a,t))&&a.setAttribute("class",(a[C]("class")||"").replace(s," "))},fe=function(a,t,s){var v=s?F:"removeEventListener";s&&fe(a,t),D.forEach(function(d){a[v](d,t)})},K=function(a,t,s,v,d){var n=u.createEvent("Event");return s||(s={}),s.instance=A,n.initEvent(t,!v,!d),n.detail=s,a.dispatchEvent(n),n},ue=function(a,t){var s;!le&&(s=h.picturefill||r.pf)?(t&&t.src&&!a[C]("srcset")&&a.setAttribute("srcset",t.src),s({reevaluate:!0,elements:[a]})):t&&t.src&&(a.src=t.src)},Q=function(a,t){return(getComputedStyle(a,null)||{})[t]},pe=function(a,t,s){for(s=s||a.offsetWidth;s<r.minSize&&t&&!a._lazysizesWidth;)s=t.offsetWidth,t=t.parentNode;return s},X=function(){var a,t,s=[],v=[],d=s,n=function(){var l=d;for(d=s.length?v:s,a=!0,t=!1;l.length;)l.shift()();a=!1},z=function(l,f){a&&!f?l.apply(this,arguments):(d.push(l),t||(t=!0,(u.hidden?c:O)(n)))};return z._lsFlush=n,z}(),te=function(a,t){return t?function(){X(a)}:function(){var s=this,v=arguments;X(function(){a.apply(s,v)})}},ke=function(a){var t,s=0,v=r.throttleDelay,d=r.ricTimeout,n=function(){t=!1,s=$.now(),a()},z=T&&d>49?function(){T(n,{timeout:d}),d!==r.ricTimeout&&(d=r.ricTimeout)}:te(function(){c(n)},!0);return function(l){var f;(l=l===!0)&&(d=33),!t&&(t=!0,f=v-($.now()-s),f<0&&(f=0),l||f<9?z():c(z,f))}},ye=function(a){var t,s,v=99,d=function(){t=null,a()},n=function(){var z=$.now()-s;z<v?c(n,v-z):(T||d)(d)};return function(){s=$.now(),t||(t=c(n,v))}},ze=function(){var a,t,s,v,d,n,z,l,f,S,k,q,Ne=/^img$/i,Be=/^iframe$/i,Te="onscroll"in h&&!/(gle|ing)bot/.test(navigator.userAgent),Re=0,Y=0,M=0,U=-1,me=function(e){M--,(!e||M<0||!e.target)&&(M=0)},he=function(e){return q==null&&(q=Q(u.body,"visibility")=="hidden"),q||!(Q(e.parentNode,"visibility")=="hidden"&&Q(e,"visibility")=="hidden")},We=function(e,i){var o,m=e,_=he(e);for(l-=i,k+=i,f-=i,S+=i;_&&(m=m.offsetParent)&&m!=u.body&&m!=V;)_=(Q(m,"opacity")||1)>0,_&&Q(m,"overflow")!="visible"&&(o=m.getBoundingClientRect(),_=S>o.left&&f<o.right&&k>o.top-1&&l<o.bottom+1);return _},Ce=function(){var e,i,o,m,_,E,R,W,H,P,w,j,x=A.elements;if((v=r.loadMode)&&M<8&&(e=x.length)){for(i=0,U++;i<e;i++)if(!(!x[i]||x[i]._lazyRace)){if(!Te||A.prematureUnveil&&A.prematureUnveil(x[i])){Z(x[i]);continue}if((!(W=x[i][C]("data-expand"))||!(E=W*1))&&(E=Y),P||(P=!r.expand||r.expand<1?V.clientHeight>500&&V.clientWidth>500?500:370:r.expand,A._defEx=P,w=P*r.expFactor,j=r.hFac,q=null,Y<w&&M<1&&U>2&&v>2&&!u.hidden?(Y=w,U=0):v>1&&U>1&&M<6?Y=P:Y=Re),H!==E&&(n=innerWidth+E*j,z=innerHeight+E,R=E*-1,H=E),o=x[i].getBoundingClientRect(),(k=o.bottom)>=R&&(l=o.top)<=z&&(S=o.right)>=R*j&&(f=o.left)<=n&&(k||S||f||l)&&(r.loadHidden||he(x[i]))&&(t&&M<3&&!W&&(v<3||U<4)||We(x[i],E))){if(Z(x[i]),_=!0,M>9)break}else!_&&t&&!m&&M<4&&U<4&&v>2&&(a[0]||r.preloadAfterLoad)&&(a[0]||!W&&(k||S||f||l||x[i][C](r.sizesAttr)!="auto"))&&(m=a[0]||x[i])}m&&!_&&Z(m)}},L=ke(Ce),_e=function(e){var i=e.target;if(i._lazyCache){delete i._lazyCache;return}me(e),J(i,r.loadedClass),oe(i,r.loadingClass),fe(i,Ee),K(i,"lazyloaded")},Pe=te(_e),Ee=function(e){Pe({target:e.target})},$e=function(e,i){var o=e.getAttribute("data-load-mode")||r.iframeLoadMode;o==0?e.contentWindow.location.replace(i):o==1&&(e.src=i)},Ve=function(e){var i,o=e[C](r.srcsetAttr);(i=r.customMedia[e[C]("data-media")||e[C]("media")])&&e.setAttribute("media",i),o&&e.setAttribute("srcset",o)},De=te(function(e,i,o,m,_){var E,R,W,H,P,w;(P=K(e,"lazybeforeunveil",i)).defaultPrevented||(m&&(o?J(e,r.autosizesClass):e.setAttribute("sizes",m)),R=e[C](r.srcsetAttr),E=e[C](r.srcAttr),_&&(W=e.parentNode,H=W&&G.test(W.nodeName||"")),w=i.firesLoad||"src"in e&&(R||E||H),P={target:e},J(e,r.loadingClass),w&&(clearTimeout(s),s=c(me,2500),fe(e,Ee,!0)),H&&ee.call(W.getElementsByTagName("source"),Ve),R?e.setAttribute("srcset",R):E&&!H&&(Be.test(e.nodeName)?$e(e,E):e.src=E),_&&(R||H)&&ue(e,{src:E})),e._lazyRace&&delete e._lazyRace,oe(e,r.lazyClass),X(function(){var j=e.complete&&e.naturalWidth>1;(!w||j)&&(j&&J(e,r.fastLoadedClass),_e(P),e._lazyCache=!0,c(function(){"_lazyCache"in e&&delete e._lazyCache},9)),e.loading=="lazy"&&M--},!0)}),Z=function(e){if(!e._lazyRace){var i,o=Ne.test(e.nodeName),m=o&&(e[C](r.sizesAttr)||e[C]("sizes")),_=m=="auto";(_||!t)&&o&&(e[C]("src")||e.srcset)&&!e.complete&&!I(e,r.errorClass)&&I(e,r.lazyClass)||(i=K(e,"lazyunveilread").detail,_&&ce.updateElem(e,!0,e.offsetWidth),e._lazyRace=!0,M++,De(e,i,_,m,o))}},He=ye(function(){r.loadMode=3,L()}),be=function(){r.loadMode==3&&(r.loadMode=2),He()},re=function(){if(!t){if($.now()-d<999){c(re,999);return}t=!0,r.loadMode=3,L(),g("scroll",be,!0)}};return{_:function(){d=$.now(),A.elements=u.getElementsByClassName(r.lazyClass),a=u.getElementsByClassName(r.lazyClass+" "+r.preloadClass),g("scroll",L,!0),g("resize",L,!0),g("pageshow",function(e){if(e.persisted){var i=u.querySelectorAll("."+r.loadingClass);i.length&&i.forEach&&O(function(){i.forEach(function(o){o.complete&&Z(o)})})}}),h.MutationObserver?new MutationObserver(L).observe(V,{childList:!0,subtree:!0,attributes:!0}):(V[F]("DOMNodeInserted",L,!0),V[F]("DOMAttrModified",L,!0),setInterval(L,999)),g("hashchange",L,!0),["focus","mouseover","click","load","transitionend","animationend"].forEach(function(e){u[F](e,L,!0)}),/d$|^c/.test(u.readyState)?re():(g("load",re),u[F]("DOMContentLoaded",L),c(re,2e4)),A.elements.length?(Ce(),X._lsFlush()):L()},checkElems:L,unveil:Z,_aLSL:be}}(),ce=function(){var a,t=te(function(n,z,l,f){var S,k,q;if(n._lazysizesWidth=f,f+="px",n.setAttribute("sizes",f),G.test(z.nodeName||""))for(S=z.getElementsByTagName("source"),k=0,q=S.length;k<q;k++)S[k].setAttribute("sizes",f);l.detail.dataAttr||ue(n,l.detail)}),s=function(n,z,l){var f,S=n.parentNode;S&&(l=pe(n,S,l),f=K(n,"lazybeforesizes",{width:l,dataAttr:!!z}),f.defaultPrevented||(l=f.detail.width,l&&l!==n._lazysizesWidth&&t(n,S,f,l)))},v=function(){var n,z=a.length;if(z)for(n=0;n<z;n++)s(a[n])},d=ye(v);return{_:function(){a=u.getElementsByClassName(r.autosizesClass),g("resize",d)},checkElems:d,updateElem:s}}(),ae=function(){!ae.i&&u.getElementsByClassName&&(ae.i=!0,ce._(),ze._())};return c(function(){r.init&&ae()}),A={cfg:r,autoSizer:ce,loader:ze,init:ae,uP:ue,aC:J,rC:oe,hC:I,fire:K,gW:pe,rAF:X},A})})(Ze);const et={class:"zfile-gallery-body"},tt={key:0,class:"zfile-img-body"},at=["onClick"],rt=["data-src","alt"],it={class:"zfile-gallery-img-text"},st={class:"zfile-gallery-img-text"},nt={key:1},lt={class:"zfile-gallery-img-text"},ot={key:1,class:"h-full"},ft={__name:"FileGallery",setup(ne){Ge(g=>({a16d1242:b(r),"45f7715e":b(A),"3887fe44":b($)}));let y=Ie(),h=Ke();const u=ie(()=>{let g=h.filterFileByType("image");if(g.length===0)return[];let c=qe([]),O=y.zfileConfig.gallery.column,T=0;g.forEach((D,p)=>{p%O===0&&(p!==0&&T++,c.value[T]=[]),c.value[T].push(D)});function G(D){return D[0].map((p,ee)=>D.map(I=>I[ee]))}return G(c.value)});let $=ie(()=>y.zfileConfig.gallery.rowSpacing+"px"),A=ie(()=>"0 ".concat(y.zfileConfig.gallery.columnSpacing/2,"px")),r=ie(()=>{let g=y.zfileConfig.gallery.column,c=y.zfileConfig.gallery.columnSpacing;return"calc(calc(100% / ".concat(y.zfileConfig.gallery.column,") - calc(").concat((g-1)*c,"px / ").concat(g,"))")});const{openImage:V}=Xe(),le=g=>{y.zfileConfig.imagePreview.gallery&&F.includes(g.name)&&V(g)};let F=we([]);const C=g=>{F.push(g.currentTarget.alt)};return(g,c)=>{const O=Je,T=je;return N(),B("div",et,[u.value.length>0?(N(),B("div",tt,[(N(!0),B(de,null,Se(u.value,(G,D)=>(N(),B("div",{class:"zfile-img-row",key:D},[(N(!0),B(de,null,Se(G,p=>(N(),B("div",{class:"zfile-img-col",onClick:ee=>le(p),style:Oe({display:b(y).zfileConfig.gallery.showInfoMode==="hover"?"flex":"block"})},[p!=null&&p.url?(N(),B(de,{key:0},[se("img",{class:Le(["zfile-gallery-img lazyload",b(y).zfileConfig.gallery.roundedBorder?"zfile-gallery-img-rounded":""]),"data-sizes":"auto",onLoad:C,"data-src":p.url,loading:"lazy",alt:p.name},null,42,rt),b(y).zfileConfig.gallery.showInfo&&b(y).zfileConfig.gallery.showInfoMode==="hover"?xe((N(),B("div",{key:0,class:Le([b(y).zfileConfig.gallery.roundedBorder?"zfile-gallery-img-rounded":"","zfile-gallery-img-hover-info"])},[se("span",it,ve(p.name),1),se("span",st,ve(b(Qe)(p.size)),1)],2)),[[Ae,b(F).includes(p.name)]]):ge("",!0),b(y).zfileConfig.gallery.showInfo&&b(y).zfileConfig.gallery.showInfoMode==="bottom"?xe((N(),B("div",nt,[se("span",lt,ve(p.name),1)],512)),[[Ae,b(F).includes(p.name)]]):ge("",!0)],64)):ge("",!0)],12,at))),256))]))),128))])):(N(),B("div",ot,[Fe(T,{class:"h-full",description:"当前文件夹无图片"},{default:Me(()=>[Fe(O,{type:"primary",onClick:c[0]||(c[0]=G=>b(h).imgMode=!1)},{default:Me(()=>c[1]||(c[1]=[Ue("退出画廊模式")])),_:1,__:[1]})]),_:1})]))])}}},Vt=Ye(ft,[["__scopeId","data-v-61f00fb0"]]);export{Vt as default};
