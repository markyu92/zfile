import{a4 as S,r as g,a8 as N,a3 as K,b as w,e as R,w as s,k as n,a0 as E,f as l,i as z,a2 as D}from"./index-008199ed.js";import{E as I}from"./dialog-9877e468.js";import"./overlay-64b24548.js";import{E as q}from"./button-30635c71.js";/* empty css                  */import{E as k,a as B}from"./input-73d413ba.js";import{e as M,f as U}from"./admin-storage-185041e5.js";import{E as $,b as j}from"./request-7014ab81.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";const i=S({toName:"",toKey:"",fromId:null}),O={toName:[{required:!0,message:"请输入新存储源名称",trigger:"blur"}],toKey:[{required:!0,message:"请输入新存储源别名",trigger:"blur"},{validator:(d,r,o)=>{if(r==null||r===""){o("请输入存储源别名");return}if(N.systemNames.includes(r)){o(new Error("不可占用系统级名称，请修改。"));return}if(!/^[\w\-]+$/.test(r)){o(new Error("只允许使用字母、数字、下划线、横杠"));return}M({storageKey:r}).then(t=>{t.data?o(new Error("该存储源别名已存在，请修改。")):o()})}}]},m=g(!1),u=g(!1);function P(){const d=t=>{m.value=!0,i.fromId=t.id,i.toKey=t.key,i.toName=t.name},r=()=>{m.value=!1},o=g(null);return{dialogVisible:m,openDialog:d,closeDialog:r,formData:i,rules:O,storageCopyFormRef:o,submitForm:t=>{u.value=!0,o.value.validate(p=>{p?U(i).then(y=>{$.success("复制成功"),m.value=!1,t("close")}).finally(()=>{u.value=!1}):u.value=!1})},saveLoading:u}}const T={__name:"index",setup(d,{emit:r}){const{dialogVisible:o,saveLoading:f,formData:t,rules:p,storageCopyFormRef:y,submitForm:V}=P(),F=r,_=K();return(W,e)=>{const b=j,v=k,x=B,c=q,C=I;return w(),R(C,{"append-to-body":"",title:"复制存储配置",modelValue:l(o),"onUpdate:modelValue":e[5]||(e[5]=a=>D(o)?o.value=a:null)},{footer:s(()=>[n(c,{onClick:e[3]||(e[3]=a=>o.value=!1)},{default:s(()=>e[6]||(e[6]=[E("取 消")])),_:1,__:[6]}),n(c,{type:"primary",onClick:e[4]||(e[4]=a=>l(V)(F)),loading:l(f)},{default:s(()=>e[7]||(e[7]=[E("确 定")])),_:1,__:[7]},8,["loading"])]),default:s(()=>[n(x,{onSubmit:e[2]||(e[2]=z(()=>{},["prevent"])),model:l(t),rules:l(p),"label-width":l(_).adminForm.labelWidth,"label-position":l(_).adminForm.labelPosition,size:l(_).adminForm.size,"status-icon":"",class:"z-admin-form",ref_key:"storageCopyFormRef",ref:y},{default:s(()=>[n(v,{label:"新存储源名称",prop:"toName"},{default:s(()=>[n(b,{modelValue:l(t).toName,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).toName=a),placeholder:"请输入新存储源名称"},null,8,["modelValue"])]),_:1}),n(v,{label:"新存储源别名",prop:"toKey"},{default:s(()=>[n(b,{modelValue:l(t).toKey,"onUpdate:modelValue":e[1]||(e[1]=a=>l(t).toKey=a),placeholder:"请输入新存储源别名"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules","label-width","label-position","size"])]),_:1},8,["modelValue"])}}},G=L(T,[["__scopeId","data-v-6d7db6e1"]]),oe=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));export{G as S,oe as i,P as u};
