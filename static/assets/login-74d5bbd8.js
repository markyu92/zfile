import{b as c,g as _,x as a,_ as j,r as u,a3 as D,ae as A,o as N,Z,k as o,w as n,f as t,e as U,l as G,F as T,G as H,a2 as P,a0 as h,i as J}from"./index-008199ed.js";/* empty css                  */import{E as K}from"./button-30635c71.js";import{E as O}from"./link-64f58088.js";/* empty css                 */import"./tooltip-4ed993c7.js";/* empty css               */import{_ as Q}from"./AutoIcon-e82f7b4b.js";import{E as W}from"./image-viewer-3212b1b6.js";import{E as X,a as Y}from"./input-73d413ba.js";import{_ as ee}from"./zfile-basic-ce5d3448.js";import{c as te,l as oe,a as ae,b as le}from"./user-12b1d757.js";import{f as re,E as R,b as se,e as ne}from"./request-7014ab81.js";import{i as ie,r as de}from"./install-bbe1534f.js";import{c as me}from"./path-229a1735.js";import{_ as ue}from"./_plugin-vue_export-helper-c27b6911.js";import{r as fe}from"./KeyIcon-1b979890.js";import{r as ce}from"./QuestionMarkCircleIcon-492baaf8.js";import{r as pe}from"./CheckBadgeIcon-af1628c6.js";import{E as _e}from"./index-60380bfa.js";import"./index-4ea0a277.js";import"./debounce-3f0c1a7c.js";import"./scroll-374ad3fb.js";import"./_initCloneObject-ffec0ace.js";import"./base-00eb0fe9.js";function ge(y,f){return c(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function ve(y,f){return c(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})])}const xe=()=>re({url:"/api/sso/list",method:"get"});const be={class:"h-full min-h-screen bg-gray-100 text-gray-900 flex justify-center items-center"},we={class:"h-full lg:h-auto max-w-screen-lg bg-white shadow-xl sm:rounded-xl flex flex-1"},he={class:"w-full lg:w-1/2 xl:w-1/2 mt-10 p-6 sm:p-12"},ye={class:"mt-0 flex flex-col items-center"},ke={class:"w-full flex-1"},Ve={class:"flex space-x-5 w-full"},Ce={class:"flex w-full space-x-4 items-center justify-center"},Ie=["href"],Ee={class:"flex justify-between w-full"},Ue={__name:"login",setup(y){let f=j(),x=u(!1),L=D();const i=A("zfile-login-storage",{remember:!1,username:"",password:""}),g=u(i.value.remember);let k=u(),r=u({username:i.value.username,password:i.value.password,verifyCode:"",verifyCodeUUID:""}),M=u({username:[{required:!0,message:"账号不能为空",trigger:["change","blur"]}],password:[{required:!0,message:"密码不能为空",trigger:["change","blur"]}]});const q=()=>{k.value.validate(s=>{s?(x.value=!0,oe(r.value).then(e=>{let m=e.data.token,d=e.data.admin;g.value?(i.value.username=r.value.username,i.value.password=r.value.password,i.value.remember=!0):(i.value.username="",i.value.password="",i.value.remember=!1),window.localStorage.setItem("zfile-token",m),R({message:"登录成功",type:"success",duration:1e3,onClose(){if(d){let v=f.currentRoute.value.query.redirect;f.push(v||"/admin")}else f.push("/")}})}).catch(()=>{x.value=!1,w()})):R.warning("请输入账号密码!")})},p=u(""),b=()=>{ae(r.value.username).then(s=>{let e=p.value;p.value=s.data,e!=="image"&&p.value==="image"&&w()})},V=u({}),w=()=>{le().then(s=>{V.value=s.data,r.value.verifyCodeUUID=s.data.uuid})},C=u([]);return N(()=>{ie().then(s=>{s.data||f.push("/install")}),te().then(s=>{let e=s.data.isLogin,m=s.data.isAdmin;e&&m&&f.push("/admin")}),xe().then(s=>{C.value=s.data}),b()}),(s,e)=>{const m=se,d=X,v=W,z=Q,I=_e,S=ne,B=O,F=K,$=Y;return c(),_("div",be,[a("div",we,[e[12]||(e[12]=a("div",{class:"flex-1 bg-gray-50 text-center hidden lg:flex rounded-l-xl"},[a("div",{class:"m-12 xl:m-16 w-full bg-contain bg-center bg-no-repeat zfile-login-logo"})],-1)),a("div",he,[a("div",ye,[e[11]||(e[11]=a("a",{href:"https://github.com/zfile-dev/zfile",target:"_blank",class:"text-2xl mt-0 xl:text-3xl font-extrabold box animate__animated animate__fadeInDown"},[a("img",{class:"w-16 cursor-pointer",src:ee})],-1)),a("div",ke,[e[10]||(e[10]=Z('<div class="my-12 relative" data-v-6bc717e7><div class="absolute inset-0 flex items-center" aria-hidden="true" data-v-6bc717e7><div class="w-full border-t text-gray-600" data-v-6bc717e7></div></div><div class="relative flex justify-center text-sm" data-v-6bc717e7><span class="px-2 bg-white text-sm leading-none text-gray-600 tracking-wide font-medium" data-v-6bc717e7> 登录 </span></div></div>',1)),o($,{rules:t(M),model:t(r),ref_key:"loginFormRef",ref:k,class:"zfile-login-form",size:"large",onSubmit:e[6]||(e[6]=J(()=>{},["prevent"]))},{default:n(()=>[o(d,{class:"box animate__animated animate__fadeInUp",prop:"username"},{default:n(()=>[o(m,{placeholder:"账号","prefix-icon":t(de),modelValue:t(r).username,"onUpdate:modelValue":e[0]||(e[0]=l=>t(r).username=l),modelModifiers:{trim:!0},onInput:b,onChange:b},null,8,["prefix-icon","modelValue"])]),_:1}),o(d,{class:"box animate__animated animate__fadeInUp",prop:"password"},{default:n(()=>[o(m,{placeholder:"密码",type:"password","show-password":"","prefix-icon":t(fe),modelValue:t(r).password,"onUpdate:modelValue":e[1]||(e[1]=l=>t(r).password=l),modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue"])]),_:1}),t(p)==="2fa"?(c(),U(d,{key:0,class:"box animate__animated animate__fadeInUp",prop:"verifyCode"},{default:n(()=>[o(m,{placeholder:"双因素认证验证码","prefix-icon":t(ge),modelValue:t(r).verifyCode,"onUpdate:modelValue":e[2]||(e[2]=l=>t(r).verifyCode=l),modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue"])]),_:1})):t(p)==="image"?(c(),U(d,{key:1,class:"box animate__animated animate__fadeInUp",prop:"verifyCode"},{default:n(()=>{var l;return[a("div",Ve,[o(m,{class:"flex-1",placeholder:"请输入验证码","prefix-icon":t(ve),modelValue:t(r).verifyCode,"onUpdate:modelValue":e[3]||(e[3]=E=>t(r).verifyCode=E),modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue"]),o(v,{src:(l=t(V))==null?void 0:l.imgBase64,onClick:e[4]||(e[4]=E=>w())},null,8,["src"])])]}),_:1})):G("",!0),o(d,{class:"!mb-0"},{default:n(()=>[a("div",Ce,[(c(!0),_(T,null,H(t(C),l=>(c(),_("a",{key:l.provider,class:"cursor-pointer inline",href:t(me)(t(L).serverAddress,"sso",l.provider,"login")},[o(I,{content:l.name},{default:n(()=>[o(z,{class:"inline",icon:l.icon},null,8,["icon"])]),_:2},1032,["content"])],8,Ie))),128))])]),_:1}),o(d,{class:"box animate__animated animate__fadeInUp"},{default:n(()=>[a("div",Ee,[o(S,{modelValue:t(g),"onUpdate:modelValue":e[5]||(e[5]=l=>P(g)?g.value=l:null),label:"记住密码"},null,8,["modelValue"]),o(I,{class:"item",effect:"dark",placement:"left"},{content:n(()=>e[7]||(e[7]=[a("div",null,[h(" 将配置文件 application.properties 中 zfile.debug 修改为 true, 重启后访问首页即可重置密码 "),a("br"),a("a",{target:"_blank",class:"text-blue-400",href:"https://docs.zfile.vip/config/config-debug"}," 点击可前往文档查看操作方式 ")],-1)])),default:n(()=>[o(B,{icon:t(ce),underline:!1},{default:n(()=>e[8]||(e[8]=[h("忘记密码")])),_:1,__:[8]},8,["icon"])]),_:1})])]),_:1}),o(d,null,{default:n(()=>[o(F,{loading:t(x),autofocus:"",class:"w-full mb-0","native-type":"submit",type:"primary",icon:t(pe),onClick:q},{default:n(()=>e[9]||(e[9]=[h(" 登录 ")])),_:1,__:[9]},8,["loading","icon"])]),_:1})]),_:1},8,["rules","model"])])])])])])}}},et=ue(Ue,[["__scopeId","data-v-6bc717e7"]]);export{et as default};
