System.register(["./index-legacy-e574cec8.js","./loading-legacy-2688a411.js","./form-item-legacy-de8da7e8.js","./button-legacy-f53896dd.js","./popper-legacy-ef8fd66b.js","./popover-legacy-fa927888.js","./input-legacy-bc871eba.js","./admin-form-header-legacy-5b0f136c.js","./vue3-clipboard.esm-legacy-e37b8e98.js","./useAdminSetting-legacy-246910c5.js","./useClientInfo-legacy-47dbf540.js","./route-block-legacy-509c7347.js","./_plugin-vue_export-helper-legacy-8fcf0e06.js","./QuestionMarkCircleIcon-legacy-13cc9795.js","./request-legacy-61b983ae.js","./CheckBadgeIcon-legacy-a01a5b9d.js","./index-legacy-32709ede.js","./directive-legacy-64af483a.js","./index-legacy-c317e588.js","./_initCloneObject-legacy-b35b9836.js","./index-legacy-1ae34dc2.js","./dropdown-legacy-648534c2.js"],(function(e,l){"use strict";var n,t,i,a,u,c,o,s,r,d,f,p,m,v,y,g,I,_,k,b,x,h,j,P,U,w,V,A,C,F,B,M,T,z;return{setters:[function(e){n=e.a3,t=e.r,i=e.f,a=e.$,u=e.b,c=e.e,o=e.w,s=e.k,r=e.x,d=e.a0,f=e.y,p=e.a2,m=e.l,v=e.g,y=e.aD},null,null,function(e){g=e.E},null,null,function(e){I=e.E,_=e.a},function(e){k=e._},function(e){b=e.t},function(e){x=e.u,h=e.c,j=e.t},function(e){P=e.u},function(e){U=e.b},function(e){w=e._},function(e){V=e.r},function(e){A=e.d,C=e.c,F=e.E,B=e.b},function(e){M=e.r},function(e){T=e.E},function(e){z=e.v},null,null,null,null],execute:function(){var l=document.createElement("style");l.textContent=".error-icon[data-v-c939d214]{width:1rem;--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.success-icon[data-v-c939d214]{width:1rem;--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}\n",document.head.appendChild(l);var E={class:"el-form-item-tips"},S={class:"mt-1"},W={class:"text-blue-400"},Z={class:"mt-4"},L={key:0},O={key:0},R={class:"text-blue-500"},D={key:1},H={class:"el-form-item-tips"},K={class:"mt-1"},X={class:"text-blue-400"},Q={class:"mt-4"},q={key:0},G={key:0},N={class:"text-blue-500"},Y={key:1},$={__name:"index",setup:function(e){var l=n(),U=t(),w=x(h,U),$=w.siteSetting,J=w.saveData,ee=w.saveLoading,le=P(),ne=le.clientIp,te=le.userAgent,ie=t(""),ae=t(null),ue=y((function(){var e;re("springSimple",null===(e=$.value)||void 0===e?void 0:e.accessUaBlocklist,ie.value,ae)}),250),ce=t(""),oe=t(null),se=y((function(){var e;re("ip",null===(e=$.value)||void 0===e?void 0:e.accessIpBlocklist,ce.value,oe)}),250),re=function(e,l,n,t){var i={ruleType:e,rules:l,testValue:n};i.rules&&i.testValue?j(i).then((function(e){t.value=e.data})):t.value=null},de=function(){b("*Thunder*\nMozilla/5.0 (Linux; Android) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36\n*Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;*").then((function(){$.value.accessUaBlocklist&&($.value.accessUaBlocklist.endsWith("\n")||($.value.accessUaBlocklist+="\n")),F.success("复制成功，请粘贴到 UA 黑名单中，然后保存。")})).catch((function(){F.error("复制失败")}))};return function(e,n){var t=k,y=B,b=T,x=I,h=g,j=_,P=z;return i($)?a((u(),c(j,{key:0,model:i($),"label-width":i(l).adminForm.labelWidth,"label-position":i(l).adminForm.labelPosition,size:i(l).adminForm.size,class:"z-admin-form"},{default:o((function(){return[s(t,{title:"访问控制","sub-title":"此处设置可保护您的站点安全"}),s(x,{label:"IP 黑名单"},{default:o((function(){return[s(y,{type:"textarea",onInput:i(se),rows:6,modelValue:i($).accessIpBlocklist,"onUpdate:modelValue":n[0]||(n[0]=function(e){return i($).accessIpBlocklist=e})},null,8,["onInput","modelValue"]),r("div",E,[n[12]||(n[12]=d(" 每行输入一个 IP 或 IP 段，如： ")),n[13]||(n[13]=r("ul",{class:"list-disc ml-4"},[r("li",null,"127.0.0.1"),r("li",null,"192.168.0.0/24"),r("li",null,"支持 IPv6 地址和网段。")],-1)),r("div",S,[n[6]||(n[6]=d(" 注意：检测到你当前 ip 为：")),r("span",W,f(i(ne)),1),n[7]||(n[7]=d("，别把自己 ip 配置进去（ ")),s(b,{placement:"top-start",title:"提示",width:300,trigger:"hover"},{reference:o((function(){return[r("span",null,[n[4]||(n[4]=d("这里显示的不是你的 IP 地址？")),s(i(V),{class:"w-4 h-4 inline align-sub"})])]})),default:o((function(){return n[5]||(n[5]=[d(' 注意：如果你使用了反向代理，而不是直接访问的 ZFile 端口, 那你需要在反向代理处添加以下任意请求头为用户真实 IP："X-Forwarded-For", "X-Real-IP", "Proxy-Client-IP", "WL-Proxy-Client-IP", "HTTP_CLIENT_IP", "HTTP_X_FORWARDED_FOR"，不然不论谁访问 ZFile 都只能获取到反代服务器的 IP，同服务器一般是获取到 127.0.0.1 或 localhost, 这样此功能就无法正常使用!!! ')])})),_:1}),n[8]||(n[8]=d(" ）。 "))]),r("div",Z,[n[11]||(n[11]=r("div",null,"可在下方输入你要测试的 IP, 显示绿色表示不会被拦截，红色表示触发了黑名单会被拦截",-1)),s(y,{onInput:i(se),modelValue:i(ce),"onUpdate:modelValue":n[1]||(n[1]=function(e){return p(ce)?ce.value=e:null})},{suffix:o((function(){return[i(ce)&&null!==i(oe)?(u(),c(i(A),{key:0,class:"error-icon"})):i(ce)&&null===i(oe)?(u(),c(i(C),{key:1,class:"success-icon"})):m("",!0)]})),_:1},8,["onInput","modelValue"]),i(ce)?(u(),v("div",L,[i(oe)?(u(),v("div",O,[n[9]||(n[9]=d(" 输入的测试 IP 匹配了规则: ")),r("span",R,f(i(oe)),1),n[10]||(n[10]=d("，会被禁止访问 ZFile。 "))])):(u(),v("div",D,"输入的测试 IP 未匹配任何规则, 可以正常访问 ZFile。"))])):m("",!0)])])]})),_:1}),s(x,{label:"UA 黑名单"},{default:o((function(){return[s(y,{type:"textarea",onInput:i(ue),rows:6,modelValue:i($).accessUaBlocklist,"onUpdate:modelValue":n[2]||(n[2]=function(e){return i($).accessUaBlocklist=e})},null,8,["onInput","modelValue"]),r("div",H,[n[19]||(n[19]=d(" 每行输入一个 UserAgent，支持 * 通配符，如： ")),n[20]||(n[20]=r("ul",{class:"list-disc ml-4"},[r("li",null,"Mozilla/5.0*"),r("li",null,"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36")],-1)),r("div",K,[n[14]||(n[14]=d("注意：当前浏览器 UserAgent 为：")),r("span",X,f(i(te)),1),n[15]||(n[15]=d("，别把自己 ua 填到黑名单去。 "))]),r("div",Q,[n[18]||(n[18]=r("div",null,"可在下方输入你要测试的 UserAgent, 显示绿色表示不会被拦截，红色表示触发了黑名单会被拦截",-1)),s(y,{onInput:i(ue),modelValue:i(ie),"onUpdate:modelValue":n[3]||(n[3]=function(e){return p(ie)?ie.value=e:null})},{suffix:o((function(){return[i(ie)&&null!=i(ae)?(u(),c(i(A),{key:0,class:"error-icon"})):i(ie)&&null===i(ae)?(u(),c(i(C),{key:1,class:"success-icon"})):m("",!0)]})),_:1},8,["onInput","modelValue"]),i(ie)?(u(),v("div",q,[i(ae)?(u(),v("div",G,[n[16]||(n[16]=d(" 输入的测试 UserAgent 匹配了规则: ")),r("span",N,f(i(ae)),1),n[17]||(n[17]=d("，会被禁止访问 ZFile。 "))])):(u(),v("div",Y,"输入的测试 UserAgent 未匹配任何规则, 可以正常访问 ZFile。"))])):m("",!0)])])]})),_:1}),s(x,{label:"快捷操作"},{default:o((function(){return[s(b,{placement:"top-start",title:"提示",width:300,trigger:"hover"},{reference:o((function(){return[s(h,{type:"primary",onClick:de},{default:o((function(){return n[21]||(n[21]=[d("屏蔽迅雷下载")])})),_:1,__:[21]})]})),default:o((function(){return n[22]||(n[22]=[r("div",null,[d("使用迅雷下载，可能会导致服务器CPU和带宽长时间被耗尽，所以这里提供了一键屏蔽迅雷下载的功能，点击按钮即可复制到剪贴板，然后粘贴到 UA 黑名单中"),r("span",{class:"font-bold"},"保存"),d("即可。 ")],-1),r("div",{class:"mt-1"},"tips: 不保证该规则一直有效，迅雷的下载服务可能会更改 UA。",-1)])})),_:1})]})),_:1}),s(x,{class:"admin-from-footer"},{default:o((function(){return[s(h,{class:"ml-auto",type:"primary",icon:i(M),onClick:i(J)},{default:o((function(){return n[23]||(n[23]=[d("保存设置")])})),_:1,__:[23]},8,["icon","onClick"])]})),_:1})]})),_:1},8,["model","label-width","label-position","size"])),[[P,i(ee)]]):m("",!0)}}};"function"==typeof U&&U($),e("default",w($,[["__scopeId","data-v-c939d214"]]))}}}));
