import{b as f,g as c,x as n,a3 as T,r as w,B as $,o as R,_ as q,f as o,$ as L,e as I,w as i,k as t,a1 as k,a0 as p,y as O,l as P}from"./index-008199ed.js";/* empty css                *//* empty css                  */import{E as G,a as j}from"./input-73d413ba.js";import{E as W}from"./input-number-89d86f4f.js";import{E as J}from"./switch-6e3117dc.js";import{E as K,a as Q}from"./radio-7917ad9b.js";/* empty css               *//* empty css                */import{E as X}from"./button-30635c71.js";import{_ as Y}from"./admin-form-header-819a5389.js";import{g as ee}from"./admin-user-8224dae0.js";import{u as oe,f as te}from"./useAdminSetting-8228330a.js";import{l as le}from"./admin-storage-185041e5.js";import{b as C}from"./route-block-83d24a4e.js";import{E as ie}from"./index-c0734d0a.js";import{r as E}from"./LinkIcon-7af8e7e3.js";import{r as M}from"./CheckBadgeIcon-af1628c6.js";import{b as ae}from"./request-7014ab81.js";import{E as ne}from"./index-751f7128.js";import{v as re}from"./directive-20abcd4b.js";import"./index-4ea0a277.js";import"./_initCloneObject-ffec0ace.js";import"./index-3c7e69e5.js";import"./validator-38288ad7.js";import"./index-8286893b.js";import"./vnode-5e2fd68e.js";import"./scroll-374ad3fb.js";import"./index-60380bfa.js";import"./dropdown-40114633.js";function se(g,d){return f(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z","clip-rule":"evenodd"}),n("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})])}function me(g,d){return f(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"})])}function de(g,d){return f(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{d:"M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.689Z"}),n("path",{d:"m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.432Z"})])}function A(g,d){return f(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z","clip-rule":"evenodd"})])}function ue(g,d){return f(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[n("path",{"fill-rule":"evenodd",d:"M12.516 2.17a.75.75 0 0 0-1.032 0 11.209 11.209 0 0 1-7.877 3.08.75.75 0 0 0-.722.515A12.74 12.74 0 0 0 2.25 9.75c0 5.942 4.064 10.933 9.563 12.348a.749.749 0 0 0 .374 0c5.499-1.415 9.563-6.406 9.563-12.348 0-1.39-.223-2.73-.635-3.985a.75.75 0 0 0-.722-.516l-.143.001c-2.996 0-5.717-1.17-7.734-3.08Zm3.094 8.016a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}const pe={class:"mt-2"},fe={class:"text-sm"},ge={class:"mb-2"},ve={class:"text-red-500"},ce={class:"flex justify-end"},_e={__name:"site-setting",setup(g){let d=T();const b=w(),{siteSetting:l,siteSettingLoading:S,saveData:x,saveLoading:Z}=oe(te,b);let B=w({siteName:[{required:!0,message:"请输入站点名称"}],faviconUrl:[{type:"url",message:"请输入正确的 favicon 地址，需以 http 或 https 开头"}]}),s=w({flag:!1,except:"",action:()=>{}});$(()=>S.value,(V,e)=>{if(e===!0){let u=l.value.frontDomain,m=window.location.origin;d.zfileConfig.baseUrl!==""&&u!==m?(s.value.flag=!0,s.value.current=u,s.value.except=m,s.value.action=()=>{l.value.frontDomain=m,x(),s.value.flag=!1}):d.zfileConfig.baseUrl===""&&u&&(s.value.flag=!0,s.value.current=u,s.value.except="空",s.value.action=()=>{l.value.frontDomain="",x(),s.value.flag=!1})}}),R(()=>{D()});const N=q(),D=()=>{le().then(V=>{var u;let e=(u=V.data)==null?void 0:u.length;e>0&&ee({hideDisabledStorage:!0}).then(m=>{var v;let r=m.data;r.length>0&&((v=r[0].userStorageSourceList)==null?void 0:v.length)===0&&ie.confirm("检测到你有 ".concat(e," 个存储源，但没有给管理员分配任何存储源，是否前往配置？（不配置将无法访问存储源）"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{N.push("/admin/user-list")})})})};return(V,e)=>{const u=Y,m=ae,r=G,v=X,H=ne,_=K,U=Q,F=J,y=W,h=j,z=re;return o(l)?L((f(),I(h,{key:0,model:o(l),"label-width":o(d).adminForm.labelWidth,"label-position":o(d).adminForm.labelPosition,size:o(d).adminForm.size,"scroll-to-error":"","status-icon":"",class:"z-admin-form",ref_key:"settingFormRef",ref:b,rules:o(B)},{default:i(()=>[t(u,{title:"站点信息","sub-title":"请填写您的站点信息"}),t(r,{prop:"siteName",label:"站点名称"},{default:i(()=>[t(m,{id:"siteName","prefix-icon":o(se),modelValue:o(l).siteName,"onUpdate:modelValue":e[0]||(e[0]=a=>o(l).siteName=a)},null,8,["prefix-icon","modelValue"])]),_:1}),t(r,{prop:"faviconUrl",label:"站点 favicon"},{default:i(()=>[t(m,{id:"faviconUrl","prefix-icon":o(A),modelValue:o(l).faviconUrl,"onUpdate:modelValue":e[1]||(e[1]=a=>o(l).faviconUrl=a)},null,8,["prefix-icon","modelValue"]),e[11]||(e[11]=n("div",{class:"el-form-item-tips"},"网站在浏览器标题栏的 favicon 图标，需确保输入的地址没有 referer 防盗链，如修改后不生效请清理浏览器缓存或再试。 ",-1))]),_:1,__:[11]}),L(t(r,{prop:"frontDomain",label:"前端站点域名"},{default:i(()=>[t(m,{"prefix-icon":o(E),modelValue:o(l).frontDomain,"onUpdate:modelValue":e[2]||(e[2]=a=>o(l).frontDomain=a)},null,8,["prefix-icon","modelValue"]),e[16]||(e[16]=n("div",{class:"el-form-item-tips"},"前后端分离后，需配置此地址，用于访问未授权页面调回登录页、访问失效短链时调到 403 页面时确保跳转到前端服务的地址，不配置的话会跳转到后端地址 ",-1)),t(H,{placement:"right",width:400,trigger:"click"},{reference:i(()=>[L(n("div",pe,[e[12]||(e[12]=n("span",{class:"text-red-500 text-sm"},"设置异常，点击查看",-1)),t(o(me),{class:"inline w-5 text-red-500"})],512),[[k,o(s).flag]])]),default:i(()=>[n("div",fe,[n("div",ge,[e[13]||(e[13]=p("检测到设置异常，实际前端域名应为 ")),n("span",ve,O(o(s).except),1),e[14]||(e[14]=p("，是否需要修复？（不修正会影响 401、403、404 页面的跳转功能） "))]),n("div",ce,[t(v,{size:"small",type:"warning",icon:o(M),onClick:o(s).action},{default:i(()=>e[15]||(e[15]=[p(" 自动修正 ")])),_:1,__:[15]},8,["icon","onClick"])])])]),_:1})]),_:1,__:[16]},512),[[k,o(d).zfileConfig.baseUrl||o(l).frontDomain]]),t(r,{prop:"siteHomeName",label:"根路径名称"},{default:i(()=>[t(m,{id:"siteHomeName","prefix-icon":o(de),modelValue:o(l).siteHomeName,"onUpdate:modelValue":e[3]||(e[3]=a=>o(l).siteHomeName=a)},null,8,["prefix-icon","modelValue"]),e[17]||(e[17]=n("div",{class:"el-form-item-tips"},"用于设置首页上方面包屑根目录的默认名称.",-1))]),_:1,__:[17]}),t(r,{prop:"siteHomeLogo",label:"首页 Logo 图片地址"},{default:i(()=>[t(m,{id:"siteHomeLogo","prefix-icon":o(A),modelValue:o(l).siteHomeLogo,"onUpdate:modelValue":e[4]||(e[4]=a=>o(l).siteHomeLogo=a)},null,8,["prefix-icon","modelValue"]),e[18]||(e[18]=n("div",{class:"el-form-item-tips"},"用于设置首页上面包屑左侧 Logo，留空为不显示，会自动居中显示，如有需要可通过自定义 css 来修改默认样式, logo 元素的 id 为 zfile-home-logo ",-1))]),_:1,__:[18]}),t(r,{prop:"siteHomeLogoLink",label:"首页 Logo 打开链接"},{default:i(()=>[t(m,{disabled:!o(l).siteHomeLogo,id:"siteHomeLogoLink","prefix-icon":o(E),modelValue:o(l).siteHomeLogoLink,"onUpdate:modelValue":e[5]||(e[5]=a=>o(l).siteHomeLogoLink=a)},null,8,["disabled","prefix-icon","modelValue"]),e[19]||(e[19]=n("div",{class:"el-form-item-tips"},"点击 Logo 链接后打开的地址，为空则点击不进行任何跳转",-1))]),_:1,__:[19]}),t(r,{prop:"siteHomeLogoTargetMode",label:"首页 Logo 链接打开方式"},{default:i(()=>[t(U,{modelValue:o(l).siteHomeLogoTargetMode,"onUpdate:modelValue":e[6]||(e[6]=a=>o(l).siteHomeLogoTargetMode=a)},{default:i(()=>[t(_,{value:"_blank"},{default:i(()=>e[20]||(e[20]=[p("新标签打开")])),_:1,__:[20]}),t(_,{value:"_self"},{default:i(()=>e[21]||(e[21]=[p("当前页面打开")])),_:1,__:[21]})]),_:1},8,["modelValue"])]),_:1}),t(r,{prop:"siteAdminLogoTargetMode",label:"管理员页面 logo 链接打开方式"},{default:i(()=>[t(U,{modelValue:o(l).siteAdminLogoTargetMode,"onUpdate:modelValue":e[7]||(e[7]=a=>o(l).siteAdminLogoTargetMode=a)},{default:i(()=>[t(_,{value:"_blank"},{default:i(()=>e[22]||(e[22]=[p("新标签打开")])),_:1,__:[22]}),t(_,{value:"_self"},{default:i(()=>e[23]||(e[23]=[p("当前页面打开")])),_:1,__:[23]})]),_:1},8,["modelValue"]),e[24]||(e[24]=n("div",{class:"el-form-item-tips"},"管理员页面左上角的 ZFile Logo 点击会回到首页",-1))]),_:1,__:[24]}),t(r,{prop:"siteAdminVersionOpenChangeLog",label:"管理员页面点击版本号打开更新日志"},{default:i(()=>[t(F,{modelValue:o(l).siteAdminVersionOpenChangeLog,"onUpdate:modelValue":e[8]||(e[8]=a=>o(l).siteAdminVersionOpenChangeLog=a)},null,8,["modelValue"])]),_:1}),t(r,{label:"备案号"},{default:i(()=>[t(m,{id:"icp","prefix-icon":o(ue),modelValue:o(l).icp,"onUpdate:modelValue":e[9]||(e[9]=a=>o(l).icp=a)},null,8,["prefix-icon","modelValue"])]),_:1}),t(r,{label:"最大同时上传文件数"},{default:i(()=>[t(y,{id:"maxFileUploads",modelValue:o(l).maxFileUploads,"onUpdate:modelValue":e[10]||(e[10]=a=>o(l).maxFileUploads=a),min:1,max:99},null,8,["modelValue"])]),_:1}),t(r,{class:"admin-from-footer"},{default:i(()=>[t(v,{class:"ml-auto",type:"primary",icon:o(M),onClick:o(x)},{default:i(()=>e[25]||(e[25]=[p("保存设置")])),_:1,__:[25]},8,["icon","onClick"])]),_:1})]),_:1},8,["model","label-width","label-position","size","rules"])),[[z,o(Z)]]):P("",!0)}}};typeof C=="function"&&C(_e);export{_e as default};
