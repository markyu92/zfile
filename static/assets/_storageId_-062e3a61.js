import{Y as $,_ as j,r as f,o as H,c as C,ak as L,b as z,g as Q,x as l,k as a,w as n,y as b,f as r,a0 as m,$ as Y,a1 as F,a2 as V,a8 as E}from"./index-008199ed.js";import{E as G}from"./button-30635c71.js";/* empty css                     *//* empty css                 */import"./tooltip-4ed993c7.js";/* empty css               *//* empty css                  *//* empty css            *//* empty css                */import{_ as J}from"./arrow-left-6c74187b.js";import{j as K,p as W,q as X}from"./admin-storage-185041e5.js";import{b as S}from"./route-block-83d24a4e.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";import{r as B}from"./QuestionMarkCircleIcon-492baaf8.js";import{r as ee}from"./CheckBadgeIcon-af1628c6.js";import{E as I}from"./index-c0734d0a.js";import{E as te,e as oe}from"./request-7014ab81.js";import{E as le}from"./index-751f7128.js";import{E as ae,a as ne}from"./index-91840f01.js";import"./index-4ea0a277.js";import"./index-8286893b.js";import"./vnode-5e2fd68e.js";import"./scroll-374ad3fb.js";import"./validator-38288ad7.js";import"./index-60380bfa.js";import"./dropdown-40114633.js";import"./index-0da14aee.js";import"./_initCloneObject-ffec0ace.js";import"./index-293710b7.js";import"./debounce-3f0c1a7c.js";const se={class:"zfile-admin-permission-index"},re={class:"flex justify-between"},ie={class:"flex text-lg leading-6 font-medium text-gray-900"},me={class:"line-through"},ue={class:"text-sm my-auto text-gray-400 ml-2"},de={class:"space-x-2"},pe={class:"space-x-2"},fe={class:"flex mt-5"},R={__name:"[storageId]",setup(ce){let T=$(),x=j(),c=T.params.storageId;const o=f([]),U=()=>{W(c).then(t=>{o.value=t.data})},P=()=>{X(c,o.value).then(t=>{let e=t.data;if(e.code!==E.responseCode.SUCCESS){e.code===E.responseCode.BAD_REQUEST?I.confirm("保存成功，".concat(e.msg,", 是否前往编辑存储源设置？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",callback:i=>{i==="confirm"&&x.push("/admin/storage-edit/"+c)}}):te({type:"error",dangerouslyUseHTMLString:!0,grouping:!0,message:e.msg});return}I.confirm("保存成功, 是否返回存储源列表？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success",callback:i=>{i==="confirm"&&x.push("/admin/storage-list")}})})};H(()=>{U(),D()});const A=f(),D=()=>{K(c).then(t=>{t.data.type=t.data.type.key,A.value=t.data})},N=f(),q=(t,e,i,p)=>{p.preventDefault(),p.stopPropagation(),e.property==="allowAdmin"&&(t.allowAdmin=!t.allowAdmin),e.property==="allowAnonymous"&&(t.allowAnonymous=!t.allowAnonymous)},u=f(!1),g=C({get:()=>{if(!o.value)return u.value=!1,!1;let t=0;for(let e=0;e<o.value.length;e++)o.value[e].allowAdmin||t++;return t===o.value.length?(u.value=!1,!1):t===0?(u.value=!1,!0):(u.value=!0,!1)},set:t=>{if(o.value)for(let e=0;e<o.value.length;e++)o.value[e].allowAdmin=t}}),d=f(!1),v=C({get:()=>{if(!o.value)return d.value=!1,!1;let t=0;for(let e=0;e<o.value.length;e++)o.value[e].allowAnonymous||t++;return t===o.value.length?(d.value=!1,!1):t===0?(d.value=!1,!0):(d.value=!0,!1)},set:t=>{if(o.value)for(let e=0;e<o.value.length;e++)o.value[e].allowAnonymous=t}});return(t,e)=>{var h;const i=J,p=L("router-link"),k=le,w=ae,_=oe,M=ne,O=G;return z(),Q("div",se,[l("div",null,[l("div",re,[l("h3",ie,[a(p,{to:"/admin/storage-list"},{default:n(()=>[a(i,{class:"my-auto h-full mr-2 cursor-pointer"})]),_:1}),l("span",me,"存储源权限控制（"+b((h=r(A))==null?void 0:h.name)+"）",1),e[5]||(e[5]=l("span",{class:"badge-blue"},"Pro",-1)),l("span",ue,[e[3]||(e[3]=m("这个页面的功能已经废弃，已自动将数据迁移到 ")),a(p,{class:"text-blue-400",to:"/admin/user-list"},{default:n(()=>e[2]||(e[2]=[m("用户管理")])),_:1,__:[2]}),e[4]||(e[4]=m(" 中来配置权限。"))])])]),a(M,{ref_key:"tableRef",ref:N,onCellClick:q,"class-name":"mt-8",data:r(o)},{default:n(()=>[a(w,{align:"center","show-overflow-tooltip":"",prop:"operatorName",label:"操作"},{header:n(()=>[e[7]||(e[7]=l("span",null,"操作",-1)),a(k,{placement:"right",width:"300",trigger:"hover"},{default:n(()=>e[6]||(e[6]=[m(" 以下操作需要先在存储源打开"),l("b",null,"启用文件操作",-1),m("功能才可用，且会覆盖"),l("b",null,"允许匿名文件操作",-1),m("功能. ")])),reference:n(()=>[a(r(B),{class:"inline w-4 ml-1 -mt-0.5"})]),_:1})]),default:n(s=>[l("span",null,b(s.row.operatorName),1),a(k,{placement:"right",width:"300",trigger:"hover"},{default:n(()=>[m(b(s.row.tips),1)]),reference:n(()=>[Y(a(r(B),{class:"inline w-4 ml-1 -mt-0.5"},null,512),[[F,s.row.tips]])]),_:2},1024)]),_:1}),a(w,{align:"center",prop:"allowAdmin",label:"管理员"},{header:n(()=>[l("div",de,[e[8]||(e[8]=l("span",{class:"relative -top-[2px]"},"管理员",-1)),a(_,{disabled:"",indeterminate:r(u),modelValue:r(g),"onUpdate:modelValue":e[0]||(e[0]=s=>V(g)?g.value=s:null)},null,8,["indeterminate","modelValue"])])]),default:n(s=>[a(_,{disabled:"",modelValue:s.row.allowAdmin,"onUpdate:modelValue":y=>s.row.allowAdmin=y},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(w,{align:"center",prop:"allowAnonymous",label:"匿名用户"},{header:n(()=>[l("div",pe,[e[9]||(e[9]=l("span",{class:"relative -top-[2px]"},"匿名用户",-1)),a(_,{disabled:"",indeterminate:r(d),modelValue:r(v),"onUpdate:modelValue":e[1]||(e[1]=s=>V(v)?v.value=s:null)},null,8,["indeterminate","modelValue"])])]),default:n(s=>[a(_,{disabled:"",modelValue:s.row.allowAnonymous,"onUpdate:modelValue":y=>s.row.allowAnonymous=y},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"]),l("div",fe,[e[11]||(e[11]=l("div",{class:"flex-1"},null,-1)),a(O,{type:"primary",disabled:"",onClick:P,icon:r(ee)},{default:n(()=>e[10]||(e[10]=[m("保存")])),_:1,__:[10]},8,["icon"])])])])}}};typeof S=="function"&&S(R);const Qe=Z(R,[["__scopeId","data-v-1de60f1c"]]);export{Qe as default};
