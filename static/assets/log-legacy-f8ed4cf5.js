System.register(["./index-legacy-e574cec8.js","./loading-legacy-2688a411.js","./pagination-legacy-9b996ae5.js","./tag-legacy-5e0686c8.js","./select-legacy-8b64fa67.js","./scrollbar-legacy-0817fabf.js","./popper-legacy-ef8fd66b.js","./input-legacy-bc871eba.js","./table-column-legacy-0040b455.js","./checkbox-legacy-80a8805e.js","./tooltip-legacy-518b8698.js","./popconfirm-legacy-da863897.js","./popover-legacy-fa927888.js","./button-legacy-f53896dd.js","./open-in-new-legacy-ecaeb750.js","./baseline-content-copy-legacy-4d694d8f.js","./form-item-legacy-de8da7e8.js","./row-legacy-a6975c57.js","./col-legacy-9b42dca7.js","./admin-form-header-legacy-5b0f136c.js","./switch-legacy-a4b2d82c.js","./vue3-clipboard.esm-legacy-e37b8e98.js","./path-legacy-63087d21.js","./admin-storage-legacy-6381f83d.js","./useAdminSetting-legacy-246910c5.js","./request-legacy-61b983ae.js","./route-block-legacy-509c7347.js","./MagnifyingGlassIcon-legacy-d9a3789c.js","./ArrowPathIcon-legacy-4576c0d8.js","./TrashIcon-legacy-3360f913.js","./index-legacy-47a1148a.js","./index-legacy-69b9ad2b.js","./index-legacy-1ae34dc2.js","./index-legacy-183af9d3.js","./directive-legacy-64af483a.js","./index-legacy-c317e588.js","./index-legacy-ea3d196e.js","./strings-legacy-b2510e8b.js","./scroll-legacy-68db505b.js","./debounce-legacy-321ba92e.js","./index-legacy-d493f4b0.js","./vnode-legacy-bdad68af.js","./_initCloneObject-legacy-b35b9836.js","./_plugin-vue_export-helper-legacy-8fcf0e06.js","./dayjs.min-legacy-136cb260.js","./index-legacy-e86b74e4.js","./validator-legacy-a3ca6880.js","./base-legacy-173045dc.js","./index-legacy-b5baaeae.js"],(function(e,n){"use strict";var l,t,a,o,r,u,i,c,s,d,f,p,g,m,y,h,b,v,_,j,w,x,k,z,V,S,C,K,E,T,U,A,D,P,R,I,L,F,q,G,O,N,Q,X,$,B,M,W,Y,Z,H,J,ee;return{setters:[function(e){l=e.a3,t=e.r,a=e.o,o=e.b,r=e.g,u=e.k,i=e.w,c=e.x,s=e.f,d=e.l,f=e.F,p=e.G,g=e.e,m=e.y,y=e.al,h=e.am,b=e.an,v=e.a0,_=e.$,j=e.ah},null,function(e){w=e.E},null,function(e){x=e.E,k=e.a},null,null,function(e){z=e.E,V=e.a},null,null,null,function(e){S=e.E},null,function(e){C=e.E},function(e){K=e._},function(e){E=e._},null,function(e){T=e.E},function(e){U=e.E,A=e._},function(e){D=e._},function(e){P=e.E},function(e){R=e.t},function(e){I=e.c},function(e){L=e.l},function(e){F=e.u,q=e.b,G=e.l},function(e){O=e.f,N=e.E,Q=e.b},function(e){X=e.b},function(e){$=e.r},function(e){B=e.r},function(e){M=e.r},function(e){W=e.E},function(e){Y=e.E,Z=e.a},function(e){H=e.E},function(e){J=e.E},function(e){ee=e.v},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var n={class:"zfile-admin-down-link"},ne={class:"flex justify-between"},le={key:0,class:"flex space-x-1.5 justify-center items-center cursor-pointer"},te={class:"flex justify-between space-x-20"},ae={class:"text-gray-400"},oe={class:"z-admin-table-tools"},re={key:0},ue={key:1},ie=e("default",{__name:"log",setup:function(e){var X=F(q),ie=X.siteSetting,ce=X.saveData,se=l(),de=t({shortKey:"",linkType:"",storageKey:null,page:1,limit:10,path:"",ip:"",userAgent:"",referer:"",searchDate:[],total:0}),fe=t(),pe=function(){fe.value.resetFields()},ge=t(),me=t(!1),ye=function(){var e;me.value=!0,(e=de.value,O({url:"/admin/download/log/list",method:"get",data:e})).then((function(e){ge.value=e.data,de.value.total=e.dataCount})).finally((function(){me.value=!1}))},he=t(),be=t();a((function(){ye(),L().then((function(e){be.value=e.data})),G().then((function(e){he.value=e.data}))}));var ve=function(e){de.value.limit=e,de.value.page=1,ye()},_e=function(e){de.value.page=e,ye()},je=function(e){(function(e){return O({url:"/admin/download/log/delete/".concat(e),method:"delete"})})(e).then((function(e){N.success("删除成功"),ye()}))},we=t(),xe=function(){var e=we.value.getSelectionRows();0!==e.length?W.confirm("是否确认删除选中的 ".concat(e.length," 条直链下载日志？"),"提示",{type:"warning"}).then((function(){var n,l=e.map((function(e){return e.id}));(n={ids:l},O({url:"/admin/download/log/delete/batch",method:"post",data:n})).then((function(e){N.success("删除成功"),ye()}))})):N.warning("请至少选择一条数据")},ke=function(){W.confirm("是否确认删除当前查询条件下的 ".concat(de.value.total," 条直链下载日志？(如数量不对，请先点击查询后再用该功能按条件删除)"),"提示",{type:"warning"}).then((function(){var e;(e=getSearchParam().value,O({url:"/admin/download/log/delete/batch/query",method:"post",data:e})).then((function(e){N.success("清空成功"),ye()}))}))},ze=function(e){R(e).then((function(){N.success("复制成功")}))},Ve=function(e){window.open(e)},Se=function(e){return I(se.serverAddress,"s",e)},Ce=function(e){var n;return I(se.serverAddress,null==he||null===(n=he.value)||void 0===n?void 0:n.directLinkPrefix,e.storageKey,e.path)};return function(e,l){var t=P,a=D,R=x,I=k,L=z,F=U,q=Q,G=A,O=C,N=T,X=V,W=Y,he=H,Ke=J,Ee=E,Te=K,Ue=S,Ae=Z,De=w,Pe=ee;return o(),r("div",n,[u(a,{"hide-bottom-border":"","sub-title":"这里只记录用户通过直链/短链下载的记录，不包括文件预览，下载失败(超出访问次数，超出访问时间，无权限等)"},{title:i((function(){return[c("div",ne,[l[11]||(l[11]=c("span",null,"下载日志",-1)),s(ie)?(o(),r("div",le,[l[10]||(l[10]=c("span",{class:"text-gray-400 text-sm font-bold"},"记录下载日志：",-1)),u(t,{modelValue:s(ie).recordDownloadLog,"onUpdate:modelValue":l[0]||(l[0]=function(e){return s(ie).recordDownloadLog=e}),"active-text":"是","inactive-text":"否","inline-prompt":"",onChange:s(ce)},null,8,["modelValue","onChange"])])):d("",!0)])]})),_:1}),u(X,{inline:"",class:"z-admin-search-from",size:s(se).adminSearch.size,"label-width":"100",ref_key:"searchFormRef",ref:fe,"label-position":s(se).adminSearch.labelPosition,model:s(de)},{default:i((function(){return[u(N,{class:"z-admin-search-from-row",gutter:20},{default:i((function(){return[u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(L,{label:"存储源",prop:"storageKey"},{default:i((function(){return[u(I,{clearable:"",modelValue:s(de).storageKey,"onUpdate:modelValue":l[1]||(l[1]=function(e){return s(de).storageKey=e}),placeholder:"请选择存储源"},{default:i((function(){return[(o(!0),r(f,null,p(s(be),(function(e){return o(),g(R,{key:e.id,label:e.name,value:e.key},{default:i((function(){return[c("div",te,[c("span",null,m(e.name),1),c("span",ae,m(e.type.description),1)])]})),_:2},1032,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})]})),_:1},8,["span"]),u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(L,{label:"下载类型",prop:"linkType"},{default:i((function(){return[u(I,{clearable:"",modelValue:s(de).linkType,"onUpdate:modelValue":l[2]||(l[2]=function(e){return s(de).linkType=e}),placeholder:"请选择下载类型"},{default:i((function(){return[u(R,{label:"直链",value:"directLink"}),u(R,{label:"短链",value:"shortLink"})]})),_:1},8,["modelValue"])]})),_:1})]})),_:1},8,["span"]),u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(L,{label:"短链 Key",prop:"shortKey"},{default:i((function(){return[u(q,{clearable:"",modelValue:s(de).shortKey,"onUpdate:modelValue":l[3]||(l[3]=function(e){return s(de).shortKey=e})},null,8,["modelValue"])]})),_:1})]})),_:1},8,["span"]),u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(L,{label:"文件路径",prop:"path"},{default:i((function(){return[u(q,{clearable:"",modelValue:s(de).path,"onUpdate:modelValue":l[4]||(l[4]=function(e){return s(de).path=e})},null,8,["modelValue"])]})),_:1})]})),_:1},8,["span"]),u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(L,{label:"请求 IP",prop:"ip"},{default:i((function(){return[u(q,{clearable:"",modelValue:s(de).ip,"onUpdate:modelValue":l[5]||(l[5]=function(e){return s(de).ip=e})},null,8,["modelValue"])]})),_:1})]})),_:1},8,["span"]),u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(L,{label:"UserAgent",prop:"userAgent"},{default:i((function(){return[u(q,{clearable:"",modelValue:s(de).userAgent,"onUpdate:modelValue":l[6]||(l[6]=function(e){return s(de).userAgent=e})},null,8,["modelValue"])]})),_:1})]})),_:1},8,["span"]),u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(L,{label:"Referer",prop:"referer"},{default:i((function(){return[u(q,{clearable:"",modelValue:s(de).referer,"onUpdate:modelValue":l[7]||(l[7]=function(e){return s(de).referer=e})},null,8,["modelValue"])]})),_:1})]})),_:1},8,["span"]),u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(L,{label:"下载时间",prop:"searchDate"},{default:i((function(){return[u(G,{class:"w-full",shortcuts:s(y),modelValue:s(de).searchDate,"onUpdate:modelValue":l[8]||(l[8]=function(e){return s(de).searchDate=e}),type:"daterange","value-format":s(h),"default-time":s(b),"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["shortcuts","modelValue","value-format","default-time"])]})),_:1})]})),_:1},8,["span"]),u(F,{span:s(se).adminSearch.spanSize},{default:i((function(){return[u(O,{type:"primary",icon:s($),loading:s(me),onClick:ye},{default:i((function(){return l[12]||(l[12]=[v(" 查询 ")])})),_:1,__:[12]},8,["icon","loading"]),u(O,{icon:s(B),loading:s(me),onClick:pe},{default:i((function(){return l[13]||(l[13]=[v("重置")])})),_:1,__:[13]},8,["icon","loading"])]})),_:1},8,["span"])]})),_:1})]})),_:1},8,["size","label-position","model"]),c("div",oe,[u(O,{size:s(se).adminTable.size,onClick:xe,icon:s(M),type:"danger"},{default:i((function(){return l[14]||(l[14]=[v("批量删除选中 ")])})),_:1,__:[14]},8,["size","icon"]),u(O,{size:s(se).adminTable.size,onClick:ke,icon:s(M),type:"danger"},{default:i((function(){return l[15]||(l[15]=[v("删除全部页 ")])})),_:1,__:[15]},8,["size","icon"])]),_((o(),g(Ae,{border:"",data:s(ge),size:s(se).adminTable.size,ref_key:"tableRef",ref:we},{default:i((function(){return[u(W,{type:"selection",width:"55"}),u(W,{align:"center",fixed:s(j),width:"120",label:"存储源名称"},{default:i((function(e){var n;return[u(he,{content:null===(n=e.row.storageType)||void 0===n?void 0:n.description,placement:"right"},{default:i((function(){return[c("span",null,m(e.row.storageName),1)]})),_:2},1032,["content"])]})),_:1},8,["fixed"]),u(W,{fixed:s(j),width:"90",align:"center",label:"下载类型"},{default:i((function(e){return[e.row.shortKey?(o(),g(Ke,{key:0,type:"success"},{default:i((function(){return l[16]||(l[16]=[v("短链")])})),_:1,__:[16]})):(o(),g(Ke,{key:1},{default:i((function(){return l[17]||(l[17]=[v("直链")])})),_:1,__:[17]}))]})),_:1},8,["fixed"]),u(W,{"min-width":"400","show-overflow-tooltip":"",prop:"shortKey",label:"下载链接"},{default:i((function(e){return[e.row.shortKey?(o(),r("div",re,[c("span",null,m(s(Se)(e.row.shortKey)),1),u(Ee,{onClick:function(n){return s(ze)(s(Se)(e.row.shortKey))},class:"ml-2 inline cursor-pointer"},null,8,["onClick"]),u(Te,{onClick:function(n){return s(Ve)(s(Se)(e.row.shortKey))},class:"ml-1 inline cursor-pointer text-blue-500 text-sm"},null,8,["onClick"])])):(o(),r("div",ue,[c("span",null,m(s(Ce)(e.row)),1),u(Ee,{onClick:function(n){return s(ze)(s(Ce)(e.row))},class:"ml-2 inline cursor-pointer"},null,8,["onClick"]),u(Te,{onClick:function(n){return s(Ve)(s(Ce)(e.row))},class:"ml-1 inline cursor-pointer text-blue-500 text-sm"},null,8,["onClick"])]))]})),_:1}),u(W,{width:"300","show-overflow-tooltip":"",prop:"path",label:"文件路径"}),u(W,{width:"100","show-overflow-tooltip":"",prop:"ip",label:"请求 IP"}),u(W,{width:"250","show-overflow-tooltip":"",prop:"userAgent",label:"UserAgent"}),u(W,{width:"200","show-overflow-tooltip":"",prop:"referer",label:"Referer"}),u(W,{width:"170",prop:"createTime",label:"下载时间"}),u(W,{fixed:"right",align:"center",width:"80",label:"操作"},{default:i((function(e){return[u(Ue,{title:"是否确认删除?",onConfirm:function(n){return je(e.row.id)}},{reference:i((function(){return[u(s(M),{class:"z-btn-danger"})]})),_:2},1032,["onConfirm"])]})),_:1})]})),_:1},8,["data","size"])),[[Pe,s(me)]]),u(De,{class:"mt-3","page-size":s(de).limit,background:"",layout:s(se).adminTable.pager.layout,size:s(se).adminTable.pager.size,"pager-count":s(se).adminTable.pager.pagerCount,onCurrentChange:_e,onSizeChange:ve,"current-page":s(de).page,"onUpdate:currentPage":l[9]||(l[9]=function(e){return s(de).page=e}),"default-current-page":10,"page-sizes":[10,50,100,200,1e3,99999999],total:s(de).total},null,8,["page-size","layout","size","pager-count","current-page","total"])])}}});"function"==typeof X&&X(ie)}}}));
